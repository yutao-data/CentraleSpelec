"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[642850],{7313:(e,t,n)=>{n.d(t,{N:()=>s});var i=n(572909),a=n(937545),o=n(693973),r=n(740875);const s=async(e,t,n,s)=>{if("Meeting"!==e.type)return Promise.reject("callingIntent must be of type Meeting");let c,d,l;if(e.coordinates.legacyMeeting){const{conversationId:t,rootMessageId:n,tenantId:i,meetingCloud:a}=e.coordinates.legacyMeeting;c=`${t}/${n}`,d=i,l=(0,r.iy)({...e.coordinates.legacyMeeting,meetingCloud:a||""})}else{if(!e.coordinates.meetingData)return Promise.reject("meeting coordinates not set on callingIntent");{const{meetingCode:t,meetingUrl:n}=e.coordinates.meetingData;if(!t&&!n)return Promise.reject("no meetingCode/meetingUrl in meetingData coordinates");c=t||n,d=void 0,l=n||void 0}}const u=(0,r.sB)(l||"",s);await n.deepLink.executeIntent({entityCommand:{entity:{type:i.ck.meetings,action:i.SY.join,id:c},command:{visibilityState:a.Rp.show,stateTransition:a.Ar.new,layoutMode:o.Rm.focus,correlation:t},entityOptions:{callingIntent:e,isBroadcastMeeting:!!e.coordinates.legacyMeeting?.broadcast||void 0}},metadata:{allowAnonymous:!0,tenantId:d,deepLink:l}},u)}},627062:(e,t,n)=>{n.d(t,{lD:()=>S,_C:()=>f,VI:()=>y,ao:()=>g,s4:()=>C,hT:()=>D,_v:()=>E,YT:()=>v,jI:()=>I});var i=n(572909),a=n(937545),o=n(131647),r=n(903502),s=n(363678),c=n(601440),d=n(702183),l=n(562292);const u=["bd9fb5cb-4d02-4cc6-a7f4-52a8a62d30b7","9d17e873-c4c4-424d-869c-67f62a3d3174","77be3f72-7c14-415f-992c-3511dd54a4ae","66aeee93-507d-479a-a3ef-8f494af43945","62554c36-4756-4d4e-b8fb-f4b24875ae0c","2c95977d-f2fb-4df3-ad70-1aece87afe03","98eb9edc-3b11-4950-8780-c6ec73d71571","98eb9edc-3b11-4950-8780-c6ec73d71572","be9c77ca-202c-4f11-9241-b27afd891781","5a22b425-b693-4f86-b668-31baeb3dad6c","b85718a3-6d15-4f59-8fad-b6809c6fc6a9","2c95977d-f2fb-4df3-ad70-1aece87afe00","2c95977d-f2fb-4df3-ad70-1aece87afe01","2c95977d-f2fb-4df3-ad70-1aece87afe02"],m={qna:"5db56dd0-534d-467b-aeda-d622bee2574a"};var p=n(361226),h=n(111143),k=n(701750);const _="_djb2_msteams_prefix_",v="tab::",S=2,g=(e,t)=>t?.startsWith(_)?t:`${_}${(0,c.M)(`${e}:${t?.replace(/\+/g," ")}`)}`,f=(e,t,n,r,c,d,l,u,m,p,h)=>({entity:{type:i.ck.extensions,id:JSON.stringify({appId:e,tabEntityId:d,subEntityId:u}),action:i.SY.view},command:{visibilityState:l?.visibilityState??a.Rp.show,stateTransition:t?a.Ar.new:l?.stateTransition??a.Ar.flush,correlation:{source:c??o.p.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:r?s.hB.activityFeed:s.hB.personalApp,isMultiWindow:t,subEntityId:u,isAppSelected:m,source:c,originalDeeplink:p||void 0,reloadTrigger:n,isFromActivityFeed:r,skipAppCacheRemoveOnReload:h}}),y=(e,t,n,c,d,l,m,p,h,k,_)=>{if(b(t)){const n=N(t,c,d,l,h,e,_,p);if(n)return n}return{entity:{type:i.ck.extensions,id:JSON.stringify({appId:t,threadId:n||c,tabId:null,tabEntityId:g(t,m)}),action:i.SY.view,linkedEntity:{id:n?JSON.stringify({channelId:n}):c,type:n?i.ck.channels:i.ck.chats,action:i.SY.view}},command:{visibilityState:p?.visibilityState??a.Rp.show,stateTransition:p?.stateTransition??a.Ar.forceFlush,correlation:{source:o.p.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{entryPoint:n?s.hB.channelTab:s.hB.chatTab,source:o.p.PlatformTabDeepLink,subEntityId:h,reloadTabTrigger:k,originalDeeplink:e,isAppTeamLevelApp:u.includes(t),...!!c&&{focusOnLoad:r.I.DoNotMove}}}},E={files:"files",photos:"photos",attendancereport:"attendancereport",recordingsandtranscripts:"recordingsandtranscripts",recap:"recap",breakoutrooms:"breakoutrooms",coachReport:"coachReport",qna:"qna"},b=e=>Object.values(m).includes(e),N=(e,t,n,c,d,l,u,h)=>((0,p.pP)(n,"Non apps platform tab deeplink handling"),c?.cancel(),e===m.qna?{entity:{type:i.ck.yammerqna,id:JSON.stringify({chatId:t,subEntityId:d}),action:i.SY.view,linkedEntity:{action:null,id:t,type:i.ck.chats}},command:{visibilityState:h?.visibilityState??a.Rp.show,stateTransition:h?.stateTransition??a.Ar.flow,correlation:{source:o.p.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{conversationId:t,entryPoint:s.hB.activityFeed,source:o.p.ActivityFeed,subEntityId:d,meetingTenantId:u,originalDeeplink:l,...!!t&&{focusOnLoad:r.I.DoNotMove}}}:null),I=async(e,t,n,c,l,u,m,p,h)=>{m?.findScenario(d.Cu.PlatformTabDeeplinkHandling)?.cancel();const k=m?.newScenario(d.Cu.PlatformTabDeeplinkHandling);k&&m?.hoistScenarioToCore?.(k),k?.appendEventData({"PlatformTabDeeplink.pathname":n.pathname,"PlatformTabDeeplink.search":n.search}),k?.mark("create_deeplink_command");const _="files"===u,v=(e=>{switch(e){case E.files:return i.ck.file;case E.photos:return i.ck.gallery;case E.attendancereport:return i.ck.meetinganalytics;case E.recordingsandtranscripts:return i.ck.transcriptcontent;case E.recap:return i.ck.meetingrecap;case E.breakoutrooms:return i.ck.breakoutrooms;case E.coachReport:return i.ck.coachreport;case E.qna:return i.ck.yammerqna;default:return i.ck.extensions}})(u),{entityType:S,appId:g}=await T(v,e,u,h),f={entityCommand:{entity:{type:S,action:_?i.SY.list:i.SY.view,id:v===i.ck.extensions?JSON.stringify({appId:g,threadId:e||t,tabId:u,tabEntityId:S===i.ck.channelcalendar?"":null}):null,linkedEntity:{id:e?JSON.stringify({channelId:e}):t,type:e?i.ck.channels:i.ck.chats,action:i.SY.view}},command:{stateTransition:p?.stateTransition??a.Ar.flush,visibilityState:p?.visibilityState??a.Rp.show},entityOptions:{subEntityId:l?.subEntityId,entryPoint:e?s.hB.channelTab:s.hB.chatTab,source:o.p.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:n,...v===i.ck.coachreport&&{threadId:t},...!!t&&{focusOnLoad:r.I.DoNotMove}}},metadata:{allowAnonymous:!1,tenantId:c}};return k?.mark("return_deeplink_command"),k?.appendEventData({"PlatformTabDeeplink.generatedCommand":f.toString()}),Promise.resolve(f)},D=(e,t,n)=>{const i=t?.baseInfo?.appId??"",a=t?.baseInfo?.id??"";let o="";return"StaticExtensionTab"!==t?.__typename&&"ExtensionTab"!==t?.__typename||!t?.entityId||(o=t?.entityId),{appId:i,threadId:e,tabId:a,tabEntityId:o,messageId:(0,l.JU)(n)?n:void 0}},C=(e,t,n,i,a)=>{const o=t?.baseInfo?.appId??"",r=t?.baseInfo?.id??"";let s="";return"StaticExtensionTab"!==t?.__typename&&"ExtensionTab"!==t?.__typename||!t?.entityId||(s=t?.entityId),i&&a?JSON.stringify(((e,t,n,i,a)=>{const o=("ExtensionTab"===e?.__typename||"StaticExtensionTab"===e?.__typename)&&e?.entityId||null,r=o?`_djb2_msteams_prefix_${(0,c.M)(`${i?e?.baseInfo?.externalAppId:e?.baseInfo?.appId}:${o?.replace(/\+/g," ")}`)}`:null;return n?{appId:o?i?e?.baseInfo?.externalAppId:e?.baseInfo?.appId:null,threadId:t,tabId:o?null:e?.baseInfo?.id,tabEntityId:r,messageId:(0,l.JU)(a)?a:void 0}:{appId:e.baseInfo.appId,threadId:t,tabId:e.baseInfo.id,tabEntityId:o,messageId:(0,l.JU)(a)?a:void 0}})(t,e,i,void 0,n)):JSON.stringify({appId:o,threadId:e,tabId:r,tabEntityId:s,messageId:(0,l.JU)(n)?n:void 0})},T=async(e,t,n,a)=>{let o=e,r=null;if(e===i.ck.extensions&&n&&a)try{const e=await a.query({query:h.F,variables:{threadId:t,tabId:n},fetchPolicy:"network-only"});"CalendarTab"===e?.data?.platformTab?.__typename&&e?.data?.platformTab?.baseInfo?.appId===k.j&&(o=i.ck.channelcalendar,r=k.j)}catch(e){}return{entityType:o,appId:r}}},541381:(e,t,n)=>{n.d(t,{D:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppButtonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appButtonResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]}},883038:(e,t,n)=>{n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformBackButtonHandlerStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"backButtonHandlerState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registered"}}]}}]}}]}},335483:(e,t,n)=>{n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},950362:(e,t,n)=>{n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsTriggerQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsTriggerResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},793236:(e,t,n)=>{n.d(t,{R:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformLocalFrameContextQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localFrameContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}}]}}]}}]}},828822:(e,t,n)=>{n.d(t,{V:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mapCoordinateResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mapCoordinateResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}},{kind:"Field",name:{kind:"Name",value:"locationApiError"}}]}}]}}]}},530811:(e,t,n)=>{n.d(t,{B:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToChildResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToChildResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},609904:(e,t,n)=>{n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectMediaResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaError"}},{kind:"Field",name:{kind:"Name",value:"mediaUrls"}}]}}]}}]}},800520:(e,t,n)=>{n.d(t,{m:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectPeoplePickerResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectPeoplePickerResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}}]}}]}}]}},186070:(e,t,n)=>{n.d(t,{z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"showLocationResponse"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showLocationResponse"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},189261:(e,t,n)=>{n.d(t,{g:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"viewImagesResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesError"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},211489:(e,t,n)=>{var i;n.d(t,{AZ:()=>c,B4:()=>d,sT:()=>l,QV:()=>u,Sx:()=>m}),function(e){e.StoreDevices="StoreDevices",e.StoreCart="StoreCart",e.StoreCartCheckout="StoreCartCheckout"}(i||(i={}));const a="openDeviceDetailsDialog",o="openStoreCartCheckoutDialog",r="openStoreCartDialog",s="closeStoreCartCheckoutDialog",c={openDeviceDetailsDialog:e=>({originator:i.StoreDevices,type:a,data:()=>({...e})}),openStoreCartDialog:()=>({originator:i.StoreCart,type:r}),openStoreCartCheckoutDialog:e=>({originator:i.StoreCartCheckout,type:o,data:()=>({...e})}),closeStoreCartCheckoutDialog:()=>({originator:i.StoreCartCheckout,type:s})},d=e=>p(e)&&e.type===a,l=e=>p(e)&&e.type===r,u=e=>p(e)&&e.type===o,m=e=>p(e)&&e.type===s,p=e=>Object.keys(i).includes(e.originator)},81670:(e,t,n)=>{n.d(t,{yq:()=>i,QF:()=>a,ct:()=>o,NP:()=>r,F9:()=>s,CO:()=>c,D2:()=>d,kj:()=>l,pw:()=>u,GT:()=>m,yx:()=>p,$Z:()=>h,tG:()=>k,Cd:()=>_,p2:()=>v,Pj:()=>S,NI:()=>g,xM:()=>f,oF:()=>y,$X:()=>E,i3:()=>N,vF:()=>I,ar:()=>C,Ib:()=>T,FQ:()=>A,zB:()=>F,xD:()=>R,J:()=>M,bw:()=>w,Xz:()=>O,Oi:()=>P,OF:()=>U,wk:()=>x,aF:()=>L,gl:()=>$,Qc:()=>B});const i="TflFreProfileCardDisplayed",a="LogoutState",o="authSessionId",r="tmp.previous.silent.signin",s="in-progress",c={nopa:"2"},d={coa:"1"},l="tenantId",u="loginhint",m="login_hint",p="clientexperience",h="t2",k={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",CloudMismatch:"CloudMismatch",CloudMismatchNoMultiCloud:"CloudMismatchNoMultiCloud",MultiMSARoadBlock:"MultiMSARoadBlock",InitFailure:"Core-auth init failure",NoMatchingUserFound:"NoMatchingUserFound",InteractionRequired:"InteractionRequired",UnsupportedAccountType:"UnsupportedAccountType",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",NoNetwork:"NoNetwork",MachineAsleep:"MachineAsleep",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",InvalidEndpoint:"endpoints_resolution_error",UnsupportedParameter:"UnsupportedParameter",UserAuthOrHomeAccountNotAvailable:"UserAuthOrHomeAccountNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken",HiddenUserErrorForLogin:"HiddenUserErrorForLogin",MsaUserNotAllowed:"MsaUserNotAllowed",ShowTenantPicker:"ShowTenantPicker",LogOutTriggeredFromCrossCloud:"Log out triggered cross cloud",NoSkypetokenAvailableInResponse:"NoSkypetokenAvailableInResponse",PushNotificationEventWithErrors:"PushNotificationEventWithErrors",NoTenantsFound:"NoTenantsFound",SkypeTokenResponseInvalidJson:"SkypeTokenResponseInvalidJson",AcquireTokenCloudMismatch:"AcquireTokenCloudMismatch",CrossCloudTenantInWeb:"CrossCloudTenantInWeb",SkypeTokenMigrationUnsupportedClient:"SkypeTokenMigrationUnsupportedClient"},_={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},v="https://login.microsoftonline.com/",S=[{cloud:"prod",authority:v},{cloud:"gallatin",authority:"https://login.partner.microsoftonline.cn/"},{cloud:"dod",authority:"https://login.microsoftonline.us/"},{cloud:"gcch",authority:"https://login.microsoftonline.us/"},{cloud:"life",authority:v},{cloud:"airgap09",authority:"https://login.microsoftonline.microsoft.scloud/"},{cloud:"airgap08",authority:"https://login.microsoftonline.eaglex.ic.gov/"}],g="InteractionRequiredAuthError",f="skype-token";var y,E;!function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com",e.IC3_GATEWAY_CAE_KEY_INT="https://ic3-testing.teams.office.com",e.IC3_GATEWAY_AAD_KEY_INT="https://ic3-non-cae-testing.teams.office.com"}(y||(y={})),function(e){e.openId="openId",e.profile="profile"}(E||(E={}));let b=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error","Sending silent Cross-Cloud request on unsupported version of Windows"];const N=e=>(e&&(b=[...b,...e]),b),I=()=>b;let D=[];const C=e=>(e&&(D=[...D,...e]),D),T=e=>D.includes(e);var A,F,R;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.TEN=10]="TEN",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY",e[e.TWO_HUNDRED_FIFTY_FIVE=255]="TWO_HUNDRED_FIFTY_FIVE"}(A||(A={})),function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.ONE_DAY=864e5]="ONE_DAY"}(F||(F={})),function(e){e.services="f8cdef31-a31e-4b4a-93e4-5f571e91255a"}(R||(R={}));const M="9188040d-6c67-4c5b-b112-36a304b66dad",w="wids",O="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",P="b44d8d43-c828-450b-9b6f-ae3788447705",U="X-MS-Migration",x="X-Ms-Test-User",L=(A.TWO,F.MILLI_PER_SECOND,F.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim",SKYPE_ONLY_TEAMS_SHARED_DEVICES:"skype_only_teams_shared_devices"}),$={MTO:"MTO"},B={TENANTSV2:"/beta/users/tenantsv2"}},663789:(e,t,n)=>{n.d(t,{l:()=>i});class i{}i._authTelemetryCollection={},i._correlationMap={},i._userBiServiceMap={},i.getUserBiService=e=>i._userBiServiceMap[e]||i._userBiServiceMap.GLOBAL,i.setUserBiService=(e,t)=>{t?i._userBiServiceMap[e]=t:delete i._userBiServiceMap[e]},i.getAuthTelemetry=e=>i._authTelemetryCollection[e],i.setAuthTelemetry=(e,t)=>i._authTelemetryCollection[e]=t,i.delete=e=>{delete i._authTelemetryCollection[e];const t=Object.keys(i._correlationMap);for(const n in t)if(i._correlationMap.hasOwnProperty(t[n])){const a=t[n],o=i._correlationMap[a];o&&(i._correlationMap[a]=o.filter((t=>t!==e)))}},i.getCorrelation=e=>i._correlationMap[e],i.setCorrelation=e=>{if(!e.scenarioName)return;const t=i.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),i._correlationMap[e.scenarioName]=t}},899855:(e,t,n)=>{n.d(t,{we:()=>p,yw:()=>m,d9:()=>u,$C:()=>_,nd:()=>k,FS:()=>v});var i=n(710225),a=n(736626),o=n(726723),r=n(195695),s=n(667606),c=n(663789);class d{constructor(e,t,n,d,l,u,m,p,h){this._scenarioFactory=e,this._correlation=t,this._asyncAuthCache=n,this._subContext=d,this._shouldCreateScenario=l,this._isBatch=u,this._timeoutMs=m,this._telemetryService=p,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData={...this._localScenarioEventData,...e}},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},n)=>{t=this._mapEventData(t,n),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),this.logMessage(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,a.hR)(t)}]`)},this.closeScenario=(e={},t,n,a)=>{if(e=this._mapEventData(e,t),n)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(this._isBatch&&this._correlation.scenarioName&&(this._batchScenarioStartTime&&(e.perfDelta=performance.now()-this._batchScenarioStartTime),e.correlationId=e.correlationId??this._correlation.id,"success"===e.status?(0,r.G4)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,a):"failure"===e.status?(0,r.Bz)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,a):(0,r.Fy)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,a)),!this._scenario){const t=this._shouldCreateScenario?i.D.warn:i.D.log,n=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${n} [scenarioEventData]`,e),void c.l.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const o="failure"===e.status?i.D.error:i.D.log;this.logEventData(o,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),c.l.delete(this._correlation.id)},this.createScenario=(e,t,n)=>{this._scenario?this.logMessage(`createScenario called with [${this._subContext}][${(0,a.hR)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`,i.D.warn):(this._createScenario(e,n||this._timeoutMs,{...this._localScenarioEventData,...t}),this.logMessage(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const n={panelRegion:o.rP.main,panelType:o.HP.AuthStart,actionWorkload:o.E0.auth,actionSubworkload:o.i7.sisu,actionScenarioType:o.DB.appAuth,actionScenario:t.scenario,actionGesture:t.actionGesture||o.Od.auto},a=c.l.getUserBiService(e||"GLOBAL");a&&a.recordPanelAction(n,i.D)},this.setUserToTelemetryContext=e=>{e&&(this._telemetryService?.setAuthContext(e),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`))},this.setUserDetailsToTelemetryContext=e=>{if(e){const{region:t}=e;void 0!==t&&this._telemetryService?.setCoreContext("UserInfo.Region",t),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>(e.subContext=e.subContext||this._subContext,(e={...this._localScenarioEventData,...e}).error&&(e.error={...e.error,message:e.error.message,errorMetaData:void 0},e.errorCode=e.error.code??e.error.errorCode,e.message=e.error.message||"",this.addEventData([`errorCode:${e.error.errorCode}`])),!t&&e.error&&(t=(0,s.$z)(e.error)?"incomplete":"failure"),e.eventData=this._eventData.join(","),e.status=t||"success",e),this._createScenario=(e,t,n)=>{const a=t?{timeoutMs:t}:{};this._scenario=this._scenarioFactory.findScenario(e)||void 0,this._scenario||(this._scenario=this._scenarioFactory.newScenario(e,a),this._scenario.appendEventData({createdBy:"authTelemetry"}));try{this._scenarioFactory.hoistScenarioToCore?.(this._scenario)}catch(e){i.D.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source,...n}),this._shouldCreateScenario=!0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,n)=>{n.error||delete n.error;const i=this.splitStringEqually((0,a.hR)(n));for(const n of i)this.logMessage(`${t}${n}`,e)},this.splitStringEqually=(e,t=300)=>{const n=new RegExp(`.{1,${t}}`,"g"),i=e.match(n);return i||[]},this.logMessage=(e,t)=>{this._isBatch||(t?t(e):i.D.log(e))},this._loggingPrefix=this.loggingPrefix(),this._isBatch&&(this._batchScenarioStartTime=performance.now()),l&&(h?this._scenario=h:this._correlation?.scenarioName&&this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),this.logMessage(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${l}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return{...this._correlation}}}class l{constructor(e,t,n){this._scenarioProvider=e,this._asyncAuthCache=t,this._telemetryService=n,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{const t=new d(this._scenarioProvider,e.correlation,this._asyncAuthCache,e.subContext,!0,e.isBatch??!1,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>c.l.getCorrelation(e)||[],this._createScenario=(e,t)=>{const{correlation:n,subContext:i,scenarioEventData:a,timeoutMs:o,scenario:r,isBatch:s}=e;let l=c.l.getAuthTelemetry(n.id);if(l)l.addEventData([`fn:${i}`]);else{const a=this._telemetryService?.getTelemetryServicesCache().get(e.scenarioEventData?.accountId);l=new d(a?.coreScenarioFactory||this._scenarioProvider,n,this._asyncAuthCache,i,t,s??!1,o,a?.telemetryService||this._telemetryService,r),c.l.setAuthTelemetry(n.id,l)}return a&&l.appendScenarioEventData(a),c.l.setCorrelation(n),l}}}const u=(e,t)=>{c.l.setUserBiService(e||"GLOBAL",t)},m=e=>h({...e,startWithoutScenario:!1}),p=e=>{e.options.correlation={id:e.options.correlation?.id??(0,a.DA)(),scenarioName:e.options.correlation?.scenarioName??e.scenarioName,source:e.options.correlation?.source??e.source};const{options:{correlation:t},...n}=e;return h({correlation:t,...n})},h=e=>{const{correlation:t,subContext:n,scenarioEventData:i,eventData:a,timeoutMs:o,scenario:r,isBatch:s}=e,d=c.l.getAuthTelemetry(t.id),l=(e.startWithoutScenario||!t.scenarioName?_.createWithoutScenario:_.create)({correlation:t,subContext:n,scenarioEventData:i,timeoutMs:o,scenario:r,isBatch:s});a&&l.addEventData(a);return[l,(e,t,n)=>l.closeScenario(e,t,!!d,n)]},k=e=>_.getCorrelation(e);let _;const v=(e,t,n)=>{_||(_=new l(e,t,n),i.D.log("authTelemetryProvider initialized"))}},667606:(e,t,n)=>{n.d(t,{$5:()=>r,r$:()=>s,pz:()=>c,BI:()=>d,$z:()=>l,Oi:()=>u});var i=n(81670),a=n(850434),o=n(736626);function r(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}const s=(e,t,n)=>{switch(e.code){case a.O4.NoNetwork:return c({name:"offlineEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"OfflineError",errorMetaData:void 0});case a.O4.SignInRestrictions:return c({name:"signInRestrictionEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"SignInRestriction",errorMetaData:n})}return e};function c(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetaData:e.errorMetaData,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError,message:e.message})}function d(e){return(0,i.vF)().indexOf(e)>=0}function l(e){return e&&(e.isExpected||d(e.errorCode)||!!(t=e.message)&&(0,i.vF)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}function u(e,t,n,r=!0){let s,d,l="";const{name:u,email:m,pictureBlob:p,customError:h,shouldBypassEndPageLogout:k}=e;let _={accountId:n,name:u,email:m,pictureBlob:p,userLoggedIn:r};switch(t){case"LicenseError":s="licenseEndPage",d="show-license-error",l=a.O4.Forbidden;break;case"SignInRestriction":s="signInRestrictionEndPage",d="show-signin-restriction-error",l=a.O4.SignInRestrictions;break;case"MsaUserNotAllowed":s="msaUserNotAllowedEndPage",d="show-msa-user-not-allowed-error",l=i.tG.ShowTenantPicker,_={..._,preventLogout:k||!1};break;default:s="",d=""}return c({authSubErrorCode:t,errorCode:l,errorMetaData:_,name:s,message:h?.message||"",correlationId:h?.correlationId||(0,o.DA)(),context:h?.context||"endPageDataToAuthError",subContext:h?.subContext||d})}},701750:(e,t,n)=>{n.d(t,{j:()=>i});const i="44263ed4-f1ac-4e96-93aa-d24dd50459ea"},639908:(e,t,n)=>{n.d(t,{cP:()=>o,Xb:()=>r,CM:()=>s});const i=200;function a(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType=t,new Promise(((e,t)=>{n.onload=()=>{n.status===i&&n.response?e(n.response):t(n.status!==i?{status:n.status,statusText:n.statusText}:{status:404,statusText:"no response data"})},n.onerror=()=>{t({status:n.status,statusText:n.statusText})},n.send()}))}async function o(e){return await a(e,"blob")}async function r(e){const t=await a(e,"arraybuffer");return new Uint8Array(t)}async function s(e){return e.then((e=>URL.createObjectURL(e)))}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/642850-7020f4ba520154f5.js.map