"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[106421],{263852:(e,n,t)=>{t.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsConnectedCalendarConnectedCalendarSettingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCalendarSetting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"accountAddress"}},{kind:"Field",name:{kind:"Name",value:"accountId"}},{kind:"Field",name:{kind:"Name",value:"isSyncAllowed"}},{kind:"Field",name:{kind:"Name",value:"eTag"}}]}}]}},291555:(e,n,t)=>{t.d(n,{V:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"syncConnectedCalendarSettings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syncConnectedCalendarSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsConnectedCalendarConnectedCalendarSettingFragment"}}]}}]}},...t(263852).H.definitions]}},88119:(e,n,t)=>{var a,i;t.d(n,{DG:()=>a,Mv:()=>i,qh:()=>s}),function(e){e.CreateTeam="CreateTeam",e.CreateChannel="CreateChannel",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.MarkAllChannelsAsRead="MarkAllChannelsAsRead",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(a||(a={})),function(e){e.None="None",e.PinChannel="PinChannel",e.UnpinChannel="UnpinChannel",e.ShowChannel="ShowChannel",e.HideChannel="HideChannel",e.ShowTeam="ShowTeam",e.HideTeam="HideTeam",e.ExpandTeam="ExpandTeam",e.CollapseTeam="CollapseTeam",e.ReorderTeam="ReorderTeam",e.ReorderPinnedChannels="ReorderPinnedChannels",e.ForceHideTeam="ForceHideTeam",e.SetChannelRecommendation="SetChannelRecommendation",e.StopChannelRecommendation="StopChannelRecommendation"}(i||(i={}));const s={forceSync:!1}},596889:(e,n,t)=>{t.d(n,{H:()=>o});var a=t(957032),i=(t(513432),t(109427)),s=t(965937);const o=e=>(0,a.Y)(s.e,{loaderRenderer:()=>(0,a.Y)(i.l,{}),...e})},109427:(e,n,t)=>{t.d(n,{l:()=>d});var a=t(957032),i=t(513432),s=t(910316),o=t(899273);const r=(0,t(965804).O)({root:{Bqenvij:"f1l02sjl"}}),d=({label:e,delay:n})=>{const t=i.useRef(),d=(0,o.ur)(),l=d?.host||window,[c,u]=i.useState(!n),p=r();return i.useEffect((()=>(void 0!==n&&n>0&&!t.current&&(t.current=l.setTimeout((()=>{u(!0)}),n)),()=>l.clearTimeout(t.current))),[n,l]),c?(0,a.Y)(s.y,{size:"large",label:{children:e||"Loading..."},labelPosition:"below",className:p.root}):null}},151692:(e,n,t)=>{t.d(n,{GT:()=>c,Ep:()=>u,Cd:()=>m,us:()=>g,RR:()=>h,V2:()=>v,yt:()=>E,vf:()=>I,Wo:()=>T});var a=t(850434),i=t(199448),s=t(370054),o=t(945824),r=t(131647),d=t(668625),l=t(88119);const c=(e,n)=>e.isGeneral?"OwnersPost"!==n||"Admin"===e.memberRole:"Admin"===e.memberRole||e.isModerator||"Everyone"===e.channelSettings?.channelPostPermissions||"EveryoneButGuests"===e.channelSettings?.channelPostPermissions&&"Guest"!==e.memberRole&&"Undefined"!==e.memberRole,u=(e,n)=>{const t=decodeURIComponent(e),s=p(t,n);let o=s.channelId;const r=s.replyChainId,d="string"==typeof o,l="string"==typeof r||null==r;if(d&&(o=o.includes("login")?o.substring(0,o.indexOf("/?login")):o),!d||!l){const t=`TeamsAndChannelsHelper::extractChannelMessageCompoundId::${a.O4.InvalidInput}::${e}`;throw n?.error(t),(0,i.$5)("TeamsAndChannelsHelper",a.O4.InvalidInput,"extractChannelMessageCompoundId",{compoundId:e},t)}return{channelId:o,replyChainId:r}},p=(e,n)=>{try{const{channelId:n,replyChainId:t}=JSON.parse(e);return{channelId:n,replyChainId:t}}catch(t){return n?.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},m=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:n,channelId:t}=JSON.parse(e);return{teamId:n,channelId:t}}catch{return{channelId:e}}},g=(e,n,t,a,i,d,c,u,p,m,g,h,v,E)=>{switch(e){case l.DG.CreateTeam:i&&E?n.teamsAndChannels.createTeamV2({entryPoint:s.qF.teamsAndChannels}):a?n.teamsAndChannels.createTeamOnMainView({source:s.$D.template,canUserCreateTeam:!!E,entryPoint:s.qF.teamsAndChannels},u):n.teamsAndChannels.createTeam();break;case l.DG.CreateChannel:h&&g&&n.teamsAndChannels.createChannelOnLeftRail({entryPoint:o.k.ChannelListHeaderContextMenu});break;case l.DG.JoinTeamByCode:u===r.p.SchoolTeams?n.school.gridTeamDiscover():n.teamsAndChannels.teamDiscover();break;case l.DG.JoinTeam:d?n.teamsGallery.launchTeamsGallery():n.teamsAndChannels.teamDiscover();break;case l.DG.AddChannel:t&&g?n.teamsAndChannels.createChannel({teamId:t.id,groupId:t.groupId||"",teamType:t.teamType}):t&&n.teamsAndChannels.addChannel(t.id);break;case l.DG.AddMember:t&&(c?n.teamsAndChannels.addMemberToTeamDialog(t.id):n.teamsAndChannels.addMember(t.id));break;case l.DG.MarkAllChannelsAsRead:p?.();break;case l.DG.ManageTeamsList:n.teamsAndChannels.manageTeamsList(r.p.ChannelList,v?{entityCommand:v}:void 0,m?.()),p?.();break;case l.DG.ManageTeamsInvites:n.teamsAndChannels.manageSharedChannelsPendingInvites(r.p.ChannelList,void 0,m?.()),p?.();break;case l.DG.CrossTeamAnalytics:n.teamsAndChannels.crossTeamAnalytics(r.p.ChannelList,void 0,m?.()),p?.()}},h=e=>{const n=e,t=n.graphQLErrors?.find((e=>"CDLResolver"===e.extensions?.source)),a=t?.extensions?.prevError,i=a?.extraInfo;return i},v=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0,renderId:void 0};try{const n=decodeURIComponent(e),{teamId:t,channelId:a,replyChainId:i,renderId:s}=JSON.parse(n);return{teamId:t,channelId:a,replyChainId:i,renderId:s}}catch{return{channelId:e}}},E=e=>`overflow-${e}`,I=e=>{if("options"in e&&e.options)return(0,d.j)(e.options||"")},T=e=>{let n;try{n=JSON.parse(e?.id||"{}")}catch{n={}}return n}},858108:(e,n,t)=>{var a,i;t.d(n,{d:()=>a,J:()=>i}),function(e){e.HighMemoryUsage="HighMemoryUsage",e.CallingStackInitTimeoutOrFailure="CallingStackInitTimeoutOrFailure",e.GroupCallTimeoutOrFailure="GroupCallTimeoutOrFailure"}(a||(a={})),function(e){e.MeetingsAudio="1",e.MeetingsVideoOrScreenSharing="2",e.CallingCallDrops="3",e.MessagingOther="5",e.ActivityFeed="6",e.Crashing="7",e.Files="8",e.SearchSERPSearchResultsPage="9",e.SearchPowerbarAutosuggest="10",e.Other="11",e.MeetingsLiveCaptionsOrTranscript="14",e.TeamsChannelsMembership="15",e.Accessibility="17",e.Calendar="18",e.MeetingsOther="19",e.PlatformApps="20",e.PlatformBotsConnectors="21",e.PlatformTabs="22",e.TeamsChannelsCreateManageSettings="23",e.MessagingSync="25",e.PeopleProfiles="26",e.StatusPresence="27",e.TeamsChannelsPrivateAndSharedChannels="28",e.LocalizationTranslation="29",e.MeetingsAgendaNotes="30",e.MessagingCreateNewOrEdit="31",e.MessagingConversationWithExternalOrSkypeUsers="32",e.Tasks="34",e.Lists="35",e.Approvals="36",e.CallingOther="38",e.Performance="39",e.MessagingChatWindow="40",e.MessagingMissingOrDelayed="41",e.VivaLearning="42",e.MeetingsPowerPointLive="43",e.MeetingsChat="44",e.MeetingsRecording="45",e.MeetingsBreakoutRooms="46",e.MeetingsJoinExperience="47",e.MeetingsGalleryViews="48",e.CallingAudio="49",e.CallingVideoOrScreenSharing="50",e.VirtualAppointments="51",e.MeetingsSpeakerCoach="52",e.NotificationToasts="53",e.WebinarsVirtualEvents="54",e.MessagingVideo="55",e.MeetingsExcelLive="56",e.MeetingsWordLive="57",e.Avatars="58",e.ImmersiveSpace="59",e.MessagingLoopComponents="60",e.Discover="61",e.MeetingsMeetApp="62",e.Communities="63",e.Dashboard="64",e.Photos="65",e.Groups="66",e.InvitingJoiningTeams="67",e.Gaming="68",e.MessagingMessageCompose="70",e.MessagingMessagePaneScrolling="71",e.MessagingReactionsEmojisGIFsStickers="72",e.TeamsChannelsApp="73",e.UpdatesApp="74",e.MeetingsAttendanceReport="75",e.Devices="76",e.VideoFilters="77",e.AuthenticationOrSignIn="78",e.PerformanceMemory="79",e.DesktopAppLaunch="80",e.DesktopAppUpdate="81",e.TaskbarOrSystrayExperiences="82",e.Settings="83",e.AppSwitcherPreview="84",e.MeetingsRecap="86",e.FlyoutAndMinimode="87",e.MultiTenantMultiAccount="88",e.CallingCallNotifications="89",e.TagsChatMentions="90",e.TagsManagement="91",e.MeetingsCopilot="92",e.MessagingSMSIntegration="93",e.PlatformWorkflowsAndConnectors="94",e.MessagingThreading="121"}(i||(i={}))},945824:(e,n,t)=>{var a,i;t.d(n,{x:()=>a,k:()=>i}),function(e){e.Default="Default",e.Regular="Regular"}(a||(a={})),function(e){e.ChannelListHeaderContextMenu="ChannelListHeaderContextMenu",e.TeamContextMenu="TeamContextMenu",e.ChannelContextMenuLeftRail="ChannelContextMenuLeftRail",e.ManageTeam="ManageTeam",e.ManageChannel="ManageChannel",e.ChannelHeader="ChannelHeader",e.TrinityLeftRail="TrinityLeftRail",e.OnboardTeam="OnboardTeam",e.TrinityChannelsTab="TrinityChannelsTab"}(i||(i={}))},543804:(e,n,t)=>{t.d(n,{Km:()=>a,tu:()=>i,Xg:()=>s,_A:()=>o});const a={Safari:11.1},i=11,s=11.1,o={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},808692:(e,n,t)=>{t.d(n,{hl:()=>o,OS:()=>r,oW:()=>d,bR:()=>l});var a=t(364836),i=t(543804),s=t(779898);function o(e=i._A){return!!e&&!!c().satisfies(e)}function r(){return!u("ie")}function d(){return!!c().satisfies({safari:`>=${i.Km.Safari}`})}function l(){return u("safari")&&void 0===c().getBrowserVersion()}function c(){return a.getParser((0,s.z)().navigator.userAgent)}function u(e){return c().isBrowser(e,!0)}},332684:(e,n,t)=>{t.d(n,{l:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"smartReplyFileSuggestion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"smartReplyFileSuggestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileName"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}},656074:(e,n,t)=>{t.d(n,{u:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}.definitions]}},3711:(e,n,t)=>{t.d(n,{$6:()=>u,Ss:()=>p,M:()=>m,rY:()=>g,l:()=>h,E2:()=>v,qb:()=>E,iV:()=>I,zr:()=>T,Nh:()=>A,I0:()=>y,rt:()=>_,RI:()=>k,Zk:()=>C,rz:()=>S,e6:()=>N,pj:()=>D,jU:()=>b,gK:()=>R,O:()=>w,v6:()=>M,Y6:()=>L,n$:()=>P,ab:()=>U,PW:()=>F,OF:()=>V,tP:()=>B,NX:()=>x,Dt:()=>G,fK:()=>H,UK:()=>W,gl:()=>q,xs:()=>j});var a=t(754255),i=t(141685),s=t(784109),o=t(150768),r=t(719156),d=t(576129),l=t(315931),c=t(96594);const u="acceptStreamPermissionsDebug",p={__typename:"PrejoinState",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,withByod:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1,wasByodConnectedDeviceRoomSelected:!1,byodRoomSpeakerId:null,byodRoomMicrophoneId:null,roomType:null,shouldSuggestRoomAudioForByod:!1,wasByodMoveToRoomAudioTriggered:!1},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1,timestamp:null};function m(e){e.writeQuery({query:d.y1,data:{prejoinState:p}})}function g(e){e.writeQuery({query:l.U,data:{shouldShowVideoApp:!1}})}const h={__typename:"ByodState",isToggleEnabled:!1,isPoppedOut:!1,byodScreenBounds:null,targetMonitorId:null,sourceMonitorId:null,displayModeBeforeByod:null},v=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,isRosterVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isTogetherModeAssignSeatsDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,isInterpretationDialogVisible:!1,isMeetingLevelSpokenLanguageDialogVisible:!1,isUserLevelSpokenLanguageDialogVisible:!1,isPinConfirmDialogVisible:!1}),E=e=>({__typename:"CallingScreenLayout",currentLayout:e.get(a.w.Calling).defaultLayoutSelection||"Grid",meetingRoomLayoutSelection:"ContentAndPeople",lastSelectedLayout:"Grid",initialLayoutBeforeContentPopout:"Grid",meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeWithContentActive:!1,shouldDisableAutoNarrowMode:!1,isLayoutFlipped:!1,isContentPoppedOut:!1,shouldMeBeInOverlay:!0,isPresenterHostModeWithContent:!1,isGalleryInCentralSegment:!0,isMyselfInBarSegment:!1,isFrontRowUnifiedBackgroundActivated:!0,isPanoramicAudienceViewActivated:!1,productionStudioViewType:"None"}),I=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),T=e=>({__typename:"VideoScanTypeResponse",videoScanType:"none",id:e}),f="microsoft_none",A={__typename:"BackgroundsInfo",imageId:f,imagePath:"",imageStatus:"",imageProvider:"default",imageName:"",imageSrc:""},y={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:f},_=e=>({__typename:"MyselfSettings",isMyselfHidden:!1,id:e}),k={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},C={__typename:"ImmersiveViewModeAppAvailabilityInfo",isAppAvailable:null,timestamp:null},S={__typename:"AudioVideoFrameworkInfo",id:"",isInFlyoutAvatarTab:!1,dismissedComponentIds:[]},N={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},D={__typename:"ActiveVideoEffects",first:N,second:N,third:N},b={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},R={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:b,isShowingAppPageVideoEffect:N,isAppliedVideoEffect:N,isUnderApplyingProcessVideoEffect:N,allVideoApps:[]},w={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},M={__typename:"AvatarPayload",avatarItems:[]},L=(e,n)=>n.readQuery({query:s.W,variables:{id:e}})?.callParticipants||[],P=(e,n)=>n.readFragment({id:O(e),fragment:c.bs,fragmentName:"participantFields"})||null,U=(e,n,t)=>{const a=P(e,t);a&&t.writeFragment({id:O(e),fragment:c.bs,data:{...a,...n},fragmentName:"participantFields"})},O=e=>`Participant:{"participantId":"${e}"}`,F=(e,n)=>{e.writeQuery({query:o.t,data:{callingAlerts:n}})},V=e=>`No call found with id ${e}`,B=(e,n)=>{const t=e.coordinates;return{conversationId:(0,i.KX)(t)&&t.conversationId||null,isOneOnOne:"OneToOneCall"===e.type,isMeetup:"Meeting"===e.type,isBroadcast:(0,i.KX)(t)&&"LegacyMeetingCoordinates"===t.__typename&&!!t.broadcast,broadcastRole:(0,i.KX)(t)&&"LegacyMeetingCoordinates"===t.__typename?(0,i.KX)(t)&&t.broadcast?.role:null,withVideo:n&&n.outgoingVideo,withAudio:n&&n.outgoingAudio}},x=e=>({tenantId:"tenantId",organizerId:e??"31eedce6-db0e-44e3-9a76-56d1fa5f010a",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),G=()=>{const e=x();return{__typename:"BreakoutRoom",coordinates:{__typename:"RoomCoordinates",...e,additionalMessageId:"additionalMessage"},roomName:"Room 1",sourceMeetingCoordinates:{__typename:"RoomCoordinates",...e,additionalMessageId:"additionalMessage"},participants:[(n="9342492d-d51e-4317-bbf6-8341bf69f07a",{__typename:"BreakoutRoomParticipant",mri:n,role:null,objectId:null,upn:null})],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null};var n},$=(e,n)=>e?{...e,__typename:"VideoEffectInfo"}:n,H=e=>({__typename:"ActiveVideoEffects",first:$(e.activeVideoEffects.first,N),second:$(e.activeVideoEffects.second,N),third:$(e.activeVideoEffects.third,N)}),W=(e,n)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:n&&n.allVideoApps&&n.allVideoApps.length>0&&n.allVideoApps.map((e=>({...e,__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:n.isInstallingVideoEffectInfo?{...n.isInstallingVideoEffectInfo,__typename:"InstallingVideoEffectInfo"}:e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:$(n.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:$(n.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:$(n.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),q=()=>"None",j=(e,n)=>{const t=n.filter((e=>"TM bot"!==e.displayName)).length+1,a=n.filter((e=>e.state===r.ParticipantState.InLobby)).length;return{__typename:"CallParticipantsCounts",teamsCallId:e,participantCounts:{__typename:"ParticipantCounts",id:"id",totalParticipants:t,totalConnectedTflParticipants:0,lobbyParticipants:a,totalPresenters:t-a,totalAttendees:0,requestingAttentionPresenters:0,requestingAttentionAttendees:0,overflowAttendees:0,streamingAttendees:0}}}},784109:(e,n,t)=>{t.d(n,{W:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callParticipants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callParticipants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantFields"}}]}}]}},...t(96594).bs.definitions]}},150768:(e,n,t)=>{t.d(n,{t:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAlert"}}]}}]}},...t(644077).l.definitions]}},484302:(e,n,t)=>{t.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldKeepPreviewWindowInSidePanelOpen"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},576129:(e,n,t)=>{t.d(n,{y1:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"prejoinState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"prejoinState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntentId"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"incomingAudio"}},{kind:"Field",name:{kind:"Name",value:"isPSTN"}},{kind:"Field",name:{kind:"Name",value:"withAudio"}},{kind:"Field",name:{kind:"Name",value:"withVideo"}},{kind:"Field",name:{kind:"Name",value:"withByod"}},{kind:"Field",name:{kind:"Name",value:"volume"}},{kind:"Field",name:{kind:"Name",value:"wasAutomuteTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasMuteToggledByUser"}},{kind:"Field",name:{kind:"Name",value:"roomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"isAuditoriumModeEnabled"}},{kind:"Field",name:{kind:"Name",value:"shouldShowCameraCoachMark"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoExpandRoomsDropdown"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RoomDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"room"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"roomParticipantInMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"wasRoomBluetoothProximityTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasRoomLoudSpeakerInTheMeetingTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasByodConnectedDeviceRoomSelected"}},{kind:"Field",name:{kind:"Name",value:"roomType"}},{kind:"Field",name:{kind:"Name",value:"byodRoomSpeakerId"}},{kind:"Field",name:{kind:"Name",value:"byodRoomMicrophoneId"}},{kind:"Field",name:{kind:"Name",value:"shouldSuggestRoomAudioForByod"}},{kind:"Field",name:{kind:"Name",value:"wasByodMoveToRoomAudioTriggered"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"proximityValidationCode"}}]}}]}.definitions]}.definitions]}},315931:(e,n,t)=>{t.d(n,{U:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoApp"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoApp"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},503127:(e,n,t)=>{t.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},86221:(e,n,t)=>{t.d(n,{Nv:()=>a,mu:()=>i,y8:()=>s,fL:()=>o,k8:()=>r,AZ:()=>d});const a="BroadcastSchedulingEvents",i={closeViewBroadcastEvent:"closeViewBroadcastEvent",createBroadcastEvent:"createBroadcastEvent",editBroadcastEvent:"editBroadcastEvent",viewBroadcastEvent:"viewBroadcastEvent",cancelBroadcastEvent:"cancelBroadcastEvent",showBroadcastEventError:"showBroadcastEventError",discardBroadcastEvent:"discardBroadcastEvent"},s=e=>"object"==typeof e&&!!e&&"eventId"in e,o=e=>"object"==typeof e&&!!e&&"eventId"in e,r=e=>"object"==typeof e&&!!e&&"eventId"in e,d={closeViewBroadcastEvent:()=>({originator:a,type:i.closeViewBroadcastEvent}),createBroadcastEvent:()=>({originator:a,type:i.createBroadcastEvent}),editBroadcastEvent:e=>({originator:a,type:i.editBroadcastEvent,data:e}),viewBroadcastEvent:e=>({originator:a,type:i.viewBroadcastEvent,data:e}),cancelBroadcastEvent:e=>({originator:a,type:i.cancelBroadcastEvent,data:e}),showBroadcastEventError:()=>({originator:a,type:i.showBroadcastEventError}),discardBroadcastEvent:()=>({originator:a,type:i.discardBroadcastEvent})}},825225:(e,n,t)=>{var a;t.d(n,{V5:()=>a,Mi:()=>i,we:()=>s,E:()=>o,Wr:()=>r}),function(e){e.ChannelCard="ChannelCard",e.Channels="Channels",e.ManageTeams="ManageTeams"}(a||(a={}));const i={getLinkToChannel:"getLinkToChannel",viewChannelEmail:"viewChannelEmail",manageChannelMembers:"manageChannelMembers",manageTeamMembers:"manageTeamMembers",manageTeamChannels:"manageTeamChannels",leaveChannel:"leaveChannel",manageChannel:"manageChannel",channelAddMembers:"channelAddMembers",shareChannelWithUser:"shareChannelWithUser",shareChannelWithTeam:"shareChannelWithTeam",channelNotificationSettings:"channelNotificationSettings",toggleInfoPane:"toggleInfoPane"},s={teamAddMember:"teamAddMember",teamAddChannel:"teamAddChannel",manageTags:"manageTags",leaveTeam:"leaveTeam",hideAllChannelsDialog:"hideAllChannelsDialog",getLinkToTeam:"getLinkToTeam",deleteTeam:"deleteTeam",manageTeam:"manageTeam"},o={getLinkToChannel:(e,n)=>({data:n,originator:e,type:i.getLinkToChannel}),viewChannelEmail:(e,n)=>({data:n,originator:e,type:i.viewChannelEmail}),manageChannelMembers:(e,n)=>({data:n,originator:e,type:i.manageChannelMembers}),manageTeamMembers:(e,n)=>({data:n,originator:e,type:i.manageTeamMembers}),manageTeamChannels:(e,n)=>({data:n,originator:e,type:i.manageTeamChannels}),leaveChannel:(e,n)=>({data:n,originator:e,type:i.leaveChannel}),manageChannel:(e,n)=>({data:n,originator:e,type:i.manageChannel}),channelAddMembers:(e,n)=>({data:n,originator:e,type:i.channelAddMembers}),shareChannelWithUser:(e,n)=>({data:n,originator:e,type:i.shareChannelWithUser}),shareChannelWithTeam:(e,n)=>({data:n,originator:e,type:i.shareChannelWithTeam}),channelNotificationSettings:(e,n)=>({data:n,originator:e,type:i.channelNotificationSettings}),toggleInfoPane:e=>({data:e,originator:a.Channels,type:i.toggleInfoPane})},r={teamAddMember:(e,n)=>({data:n,originator:e,type:s.teamAddMember}),teamAddChannel:(e,n)=>({data:n,originator:e,type:s.teamAddChannel}),manageTags:(e,n)=>({data:n,originator:e,type:s.manageTags}),leaveTeam:(e,n)=>({data:n,originator:e,type:s.leaveTeam}),hideAllChannelsDialog:(e,n)=>({data:n,originator:e,type:s.hideAllChannelsDialog}),getLinkToTeam:(e,n)=>({data:n,originator:e,type:s.getLinkToTeam}),deleteTeam:(e,n)=>({data:n,originator:e,type:s.deleteTeam}),manageTeam:(e,n)=>({data:n,originator:e,type:s.manageTeam})}},359676:(e,n,t)=>{t.d(n,{SS:()=>a,p2:()=>i,r2:()=>s,SY:()=>o,We:()=>r,Ut:()=>d,Xo:()=>l,P9:()=>c,JQ:()=>u,sM:()=>p,h5:()=>m,OZ:()=>g,f0:()=>h,hW:()=>v,TJ:()=>E,Ay:()=>I,GW:()=>T,UH:()=>f,ll:()=>A,IT:()=>y,Sj:()=>_,sm:()=>k,I4:()=>C,AX:()=>S,Ze:()=>N,A7:()=>D,jY:()=>b,Ry:()=>R,O:()=>w,fZ:()=>M});const a="v1/objects/",i={desktop:"imgpsh_mobile_save_anim",mobile:"imgpsh_fullsize_anim"},s="v1/objects/{objectId}/forward",o="v1/objects/{objectId}/views/imgo",r="v1/objects/{objectId}/views/imgpsh_mobile_save_anim",d="?v=1",l="&v=1",c="retry-after",u="/views/video",p="/views/thumbnail",m="/status",g=4194304,h=524288,v=2,E=144e3,I="/views/original",T="RejectedByPolicy",f=10004,A=403,y="retry-after",_=2,k=4,C=.5,S="transcript_info",N=3,D={IMAGE:"pish/image",DOCUMENT:"sharing/file",VIDEO:"sharing/videototranscode"},b={IMAGE:"imgpsh",DOCUMENT:"original",VIDEO:"video",THUMBNAIL:"thumbnail",TRANSCRIPT_INFO:"transcript_info"},R={IMAGE:"imgpsh",ORIGINAL:"original",VIDEO:"video"},w={downloadMedia:"downloadMedia",getViewStatus:"getViewStatus",postMedia:"postMedia",putMedia:"putMedia",forwardMediaContent:"forwardMediaContent"},M={"x-ms-client-version":"1415/1.0.0.2018090100"}},231684:(e,n,t)=>{t.d(n,{y:()=>i});var a=t(359676);const i=e=>!!e&&(e.endsWith(a.p2.mobile)||e.endsWith(a.p2.desktop))},333704:(e,n,t)=>{t.d(n,{C:()=>g,j:()=>h});var a=t(383851),i=t(364819),s=t(754255),o=t(702183),r=t(373639),d=t(600824),l=t(649288),c=t(220192),u=t(102029),p=t(503210),m=t(692184);const g="~~~~###@@TACOCAT@@###~~~~";let h=class{async transform(e,n){if(!e||!n.messageProperties)return;this._logger=n.loggerFactory.newLogger("CodeSnippetsSerializer","services-io-browser-compose-serializer-extensions"),this._scenarioFactory=n.scenarioFactory,this._settings=n.coreSettings;const t=(0,i.unescape)(u.L.DomUtils.getAttributeValue(e,r.Os)),a=u.L.DomUtils.getAttributeValue(e,r.$v),[s]=u.L.DomUtils.getElementsByTagName("code",e);if(!t)return this._logger.error("The props was missing"),null;if(!s)return this._logger.error("The code snippet was missing"),null;if(!a)return this._logger.error("The id of the card was missing"),null;try{await this._uploadAndUpdateCard(a,JSON.parse(t),s,n);const e=(0,p.VZ)("span",{content:a,itemprop:"cardId"}),i=(0,p.VZ)("span",{class:"inline-compose-card",itemid:a,itemscope:"",itemtype:c.A.inputExtension});return u.L.DomUtils.appendChild(i,e),this._logger.debug("Uploaded code snippet",a),i}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}async _uploadCodeSnippet(e,n,t){const{source:a}=e,i=u.L.DomUtils.getInnerHTML(n),r=`${a}${g}${i}`,d=this._scenarioFactory?.newScenario(o.Cu.CodeSnippetUpload);try{const{objectId:e}=await this._uploadToAMS(r,t,this._logger);return d?.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),d?.fail();const{enableCacheStorageInSendMessageMW:n}=this._settings.get(s.w.Messaging);if(n){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=await this._uploadToCache(r,t,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{d?.stop()}}async _uploadToAMS(e,n,t){t.log("Uploading to code snippet to ams");const{objectId:a}=await n.asyncMediaService.uploadItem(e,n.conversationId,"DOCUMENT",void 0,l.vV.Attached,!1,n.correlationId);return{objectId:a}}async _uploadToCache(e,n,t){try{t.log("uploading inline image to offline cache storage");const[a,i]=await n.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return t.log(`Uploaded image to offline cache, image: ${i} objectId: ${a}`),{objectId:a}}catch(e){throw t.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}async _uploadAndUpdateCard(e,n,t,a){const{amsReferenceId:i}=n,{name:s,language:o,wrap:r}=n,d=a.messageProperties.cards||[];let l={objectId:i,uploadType:"AMS"};if(i||(l=await this._uploadCodeSnippet(n,t,a)),"AMS"===l.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,l.objectId]}else if("OfflineCache"===l.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,l.objectId]}a.messageProperties.cards=[...d.filter((n=>n.cardClientId!==e)),{appId:e,cardClientId:e,contentType:m.b.CodeSnippet,content:JSON.stringify({type:m.b.CodeSnippet,editable:!0,id:e,name:s,language:o,wrap:r,lines:t.children?t.children.length:0,cardClientId:e,amsReferenceId:l.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}};h=(0,a.__decorate)([(0,d.hY)({name:"CodeSnippets",filter:{[r.Lm]:"CodeSnippetCard"}})],h)},827558:(e,n,t)=>{t.d(n,{C:()=>g});var a=t(383851),i=t(364819),s=t(600824),o=t(220192),r=t(102029);const d=new RegExp(/animated-emoticon.*?/),l=/img|table/,c=e=>!!e&&r.L.DomUtils.getAttributeValue(e,"itemtype")===o.A.customEmoji,u=e=>!!e&&(r.L.DomUtils.getAttributeValue(e,"itemtype")===o.A.emoji||d.test(r.L.DomUtils.getAttributeValue(e,"class")||"")),p=(e,n)=>!n.containsPotentiallyIncludedWhitespace&&e<m&&e+1,m=3;let g=class{preTransform(e,n){const t=(0,i.isUndefined)(n.superSizeEmoticons)?0:n.superSizeEmoticons;"br"===e.name?n.containsPotentiallyIncludedWhitespace=!0:"img"===e.name?(0,i.isNumber)(t)&&c(e)?n.superSizeEmoticons=p(t,n):(0,i.isUndefined)(n.superSizeEmoticons)&&(n.superSizeEmoticons=!1):(0,i.isNumber)(t)&&u(e)?n.superSizeEmoticons=p(t,n):n.superSizeEmoticons=!(e=>e&&!u(e.parent)&&!c(e.parent)&&!(e.parent&&u(e.parent.parent))&&(l.test(e.name||"")||!(!e.data||!e.data.replace(" ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&t}};g=(0,a.__decorate)([(0,s.dL)({name:"BigEmoticonPreprocessor",filter:"*"})],g)},6680:(e,n,t)=>{t.d(n,{TQ:()=>m,Td:()=>g,YG:()=>h});var a=t(383851),i=t(364819),s=t(754255),o=t(850434),r=t(702183),d=t(600824),l=t(431286),c=t(781463),u=t(780952),p=t(102029);const m="app-preview-card",g="app-preview-card-ps";let h=class{async transform(e,n){const t=n.coreSettings.get(s.w.Extensibility).postSendTimeoutInMs||2e3,{enableAppBasedLinkUnfurlingPostSend:a}=n.coreSettings.get(s.w.Extensibility),{areUrlPreviewsAllowed:i}=n.coreSettings.get(s.w.Messaging);if(!!!i||!n.connectedExperienceEnabled||!e||!n.messageProperties||n.messageProperties.urlPreview||!n.urlPreviewService||!n.appBasedLinkService||!p.L.DomUtils.hasAttrib(e,"href"))return;const o=n.loggerFactory.newLogger("UrlPreviewSerializer","services-io-browser-compose-serializer-extensions"),r=e.attribs.href||"",d=[this.getLinkUnfurlingPreviewFromAppTimed(r,t,n,o),this.getUrlPreviewTimed(r,t,n,o)],[l,u]=await Promise.all(d),m=l?.urlPreview??(u&&E(u));return m?(n.messageProperties.urlPreview=m,n.messageProperties.cards=l?.card&&a?[{...(0,c.h)({...l?.card,cardClientId:`${g}${l?.card?.cardClientId}`},"__typename")},...n.messageProperties.cards||[]]:n.messageProperties.cards,e):void 0}async getLinkUnfurlingPreviewFromAppTimed(e,n,t,a){const{enableAppBasedLink:i}=t.coreSettings.get(s.w.Extensibility),{enableGetRichLinkToTeamOrChannel:d}=t.coreSettings.get(s.w.TeamsAndChannels),{deepLinkDomains:c}=t.coreSettings.get(s.w.Messaging);if(!i)return Promise.resolve(void 0);const p={enableDomainLinks:d,currentDomainLinks:c};if((0,l.c)(e,p))return;const m=t.scenarioFactory.newScenario(r.Cu.ExtGetAppPreviewPostSend),g="post send app preview timed out";try{let a;return t.linkUnfurlingAppDetails&&(a=await(0,u.a)(t.appBasedLinkService.getLinkUnfurlingPreviewFromApp(e,t.linkUnfurlingAppDetails,m,t.convId),n,g)),m.stop(),a}catch(n){return v(n)&&n.code===o.O4.TimedOut&&n.context===o.Ir.Timed?m.incomplete({errors:g}):m.fail(),void a.warn(`fetching app preview for url: ${e} failed with error: ${n}`)}}async getUrlPreviewTimed(e,n,t,a){const{enableGetRichLinkToTeamOrChannel:i}=t.coreSettings.get(s.w.TeamsAndChannels),{deepLinkDomains:o}=t.coreSettings.get(s.w.Messaging),r={enableDomainLinks:i,currentDomainLinks:o};if(!(0,l.c)(e,r))try{return await(0,u.a)(t.urlPreviewService.getPreview(e,t.correlationId),n,"url preview timed out")}catch(n){return void a.warn(`fetching url preview for url: ${e} failed with error: ${n}`)}}};h=(0,a.__decorate)([(0,d.hY)({name:"URLPreviewSerializer",filter:"a",transient:!0})],h);const v=e=>!!(e&&((0,i.get)(e,"code")&&(0,i.get)(e,"context")||(0,i.get)(e,"reason"))),E=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta})},431286:(e,n,t)=>{t.d(n,{C:()=>A,c:()=>T});var a=t(364819),i=t(554186),s=t(575930),o=t(84646),r=t(199448),d=t(850434),l=t(198993),c=t(878336),u=t(327080),p=t(654703),m=t(726723),g=t(712839),h=t(754255),v=t(702183),E=t(908060);const I=["teams","/l/message/","chat"],T=(e,n)=>{if(n?.enableDomainLinks){const t=n.currentDomainLinks;return!!t&&t.some((n=>f(e,n)))}return I.every((n=>e.includes(n)))},f=(e,n)=>{try{const t=new URL(e),a=new URL(n);return t.hostname===a.hostname&&t.pathname&&(t.pathname.includes("/l/message")||t.pathname.includes("/l/channel")||t.pathname.includes("/l/chat"))}catch(e){return!0}};class A{constructor(e,n,t,a,i){this.botsPlatformService=n,this.scenarioFactory=t,this.queryLinkRequestsInProgress={},this.logTelemetryForLinkUnfurlingCardViewPostSend=(e,n)=>{if(!e)return;const t=this.getExtensibilityData(e,n);this.userBiService.recordPanelAction({actionGesture:m.Od.auto,actionOutcome:m.nd.appBasedLinkUnfurlingCardPreviewPostSend,actionScenario:this.getPreviewActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1),actionScenarioType:m.DB.sendMsgs,moduleName:m.Sn.linkUnfurl,moduleType:m.nR.link,panelRegion:m.rP.main,panelType:m.HP.AppBasedLink,extensibilityData:t})},this.logTelemetryForLinkUnfurlingInvokePostSend=(e,n,t=!0)=>{if(!e)return;const a=this.getExtensibilityData(e,n);this.userBiService.recordPanelAction({actionGesture:m.Od.asyncStateChange,actionOutcome:m.nd.invoke,actionScenario:this.getInvokeActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1,t),actionScenarioType:m.DB.sendMsgs,moduleName:m.Sn.linkUnfurl,moduleType:m.nR.link,panelRegion:m.rP.main,panelType:m.HP.AppBasedLink,extensibilityData:a})},this.getExtensibilityData=(e,n)=>({id:e?.appId||"",botId:e?.botId||"",scenarioCapability:g.n3.messaging,name:e?.appName||"",threadId:n||"",externalId:e?.externalId||"",installationState:e.installationState}),this.getInvokeActionScenarioName=(e,n)=>e&&n?m.vB.linkUnfurlingAnonymousInvokePostSend:e&&!n?m.vB.linkUnfurlingAnonymousInvokePostSendNoResult:!e&&n?m.vB.linkUnfurlingInvokePostSend:m.vB.linkUnfurlingInvokePostSendNoResult,this.getPreviewActionScenarioName=e=>e?m.vB.linkUnfurlingPostSendAnonymousCardPreview:m.vB.linkUnfurlingPostSendCardPreview,this.enableAppBasedLinkSsoAuth=e.get(h.w.Extensibility).enableAppBasedLinkSsoAuth,this.tokenPrefetchBots=e.get(h.w.Extensibility).tokenPrefetchBots,this.ssoForBotsDefaultWebResourceEnabledBotIds=e.get(h.w.Extensibility).ssoForBotsDefaultWebResourceEnabledBotIds,this.enableAnonymousAppBasedLink=e.get(h.w.Extensibility).enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps=e.get(h.w.Extensibility).anonymousAppBasedLinkApps,this.enablePreAuthCard=e.get(h.w.Extensibility).enablePreAuthCard,this.logger=a.newLogger("AppBasedLinkService","services-io-app-based-link"),this.enableGetRichLinkToTeamOrChannel=e.get(h.w.TeamsAndChannels).enableGetRichLinkToTeamOrChannel,this.deepLinkDomains=e.get(h.w.Messaging).deepLinkDomains,this.userBiService=i}async getLinkUnfurlingPreviewFromApp(e,n,t,a){const i={enableDomainLinks:this.enableGetRichLinkToTeamOrChannel,currentDomainLinks:this.deepLinkDomains};if(p.$===a||T(e,i))return void this.logger.debug(`LinkUnfurling: getLinkUnfurlingPreviewFromApp: url is a chat url and no link preview is needed for url: ${e}`);let s,o,r;try{s=this.toAppDefinition(n),s&&(o=(0,l.jN)(s?.definition))}catch{return this.logger.error("Ran into an error trying to create the linkUnfurlingAppDetails object"),void t.incomplete({errors:"Could not fetch app details for link unfurling app"})}if(o&&"NotInstalled"===n?.installationState&&(0,l.rv)(o,this.enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps)?(t.mark(v.BQ.ExtAppBasedLinkUnfurlingPostSendAnonymousInvoke),r=await this.getAnonymousAppPreview(e,o,a),this.logger.debug(`LinkUnfurling: Fetching anonymous app preview for url: ${e}`)):(t.mark(v.BQ.ExtAppBasedLinkUnfurlingPostSendInvoke),r=await this.getAppPreview(e,o,a),this.logger.debug(`LinkUnfurling: Fetching app preview for url: ${e}`)),this.logTelemetryForLinkUnfurlingInvokePostSend(n,a),"HasResult"===r?.type&&r.messageExtensionItem){const{card:t,previewCard:i}=r.messageExtensionItem,s=(e=>{let n=!1;return(0,E.KQ)(JSON.parse(e),{type:"Action.Execute"},(()=>{n=!0})),n})(t.content)?void 0:t;return s&&this.logTelemetryForLinkUnfurlingCardViewPostSend(n,a),{card:s,urlPreview:(0,u.w)(e,i)}}this.logTelemetryForLinkUnfurlingInvokePostSend(n,a,!1),this.logger.debug(`LinkUnfurling: No app preview found for url: ${e}`)}async getAnonymousAppPreview(e,n,t){try{const a=this.getQueryLinkVariables(e,n,t);if(!a)throw(0,r.$5)("AppBasedLinkService",d.O4.InvalidInput,"getAnonymousAppPreview",void 0,this.getErrorMessage("Invalid message extension passed to invoke",n));this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(a,n,v.Cu.ExtGetAnonymousAppPreview,void 0,"composeExtension/anonymousQueryLink"));const i=await this.queryLinkRequestsInProgress[e];return delete this.queryLinkRequestsInProgress[e],!i||this.isEmptyResult(i)?null:this.matchedAnonymousResult(e,n,i)}catch(n){throw delete this.queryLinkRequestsInProgress[e],n}}async getAppPreview(e,n,t,a,i){if(!n)return null;try{const s=await this.tryPrefetchingToken(n,i,this.logger),o={},r=i??s,d=!!r,l=await this.getMessageExtensionResult(e,n,t,a,r,o);return delete this.queryLinkRequestsInProgress[e],!l||this.isEmptyResult(l)?null:this.matchedResult(e,n,l,d,t,a,o)}catch(n){throw delete this.queryLinkRequestsInProgress[e],n}}async matchedAnonymousResult(e,n,t){switch(t.type){case"result":return this.logger.debug(`LinkUnfurling: Initiating result type response for url: ${e}`),this.handleResultResponse(e,t,n);case"auth":return this.logger.debug(`LinkUnfurling: Initiating anonymous auth for url: ${e}`),this.handleAnonymousAuthConfigResponse(e,t,n);default:return this.logger.error(this.getErrorMessage(`LinkUnfurling: Invalid value ${t.type} for field 'type' in invoke response`,n)),null}}async matchedResult(e,n,t,a,i,s,o){switch(t.type){case"result":return this.logger.debug(`LinkUnfurling: Initiating result type response for url: ${e}`),this.handleResultResponse(e,t,n);case"auth":case"config":return"config"===t.type?this.logger.debug(`LinkUnfurling: Initiating config type response for url: ${e}`):this.logger.debug(`LinkUnfurling: Initiating auth type response for url: ${e}`),this.handleAuthConfigResponse(e,t,n);case"silentAuth":if(a)return this.logger.error(this.getErrorMessage(`LinkUnfurling: Result type ${t.type} not allowed for duplicate request`,n)),null;if(this.enableAppBasedLinkSsoAuth){if(o?.consentOverride)return this.handleSsoAuthResponse({isFailure:!1,isConsentRequired:!0,token:void 0},t,e,n,i,s);const a=await this.tryGetAuthToken(n);return this.handleSsoAuthResponse(a,t,e,n,i,s)}default:return this.logger.error(this.getErrorMessage(`Invalid value ${t.type} for field 'type' in invoke response`,n)),null}}isEmptyResult(e){const n=Object.keys(e);return 1===n.length&&"__typename"===n[0]}async handleSsoAuthResponse(e,n,t,a,i,s){const{isFailure:o,isConsentRequired:r,token:d}=e;if(o)return null;if(d&&!r){return await this.getAppPreview(t,a,i,s,{token:d})}return this.handleAuthConfigResponse(t,n,a)}toAppDefinition(e){return e&&e.appId?{installationState:e.installationState,id:e.appId||"",definition:{id:e.appId,name:e.appName||"",messageExtensions:[{type:"BotBased",botId:e.botId||"",fetchCommands:!1,commands:[],canUpdateConfiguration:!0,messageHandlers:[{type:"link",value:{domains:[],supportsAnonymousAccess:e.supportsAnonymousAccess||!1}}],scopes:[]}],largeImageUrl:e.appIcon||"",externalId:e.externalId||"",tenantId:e.tenantId||"",validDomains:e.validDomains||[]}}:null}getWebApplicationInfo(e){const n=e.messageExtensions&&e.messageExtensions[0].botId;return n&&this.ssoForBotsDefaultWebResourceEnabledBotIds&&this.ssoForBotsDefaultWebResourceEnabledBotIds?.indexOf(n)>=0?{botId:n,resource:`api://botid-${n}`}:{botId:n,resource:e.resource}}async tryPrefetchingToken(e,n,t){const{botId:a,resource:i}=this.getWebApplicationInfo(e);if(n||!this.enableAppBasedLinkSsoAuth||!a||!i||!this.tokenPrefetchBots||-1===this.tokenPrefetchBots.indexOf(a))return null;const s=this.scenarioFactory.newScenario(v.Cu.AppBasedLinkAadAuth);s.appendEventData({"Bot.Id":a,context:"tokenPrefetch"});try{const e=await this.botsPlatformService.getAuthTokenForBot(a,i,!0,t);return s.stop(),{token:e}}catch(e){s.incomplete({errors:"tryPrefetchingToken: Token failed to acquire"})}return null}async tryGetAuthToken(e){const{botId:n,resource:t}=this.getWebApplicationInfo(e);if(!n||!t)return{isFailure:!0,isConsentRequired:!1,token:void 0};const a=this.scenarioFactory.newScenario(v.Cu.AppBasedLinkAadAuth);a.appendEventData({"Bot.Id":n,context:"silent:true"});try{const e=await this.botsPlatformService.getAuthTokenForBot(n,t,!0,this.logger);return a.stop(),{isFailure:!1,isConsentRequired:!1,token:e}}catch(e){return e.code===d.O4.UserConsentRequired?(a.incomplete(),{isFailure:!1,isConsentRequired:!0,token:void 0}):e.code===d.O4.InvalidInput?(a.stop(),{isFailure:!0,isConsentRequired:!1,token:void 0}):(a.fail({errorCode:e.code}),{isFailure:!0,isConsentRequired:!1,token:void 0})}}async getMessageExtensionResult(e,n,t,a,i,s){const o=this.getQueryLinkVariables(e,n,t,a,i);return o?(this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(o,n,v.Cu.GetAppPreviewResult,s)),this.queryLinkRequestsInProgress[e]):(this.logger.error(this.getErrorMessage("Invalid message extension passed to invoke",n)),Promise.resolve(null))}queryLink(e,n,t,o,r){const d=(0,i.v4)(),l=this.scenarioFactory.newScenario(t);return l.appendEventData({"Bot.Id":e.botInvokeParams.botMri,"App.Id":n.id,"Thread.Id":e.botInvokeParams.threadId??"",appType:(0,a.isEmpty)(n.externalId)?"GlobalApp":(0,a.isEmpty)(n.tenantId)?"CustomApp":"TenantApp",correlationId:d}),this.botsPlatformService.executeBotInvoke(e.botInvokeParams,e.invokeValue,s.gp,this.logger,d,r||"composeExtension/queryLink",void 0,void 0,l).then((e=>(l.stop(),e))).catch((n=>{if(this.logger.warn(`Invoke failed with error: ${n} and args: ${JSON.stringify(e)}`),this.handleInvokeFailure(l,n,o),o?.consentOverride)return{type:"silentAuth"};throw n}))}handleInvokeFailure(e,n,t){if(n)if((e=>!!e&&!!(0,a.get)(e,"code")&&!!(0,a.get)(e,"message"))(n))switch(n.code){case d.O4.BotError:case d.O4.BotDisabledByAdmin:e.stop({errorCode:n.code,errors:JSON.stringify([n.message])});break;case d.O4.UserConsentRequired:e.incomplete({errorCode:n.code,errors:JSON.stringify([n.message])}),t&&(t.consentOverride=!0);break;default:e.fail({errorCode:n.code,errors:JSON.stringify([n.message])})}else e.fail({errorCode:d.O4.Unknown});else e.fail()}handleResultResponse(e,n,t){const s=(0,a.first)(n.items),o=s?.card,{defaultPreviewType:r,cachePolicyType:d}=this.processSuggestedActions(n.suggestedActions);if(o){const n=(0,i.v4)().replace(new RegExp("-","g"),""),l=(0,a.cloneDeep)(o),c=s?.previewCard||this.isSupportedPreviewCardType(l)&&l;return c?{__typename:"AppPreviewResult",id:e,type:"HasResult",messageExtensionItem:{__typename:"MessageExtensionItem",previewCard:c,card:{__typename:"Card",contentType:o.contentType,content:o.content,cardClientId:n,appId:t.id,appName:t.name,appIcon:t.largeImageUrl}},...r&&{defaultPreviewType:r},...d&&{cachePolicyType:d}}:(this.logger.error(this.getErrorMessage(`Could not use card with content type: ${o.contentType} as a preview card`,t)),null)}return null}handleAnonymousAuthConfigResponse(e,n,t){let a;return this.enablePreAuthCard&&n.items?.length&&(a=n.items[0]?.card),n.suggestedActions?.actions&&this.logger.warn("Suggested actions are not supported for anonymous query link invoke!"),{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:t.id,card:a,isAnonymous:!0}}}handleAuthConfigResponse(e,n,t){const i=n.suggestedActions?.actions?.[0];let s;if(this.enablePreAuthCard&&n.items?.length&&(s=n.items[0]?.card),i&&t.validDomains&&(0,c.F6)(i.value,(0,a.compact)(t.validDomains)))return{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:t.id,card:s,openUrlResult:{__typename:"AppBasedLinkOpenUrlResult",title:i.title,url:i.value,isAuth:"auth"===n.type||"silentAuth"===n.type}}};const{resource:o}=this.getWebApplicationInfo(t);return"silentAuth"===n.type&&!i&&o?{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:t.id,aadAuthResult:{__typename:"AppBasedLinkAadAuthResult",resource:o}}}:(this.logger.error(this.getErrorMessage("Invalid auth/config result from bot",t)),null)}isSupportedPreviewCardType(e){const n=e.contentType.toLowerCase();return"application/vnd.microsoft.card.hero"===n||"application/vnd.microsoft.card.thumbnail"===n}getQueryLinkVariables(e,n,t,a,i){const s=n.messageExtensions?.[0];if(s){return{botInvokeParams:{threadId:t??"",botMri:`${o.gN.BotPrefix}${s.botId??""}`},invokeValue:JSON.stringify({url:e,...a&&{state:a},...i&&{authentication:i}})}}}getErrorMessage(e,n){return`${e} for app id: ${n.id}`}processSuggestedActions(e){let n,t;return e?(e.actions?.forEach((e=>{switch(e.type){case"setDefaultUrlPreviewType":n=this.getPreviewType(e.value),n||this.logger.error(`Invalid invoke response: invalid setDefaultUrlPreviewType ${e.value}`);break;case"setCachePolicy":try{const n=JSON.parse(e.value);t=this.getCachePolicy(n.type)}catch(n){this.logger.error(`Invalid invoke response: setCachePolicy requires stringified JSON payload, but got ${e.value}`);break}t||this.logger.error("Invalid invoke response: invalid cache policy type");break;default:this.logger.error(`Invalid invoke response: unsupported suggestedAction type: ${e.type}`)}})),{defaultPreviewType:n,cachePolicyType:t}):{defaultPreviewType:n,cachePolicyType:t}}getPreviewType(e){switch(e){case"Thumbnail":return"Thumbnail";case"Card":return"Card";default:return}}getCachePolicy(e){if("no-cache"===e)return"NoCache"}}},654703:(e,n,t)=>{t.d(n,{$:()=>a});const a="48:notes"},503853:(e,n,t)=>{t.d(n,{wy:()=>a,sm:()=>i,Bc:()=>s,Ue:()=>o,rR:()=>u,Mn:()=>m,w1:()=>g,dY:()=>h,zo:()=>v,kF:()=>E,f9:()=>y});var a,i,s,o,r=t(199448),d=t(850434);!function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidMessageResponse=3]="InvalidMessageResponse",e[e.BothCardAndUrl=4]="BothCardAndUrl",e[e.MissingCardAndUrl=5]="MissingCardAndUrl",e[e.InvalidAdaptiveCard=6]="InvalidAdaptiveCard",e[e.InvalidUrl=7]="InvalidUrl"}(a||(a={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(i||(i={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(s||(s={})),function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidAdaptiveCards=3]="InvalidAdaptiveCards",e[e.InvalidSubmitTaskResponse=4]="InvalidSubmitTaskResponse"}(o||(o={}));const l="BotsPlatformResolvers",c="retry-after",u=async e=>{const n=await I(e),t=T(n.errorCode),a=f(n);return t?(0,r.$5)(l,d.O4.BotError,"executeBotInvoke",void 0,a,void 0):p(e,a)},p=(e,n)=>412===e.status?(0,r.$5)(l,d.O4.UserConsentRequired,"executeBotInvoke",void 0,n,void 0):429===e.status?(0,r.$5)(l,d.O4.Throttled,"executeBotInvoke",void 0,n,{status:e.status,headers:{[c]:e.headers[c]},body:{},url:""}):403===e.status&&n.toLowerCase().includes("BotDisabledByAdmin".toLowerCase())?(0,r.$5)(l,d.O4.Forbidden,"executeBotInvoke",void 0,n,void 0):(0,r.$5)(l,d.O4.RemoteOperationFailed,"executeBotInvoke",void 0,n,void 0),m=e=>{const n=e&&a[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeTaskModuleInvoke",void 0,n,void 0)},g=e=>{const n=e&&o[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeAdaptiveCardTabInvoke",void 0,n,void 0)},h=()=>(0,r.$5)(l,d.O4.Unauthorized,"getCurrentUserName",void 0,void 0,void 0),v=e=>{const n=e&&s[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeMessageExtensionInvoke",void 0,n,void 0)},E=e=>{const n=e&&i[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeBotConfigInvoke",void 0,n,void 0)},I=async e=>{const n=await e.body.text();return n&&n.length>0?JSON.parse(n):{}},T=e=>null!=e&&(1008===e||209===e),f=e=>`Error code: ${e.errorCode} message: ${A(e.message)}`,A=e=>{const n=e&&e.match(/<[^>]*>/g);return n&&n.length>0?n[0]:""},y=(e,n)=>{const t="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",n);return new RegExp(t,"i").test(e)}},410312:(e,n,t)=>{t.d(n,{l:()=>o,Z:()=>g});var a=t(220192),i=t(908060),s=t(702183);const o=(e,n)=>{const t=(0,i.a9)(e),a=e.body;a&&t&&r(a,t,n)},r=(e,n,t)=>{const a=t?.newScenario(s.Cu.ExtCardMentionsInvoke),i={hasMentions:!1};e.forEach((e=>d(e,n,i))),a&&(i.hasMentions?a.mark(s.BQ.ExtCardMentionsInvokeComplete):a.mark(s.BQ.ExtCardMentionsInvokeMissing),a.stop())},d=(e,n,t)=>{(0,i.KQ)(e,{type:"TextBlock"},(e=>{l(n,t)(e)})),(0,i.KQ)(e,{type:"FactSet"},(e=>{c(n,t)(e)}))},l=(e,n)=>t=>{e.forEach(((e,a)=>{t.text=u(t.text,a,e,n)}))},c=(e,n)=>t=>{t.facts.forEach((t=>{e.forEach(((e,a)=>{t.title=u(t.title,a,e,n),t.value=u(t.value,a,e,n)}))}))},u=(e,n,t,i)=>{const{mentionsText:s,isMentionsApplied:o}=p(e,n,t,a.A.mention);return i.hasMentions=i.hasMentions||o,s},p=(e,n,t,a)=>{let i=!1;if(-1!==e.indexOf(n)){const s=`<span contenteditable="false" itemscope="" itemtype="${a}" itemid="${t.itemId}">${g(m(n))}</span>`;e=e.replace(new RegExp(n,"g"),s),i=!0}return{mentionsText:e,isMentionsApplied:i}},m=e=>e.substring(4,e.length-5),g=e=>e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;"):""},575930:(e,n,t)=>{t.d(n,{gp:()=>d,fh:()=>l,CH:()=>c});var a=t(364819),i=t(970778),s=t(503853),o=t(410312),r=t(605288);const d=(e,n)=>{const t={__typename:"MessageExtensionResult"},a=e?.composeExtension;if(!a)return t;const i=a.type,s=a.text,d=a.attachments,l=a.suggestedActions;if(!d){const e=u(a.activityPreview);return{...t,...i&&{type:i},...s&&{text:s},...l&&{suggestedActions:l},...e&&{activityPreview:e}}}const c=a.attachmentLayout;d.forEach((e=>{e.contentType.toLowerCase()===r.s.Adaptive&&(0,o.l)(e.content,n)}));const p={items:Array.from(d,(e=>({card:{content:JSON.stringify(e.content),contentType:e.contentType},previewCard:e.preview?{content:JSON.stringify(e.preview.content),contentType:e.preview.contentType}:void 0}))),...i&&{type:i},...c&&{attachmentLayout:c},...l&&{suggestedActions:l},...s&&{text:s}};return{...t,...p}},l=e=>{if((0,a.isEmpty)(e))return(0,i.Lp)(e);switch(e.responseType){case"composeExtension":return d(e);case"task":return(0,i.Lp)(e);default:throw(0,s.zo)(s.Bc.InvalidInvokeResponseType)}},c=e=>{if(!Array.isArray(e))return;const n=e.map((e=>{const n=(0,a.first)(e?.attachments);return{type:e?.type,attachments:n&&[{contentType:n.contentType,content:n.content&&JSON.parse(n.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(n)?void 0:n},u=e=>{if(!Array.isArray(e))return;const n=e.map((e=>{const n=(0,a.first)(e?.attachments);return{type:e?.type,attachments:n&&[{contentType:n.contentType,content:n.content&&JSON.stringify(n.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(n)?void 0:n}},970778:(e,n,t)=>{t.d(n,{Lp:()=>s,wL:()=>o,KA:()=>u});var a=t(364819),i=t(503853);const s=e=>{if((0,a.isEmpty)(e))return u();if(r(e))return l(e.task);if(d(e))return c(e.task);throw(0,i.Mn)(i.wy.Unknown)},o=e=>{const n=e.value,t=(0,a.get)(n,"url"),s=(0,a.get)(n,"card");let o;if(!s&&!t)throw(0,i.Mn)(i.wy.MissingCardAndUrl);if(s&&t)throw(0,i.Mn)(i.wy.BothCardAndUrl);if(s)o=m(e);else if(!(0,a.isString)(t))throw(0,i.Mn)(i.wy.InvalidUrl);const{title:r,fallbackUrl:d,completionBotId:l,height:c,width:u}=n;return{title:r,fallbackUrl:d,completionBotId:l,url:t,card:o,height:p(c),width:p(u)}},r=e=>e.task&&"continue"===e.task.type&&(0,a.isObject)(e.task.value),d=e=>e.task&&"message"===e.task.type&&(0,a.isString)(e.task.value),l=e=>{const n=o(e);return{__typename:"TaskModuleTaskContinue",type:e.type,value:n}},c=({type:e,value:n})=>({__typename:"TaskModuleTaskMessage",type:e,value:n}),u=()=>({__typename:"TaskModuleTaskDone",text:"Done"}),p=e=>{if((0,a.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,a.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},m=e=>{const n=e.value.card;try{if(n&&g(n)){const{content:e={},contentType:t}=n;return{__typename:"Card",contentType:t,content:JSON.stringify(e)}}throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}catch{throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}},g=e=>{const n=(0,a.get)(e,"contentType");return(0,a.isString)(n)&&n.toLowerCase()==="application/vnd.microsoft.card.adaptive".toLowerCase()}},108053:(e,n,t)=>{t.d(n,{Kw:()=>a,A$:()=>i,_7:()=>s,_3:()=>o});const a={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call",REQUEST_TIMEOUT_MESSAGE:"Request timeout"},i={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",GET_MEETING_FROM_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/{tenantId}/{organizerId}/{threadId}/{messageId}",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false"}},V2:{Unified:{GET_CALENDAR_EVENTS:"v2.0/unified/calendarEvents?startDate={startDate}&endDate={endDate}",GET_CALENDAR_VIEWS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail"},Private:{GET_OUTLOOK_CALENDAR_SETTINGS:"v1/calendarSettings?settingName={outlookCalendarSettings}",GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_ATTACHMENTS:"v2.0/me/events/{eventId}/attachments/{attachmentId}"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW_V2_1:"v2.1/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}},Outlook:{V2:{Private:{GET_ATTACHMENT_BY_ID:"/v2.0/me/events/{eventId}/attachments/{attachmentId}"}}}},s="Personal",o={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover",NOTIFICATIONS_FLYOUT:"notifications-flyout",DRAG_DROP_EDIT_DIALOG:"drag-and-drop-edit-dialog"}},649288:(e,n,t)=>{var a;t.d(n,{CK:()=>a,e:()=>i,eu:()=>s,vV:()=>o,Y2:()=>r}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(a||(a={}));const i="Thumbnails";var s,o,r;!function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort",e.RichFilePreviewFromChatsAndChannels="Thumbnails_RichFilePreviewFromChatsAndChannels",e.RichFilePreviewFromSearchFileCards="Thumbnails_RichFilePreviewFromSearchFileCards"}(s||(s={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={})),function(e){e.manualRedirect="manualRedirect"}(r||(r={}))},327080:(e,n,t)=>{t.d(n,{w:()=>s});var a=t(809110),i=t(924820);const s=(e,n)=>{try{if(!n)return;const t=JSON.parse(n.content);return{url:e,title:t.title&&o(t.title),description:t.text&&o(t.text),thumbnail:t.images&&t.images[0]?.url}}catch(e){throw new Error(`parsing preview content failed with error: ${(0,i.y)(e.message||"")}`)}},o=e=>(new a.J).stripHtml(e)||""},345640:(e,n,t)=>{t.d(n,{yr:()=>i,OE:()=>s,wr:()=>o,Ru:()=>r,Si:()=>d,Ls:()=>l,iH:()=>c,q2:()=>u,x$:()=>p,B6:()=>m});const a="__",i=(e,n,t,a,i)=>{if(!(e&&n&&t&&a))return"";return(i?[e,n,t,a,i]:[e,n,t,a]).join("__")},s=e=>{const[n,t,a,i]=e.split("__");return{tenantId:n,organizerId:t,conversationId:a,messageId:i}},o=e=>e.split(a)[0],r=e=>e.split(a)[1],d=e=>e.split(a)[2],l=e=>e.split(a)[3],c=e=>e.split(a)[4],u=(e,n,t)=>{const a=o(e),i=d(e),s={IsBroadcastMeeting:!0,role:"a",Tid:a,Oid:r(e)},l=`/l/meetup-join/${i}/0?context=${encodeURIComponent(JSON.stringify(s))}`;let c=n.replace("/{broadcastId}/join",`?url=${encodeURIComponent(l)}`);return t&&(c+=`&isanonymous=true&tenantId=${a}`),c},p=e=>{if(e){const n=e.stream,t=n?.wamsStreamingUrl,a=!!n?.decryptionToken,i=e.altStream,s=i?.wamsStreamingUrl;return!!(t&&a||s&&!!i?.decryptionToken)}return!1},m=(e,n,t,a)=>{const i=new URL(`/l/meetup-join/${encodeURIComponent(a)}/0`,`${e}`),s=new URLSearchParams({context:JSON.stringify({Tid:n,Oid:t,IsBroadcastMeeting:!0,role:"a"}),btype:"a",role:"a"});return i.search=s.toString(),i.toString()}},510699:(e,n,t)=>{function a(){return new Date}t.d(n,{AV:()=>a,Hs:()=>i,Ae:()=>l,iB:()=>c});const i=9999,s=59,o=59,r=23,d=999,l=new Date(i,11,31,0,0,0);function c(){const e=a();return e.setHours(r,o,s,d),e}},139496:(e,n,t)=>{t.d(n,{Gu:()=>a,dB:()=>i,nC:()=>s,Yl:()=>o,d6:()=>r,RJ:()=>d});class a{constructor(e,n,t){this.maxDelay=e,this.initialDelay=n,this.calculate=t,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class i extends a{constructor(e,n){super(e,n,((e,n)=>Math.pow(e,n)))}}class s extends a{constructor(e,n,t){super(t,e,((e,t)=>e*Math.pow(n,t-1)))}}class o extends a{constructor(e){super(e,e,(()=>e))}}class r extends a{constructor(e){super(e,e,(()=>Math.floor(Math.random()*e)))}}class d extends a{constructor(e,n){super(n,e,((e,n)=>{const t=Math.random()*Math.pow(2,n-1);return Math.floor((.5*Math.pow(4,n-1)+t)*e)}))}}},9012:(e,n,t)=>{t.d(n,{IN:()=>a,sP:()=>i,VQ:()=>s});const a=Symbol("ForEachAsyncIteratorContinue"),i=Symbol("ForEachAsyncIteratorBreak");function s(e,n){let t,s=!1,r=e=>Promise.reject(e);"function"==typeof e.return&&(t=e.return,r=n=>{const a=()=>Promise.reject(n);return t.call(e).then(a,a)});const d=function(e,n){return function(t){return t.done?Promise.resolve(t):function(e,n){return new Promise((t=>t(n(e))))}(t.value,e).then(o,n)}}(n,r);return{async next(){if(s)return this.return();{let n=await e.next(),t=await d(n);for(;!t.done&&t.value===a;)n=await e.next(),t=await d(n);return t.value===i||t.value===a?this.return():t}},return:()=>(s=!0,t?t.call(e).then(d):Promise.resolve({value:void 0,done:!0})),throw:n=>(s=!0,"function"==typeof e.throw?e.throw(n).then(d):Promise.reject(n).catch(r)),[Symbol.asyncIterator](){return this}}}function o(e){return{value:e,done:!1}}},430426:(e,n,t)=>{var a;t.d(n,{V:()=>r}),function(e){e[e.Value=0]="Value",e[e.Error=1]="Error"}(a||(a={}));var i=t(702183),s=t(364819);class o{constructor(e=100,n,t,a,i){if(this.newScenario=n,this.logger=a,this.getDroppedEventMetadataFn=i,e<0)throw new TypeError(`BufferLimit has to be > 0. OperationName ${this._operationName}`);this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e,this._overflowScenario=null,this._droppedEvents=0,this._operationName=t,this._droppedEventMetadataToCount=new Map}next(e){this._push({type:a.Value,value:e})}error(e){this._push({type:a.Error,error:e})}complete(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;)this._promiseResolutionFunctions.shift().resolve({done:!0})}onUnsubscribe(){this.complete(),this._promiseResolutionFunctions=[],this._values=[]}nextPromise(){if(this._overflowScenario&&this._values.length<this._bufferLimit){let e=`AsyncIterableObserver buffer is no longer full for operation ${this._operationName}. Dropped ${this._droppedEvents} events.`;if(this.getDroppedEventMetadataFn){const n=(0,s.maxBy)(Array.from(this._droppedEventMetadataToCount.keys()),(e=>this._droppedEventMetadataToCount.get(e)));e=`${e} Max dropped event metadata: ${n}.`,this._overflowScenario.appendEventData({context:JSON.stringify(Array.from(this._droppedEventMetadataToCount.entries())),reason:n})}this.logger&&this.logger.warn(e),this._overflowScenario.stop({size:this._droppedEvents}),this._overflowScenario=null,this._droppedEvents=0,this._droppedEventMetadataToCount=new Map}if(this._values.length>0){const{type:e,value:n,error:t}=this._values.shift();return e===a.Error?Promise.reject(t):Promise.resolve({done:!1,value:n})}return this._isComplete?Promise.resolve({done:!0}):new Promise(((e,n)=>{this._promiseResolutionFunctions.push({resolve:e,reject:n})}))}_push(e){if(this._promiseResolutionFunctions.length>0){const{resolve:n,reject:t}=this._promiseResolutionFunctions.shift();e.type===a.Error?t(e.error):n({done:!1,value:e.value})}else{if(this._values.length>this._bufferLimit-1){if(this._droppedEvents+=1,this.getDroppedEventMetadataFn&&e.value){const n=this.getDroppedEventMetadataFn(e.value),t=this._droppedEventMetadataToCount.get(n);this._droppedEventMetadataToCount.set(n,t?t+1:1)}throw!this._overflowScenario&&this.newScenario&&(this._overflowScenario=this.newScenario(i.Cu.OnAsyncIterableObserverOverflow),this._overflowScenario.appendEventData({operationName:this._operationName})),new Error(`AsyncIterableObserver buffer is full, all future events will be dropped for OperationName: ${this._operationName}`)}this._values.push(e)}}}function r(e,n,t,a,i,s,o){return new d(e,n,t,a,i,s,o)}class d{constructor(e,n,t,a,i,s,r){this.error=null;try{this.observer=new o(n,t,a,i,s),this.subscription=e.subscribe(this.observer),this.running=!0,this.cancellationListenerSubscription=r?.subscribe((()=>{this.onCancelledSubscription()}))}catch(e){this.running=!1,this.error=e}}[Symbol.asyncIterator](){return this}async next(){if(this.running&&this.observer)try{const e=await this.observer.nextPromise();if(this.running&&!e.done)return e}catch(e){return this.throw(e)}return this.error?this.throw(this.error):this.return()}return(e){return this.onCancelledSubscription(),Promise.resolve({done:!0,value:void 0})}throw(e){return this.onCancelledSubscription(),Promise.reject(e)}onCancelledSubscription(){this.running=!1,this.subscription?.unsubscribe(),this.observer?.onUnsubscribe(),this.cancellationListenerSubscription?.unsubscribe()}}},891664:(e,n,t)=>{var a;t.d(n,{EE:()=>a,Dy:()=>i,Ig:()=>s,d0:()=>o,wP:()=>r}),function(e){e.SPPage="sppage",e.SPList="splist",e.SPListItem="splistitem",e.SPListForm="splistform",e.SPListPlaylist="splistplaylist",e.CustomCopilot="copilot"}(a||(a={}));const i={[a.SPListItem]:"link_list_item_default_title",[a.SPListForm]:"link_list_form_default_title"},s=e=>d(e,[a.SPList,a.SPListPlaylist]),o=e=>d(e,[a.SPListItem]),r=e=>d(e,[a.SPListForm]),d=(e,n)=>!!e&&-1!==n.indexOf(e)},458648:(e,n,t)=>{var a,i,s;t.d(n,{YM:()=>a,uM:()=>i,oF:()=>s}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.THIRTY=30]="THIRTY",e[e.ONE_HUNDRED=100]="ONE_HUNDRED",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(a||(a={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR",e[e.DEFAULT_REGION_GTM_MIN_LENGTH=10]="DEFAULT_REGION_GTM_MIN_LENGTH"}(i||(i={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(s||(s={}))},218324:(e,n,t)=>{t.d(n,{$:()=>r});var a=t(694257),i=t(228113),s=t(49180),o=t(199448);const r=(e,n,t)=>{const r=l(e),c=(0,o.xZ)(e,a.b.internalErrorCode),u=(0,o.xZ)(e,a.b.httpCode,e?.code||c||""),p={errorMessage:r,serverRequestId:(0,o.xZ)(e,a.b.correlationId)};n(r),(0,i.m)(parseInt(u||"",10))&&!d(parseInt(u||"",10),c)?t&&t.fail({errors:JSON.stringify(p),errorCode:`${u}`}):t&&t.incomplete({errors:JSON.stringify(p),errorCode:`${u||s.rA.Unhandled}`})},d=(e,n)=>e&&e===s.jL.badRequest&&n&&n===s.rA.InvalidRequest,l=e=>{let n=(0,o.xZ)(e,a.b.logErrorMessage,e?.message||"");const t=(0,o.xZ)(e,"innerError",{message:""});n=`${n}. ${t?t.message:""}`;const i={context:e?.context,subContext:e?.subContext};return n=`${n}. ${JSON.stringify(i)}`,n}},265954:(e,n,t)=>{var a;t.d(n,{G:()=>a}),function(e){e.About="about",e.Accounts="accounts",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.ChatsAndChannels="chats_and_channels",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices",e.Recognition="recognition",e.FilesAndLinks="files_and_links",e.PhoneLink="phonelink",e.AppDevicePermission="app_permissions",e.Insiders="teams_insider",e.Localization="localization"}(a||(a={}))},299144:(e,n,t)=>{t.d(n,{Bg:()=>o,kF:()=>r,eq:()=>d,Vb:()=>l,q8:()=>c,pc:()=>u,Mw:()=>p,$A:()=>m,bV:()=>g,cN:()=>h,gm:()=>v,eV:()=>I});var a=t(779898),i=t(836176);const s=/[a-z]+-[a-z]+/gi,o=e=>{const n=e.match(/\/objects\/(.*)\/views\/video/);return n?.[1]},r=e=>`${e}.mpd`,d=(e,n,t)=>e.replace(new RegExp("/video$"),`/${t}/videoSegment/${n}`),l=e=>e.includes("canary")?"canary":"prod",c=e=>e?"2":"1",u=e=>e.replace("views/video","views/transcript"),p=(e,n,t)=>{if(!t||!e||!n||e.startsWith(n))return e;return[n,new URL(e).pathname.substring(1)].join("")},m=e=>r(e),g=(e,n)=>({...e&&{authorization:`skype_token ${e}`},...n&&{"ms-cv":n}}),h=()=>{const{document:e}=(0,a.z)(),n=e?.defaultView?.navigator.userAgent;return void 0!==n&&-1!==n.indexOf("Electron")},v=()=>{const{document:e}=(0,a.z)(),n=e?.defaultView?.navigator.userAgent;return void 0!==n&&-1!==n.indexOf("Firefox")},E=e=>(0,i.zU)(e).locale??e,I=(e,n,t)=>{const a=new Set;e&&a.add(E(e.toLowerCase())),n&&!a.has(n)&&a.add(E(n.toLowerCase()));const i=t.map((e=>E(e))).filter((e=>e.match(s)));if(i)for(const e of i){if(a.size>=4)break;a.has(e.toLowerCase())||a.add(e.toLowerCase())}return[...a].slice(0,4).join(";")}},370604:(e,n,t)=>{t.d(n,{Ow:()=>a,YZ:()=>i,IQ:()=>s,cg:()=>o,sY:()=>r,Vy:()=>d,Qw:()=>l,gM:()=>c,pK:()=>u});const a="video-message",i="video-message-gc",s="Creation-Epoch",o=(e,n)=>{const t=parseInt(n||"",10);return isNaN(t)||e-t>144e5},r=(e,n)=>e-n>2592e5,d=e=>c(e,"videoBlob"),l=e=>c(e,"thumbnailBlob"),c=(e,n)=>`${a}?cacheId=${e}&type=${n}`,u=e=>{try{const n=new URL(e);if(n.pathname.slice(Math.max(0,n.pathname.length-a.length))!==a)return;const t=n.searchParams.get("cacheId"),i=n.searchParams.get("type"),s="videoBlob"===i||"thumbnailBlob"===i?i:void 0;return t&&s?{cacheId:t,type:s}:void 0}catch{return}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/106421-af8ca324ef8978ce.js.map