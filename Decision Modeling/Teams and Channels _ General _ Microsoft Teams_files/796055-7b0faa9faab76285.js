(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[796055],{643502:(e,n,i)=>{"use strict";i.d(n,{z:()=>r,I:()=>l});var a=i(422816);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"downloadAmsItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlobType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"networkCorrelationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadAmsItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"urlOrObjectId"},value:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"applyRetry"},value:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}}},{kind:"Argument",name:{kind:"Name",value:"networkCorrelationId"},value:{kind:"Variable",name:{kind:"Name",value:"networkCorrelationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blob"}},{kind:"Field",name:{kind:"Name",value:"fullSizeHeight"}},{kind:"Field",name:{kind:"Name",value:"fullSizeWidth"}},{kind:"Field",name:{kind:"Name",value:"size"}}]}}]}}]},r=async(e,n,i,r,o)=>{try{const{data:a}=await e.query({query:t,variables:{urlOrObjectId:n,type:i,applyRetry:r,networkCorrelationId:o},fetchPolicy:"network-only"});return{result:a?.downloadAmsItem??void 0,loading:!1,error:void 0}}catch(e){if(e instanceof a.K){const n=e.graphQLErrors.find((e=>l(e.extensions)))?.extensions;return{result:void 0,loading:!1,error:{...n,message:e.message,name:e.name}}}return{result:void 0,loading:!1,error:e}}},l=e=>"string"==typeof e?.cv},300616:(e,n,i)=>{"use strict";i.d(n,{QL:()=>g,dX:()=>v,wM:()=>k});var a=i(513432);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chatWithUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatWithUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}}]}}]}}]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var o=i(717828),s=i(754255),d=i(937545),c=i(131647),m=i(129123),u=i(84646),p=i(806658);const k=(e,n,i)=>{const{enableCentralizedCommandingForEV:t}=(0,m.w2)(s.w.Host,["enableCentralizedCommandingForEV"]),{enablePlatformNavigationForBots:r}=(0,m.w2)(s.w.Extensibility,["enablePlatformNavigationForBots"]);return a.useMemo((()=>({sendMessage:N(n,i),startChat:v(e,n,!!r,i),startCall:I(e,n,i,!!t)})),[e,n,i,t,r])},g=async(e,n)=>{const{data:i}=await e.query({query:t,variables:{userId:n},fetchPolicy:"network-only"});return i?.chatWithUser},N=(e,n)=>async(i,a,t)=>{try{const n=await g(e,i);if(!n)throw new Error(`Could not fetch the user conversation using the mri ${i}`);const l={convId:n.id,message:{content:a,clientMessageId:(0,o.sN)(),messageType:u.Go.Text},action:"Create"};await e.mutate({mutation:r,variables:l}),t.stop()}catch{const e=`Error while sending quick message with mri ${i}`;n.error(e),t?.fail({message:e})}},v=(e,n,i,a)=>async(t,r)=>{try{if(!t)throw new Error("No mri provided");const a=await g(n,t);if(a&&a.id){(0,p.Iz)(t)&&i?e.platform.platformTabById(JSON.stringify({appId:t,threadId:a.id,tabEntityId:"conversations"}),{stateTransition:d.Ar.new,visibilityState:d.Rp.show,correlation:{source:c.p.AppProfileCard}}):e.chat.chatById(a.id,{entityCommand:{stateTransition:d.Ar.new,visibilityState:d.Rp.show,correlation:{source:c.p.AppProfileCard}}})}else e.chat.chatWithUsers({userIds:[t],entityCommand:{stateTransition:d.Ar.new,visibilityState:d.Rp.show,correlation:{source:c.p.AppProfileCard}}});r?.stop()}catch{const e=`Error while we execute start chat with mri ${t}`;a?.error(e),r?.fail({message:e})}},I=(e,n,i,a)=>async(t,r,o)=>{try{if(!t)throw new Error(`Could not get the user mri ${t} from the persona identifier `);const i=(async(e,n,i=!1)=>{const a={callingIntent:{type:"OneToOneCall",joinOptions:{outgoingVideo:i,outgoingAudio:!0,oneToOne:{sharingSourceId:void 0}},coordinates:{oneToOne:{mri:n}}}},{data:t}=await e.mutate({mutation:l,variables:a});return t?.fireCallingIntent?.id})(n,t,r),s=g(n,t),[m,u]=await Promise.all([i,s]);if(!m)throw new Error(`Could not fetch the user calling IntentId using the mri ${t}`);const p=u?.id;a||e.call.callById(m,{stateTransition:d.Ar.new,visibilityState:d.Rp.show,correlation:{source:c.p.AppProfileCard}},p),o.stop()}catch{const e=`Error while StartCall using the mri ${t}`;i.error(e),o.fail({message:e})}}},831854:(e,n,i)=>{"use strict";i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinition"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(706397).h.definitions]}},32009:(e,n,i)=>{"use strict";i.d(n,{T:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinitions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(706397).h.definitions]}},942832:(e,n,i)=>{"use strict";i.d(n,{qn:()=>a,e6:()=>l,bf:()=>o,xK:()=>s,ag:()=>d,Q4:()=>c,c5:()=>m,$R:()=>u,yq:()=>p,dU:()=>k,pJ:()=>g,oD:()=>N,Wl:()=>v,GD:()=>f,v8:()=>h,ZQ:()=>S,kp:()=>T,Cn:()=>M,WX:()=>y,td:()=>A,LY:()=>b,zh:()=>D,TW:()=>E});var a,t=i(751733),r=i(364819);!function(e){e.Bot="Bot",e.Connector="Connector",e.Messaging="Messaging",e.StaticTabs="StaticTabs",e.GalleryTab="GalleryTab"}(a||(a={}));const l=e=>!!e&&F(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),o=e=>C(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),s=e=>"InstalledApp"===e?.__typename&&!(0,r.isUndefined)(e?.definition),d=e=>!!e&&F(e,["InstalledAndPermanent"]),c=e=>!!e&&F(e,["Featured"]),m=e=>!!e&&F(e,["PreConsented"]),u=e=>C(e,["PreConsented"]),p=e=>F(e,["RequireConsent"]),k=e=>C(e,["RequireConsent"]),g=e=>F(e,["NotInstalled"]),N=e=>e&&(v(e.definition,a.Bot,"Personal")||v(e.definition,a.StaticTabs,"Personal"))||!1,v=(e,n,i)=>{if(!e)return!1;switch(n){case a.Bot:return e.bots&&(0,r.first)(e.bots)&&(0,r.includes)(e.bots[0].scopes,i)||!1;case a.StaticTabs:return e.staticTabs&&(0,r.first)(e.staticTabs)&&(0,r.includes)(e.staticTabs[0].scopes,i)||!1;default:return!1}},I=(e,n)=>e.installedScope&&e.installedScope.includes(n),f=e=>l(e)&&I(e,"Personal"),h=(e,n=!1)=>{const i=c(e)||l(e)&&(I(e,"GroupChat")||I(e,"Team"));return n?i||m(e):i},S=e=>!g(e)&&"Team"===e.installedScope&&"Enabled"===e.statusInfo?.status,T=e=>!g(e)&&"Team"===e.installedScope&&"Disabled"===e.statusInfo?.status,M=e=>l(e)&&(I(e,"GroupChat")||I(e,"Team")),y=e=>{const n=e.data&&e.data.installApp;return!!n&&"InstalledApp"===n.__typename},A=e=>{const n=e.data&&e.data.installCustomApp;return!!n&&"InstalledApp"===n.__typename},b=e=>{const n=e.data&&e.data.upgradeApp;return!!n&&"InstalledApp"===n.__typename},F=(e,n)=>(0,r.includes)(n,e.installationState),C=(e,n)=>(0,r.includes)(n,e),D=e=>{let n="",i="";if(e&&e.length>0){const a=e.indexOf(t.fc.statusKey),r=e.indexOf(t.fc.errorCodeKey);n=a>-1?`Http status code: ${U(e.substr(a),t.fc.statusKey)}`:`Http status code: ${t.bF}`,i=r>-1?`Error code: ${U(e.substr(r),t.fc.errorCodeKey)}`:`Error code: ${t.kb.NoSpecificErrorMessageFound}`}return`${n}, ${i}`},U=(e,n)=>{const i=e.length>0?e.split(","):[];if(i.length>0){const e=i[0].replace(/[\\"'{}\s]/g,"").split(":");if(e.length>1&&(n===t.fc.statusKey&&e[1]in t.kG||n===t.fc.errorCodeKey&&e[1]in t.kb))return e[1]}return n===t.fc.statusKey?t.bF:t.kb.NoSpecificErrorMessageFound},E=()=>`${`Http status code: ${t.bF}`}, ${`Error code: ${t.kb.NoSpecificErrorMessageFound}`}`},751733:(e,n,i)=>{"use strict";var a,t;i.d(n,{kb:()=>a,kG:()=>t,bF:()=>r,fc:()=>l,gY:()=>o}),function(e){e.NoSpecificErrorMessageFound="NoSpecificErrorMessageFound",e.Unknown="Unknown",e.Unauthorized="Unauthorized",e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.NotFound="NotFound",e.AppScopeIsNotAllowed="AppScopeIsNotAllowed",e.AppIsNotInstalledInTheChat="AppIsNotInstalledInTheChat",e.AppIsNotInstalledInTheTeam="AppIsNotInstalledInTheTeam",e.AppIsNotActivelyInstalled="AppIsNotActivelyInstalled",e.AppIsBlockedByAppPermissionPolicy="AppIsBlockedByAppPermissionPolicy",e.UnknownFailureToParseTeamsAppManifest="UnknownFailureToParseTeamsAppManifest",e.UnableToParseTeamsAppManifest="UnableToParseTeamsAppManifest",e.AppSideloadingForbidden="AppSideloadingForbidden",e.CreateGroupChatAppDefinitionFailed="CreateGroupChatAppDefinitionFailed",e.AppDefinitionAlreadyExists="AppDefinitionAlreadyExists",e.AppDefinitionDoesntExist="AppDefinitionDoesntExist",e.UpdateGroupChatAppDefinitionFailed="UpdateGroupChatAppDefinitionFailed",e.GetAppDefinitionFailed="GetAppDefinitionFailed",e.GetGlobalAppDefinitionsFailed="GetGlobalAppDefinitionsFailed",e.AppDefinitionUpdateNotPermitted="AppDefinitionUpdateNotPermitted",e.AppEntitlementAlreadyExists="AppEntitlementAlreadyExists",e.CreateGroupChatAppEntitlementFailed="CreateGroupChatAppEntitlementFailed",e.CreateTeamAppEntitlementFailed="CreateTeamAppEntitlementFailed",e.GroupChatEntitlementDoesntExist="GroupChatEntitlementDoesntExist",e.TeamAppEntitlementsDontExist="TeamAppEntitlementsDontExist",e.UserAppEntitlementsDontExist="UserAppEntitlementsDontExist",e.TenantAppEntitlementsDontExist="TenantAppEntitlementsDontExist",e.UpgradeTeamAppEntitlementFailed="UpgradeTeamAppEntitlementFailed",e.UpgradeUserAppEntitlementFailed="UpgradeUserAppEntitlementFailed",e.UpgradeGroupChatAppEntitlementFailed="UpgradeGroupChatAppEntitlementFailed",e.GetUserEntitlementsFailed="GetUserEntitlementsFailed",e.GetDefaultUserAppEntitlementsFailed="GetDefaultUserAppEntitlementsFailed",e.SetUserAppEntitlementFailed="SetUserAppEntitlementFailed",e.PermanentAppEntitlementUpdateNotAllowed="PermanentAppEntitlementUpdateNotAllowed",e.GetUserAggregatedAppsFailed="GetUserAggregatedAppsFailed",e.TemplatedAppNotAllowedByTenantSettings="TemplatedAppNotAllowedByTenantSettings",e.TemplatedAppNotAllowedByUserPermissionPolicy="TemplatedAppNotAllowedByUserPermissionPolicy",e.TemplatedInstanceAppNotAllowed="TemplatedInstanceAppNotAllowed",e.GetTeamThreadFailed="GetTeamThreadFailed",e.GetTeamThreadsFailed="GetTeamThreadsFailed",e.GetChatThreadFailed="GetChatThreadFailed",e.GetTenantSettingsFailed="GetTenantSettingsFailed",e.NoPermissionToInstallApp="NoPermissionToInstallApp",e.NoPermissionToUpgradeApp="NoPermissionToUpgradeApp",e.NoPermissionToUploadCustomApp="NoPermissionToUploadCustomApp",e.FailedToCheckPermissionToManageApp="FailedToCheckPermissionToManageApp",e.AppIsTenantAdminBlocked="AppIsTenantAdminBlocked",e.AppUploadNotAllowedByTenant="AppUploadNotAllowedByTenant",e.AppUpdateNotAllowedByTenant="AppUpdateNotAllowedByTenant",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AddAppBotToChatRosterFailed="AddAppBotToChatRosterFailed",e.AddAppBotToTeamRosterFailed="AddAppBotToTeamRosterFailed",e.AddBotToRosterFailedMaxLimitReached="AddBotToRosterFailedMaxLimitReached",e.UserNotFoundInSkypeTeam="UserNotFoundInSkypeTeam",e.BotIdFormatIsIncorrect="BotIdFormatIsIncorrect",e.GuestNotAllowedToInstallApps="GuestNotAllowedToInstallApps",e.GuestNotAllowedToUpdateApps="GuestNotAllowedToUpdateApps",e.GuestNotAllowedToUpgradeApps="GuestNotAllowedToUpgradeApps",e.OperationNotAllowedOnInstalledAndDeprecatedApp="OperationNotAllowedOnInstalledAndDeprecatedApp",e.AnonymousUsersInteractionNotSupported="AnonymousUsersInteractionNotSupported",e.GetUserAppSetupPoliciesAsync="GetUserAppSetupPoliciesAsync",e.InvalidHostedAppOperationForbidden="InvalidHostedAppOperationForbidden",e.OperationNotAllowedOnArchivedTeam="OperationNotAllowedOnArchivedTeam",e.ClientNetworkOffline="ClientNetworkOffline"}(a||(a={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED"}(t||(t={}));const r="NoHttpStatusCode",l={statusKey:"status",errorCodeKey:"errorCode"};var o;!function(e){e[e.BotInputMenu=1]="BotInputMenu",e[e.BotMentions=2]="BotMentions",e[e.MessageExtension=3]="MessageExtension",e[e.MessageAction=4]="MessageAction",e[e.LinkUnfurling=5]="LinkUnfurling",e[e.Webhooks=6]="Webhooks",e[e.BotCards=7]="BotCards",e[e.ChatPane=8]="ChatPane",e[e.MeetingAppNotifications=9]="MeetingAppNotifications",e[e.AppDetails=10]="AppDetails",e[e.TcPickerNavigation=11]="TcPickerNavigation",e[e.Scenes=12]="Scenes",e[e.CallEscalation=13]="CallEscalation",e[e.VivaFeedback=14]="VivaFeedback",e[e.InContextStore=15]="InContextStore",e[e.MeetingAppsFlyout=16]="MeetingAppsFlyout",e[e.AppsFlyout=17]="AppsFlyout",e[e.FreDialog=18]="FreDialog",e[e.Compose=19]="Compose",e[e.Connectors=20]="Connectors",e[e.PreviewCardFooter=21]="PreviewCardFooter",e[e.ACV2CardJITInstall=22]="ACV2CardJITInstall",e[e.MessageExtensionCardFooter=23]="MessageExtensionCardFooter",e[e.TaskModule=24]="TaskModule",e[e.MessageExtensionFlyoutCommand=25]="MessageExtensionFlyoutCommand",e[e.MessageExtensionFlyoutCommandPostInstall=26]="MessageExtensionFlyoutCommandPostInstall",e[e.GetFetchCommandApps=27]="GetFetchCommandApps",e[e.PinnedMessageExtensions=28]="PinnedMessageExtensions",e[e.ChatRoster=29]="ChatRoster",e[e.NewChat=30]="NewChat"}(o||(o={}))},884839:(e,n,i)=>{"use strict";i.d(n,{N6:()=>q,vx:()=>X,Z1:()=>J,NM:()=>Q,at:()=>E,pW:()=>w,xR:()=>C,a:()=>D,KC:()=>U,S:()=>j,oD:()=>P,vc:()=>F,tN:()=>W,i4:()=>x,Y3:()=>G,M9:()=>O,HI:()=>Y,Pe:()=>M,gF:()=>B,c2:()=>A});var a=i(364819),t=i(812228),r=i(702183),l=i(199448),o=i(850434),s=i(942832),d=i(32009),c=i(831854);const m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appImpressions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appImpressions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"impressionProperty"},value:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]}}]};var u=i(570947);const p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"installApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"installParameters"},value:{kind:"Variable",name:{kind:"Name",value:"installParameters"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...u.B.definitions]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"upgradeApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upgradeApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...u.B.definitions]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deleteParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppDeleteParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"deleteParameters"},value:{kind:"Variable",name:{kind:"Name",value:"deleteParameters"}}}]}]}}]};var N=i(424099),v=i(308216),I=i(668989),f=i(751733),h=i(558184),S=i(937201),T=i(99595);const M=(e,n,i,a,t,r,l,o,d,c,m,u)=>{const k={installScope:t,appId:a,conversationId:o,installParameters:c||u?{isCopilotPlugin:c,hasAppEnableConsent:u}:void 0},g=n.newScenario(i);return g.appendEventData({"Thread.Id":o,"App.Id":a}),d&&g.appendEventData(d),q(g,o),e.mutate({mutation:p,variables:k,update:y(e,k,r,l),context:{callerInfo:m}}).then((e=>{if(!(0,s.WX)(e)||!e.data?.installApp?.definition)throw new Error("unexpected response, install app failed");return g.stop(),e.data.installApp})).catch((e=>{const n=e&&e.message?(0,s.zh)(e.message):(0,s.TW)();throw n.includes(f.kb.ClientNetworkOffline)?g.cancel({errors:n}):g.fail({errors:n}),e}))},y=(e,{installScope:n,conversationId:i},a,t)=>(r,l)=>{try{const r=(0,s.WX)(l)&&l.data;r&&r.installApp?(0,N.Cg)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},r.installApp):a.error("mutation update, install app failed")}catch(e){a.error("Failed to add app to client cache")}},A=(e,n,i,a,t,r,l,o,d)=>{const c={installScope:t,appId:a,conversationId:o},m=n.newScenario(i);return e.mutate({mutation:k,variables:c,update:b(e,c,r,l)}).then((e=>{if(!(0,s.LY)(e)||!e.data?.upgradeApp?.definition)throw new Error("unexpected response, upgrade app failed");return d?m.stop(d):m.stop(),e.data.upgradeApp})).catch((e=>{const n=e&&e.message?(0,s.zh)(e.message):(0,s.TW)();throw d?m.fail({...d,errors:n}):m.fail({errors:n}),e}))},b=(e,{installScope:n,conversationId:i},a,t)=>(r,l)=>{try{const r=(0,s.LY)(l)&&l.data;r&&r.upgradeApp?(0,N.Cg)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},r.upgradeApp):a.error("mutation update, upgrade app failed")}catch(e){a.error("Failed to add app to client cache")}},F=async(e,n,i,a)=>{const t=["Personal"],l=a?.conversation,o={installedScopes:l?[...t,l.scope]:t,conversationId:l&&l.id,options:{capabilityFilter:a?.capabilityFilter}},s=n.newScenario(r.Cu.ExtInstalledApps);try{const n=await(0,h.hX)(e,o,"no-cache");s.mark(r.BQ.ExtAppsFetched);const a=n?.filter((e=>e&&e.definition&&e.id===i));return s.mark(r.BQ.ExtAppsProcessed),s.stop(),a}catch(e){return s.fail({errors:`failed to get installed app id: ${i}`}),[]}},C=async(e,n,i,a,t,r)=>{let s;i&&(s=a||"GroupChat");const{data:d,error:m}=await e.query({query:c.y,variables:{appId:n,scope:s,conversationId:i,options:{allowBlockedApps:r}},context:{callerInfo:`${t}-getAppDefinition`}});if(!d||!d.appDefinition||m){const e="Get AppDefinition failed";throw(0,l.$5)("AppsHelper",o.O4.NotPresent,"getAppDefinition",void 0,m?.message??e)}return d.appDefinition},D=async(e,n,i,a,t)=>{const{data:r,error:l}=await e.query({query:d.T,variables:n,context:{callerInfo:i}});if(!r||!r.appDefinitions){const e="Get AppDefinitions failed";if(t){t(`Fail to get App definitions, error message: ${l?.message}`)}throw new Error(e)}return a&&a(),r.appDefinitions},U=async(e,n,i,a)=>{const t=await D(e,{options:{capabilityFilter:["Messaging"]},conversationId:i,scope:a},"getAppDefinitionsByContext");return E(t,n)},E=(e,n)=>e.filter((e=>L(e,n))),w=(e,n,i,t,r,l)=>{if((0,a.isEmpty)(e))return e;if((0,a.isEmpty)(n))return[];let o=e.filter((e=>!!e&&!!e.name?.toLocaleLowerCase().includes(n?.toLocaleLowerCase())));if(i&&t&&(o=o.filter((e=>!!e&&!(0,a.includes)(e.blockedConfigurations,T.H.Federation))),r)){const e=l.map((e=>e.id));o=o.filter((n=>!!n&&(0,a.includes)(e,n.id)))}return o},L=(e,n)=>{if(!n)return!0;const i=e.messageExtensions??[];if(!(0,a.isEmpty)(i))for(const e of i)if((0,a.some)(e.commands,(e=>(0,I.kS)(e,n))))return!0;return!1},O=async e=>{const{client:n,logger:i,scenarioFactory:a,enableInstalledAppsV2:t,enableAppsQueryOptimization:r,entryPoint:l,isOneOnOneBotChat:o,scope:s,convId:d,botId:c}=e;let m={};d&&(m={conversation:o?void 0:{scope:s||"GroupChat",id:d},capabilityFilter:["Bot"],shouldFetchPersonalApps:o,botId:c,entryPoint:l});const u=t?await Y(n,i,a,r,m,void 0):await V(n,i,a,m);if(t&&c){const e=u?.filter((e=>e.definition?.bots?.[0]?.id===c));return e}return u},x=async(e,n,i,a,t,r,l,o)=>a?await Y(e,n,i,t,r,l,void 0,void 0,o):await V(e,n,i,r,l),P=async(e,n,i,a)=>{const t=i.newScenario(r.Cu.ExtGetSimpleAppModel);try{const n=await(0,h.Az)(e,a??"cache-only");return t.stop(),n}catch(e){const i="getAppInstalledByCurrentUser failed";return t.fail({errors:i}),n.warn(`${i} ${e}`),[]}},V=async(e,n,i,a,t)=>{const l=i.newScenario(r.Cu.ExtInstalledApps);try{const n=[];a?.shouldFetchPersonalApps&&n.push("Personal"),a?.conversation&&n.push(a.conversation.scope);const i=await(0,h.hX)(e,{installedScopes:n,conversationId:a?.conversation?.id,options:{capabilityFilter:a?.capabilityFilter,botId:a?.botId}},a?.fetchPolicy);l.mark(r.BQ.ExtAppsFetched);const o=B(i,t);return l.mark(r.BQ.ExtAppsProcessed),l.stop(),o}catch(e){const i=`getInstalledApps failed: ${a?.botId??""}`;return l.fail({errors:i}),n.warn(`${i} ${e}`),[]}},j=async(e,n,i,a,t)=>{const s={query:m,fetchPolicy:t??"network-only",variables:{impressionProperty:a}},d=i.newScenario(r.Cu.ExtGetAppImpression),c="Get AppImpressions failed";try{const{data:n}=await e.query(s);if(!n||!n.appImpressions)throw(0,l.$5)("AppsHelper",o.O4.NotPresent,"getAppImpressions",void 0,c);return d.stop(),n.appImpressions}catch(e){return d.fail({errors:c}),n.warnToTelemetry?.(`${c} ${e}`,"platform_appsframework_appscore_apps_helper"),[]}},B=(e,n,i)=>(0,t.compose)(a.compact,(0,t.map)((e=>z(e,n))),(0,t.filter)((e=>(0,s.xK)(e)&&H(e,i))))(e),z=(e,n)=>{if(!n)return e;let i=!1,t=[];if(e.definition.messageExtensions&&(t=e.definition.messageExtensions.map((e=>{let t=e;const r=e.commands??[];return(0,a.isEmpty)(e.commands)||(t={...e,commands:r.filter((e=>!!(0,I.kS)(e,n)&&(i=!0,!0)))}),t}))),!i)return null;const r=t.length?{...e.definition,messageExtensions:t}:e.definition;return{...e,definition:r}},R=(e,{appId:n,installedScope:i,conversationId:a},t,r)=>(l,{data:o})=>{try{o&&o.deleteApp?(0,N.G7)({client:e,installedScope:i,conversationId:a,logger:t,enableAppsQueryOptimization:r},n):t.error("mutation update, delete app failed")}catch(e){t.error("Failed to remove app from client cache")}},Q=async(e,n,i,a,t,r)=>{const l=n.newScenario(i);l.appendEventData({"Thread.Id":t.conversationId??void 0,"App.Id":t.appId}),q(l,t.conversationId);try{const n=await e.mutate({mutation:g,variables:t,update:R(e,t,a,r)});if(!n?.data?.deleteApp)throw new Error("unexpected response, delete app failed");return l.stop(),n}catch(e){throw l.fail({errors:`failed to delete app ${t.appId}`}),e}},W=async(e,n,i,a,t,l,o)=>{const s=o||{},d=i.newScenario(r.Cu.ExtInstalledAppsV2);try{const i=[];if(o?.enableInstalledAppQueryOptimization){if(d.appendEventData({dataSource:"installedApp query",correlationId:l}),s.shouldFetchPersonalApps){const n=e.query({query:S.p,variables:{installedScope:"Personal",appId:a},context:{callerInfo:`${l}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));i.push(n)}if(s.conversation&&s.conversation.id){const n=e.query({query:S.p,variables:{installedScope:s.conversation.scope,appId:a,conversationId:s.conversation.id},context:{callerInfo:`${l}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));i.push(n)}const n=(await Promise.all(i)).filter((e=>!!e));return d.mark(r.BQ.ExtAppsProcessed),d.stop({appCount:n.length}),n}{d.appendEventData({dataSource:"installedAppsV2 query",correlationId:l});const i=(await _(e,d,n,t,`${l}-getInstalledAppsByIdV2`,s)).filter((e=>e&&e.definition&&e.id===a));return d.mark(r.BQ.ExtAppsProcessed),d.stop(),i}}catch(e){return d.fail({errors:`failed to get installed app id: ${a}`}),[]}},Y=async(e,n,i,a,t,l,o,s,d)=>{const c=i.newScenario(r.Cu.ExtInstalledAppsV2),m={"Thread.Id":t?.conversation?.id};t?.entryPoint&&(m["App.EntryPoint"]=f.gY[t.entryPoint]);try{const i=await _(e,c,n,a,t?.entryPoint?f.gY[t.entryPoint]:"getInstalledAppsV2",t,d),s=B(i,l,t);return c.mark(r.BQ.ExtAppsProcessed),c.stop(m),o&&o(),s}catch(e){const i=`getInstalledAppsV2 failed convId: ${t?.conversation?.id??""} botId: ${t?.botId??""}`;return c.fail({...m,errors:i}),s&&s(i),n.warn(`${i}`),[]}},G=async(e,n,i,a,t)=>{const r=i.newScenario(a);try{const i=await(0,h.gZ)(e,n,"network-only"),a=B(i);return r.stop(),a}catch{const e=`failed to get hosted installed apps for ${n}`;return r.fail({errors:e}),t.error(e),[]}},_=async(e,n,i,a,t,l,o)=>{let s;const{fetchPolicyForScope:d,fetchOptions:c}=await(0,v.HW)(e,i,l);let m=null,u=null;if(l?.shouldFetchPersonalApps){s={scope:"Personal",conversationId:l?.conversation?.id};m=(o?h.L5:h.kJ)(e,{installedContext:s,options:{includeUnconsentedApps:l.includeUnconsentedApps}},t,(0,v.or)(d.Personal)).then((e=>(n.mark(r.BQ.ExtAppsFetchedPersonalScope),i.log(`installedApps: ${e.length} scope: ${s.scope}`),e)))}l?.conversation&&l?.conversation.id&&(u=Z(e,n,i,a,l.conversation,d,t,o,l.capabilityFilter));const p=[m||Promise.resolve([]),u||Promise.resolve([])],[k,g]=await Promise.all(p);return(0,v.J7)(e,i,c),k.concat(g)},Z=(e,n,i,a,t,l,o,s,d)=>{let c;const m=t.scope,u="Team"===t.scope,p={scope:m,conversationId:t.id},k=(0,v.or)(l[m]);return a&&!u?(c=(0,h.Am)(e,{conversationId:t.id},k),n.mark(r.BQ.ExtAppsQueryInstalledAppsWithPreCheck)):(c=s?(0,h.L5)(e,{installedContext:p,options:{capabilityFilter:d}},o,k):(0,h.Tw)(e,{installedContext:p,options:{capabilityFilter:d}},o,k),n.mark(r.BQ.ExtAppsQueryInstalledAppsV2)),c=c.then((e=>{i.log(`installedApps: ${e.length} scope: ${p.scope} conversationId: ${p.conversationId} enableInstalledAppsMsgActionsQueryOptimization: ${s}`);const a="Team"===m?r.BQ.ExtAppsFetchedTeamScope:r.BQ.ExtAppsFetchedGroupScope;return n.mark(a),e})),c},H=(e,n)=>{if((0,a.isEmpty)(n?.capabilityFilter))return!0;const i=e.definition;return(0,a.some)(n?.capabilityFilter,(e=>{switch(e){case"Messaging":return!(0,a.isEmpty)(i.messageExtensions);case"Tab":return!(0,a.isEmpty)(i.galleryTabs)||n?.enableStaticTabsPhase1&&!(0,a.isEmpty)(i.staticTabs);case"Bot":return!(0,a.isEmpty)(i.bots);case"Connector":return!(0,a.isEmpty)(i.connectors);case"CUSTOMBOT":return!(0,a.isEmpty)(i.customBots)}}))},J=(e,n)=>{let i=X(e,n.bots)||X(e,n.connectors)||X(e,n.galleryTabs)||X(e,n.staticTabs);if("Team"===e)return i;if(i||(i=X(e,n.messageExtensions)),"Personal"!==e)return i;const a=(n.meetingExtensionDefinition?.scenes?.length??0)>0,t=(n.meetingExtensionDefinition?.filters?.length??0)>0;return i||a||t},X=(e,n)=>(0,a.some)(n,(n=>(0,a.includes)(n.scopes,e))),q=(e,n)=>{(e=>!!e&&(e.toLowerCase().includes("replychainid")||e.toLowerCase().includes("messageid")))(n)&&e.appendEventData({"Thread.Type":"Channel"})}},30228:(e,n,i)=>{"use strict";i.d(n,{N:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsInstalledByCurrentUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsInstalledByCurrentUser"}}]}}]}},720627:(e,n,i)=>{"use strict";i.d(n,{n:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(16214).j.definitions]}},308216:(e,n,i)=>{"use strict";i.d(n,{HW:()=>l,or:()=>c,J7:()=>s,zy:()=>d});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyOptions"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[{kind:"Argument",name:{kind:"Name",value:"always"},value:{kind:"BooleanValue",value:!0}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}}]}}]}}]},t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateAllAppsFetchPoliciesMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAllPlatformAppsFetchPolicies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fetchSource"},value:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var r=i(973120);const l=async(e,n,i)=>{const a={};let t=[];try{i?.shouldFetchPersonalApps&&(t=[{scope:"Personal"}]),i?.conversation&&i?.conversation.id&&(t=[...t,{scope:i.conversation.scope,convId:i.conversation.id}]);const a=await o(e,t);return n.log("getFetchPolicy for installedApps",a),{fetchPolicyForScope:a,fetchOptions:t}}catch(e){return n.error("getFetchPolicy for installedApps failed"),{fetchPolicyForScope:a,fetchOptions:t}}},o=async(e,n)=>{const{data:i}=await e.query({query:a,variables:{options:n}}),t={},r=i?.platformAppsBatchFetchPolicy?.reduce(((e,n)=>({...e,[n.scope]:n.forceNetworkFetch})),t);return r??t},s=(e,n,i,a)=>{const t=a??"Cache",l=i.map((e=>({...e,fetchSource:t})));return e.mutate({mutation:r.J,variables:{input:l}}).catch((e=>(n.error("failed to set fetch policy to ",t),Promise.resolve(void 0))))},d=(e,n,i)=>{e.mutate({mutation:t,variables:{fetchSource:i}}).catch((e=>{n.error("failed to update all fetch policies to ",i)}))},c=e=>e?"network-only":"cache-first"},937201:(e,n,i)=>{"use strict";i.d(n,{p:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...i(570947).B.definitions]}},434497:(e,n,i)=>{"use strict";i.d(n,{s:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},...i(570947).B.definitions]}},558184:(e,n,i)=>{"use strict";i.d(n,{Az:()=>v,g_:()=>N,Am:()=>p,hX:()=>f,gZ:()=>I,kJ:()=>g,Tw:()=>k,L5:()=>h});var a=i(434497),t=i(570947);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsForContainerApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"containerAppId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForContainerApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"containerAppId"},value:{kind:"Variable",name:{kind:"Name",value:"containerAppId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.B.definitions]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.B.definitions]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.B.definitions]};var s=i(720627),d=i(30228);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAppDefinitionMsgActionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"resource"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesInstalledAppsV2MessageActionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForMesssageAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstalledAppMsgActionFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstalledAppMsgActionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAppDefinitionMsgActionFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}},...i(802093).O.definitions,...c.definitions]}.definitions]},u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesInstalledAppsForMessageActionQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForMesssageAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},...t.B.definitions]},p=async(e,n,i)=>{const{data:a}=await e.query({query:l,variables:n,fetchPolicy:i});return a&&a.installedChatAppsWithPreCheck?a.installedChatAppsWithPreCheck:[]},k=async(e,n,i,t)=>{const{data:r}=await e.query({query:a.s,variables:n,fetchPolicy:t,context:{callerInfo:i}});return r&&r.installedAppsV2?r.installedAppsV2:[]},g=async(e,n,i,a)=>{const{data:t}=await e.query({query:u,variables:n,fetchPolicy:a,context:{callerInfo:i}});return t&&t.installedAppsForMesssageAction?t.installedAppsForMesssageAction:[]},N=async(e,n)=>{const{data:i}=await e.query({query:s.n,fetchPolicy:n});return i?.appsUsage?i.appsUsage:{__typename:"AppsUsage",appIds:[],appActions:[],appScenes:[],appsMru:[]}},v=async(e,n)=>{const i=await e.query({query:d.N,fetchPolicy:n}),{data:a}=i;return a?.appsInstalledByCurrentUser?a.appsInstalledByCurrentUser:[]},I=async(e,n,i)=>{const{data:a}=await e.query({query:r,variables:{containerAppId:n},fetchPolicy:i});return a?.installedAppsForContainerApp?a.installedAppsForContainerApp:[]},f=async(e,n,i)=>{const{data:a}=await e.query({query:o,variables:n,fetchPolicy:i});return a&&a.installedApps?a.installedApps:[]},h=async(e,n,i,a)=>{const{data:t}=await e.query({query:m,variables:n,fetchPolicy:a,context:{callerInfo:i}});return t?.installedAppsForMesssageAction?t.installedAppsForMesssageAction:[]}},424099:(e,n,i)=>{"use strict";i.d(n,{Cg:()=>k,JU:()=>m,G7:()=>p});var a=i(364819);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var r=i(308216);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsIdsList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var o=i(937201);const s=(e,n,i)=>"Personal"===e?{installedScope:e,appId:n}:{installedScope:e,appId:n,conversationId:i},d=(e,n)=>({installedContext:"Personal"===e?{scope:e}:{scope:e,conversationId:n}}),c=e=>({conversationId:e}),m=(e,n,i,a,t)=>{const r=i.newLogger("UpdateAppsCache","components-apps-platform-queries");try{if(!n.installedAppsUpdateEventV2)return;const{installedAppsUpdateEventV2:{installedScope:i,app:l,appId:o,eventType:s,conversationId:d}}=n,c={client:e,installedScope:i,conversationId:d,logger:r,enableAppsQueryOptimization:a};if(t&&"Personal"===i)return void u(i,d,e,r,t);switch(s){case"Added":k(c,l);break;case"Removed":p(c,o);break;case"Synced":u(i,d,e,r,t)}}catch(e){r.error("update apps cache failed")}},u=(e,n,i,a,t)=>{if(n&&("GroupChat"===e||"Team"===e)||!n&&"Personal"===e){if(t&&"Personal"===e)return void(0,r.zy)(i,a,"Network");let l=[];l=[{scope:e,convId:n}],(0,r.J7)(i,a,l,"Network")}},p=(e,n)=>{const{logger:i,client:t,installedScope:r,conversationId:l}=e;if((0,a.isNull)(n)||"Personal"!==r&&!l)return void i.warn("removeAppFromCache - invalid input",n,r,l);const d=s(r,n,l);try{t.writeQuery({query:o.p,variables:d,data:{installedApp:null}})}catch(e){throw i.error("removeAppFromCache - failed to update installedApp query",n,r,l),e}const c=N(e);if((0,a.isNull)(c))return void i.warn("removeAppFromCache - no apps in cache",n);const m=(0,a.filter)(c,(e=>null===e||e.id!==n));m.length!==c.length?(i.log("Removing from apps cache "),v(e,m)):i.warn("app to delete already removed from cache")},k=(e,n)=>{const{logger:i,client:t,installedScope:r,conversationId:l}=e;if((0,a.isNull)(n)||"Personal"!==r&&!l)return void i.warn("addAppToCache - invalid input",n,r,l);const{id:d,installedVersion:c,conversationId:m,__typename:u}=n,p=s(r,d,l);try{t.writeQuery({query:o.p,variables:p,data:{installedApp:n}})}catch(e){throw i.error("addAppToCache - failed to update installedApp query",n,r,l),e}const k=N(e);if((0,a.isNull)(k))return void i.warn("addAppToCache - no apps in cache",n);const g=n.id,I=(0,a.find)(k,(e=>e?.id===g));(0,a.isNil)(I)?(i.log("Adding to apps cache"),v(e,[...k,{id:d,conversationId:m,installedVersion:c,installedScope:r,__typename:u}])):i.warn("app to add already in cache",I)},g=(e,n)=>"GroupChat"===e&&n,N=({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:r})=>{try{if(g(n,r)){if(i){const n=e.readQuery({query:l,variables:c(i)});return n&&n.installedChatAppsWithPreCheck?n.installedChatAppsWithPreCheck:(a.warn("readQuery for group scope returned no results"),null)}return a.error("invalid convid for cache read"),null}{const r=e.readQuery({query:t,variables:d(n,i)});return r&&r.installedAppsV2?r.installedAppsV2:(a.warn("readQuery returned no results"),null)}}catch(e){throw e}},v=({client:e,installedScope:n,conversationId:i,enableAppsQueryOptimization:a,logger:r},o)=>{try{g(n,a)?i?e.writeQuery({query:l,variables:c(i),data:{installedChatAppsWithPreCheck:o}}):r.error("invalid convid for cache update"):e.writeQuery({query:t,variables:d(n,i),data:{installedAppsV2:o}})}catch(e){throw e}}},193576:(e,n,i)=>{"use strict";var a;i.d(n,{i:()=>a}),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(a||(a={}))},668989:(e,n,i)=>{"use strict";i.d(n,{Dr:()=>m,YB:()=>p,e1:()=>k,rh:()=>g,u2:()=>N,Ze:()=>v,dP:()=>I,Bd:()=>f,kS:()=>T,js:()=>y,Nv:()=>A,Jm:()=>C,OH:()=>D,sr:()=>w});var a=i(364819),t=i(812228),r=i(193576),l=i(84646),o=i(226107),s=i(52437);const d="Required",c=["Compose","Commandbox"],m=(e,n,i)=>{if(!n.id)return null;const a=f(n),r=h(n),l=a?u(a):null,[o,s]=(0,t.compose)((0,t.partition)(M),(0,t.map)((n=>b(e,n))),(0,t.filter)((e=>T(e,i))),S)(a);return{appInfo:r,validDomains:n.validDomains||[],type:a?.type,botId:a&&a.botId||"",actionCommands:o,queryCommands:s,authorization:l||void 0,galleryTabs:n.galleryTabs||[]}},u=e=>{if("ApiBased"!==e.type)return null;const{authorization:n}=e;return n&&"microsoftEntra"===n.authType&&n.microsoftEntraConfiguration?{authType:r.i.MicrosoftEntra,microsoftEntraConfiguration:{supportsSingleSignOn:!!n.microsoftEntraConfiguration.supportsSingleSignOn}}:{authType:r.i.None}},p=e=>!(0,a.isEmpty)(e.appInfo.tenantId),k=e=>{const n=(0,t.first)(e.messageExtensions),i=n&&n.botId||"";return`${l.gN.BotPrefix}${i}`},g=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&e.actionCommands.length>=1,N=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&1===e.actionCommands.length,v=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&e.actionCommands.length>1,I=e=>e&&(0,a.isArray)(e.queryCommands)&&e.queryCommands.length>1,f=e=>e&&(0,t.first)(e.messageExtensions),h=e=>({accentColor:e.accentColor||"",appId:e.id,appName:e.name||"",appIcon:e.largeImageUrl||"",isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,tenantId:e.tenantId||"",externalId:e.externalId||"",resource:e.webApplicationInfo?.resource||"",isMicrosoftOwned:e.isMicrosoftOwned||!1}),S=e=>e&&e.commands||[],T=(e,n)=>(0,a.isEmpty)(e.context)?(0,a.includes)(c,n):(0,a.includes)(e.context,n),M=e=>e&&(0,a.isString)(e.type)&&e.type.toLowerCase()==="Action".toLowerCase(),y=e=>{const n=f(e);if(n)return"ApiBased"===n.type?"ApiBased":"BotBased"},A=(e,n)=>(e=>"ApiBased"===e.type)(n)?e?`${l.gN.TeamsAppPrefix}${n.appInfo.appId}`:"":`${l.gN.BotPrefix}${n.botId}`,b=(e,n)=>({id:n.id,type:n.type||"Query",context:n.context,fetchTask:!!n.fetchTask,description:n.description,initialRun:!!n.initialRun,parameters:n.parameters,title:n.title||"",appKey:n.appKey,taskInfo:C(e,n.taskInfo,n.parameters)}),F=(e,n)=>{const i={};return e&&(i.title=e.title||"",i.height=w(e.height),i.width=w(e.width)||n),i},C=(e,n,i)=>{if(n?.url)return{...F(n),url:n.url};const a=U(i);if(a){const i=e.stringTranslate("extensibility","inputExtension_task_module_button_title");return a.addSubmitAction("submitButton",i,{id:"submitButton"}),{...F(n,o.j4.Large),card:a.getCard()}}return n?{...F(n)}:void 0},D=e=>U(e)?.getRawJson()??null,U=e=>{if(!e||(0,a.isEmpty)(e))return null;const n=new s.a;return e.forEach((e=>E(n,e))),n},E=(e,n)=>{if(!n)return;const i=n.title||"",a=n.name||"",t=n.description||"",r=n.value??void 0,l=n.isRequired??!1;switch(n.inputType||"Text"){case"Text":e.addTextInput(a,t,r,200,!1,{label:i,isRequired:l,errorMessage:d});break;case"Textarea":e.addTextInput(a,t,r,1e3,!0,{label:i,isRequired:l,errorMessage:d});break;case"Number":e.addNumberInput(a,t,r,{label:i,isRequired:l,errorMessage:d});break;case"Date":e.addDateInput(a,t,r,{label:i,isRequired:l,errorMessage:d});break;case"Time":e.addTimeInput(a,t,r,{label:i,isRequired:l,errorMessage:d});break;case"Toggle":e.addToggle(a,i,r,{isRequired:l,errorMessage:d});break;case"Choiceset":const o=(n.choices??[]).map((e=>({title:e.title??"",value:e.value??""})));e.addChoiceSet(a,i,!1,!0,o,r,{label:i,isRequired:l,errorMessage:d})}},w=e=>{if(!(0,a.isNil)(e))return L(e)?(0,a.isNil)(e.customValue)?void 0:e.customValue:O(e)?x(e):void 0},L=e=>"DimensionInFloat"===e.__typename,O=e=>"DimensionInString"===e.__typename,x=e=>{if((0,a.isNil)(e.predefinedValue))return;switch(e.predefinedValue.toLowerCase()){case"small":return o.j4.Small;case"medium":return o.j4.Medium;case"large":return o.j4.Large;default:return}}},388593:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{It:()=>a,xi:()=>t,wk:()=>r}),function(e){e.User="User",e.Group="Group",e.Team="Team",e.MsaUser="MsaUser",e.MsaGroup="MsaGroup",e.Bot="Bot",e.Unknown="Unknown",e.TFLOffNetwork="TFLOffNetwork",e.TFLSMSUnverified="TFLSMSUnverified",e.Initials="Initials",e.MergedGroup="MergedGroup",e.Connector="Connector",e.OutgoingWebhook="OutgoingWebhook",e.VoiceApp="VoiceApp",e.App="App",e.Mail="Mail",e.Pstn="Pstn",e.SharedChannelInviteeTeam="SharedChannelInviteeTeam",e.Communities="Communities",e.Simple="Simple",e.SubCommunity="SubCommunity"}(a||(a={})),function(e){e.Large="HR196x196",e.Medium="HR96x96",e.Small="HR64x64",e.XMedium="HR120x120",e.XSmall="HR32x32"}(t||(t={})),function(e){e.Icon="icon",e.Url="url",e.Name="name",e.Label="label"}(r||(r={}))},98687:(e,n,i)=>{"use strict";i.d(n,{Ch:()=>y,Qc:()=>Y,vG:()=>V,Dm:()=>w,UI:()=>R,eB:()=>x,BY:()=>O,Ng:()=>D,WF:()=>z,C0:()=>E,EO:()=>S,L9:()=>j,uC:()=>C,iU:()=>Q,oG:()=>b,X3:()=>U,xG:()=>B,oz:()=>W});var a=i(364819),t=i(754255),r=i(702183),l=i(810886),o=i(73466),s=i(806658),d=i(84646),c=i(800079),m=i(189888),u=i(388593);class p{static getAvatarLoggingAndTelemetryRef(){return{loggingCount:this.loggingCount,lastThrottleTime:this.lastThrottleTime}}static setAvatarLoggingAndTelemetryRef(e){this.loggingCount=e.loggingCount,this.lastThrottleTime=e.lastThrottleTime}}p.loggingCount=0,p.lastThrottleTime=0;var k=i(598569),g=i(175772);const N=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,v=/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,I=/^[\w.-:]+$/,f=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i,h=/^[^\p{Letter}]/u,S=(e,n,i,a,t,r,l,o,d,m)=>{let p=u.It.Unknown;const k=P(d,e,m);return o&&i?p=u.It.SharedChannelInviteeTeam:!a&&i?p=u.It.Team:r?p=u.It.App:l?p=u.It.Mail:t?p=u.It.MergedGroup:k||e&&(0,s.FL)(e)||(0,s.$l)(e)?p=u.It.Initials:F(e)?p=u.It.Connector:e&&(0,s.BG)(e)?p=u.It.OutgoingWebhook:b(e)?p=u.It.VoiceApp:A(e)?p=u.It.Bot:c.af.isTFLOffNetworkUser(e)?p=u.It.TFLOffNetwork:c.af.isTFLSmsUnVerifiedMri(e)?p=u.It.TFLSMSUnverified:e&&(0,s.Ku)(e)?p=u.It.Pstn:a?p=T(p,e,n,i):a||(p=M(p,e,d)),p},T=(e,n,i,a)=>(n?e=u.It.MsaUser:i?e=u.It.MsaGroup:a&&(e=u.It.Communities),e),M=(e,n,i)=>{const a=((0,s.AF)(n)||n&&N.test(n.toLowerCase()))&&!Array.isArray(i),t=!(0,s.AF)(n)&&Array.isArray(i);return a||t?e=n?u.It.User:u.It.Group:e},y=e=>{const n=e?.type?.toUpperCase(),i=e?.id;return n===m.Pk.botType||A(i)},A=e=>!!e&&e.startsWith(d.gN.BotPrefix),b=e=>!!e&&(0,s.oG)(e,d.LE),F=e=>!!e&&e.startsWith(d.Vg),C=(e,n)=>!!e&&(e===n.audienceBotId||e===n.largeGridBotId),D=(e,n,i)=>{if(n)return i?k.G:k.GX;switch(e){case u.It.Mail:return k.m$;case u.It.App:case u.It.Connector:case u.It.Bot:case u.It.OutgoingWebhook:return k.B9;case u.It.User:case u.It.MsaUser:case u.It.Initials:case u.It.Unknown:return k.Rl;case u.It.Group:case u.It.MsaGroup:case u.It.MergedGroup:case u.It.Team:case u.It.Communities:case u.It.SubCommunity:return k.Mz;case u.It.TFLOffNetwork:case u.It.TFLSMSUnverified:return k.hE;case u.It.VoiceApp:return k.S2;case u.It.Pstn:return k.Yt;default:return k.Rl}},U=e=>-1!==e?.indexOf("profilePictureV2ForSharedChannel"),E=(e,n,i,a)=>{if(!e||e&&(0,l.p_)(e))return;return void 0===n||n?i.getPresenceUserId(a):void 0},w=(e,n,i)=>e&&n?.id===e.id&&i===e.id&&"avatar"===e.updateType?e.updatedTime:void 0,L=new Map([["smallest",20],["smaller",24],["small",28],["medium",32],["medium-large",36],["large",48],["larger",64],["largest",96]]),O=e=>e&&L.get(e)||32,x=(e,n,i)=>{if(i&&e)try{const i=new URL(e);if("https:"!==i.protocol)return e;const a=i.searchParams.get("size"),t=n||u.xi.Small;return null!==a&&a!==t?e.replace(`size=${a}`,`size=${t}`):e}catch(n){return e}return e},P=(e,n,i)=>{const a=i?.get(t.w.People).enableInitialsImageForPstn,r=i?.get(t.w.Messaging).enablePaidSmsChat,l=!!e?.isInitialsImage,o=!!a&&!!r&&!!n&&c.af.isValidNameForInitialsAvatarForPstnUser(n,e?.displayName);return l||o};function V(e,n){const i=n?.stringTranslate("peoplePicker","unknown_user")??"Unknown User",a=encodeURIComponent(i);return e.includes(a)}const j=(e,n)=>{if(!e&&n&&1===n.length&&n[0].id){const e=n[0].id;return e!==o.i2&&e!==o.j8?e:void 0}},B=(e,n,i,a)=>{const t=a&&encodeURIComponent(a);return!!e&&!!t&&!!i&&V(i,n)},z=(e,n)=>{const i=!!((e,n)=>{if(!e&&n&&1===n.length&&n[0].id){const e=n[0].id;return e!==o.i2&&e!==o.j8}return!1})(e,n),a=((e,n,i)=>n||(i?e?i[0]:i:[]))(i,e,n),t=((e,n)=>e?g.y9:n?g.Ul:g._Z)(e,i),r=((e,n)=>e&&n?.[0]?.displayName?n[0]?.displayName:void 0)(i,n);return{entity:a,generator:t,displayName:r}},R=(e,n,i)=>n?k.Rl:i?k.Mz:e,Q=async(e,n)=>{try{return await fetch(e,{method:"GET",mode:"same-origin",cache:"only-if-cached",credentials:"include",headers:{"x-ms-client-caller":n||"image-cache-check"}}),!0}catch(e){return!1}},W=e=>e.some((e=>(0,a.isEmpty)(e.displayName)||!(0,s.AF)(e.userId)||(0,s.FL)(e.userId)||(0,s.Ku)(e.userId))),Y=({callerInfo:e,skipGeneratingUrl:n,propsAvatarUrl:i,cachedUrl:a,generatedUrl:t,baseImageUrl:l,isCookieValid:o,profilePictureType:d,isSelfProfileAvatar:c,forSharedChannel:m,isXtapUserUrl:k,logger:g,scenarioFactory:N})=>{const S=Date.now(),{loggingCount:T,lastThrottleTime:M}=p.getAvatarLoggingAndTelemetryRef();if(M>0&&S-M>36e5&&p.setAvatarLoggingAndTelemetryRef({loggingCount:0,lastThrottleTime:0}),T<=4){const y=i||a||t,{isValidDomain:A,isValidPath:b,isValidOid:F,isValidMri:C,isFirstCharSpecial:D,isValidUserInfo:U,isValidTeamId:E,queryParamsLength:w}=((e,n)=>{if(!e)return null;if(e.startsWith("data:image"))return{isValidDomain:!1,isValidPath:"N/A",isValidOid:!1,isValidMri:"N/A",isFirstCharSpecial:"N/A",isValidUserInfo:"N/A",isValidTeamId:"N/A",isDataUriImageApplied:!0,queryParamsLength:0};const i=new URL(e),a=`${i.protocol}//${i.hostname}`,t=v.test(a),r=i.pathname.split("/").filter((e=>""!==e)),l=r.every((e=>I.test(e))),o=r.some((e=>f.test(e))),d=i.searchParams.get("usersInfo"),c=Array.from(i.searchParams.entries()).length;let m="N/A",p="N/A";if(n===u.It.User){const e=i.pathname.split("/"),n=e.indexOf("profilepicturev2");let a=null;-1!==n&&n+1<e.length&&(a=e.slice(n+1).join("/")),m=a&&(0,s.AF)(a)?"VALID":"INVALID";const t=i.searchParams.get("displayName");p=t?h.test(t)?"YES":"NO":"INVALID"}let k=n===u.It.Group?"INVALID":"N/A";if(d&&n===u.It.Group){const e=decodeURIComponent(d),n=JSON.parse(e);k=W(n)?"VALID":"INVALID"}let g="N/A";if(n===u.It.Team){const e=r.indexOf("teams");g=-1!==e&&void 0!==r[e+1]&&f.test(r[e+1])?"VALID":"INVALID"}return{isValidDomain:t,isValidPath:l,isValidOid:o,isValidMri:m,isFirstCharSpecial:p,isValidUserInfo:k,isValidTeamId:g,isDataUriImageApplied:!1,queryParamsLength:c}})(y,d)||{},L=`Avatar load failed :: BaseImageUrl: ${l} - CallerInfo: ${e} - IsCookieValid: ${o} - IsFirstCharSpecial: ${D} - IsSharedChannel: ${m} - IsValidDomain: ${A} - IsValidMri: ${C} - IsValidOid: ${F} - IsValidPath: ${b} - IsValidTeamId: ${E} - IsValidUserInfo: ${U} - IsXtapUserUrl: ${k} - ProfilePictureType: ${d} - QueryParamsLength: ${w} - SkipGeneratingUrl: ${n}`;g.error(L);const O={callerInfo:e,profilePictureType:d,isSelfProfileAvatar:!!c,errorMessage:L};N.newScenario(r.Cu.AvatarStatus).stop(O,"failure");const x=T+1;4===x?p.setAvatarLoggingAndTelemetryRef({loggingCount:4,lastThrottleTime:S}):p.setAvatarLoggingAndTelemetryRef({loggingCount:x,lastThrottleTime:M})}}},598569:(e,n,i)=>{"use strict";i.d(n,{Rl:()=>a,Mz:()=>t,$M:()=>r,Yt:()=>l,S2:()=>o,m$:()=>s,GX:()=>d,G:()=>c,hE:()=>m,B9:()=>u,Vd:()=>p,T:()=>k,$Z:()=>g});const a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSI+PC9yZWN0PjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",t="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi40NzQ3IDguMDE0MzFDMTIuOTg3NiA4LjAxNDMxIDEzLjQxMDIgOC40MDAzNSAxMy40NjggOC44OTc2OUwxMy40NzQ3IDkuMDE0MzFWMTMuMzgxN0MxMy40NzQ3IDE1LjMwNiAxMS45MTQ4IDE2Ljg2NiA5Ljk5MDQ0IDE2Ljg2NkM4LjEzMDI3IDE2Ljg2NiA2LjYxMDU2IDE1LjQwODMgNi41MTEzMSAxMy41NzI4TDYuNTA2MTYgMTMuMzgxN1Y5LjAxNDMxQzYuNTA2MTYgOC41MDE0OCA2Ljg5MjIgOC4wNzg4IDcuMzg5NTQgOC4wMjEwNEw3LjUwNjE2IDguMDE0MzFIMTIuNDc0N1pNMTIuNDc0NyA5LjAxNDMxSDcuNTA2MTZWMTMuMzgxN0M3LjUwNjE2IDE0Ljc1MzcgOC42MTg0MSAxNS44NjYgOS45OTA0NCAxNS44NjZDMTEuMzA3NiAxNS44NjYgMTIuMzg1MyAxNC44NDA5IDEyLjQ2OTQgMTMuNTQ1TDEyLjQ3NDcgMTMuMzgxN1Y5LjAxNDMxWk01Ljc3NDA3IDguMDEzNzJDNS42MzIwOCA4LjI1ODk3IDUuNTQwNjkgOC41MzcxOCA1LjUxNDE3IDguODM0MDZMNS41MDYxNiA5LjAxNDMxSDMuMDE2ODVWMTIuNzUzNEMzLjAxNjg1IDEzLjc3ODYgMy44NDc5MyAxNC42MDk3IDQuODczMTIgMTQuNjA5N0M1LjE0NDMzIDE0LjYwOTcgNS40MDE5NiAxNC41NTE1IDUuNjM0MjEgMTQuNDQ3QzUuNzEzNDcgMTQuNzc1NiA1LjgzMDA1IDE1LjA5MDcgNS45Nzg1IDE1LjM4NzFDNS42Mzg4NyAxNS41MzA3IDUuMjY1MjIgMTUuNjA5NyA0Ljg3MzEyIDE1LjYwOTdDMy4zNTE5OCAxNS42MDk3IDIuMTA4NTcgMTQuNDIwNiAyLjAyMTY5IDEyLjkyMTJMMi4wMTY4NSAxMi43NTM0VjkuMDE0MzFDMi4wMTY4NSA4LjUwMTQ4IDIuNDAyODkgOC4wNzg4IDIuOTAwMjIgOC4wMjEwNEwzLjAxNjg1IDguMDE0MzFMNS43NzQwNyA4LjAxMzcyWk0xNC4yMDY4IDguMDEzNzJMMTYuOTkxMiA4LjAxNDMxQzE3LjUwNCA4LjAxNDMxIDE3LjkyNjcgOC40MDAzNSAxNy45ODQ0IDguODk3NjlMMTcuOTkxMiA5LjAxNDMxVjEyLjc1NDJDMTcuOTkxMiAxNC4zMzEyIDE2LjcxMjcgMTUuNjA5NyAxNS4xMzU3IDE1LjYwOTdDMTQuNzM0OCAxNS42MDk3IDE0LjM1MzIgMTUuNTI3MSAxNC4wMDY5IDE1LjM3NzlDMTQuMTU1MSAxNS4wODAzIDE0LjI3MDkgMTQuNzY0OCAxNC4zNTAzIDE0LjQzNTFDMTQuNTg4NyAxNC41NDczIDE0Ljg1NDkgMTQuNjA5NyAxNS4xMzU3IDE0LjYwOTdDMTYuMTExNiAxNC42MDk3IDE2LjkxMTYgMTMuODU2MiAxNi45ODU2IDEyLjg5OTJMMTYuOTkxMiAxMi43NTQyVjkuMDE0MzFIMTQuNDc0N0wxNC40NjkyIDguODY1MDVDMTQuNDQ2NSA4LjU1NjU0IDE0LjM1MzcgOC4yNjc0OSAxNC4yMDY4IDguMDEzNzJaTTkuOTg4NTcgMi45ODkyNkMxMS4yMTg3IDIuOTg5MjYgMTIuMjE1OSAzLjk4NjQ4IDEyLjIxNTkgNS4yMTY2MkMxMi4yMTU5IDYuNDQ2NzYgMTEuMjE4NyA3LjQ0Mzk4IDkuOTg4NTcgNy40NDM5OEM4Ljc1ODQzIDcuNDQzOTggNy43NjEyMSA2LjQ0Njc2IDcuNzYxMjEgNS4yMTY2MkM3Ljc2MTIxIDMuOTg2NDggOC43NTg0MyAyLjk4OTI2IDkuOTg4NTcgMi45ODkyNlpNMTQuOTc1NyAzLjYxNzM5QzE2LjAzMjQgMy42MTczOSAxNi44ODkgNC40NzQgMTYuODg5IDUuNTMwNjlDMTYuODg5IDYuNTg3MzcgMTYuMDMyNCA3LjQ0Mzk4IDE0Ljk3NTcgNy40NDM5OEMxMy45MTkxIDcuNDQzOTggMTMuMDYyNCA2LjU4NzM3IDEzLjA2MjQgNS41MzA2OUMxMy4wNjI0IDQuNDc0IDEzLjkxOTEgMy42MTczOSAxNC45NzU3IDMuNjE3MzlaTTUuMDE3MTcgMy42MTczOUM2LjA3Mzg2IDMuNjE3MzkgNi45MzA0NyA0LjQ3NCA2LjkzMDQ3IDUuNTMwNjlDNi45MzA0NyA2LjU4NzM3IDYuMDczODYgNy40NDM5OCA1LjAxNzE3IDcuNDQzOThDMy45NjA0OSA3LjQ0Mzk4IDMuMTAzODggNi41ODczNyAzLjEwMzg4IDUuNTMwNjlDMy4xMDM4OCA0LjQ3NCAzLjk2MDQ5IDMuNjE3MzkgNS4wMTcxNyAzLjYxNzM5Wk05Ljk4ODU3IDMuOTg5MjZDOS4zMTA3MiAzLjk4OTI2IDguNzYxMjEgNC41Mzg3NyA4Ljc2MTIxIDUuMjE2NjJDOC43NjEyMSA1Ljg5NDQ3IDkuMzEwNzIgNi40NDM5OCA5Ljk4ODU3IDYuNDQzOThDMTAuNjY2NCA2LjQ0Mzk4IDExLjIxNTkgNS44OTQ0NyAxMS4yMTU5IDUuMjE2NjJDMTEuMjE1OSA0LjUzODc3IDEwLjY2NjQgMy45ODkyNiA5Ljk4ODU3IDMuOTg5MjZaTTE0Ljk3NTcgNC42MTczOUMxNC40NzEzIDQuNjE3MzkgMTQuMDYyNCA1LjAyNjI5IDE0LjA2MjQgNS41MzA2OUMxNC4wNjI0IDYuMDM1MDkgMTQuNDcxMyA2LjQ0Mzk4IDE0Ljk3NTcgNi40NDM5OEMxNS40ODAxIDYuNDQzOTggMTUuODg5IDYuMDM1MDkgMTUuODg5IDUuNTMwNjlDMTUuODg5IDUuMDI2MjkgMTUuNDgwMSA0LjYxNzM5IDE0Ljk3NTcgNC42MTczOVpNNS4wMTcxNyA0LjYxNzM5QzQuNTEyNzcgNC42MTczOSA0LjEwMzg4IDUuMDI2MjkgNC4xMDM4OCA1LjUzMDY5QzQuMTAzODggNi4wMzUwOSA0LjUxMjc3IDYuNDQzOTggNS4wMTcxNyA2LjQ0Mzk4QzUuNTIxNTcgNi40NDM5OCA1LjkzMDQ3IDYuMDM1MDkgNS45MzA0NyA1LjUzMDY5QzUuOTMwNDcgNS4wMjYyOSA1LjUyMTU3IDQuNjE3MzkgNS4wMTcxNyA0LjYxNzM5WiIvPjwvc3ZnPg==",r="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0U4RUJGQSIgZD0iTTAgMzJWMGgzMnYzMkgwWiIvPjxwYXRoIGZpbGw9IiM0RjUyQjIiIGQ9Ik0xNS41IDEyLjUwMmEuNS41IDAgMSAxIDEgMHYxLjAwMmEuNS41IDAgMCAxLTEgMHYtMS4wMDJabTMuMzUuOTQxYS41LjUgMCAwIDAtLjcwNyAwbC0uNzA4LjcwOWEuNS41IDAgMCAwIC43MDcuNzA3bC43MDktLjcwOWEuNS41IDAgMCAwIDAtLjcwN1ptLTQuOTk4IDBhLjUuNSAwIDAgMC0uNzA3LjcwN2wuNzA4LjcwOWEuNS41IDAgMSAwIC43MDctLjcwN2wtLjcwOC0uNzA5Wk0xNiA4YzMuMzE0IDAgNiAyLjU5NyA2IDUuOCAwIDEuNjc3LS43NDUgMy4yMTYtMi4yMDQgNC41OTRhLjU5OS41OTkgMCAwIDAtLjE0NS4yMTNsLS4wMjYuMDgxLS45MzYgMy45MTdjLS4xODQuNzcxLS44NjUgMS4zMy0xLjY3IDEuMzlsLS4xNDQuMDA1aC0xLjc1Yy0uODE5IDAtMS41MzUtLjUxNi0xLjc3Ni0xLjI2MmwtLjAzOC0uMTMzLS45MzUtMy45MTZhLjU5Ni41OTYgMCAwIDAtLjE3LS4yOTVjLTEuMzktMS4zMTItMi4xMzMtMi43Ny0yLjItNC4zNTVMMTAgMTMuOGwuMDAzLS4xOTFDMTAuMTA4IDEwLjQ5NCAxMi43NTMgOCAxNiA4Wm0tMi4wNDUgMTMgLjMxOSAxLjMzNC4wMjYuMDk2Yy4wOTcuMy4zNzYuNTIyLjcxMi41NjNsLjExNC4wMDdoMS43MTJsLjEwNi0uMDAzYS44NTYuODU2IDAgMCAwIC43NDEtLjUyNWwuMDMyLS4xLjMyOC0xLjM3MmgtNC4wOVpNMTYgOWMtMi42MzIgMC00Ljc4OCAxLjk1My00Ljk4NSA0LjQxNGwtLjAxMi4yMTItLjAwMy4xNTMuMDA0LjIxN2MuMDU2IDEuMzA0LjY3NCAyLjUyNSAxLjg4OCAzLjY3MS4xODguMTc4LjMzLjM5OC40MTQuNjRsLjA0My4xNS4zNjcgMS41NDNIMTUuNXYtNC41MDNhLjUuNSAwIDEgMSAxIDBWMjBoMS43ODVsLjM4Ny0xLjYxNS4wNTEtLjE1Yy4wODYtLjIxNS4yMTgtLjQwOS4zODYtLjU2OEMyMC4zODIgMTYuNDY1IDIxIDE1LjE4IDIxIDEzLjhjMC0yLjY0My0yLjIzMS00LjgtNS00LjhaIi8+PC9zdmc+",l="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9Im1lZGl1bXR1cnF1b2lzZSIgeD0iLTYiIHk9Ii02IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTAgMkM3Ljc5MDg2IDIgNiAzLjc5MDg2IDYgNkM2IDguMjA5MTQgNy43OTA4NiAxMCAxMCAxMEMxMi4yMDkxIDEwIDE0IDguMjA5MTQgMTQgNkMxNCAzLjc5MDg2IDEyLjIwOTEgMiAxMCAyWk03IDZDNyA0LjM0MzE1IDguMzQzMTUgMyAxMCAzQzExLjY1NjkgMyAxMyA0LjM0MzE1IDEzIDZDMTMgNy42NTY4NSAxMS42NTY5IDkgMTAgOUM4LjM0MzE1IDkgNyA3LjY1Njg1IDcgNlpNNS4wMDg3MyAxMUMzLjkwMzE1IDExIDMgMTEuODg2OSAzIDEzQzMgMTQuNjkxMiAzLjgzMjgxIDE1Ljk2NjMgNS4xMzQ5OSAxNi43OTY2QzYuNDE2OTcgMTcuNjE0IDguMTQ1MjYgMTggMTAgMThDMTEuODU0NyAxOCAxMy41ODMgMTcuNjE0IDE0Ljg2NSAxNi43OTY2QzE2LjE2NzIgMTUuOTY2MyAxNyAxNC42OTEyIDE3IDEzQzE3IDExLjg5NTYgMTYuMTA0NSAxMSAxNSAxMUw1LjAwODczIDExWk00IDEzQzQgMTIuNDQ2NyA0LjQ0Nzg2IDEyIDUuMDA4NzMgMTJMMTUgMTJDMTUuNTUyMiAxMiAxNiAxMi40NDc4IDE2IDEzQzE2IDE0LjMwODggMTUuMzc3NyAxNS4yODM3IDE0LjMyNzQgMTUuOTUzNEMxMy4yNTY4IDE2LjYzNiAxMS43MzUxIDE3IDEwIDE3QzguMjY0ODkgMTcgNi43NDMxOCAxNi42MzYgNS42NzI2MiAxNS45NTM0QzQuNjIyMjYgMTUuMjgzNyA0IDE0LjMwODggNCAxM1oiLz48L3N2Zz4=",o="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAACxKAAAsSgF3enRNAAAEuElEQVR42u2cwUsjVxzHv9tVKZs9uJTEg5cY0JaNI97W4DFpb41eWjbrYVkQ/4bSRSjI9r50T9arG+iyVNNrAr1I0ps467JViLmkkJHSHHakNND2sEzIrskaWzVvZj6fk5igM/M+83vv++a9ufbF3R//EYSWD7gECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAg2bIpIPJpOPKpONKTIwG8mJXj5oqlmoqlmrGHNM1E14WHYkMa/XhfGAbvpsIa4925LotugBJoWp8SUpMjGr14TxjAK/sh6nxOyXIpOMIkLozHtoBGAJI2szvy7aPQ9f4tn2s9e93GQR6WFZUK8uzGotFAt3wDcfV0/xLlSt1UkA3FrKTWsxOKRIZDlzjb+b3VSzVjBj9GyuAFwuXckkj+sgLK/cbu2o4rnHHNnABLCvacwxgWVEt5ZK+TQlnlfv3nftVcT05ffebQR7Ak8ef6datD/Xq19/Vav391meOc6JiqaY/mn/qk48/0sjIdV+V+/WNXVWPml0r3IP7M3pwf0bPnr8a6HEaMRWcSceVmhvXVuFA24XDU58XSzWVK3UtZqe0kJ30dbk3bYxjzLOAzn5/fWP3VGl03VZ7ELWyPCvLivqu3JuYcoZMu4PGYhGtfj3f805qOK7Wvt1Ram5c93K3B35BXbfVs3J552OisMYK0HnHfPf4057RqVypq1ypD7Sklit1Pc2/7FruI5FhZdJxLeWSRndZQzKcpVxSi9mptgjvsl04VKXymxayk1cWG6tHzffOYHoN74e5DOMF8O6mleVZpe6Ma+ung1MXvuG4Wt/YVfmX+qXGxrPKvWVFtfj5lLHl3rcCdF5gy4qqWKppM79/qluw7WN9Zf98Kd1Cr//57gDWbwzJh5wVG7cLhyqWahcSG237WJv5/a553sRYFwoBzhMby5U33cJ5y7JfY11oBOg3NlaPmueKjf3Eunu520rNBWMdw5ACQj+xcc92lEnHe5bs7cKhtgoHPft5P8S60ArQT2x03VY7NnbexcVSTduFw57Tt5l0XAvZyUCuVRj408Af8ouX9rdt+7hrbOws515/343ExOh/Gj+chy9zW1SAQcXGXg0ftPUIoRWg39gYpFiHAH3ERm+eoBNTHi4hwBXExpXlWS3lkqpW30zuJBKjobnjQy9AZ0Xw05z9ZcHuYAQABAAEGBQmrpUP07kPXIAw7gs06dyN2Bxq0lapq8J7XB16AVy3pbVHO6HqChqOa8wbQozZG+g9bg3yNKy31sCkDaJGbg713hqSmhv3vQyu21K5Um+/IMo0jBSgk8TEaHuqdmY6ptjYDWPn6xuOK6dxor0Xjly3pWq12XMtIQJcgBiRm8O6GRlRLHaj/fuZ6dhb3/s/wngN2sneC6f9s+Oc6LX7l9zXLeMbOnACQEBSACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAPwL3XwvzOsJdhMAAAAASUVORK5CYII=",d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB2aWV3Qm94PSIwIDAgMzA2IDMwNiIgeD0iMHB4IiB5PSIwcHgiIHhtbG5zOnhtbD0iaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOnJnYigyMTksIDQxLCA1Myk7fQogICAgLnN0MXtlbmFibGUtYmFja2dyb3VuZDpuZXc7fQogICAgLnN0MntmaWxsOnJnYigyNTUsIDI1NSwgMjU1KTt9CiAgPC9zdHlsZT4KICA8Zz4KICA8Zz4KICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0gMTUzIDAgTCAxNTMgMCBjIDg0LjUgMCAxNTMgNjguNSAxNTMgMTUzIGwgMCAwIGMgMCA4NC41IC02OC41IDE1MyAtMTUzIDE1MyBsIDAgMCBDIDY4LjUgMzA2IDAgMjM3LjUgMCAxNTMgbCAwIDAgQyAwIDY4LjUgNjguNSAwIDE1MyAwIFoiLz4KICAgIDxnIGNsYXNzPSJzdDEiPgogICAgPHBhdGggY2xhc3M9InN0MiIgZD0iTSAxNTQuOCA4My42IGMgMi42IDAgNS4xIDAuNyA3LjUgMi4xIGMgMi4zIDEuNCA0LjEgMy4zIDUuNCA1LjYgbCA1MS45IDk2LjQgYyAxLjIgMi4yIDEuOCA0LjUgMS44IDYuOSBjIDAgMiAtMC40IDMuOSAtMS4yIDUuNiBjIC0wLjggMS44IC0xLjggMy4zIC0zLjIgNC42IGMgLTEuMyAxLjMgLTIuOSAyLjQgLTQuNiAzLjIgYyAtMS44IDAuOCAtMy43IDEuMiAtNS42IDEuMiBIIDEwMi44IGMgLTIgMCAtMy44IC0wLjQgLTUuNiAtMS4yIGMgLTEuOCAtMC44IC0zLjMgLTEuOSAtNC42IC0zLjIgYyAtMS4zIC0xLjMgLTIuNCAtMi45IC0zLjIgLTQuNiBjIC0wLjggLTEuOCAtMS4yIC0zLjYgLTEuMiAtNS42IGMgMCAtMi40IDAuNiAtNC43IDEuOCAtNi45IGwgNTEuOSAtOTYuNCBjIDEuMyAtMi4zIDMuMSAtNC4yIDUuNCAtNS42IEMgMTQ5LjcgODQuMyAxNTIuMiA4My42IDE1NC44IDgzLjYgWiBNIDE1NC44IDkzLjMgYyAtMSAwIC0xLjkgMC4zIC0yLjYgMC44IGMgLTAuNyAwLjYgLTEuNCAxLjIgLTEuOSAyLjEgYyAtMC42IDAuOCAtMSAxLjcgLTEuNCAyLjYgYyAtMC40IDAuOSAtMC44IDEuOCAtMS4yIDIuNSBjIC0wLjggMS41IC0yIDMuOSAtMy44IDcuMiBjIC0xLjggMy40IC0zLjkgNy4zIC02LjQgMTEuNyBjIC0yLjUgNC41IC01LjIgOS4zIC04LjEgMTQuNiBjIC0yLjkgNS4zIC01LjggMTAuNiAtOC43IDE1LjkgcyAtNS43IDEwLjUgLTguNCAxNS41IGMgLTIuNyA1IC01LjEgOS41IC03LjIgMTMuNiBjIC0yLjEgNCAtMy44IDcuMyAtNSA5LjkgYyAtMS4yIDIuNiAtMS45IDQuMiAtMS45IDQuOCBjIDAgMS4zIDAuNSAyLjUgMS40IDMuNCBjIDEgMSAyLjEgMS40IDMuNCAxLjQgaCAxMDMuOSBjIDEuMyAwIDIuNSAtMC41IDMuNCAtMS40IGMgMSAtMSAxLjQgLTIuMSAxLjQgLTMuNCBjIC0xLjUgLTMuNyAtMy4xIC03LjIgLTUgLTEwLjYgYyAtMS45IC0zLjQgLTMuNyAtNi45IC01LjUgLTEwLjQgYyAtMi40IC00LjUgLTQuNyAtOSAtNyAtMTMuNCBjIC0yLjMgLTQuNSAtNC43IC05IC03IC0xMy40IGMgLTIuNCAtNC42IC00LjkgLTkuMiAtNy4zIC0xMy43IGMgLTIuNCAtNC41IC00LjkgLTkuMSAtNy4zIC0xMy43IGMgLTEuOCAtMy4yIC0zLjUgLTYuNSAtNS4zIC05LjcgYyAtMS44IC0zLjIgLTMuNiAtNi40IC01LjQgLTkuNiBjIC0wLjQgLTAuNyAtMC44IC0xLjQgLTEuMiAtMi4xIGMgLTAuNCAtMC43IC0wLjkgLTEuMyAtMS40IC0xLjkgYyAtMC42IC0wLjcgLTEuMiAtMS4zIC0xLjggLTEuOCBDIDE1Ni42IDkzLjYgMTU1LjggOTMuMyAxNTQuOCA5My4zIFogTSAxNTQuOCAxNzcuNiBjIDEgMCAxLjkgMC4yIDIuNyAwLjYgYyAwLjkgMC40IDEuNiAxIDIuMyAxLjYgcyAxLjIgMS41IDEuNiAyLjMgYyAwLjQgMC45IDAuNiAxLjggMC42IDIuNyBjIDAgMSAtMC4yIDEuOSAtMC42IDIuNyBjIC0wLjQgMC45IC0xIDEuNiAtMS42IDIuMyBzIC0xLjUgMS4yIC0yLjMgMS42IGMgLTAuOSAwLjQgLTEuOCAwLjYgLTIuNyAwLjYgYyAtMSAwIC0xLjkgLTAuMiAtMi43IC0wLjYgYyAtMC45IC0wLjQgLTEuNiAtMSAtMi4zIC0xLjYgcyAtMS4yIC0xLjUgLTEuNiAtMi4zIGMgLTAuNCAtMC45IC0wLjYgLTEuOCAtMC42IC0yLjcgYyAwIC0xIDAuMiAtMS45IDAuNiAtMi43IGMgMC40IC0wLjkgMSAtMS42IDEuNiAtMi4zIHMgMS41IC0xLjIgMi4zIC0xLjYgQyAxNTIuOSAxNzcuOCAxNTMuOCAxNzcuNiAxNTQuOCAxNzcuNiBaIE0gMTU5LjcgMTcwLjIgaCAtOS44IHYgLTQ4LjggaCA5LjggViAxNzAuMiBaIi8+CiAgICA8L2c+CiAgPC9nPgogIDwvZz4KPC9zdmc+",c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8Y2lyY2xlIGN4PSI3MiIgY3k9IjcyIiByPSI3MiIgZmlsbD0idXJsKCNwYXR0ZXJuMCkiLz4KPGNpcmNsZSBjeD0iNzIiIGN5PSI3MiIgcj0iNzIiIGZpbGw9IiNEMTM0MzgiLz4KPHBhdGggZD0iTTQ1LjEyMTQgODdDMzkuMTIyIDg3IDM1IDgzLjI5ODcgMzUgNzguMzc3M0g0MC42NzI5QzQwLjcxMzcgODAuMzcwMyA0Mi42NzI3IDgyLjAzNzkgNDUuMjg0NyA4Mi4wMzc5QzQ3LjgxNSA4Mi4wMzc5IDQ5LjQ4ODMgODAuNjU1IDQ5LjQ4ODMgNzguNjYyQzQ5LjQ4ODMgNzcuMTE2NCA0OC4zNDU2IDc2LjAxODIgNDUuOTM3NyA3NS4yODYxTDQyLjUwOTQgNzQuMzFDMzYuMzQ2OCA3Mi42ODMgMzUuMjQ0OSA2OC45ODE4IDM1LjI0NDkgNjYuNDZDMzUuMjQ0OSA2MS40NTcyIDM5LjU3MSA1OCA0NC45NTgyIDU4QzUwLjI2MzggNTggNTQuMzQ1IDYxLjIxMzIgNTQuMzQ1IDY2LjU0MTRINDguNjcyMUM0OC42NzIxIDY0LjU0ODQgNDcuMjg0NSA2My4wMDI4IDQ0LjgzNTcgNjMuMDAyOEM0Mi42MzE5IDYzLjAwMjggNDAuOTU4NiA2NC40NjcgNDAuOTU4NiA2Ni4zMzhDNDAuOTU4NiA2Ny4wMjk1IDQxLjE2MjYgNjguNDUzIDQ0LjEwMTEgNjkuMzA3Mkw0Ny4yNDM3IDcwLjIwMkM1MS40ODgxIDcxLjQ2MjggNTUuMjAyMSA3My42MTg1IDU1LjIwMjEgNzguMzc3M0M1NS4yMDIxIDgzLjk0OTUgNTAuNDI3IDg3IDQ1LjEyMTQgODdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzIuOTE1OCA4N0M2NC45MTY2IDg3IDU4LjYzMTYgODAuNDUxNiA1OC42MzE2IDcyLjUyMDNDNTguNjMxNiA2NC41NDg0IDY0LjkxNjYgNTggNzIuOTE1OCA1OEM4MC44NzQyIDU4IDg3LjI0MDkgNjQuNTQ4NCA4Ny4yNDA5IDcyLjUyMDNDODcuMjQwOSA4MC40NTE2IDgwLjg3NDIgODcgNzIuOTE1OCA4N1pNNzIuOTE1OCA4MS42NzE4Qzc3LjkzNTcgODEuNjcxOCA4MS41MjcyIDc3LjU2MzggODEuNTI3MiA3Mi41MjAzQzgxLjUyNzIgNjcuNDc2OSA3Ny45MzU3IDYzLjMyODIgNzIuOTE1OCA2My4zMjgyQzY3Ljg1NTEgNjMuMzI4MiA2NC4zMDQ0IDY3LjQ3NjkgNjQuMzA0NCA3Mi41MjAzQzY0LjMwNDQgNzcuNTYzOCA2Ny44NTUxIDgxLjY3MTggNzIuOTE1OCA4MS42NzE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwMC45MTkgODdDOTQuOTIgODcgOTAuNzk4IDgzLjI5ODcgOTAuNzk4IDc4LjM3NzNIOTYuNDcwOUM5Ni41MTE3IDgwLjM3MDMgOTguNDcwNyA4Mi4wMzc5IDEwMS4wODMgODIuMDM3OUMxMDMuNjEzIDgyLjAzNzkgMTA1LjI4NiA4MC42NTUgMTA1LjI4NiA3OC42NjJDMTA1LjI4NiA3Ny4xMTY0IDEwNC4xNDQgNzYuMDE4MiAxMDEuNzM2IDc1LjI4NjFMOTguMzA3NCA3NC4zMUM5Mi4xNDQ4IDcyLjY4MyA5MS4wNDI4IDY4Ljk4MTggOTEuMDQyOCA2Ni40NkM5MS4wNDI4IDYxLjQ1NzIgOTUuMzY4OSA1OCAxMDAuNzU2IDU4QzEwNi4wNjIgNTggMTEwLjE0MyA2MS4yMTMyIDExMC4xNDMgNjYuNTQxNEgxMDQuNDdDMTA0LjQ3IDY0LjU0ODQgMTAzLjA4MiA2My4wMDI4IDEwMC42MzQgNjMuMDAyOEM5OC40Mjk4IDYzLjAwMjggOTYuNzU2NSA2NC40NjcgOTYuNzU2NSA2Ni4zMzhDOTYuNzU2NSA2Ny4wMjk1IDk2Ljk2MDYgNjguNDUzIDk5Ljg5OTEgNjkuMzA3MkwxMDMuMDQyIDcwLjIwMkMxMDcuMjg2IDcxLjQ2MjggMTExIDczLjYxODUgMTExIDc4LjM3NzNDMTExIDgzLjk0OTUgMTA2LjIyNSA4NyAxMDAuOTE5IDg3WiIgZmlsbD0id2hpdGUiLz4KPGRlZnM+CjxwYXR0ZXJuIGlkPSJwYXR0ZXJuMCIgcGF0dGVybkNvbnRlbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNpbWFnZTBfODA2N18yMjc5NzkiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMDI1KSIvPgo8L3BhdHRlcm4+CjxpbWFnZSBpZD0iaW1hZ2UwXzgwNjdfMjI3OTc5IiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFaQUFBQUdRQ0FZQUFBQ0F2emJNQUFBQldHbERRMUJKUTBNZ1VISnZabWxzWlFBQUtKRnRrRUZMQWxFVWhjK1laYVJSUkxzYUdGcEV4Q1JsQnUzQ0RDeHlNVTBHRmtHTm8ya3dUcS9uUkFqOWlQYlJyaDhSMHFKZEJPNkNJbWlieXphQkJDWFRmVTZsVmc4dTUrTnczdVZ5QUYrdndaamxCMUMwSGE0bkZwWDA1cFlTcUNFSUdRUHdZY3d3U3l5bWFVbUs0RnM3WC8wZWt0QzdLYkZyNTdsblpsSk5MTnltNWF0YTlXWGtiNzdqOVdWekpaUDBneVpzTXU0QWtrcXNIVHRNOEFueE1LZWppRThGNXoyK0VKengrTEtaU2VseDRpcnhvRmt3c3NSUHhHcW16YyszY2RFNk1yOXVFTmVIY3ZiR091a1F6U2lTU0VEQk1wYWdrMGF4U3YzOG40ODI4M0VjZ0tFTWpuM2tVWUJEdjJMa01GaklFYS9BaG9rd1ZPSUlwbWtpb3VmZi9iVzg4Z013djBhdzNmSlNqMEJGQTRKbkxXOWlIT2pmQlc3bW1NR05uMWFsdXIrME54dnhPTVNCN2pmWGZaV0JRQVZvY05kOVAzZmRCblhZUlR1dkR6OEIwTzloQ0xDY1g0UUFBQUE0WlZoSlprMU5BQ29BQUFBSUFBR0hhUUFFQUFBQUFRQUFBQm9BQUFBQUFBS2dBZ0FFQUFBQUFRQUFBWkNnQXdBRUFBQUFBUUFBQVpBQUFBQUFPUGxOOWdBQVB4MUpSRUZVZUFIdG5WdVFGY2VaNTdPcVc3dGN0SFNmdG9VdE5ERTYzWUIyck81WkkyNStHR1Exc3VCQkY0UTlJZkNUUUx6SURpbFdXRHUyTi9aQmdOL0dudFVsd2hySjh5QkEreUpRaEhXeDVJaXhKdFF0SVQ4c1lJSFgzZkpZWExxSk1DZ0VOdFhJeldWWG5GUDdmVVZYYy9yMHVWUmxaVlZsWmY0ekFrNmRPcFczWCtZNS8vN3l5NHNqRUVEQUlBSmpudGROMWVtK0trVFpwMzljTlg1MVhMZmJkWnl1OEgzdzZ2dGxmZzJETS9WOCtMN1pLNlUzSG41R2NTYUU0MHhNdlovZzkxWGZ2K0JYcTN3OVRzOU91UFNQWDIrZzk3MmxVdmhzbUFSZVFhQ3dCS2lQSTRCQWNRaVFRSlQvbnhETHFPTjJzekIwZEhUY3lxOCtpUUhmbzVyd1A5M0RVUllkRnBoS3BYS0tYL2xmNXpXQkdkZTk4Q2dmQ0lRRXFOOGlnSUJlQk5pSytKeEVnVXExVExqdU1zZHhiaVdCWU5IZ2V6WUVGcGh4cXZNcHNtU0cyWUloY1RrSzY4V0dwaTlXSFNFZ3hXb3Y0MG9iV2hTZHJudHIxWEVHTFJPS3VPMFpDRXUxVXZrdGljb3dSQ1V1UGp5dm1nQUVSRFZScE5lVUFGc1c1SnRZNXJydVZ5RVdUVEhGK29DK3dPTys0eHgxZlgrNFdxMytGcUlTQ3g4ZVRrZ0FBcElRSUtJM0o4Q0NRZjZLUVhKZ0QxSkh1NHVlWE5iOGFYeWlrTUJSOGd1OXg4TmYvNEVzRlF4OUtTU0xwR1lRZ0lETXdJRTNTUWhBTUpMUVN6VXVCQ1ZWdlBZbURnR3h0KzJWMVB5WTV3Mkt6czY3aE84UEJ2K1VwSXBFVWlYZ09NTTA1UFY2cFZwOTc3WlM2V2lxZVNGeG93bEFRSXh1WHZXVkMvMFl2dXR1cE02emhYSW93clJaOVNBTVNaSGFjSnhtZkEzVGRPSTMvbk9wOUxvaDFVSTFNaUlBQWNrSWRKR3pZZEdnYWJVYm5ZNk9MV1Jsc0I4RG9sSGtCbTFWZHNkNW5YNFVYdThnUVlIdnBCVW9mTVlFSUNEb0J3MEoxSW5HWU1PSGNOTnNBbVNaMEEvRUhvaUoyYzJjcEhZUWtDVDBESXNiRGsrSmpvNGRzRFFNYTl5azFTSExoTmFmN01Vd1YxS1Fac1dIZ0pqVm5sSzFZVWM0ZkJwUzZLeUxSRDhZZ2MvRUp6RlpXaW9OV3djQUZaNUJBQUl5QTRjOWJ3SnJvN1B6Q1ZHdGJxUmFzMThEQVFSaUVhRFY4R08waUhFWERYRzlSLzZTOFZpUjhiQVJCQ0FnUmpSajlFb0UwMjZ2RFZFTlJvK0ZKMEdnTlFIYXIyd1BySkxXakV6OEZBSmlZcXZXMVltdGphcnJicWtLc1pVK2dyVlJ4d2R2MVJHQVZhS09aUkZTZ29BVW9aVWt5MGpDVWY3Y2RiZFRJMk85aGlSRFJKTW1NRUZXQ1U4SDNvWGhMV21HMmtlRWdHamZSUEVMaUdHcStNd1FJejBDR041S2oyM2VLVU5BOG00QmhmbERPQlRDUkZKcEVEaENZdkxja2dVTDlxYVJPTkxNbmdBRUpIdm15blA4MlBPMjBoYnBPMmdIMXJMeXhKRWdDQ2dtRVBwSklDU0t3ZWFRSEFRa0IraXFzb1J3cUNLSmRQSWdBQ0hKZzdyYVBDRWdhbmxta2hxRUl4UE15Q1FqQWhDU2pFQ25rQTBFSkFXb2FTVUo0VWlMTE5MVmdRQ0VSSWRXaUZjR0NFZzhYcms4SFRqSFhmY1p5aHhyT0hKcEFXU2FKUUVJU1phMGsrVUZBVW5HTDlYWW1GV1ZLbDRrcmorQkkzUXM3elljZXFWdlEwRkFOR3diWGdCWTZlaDR4dmQ5M3FjS0FRU3NKc0RyU0xBZ1VjOHVBQUhScUYxcU5qamNUc1hxMXFob0tBb0k1RTNBRjY2N2EvTHExZWZ1S0pVbThpNE04cjlHQUFLaVNVOWdCN2x6emM4QjRkQ2tUVkFNL1FqQVA2SlhtMEJBY200UEVvNWxkRlRzTTNTQTAyRE9SVUgySUZBa0FrYzZxOVZ2WVordGZKc01BcElULzZuaHFoMTBIZ2NQVnlHQUFBaklFSENjWnlZcmxSOWhXRXNHWHZJNEVKRGtER09ud0xPcmFMaHFON1llaVkwT0VVQmdGZ0VNYTgxQ2t0a05DRWhtcU9uNE5wcGRkYldqWXplR3F6S0VqcXlzSVlEWld0azNOWWszUWhZRVRreE9QbkhWZFk5QVBMS2dqVHhzSkVEVDNyZlN3V252SHYvc016Ny9CaUVEQXJCQVVvWU1xeU5sd0VnZUJCb1FvTFBhWDd1aFVua1NUdllHY0JUZWdnV2lFR1o5VXJBNjZvbmdQUWhrUThEeC9XL0NHa21mTlN5UUZCZ0hNNnc2T2w3RGNGVUtjSkVrQ01Ra0FOOUlUR0F4SG9lQXhJQVY1ZEdwalE5Zm8yZXhJREFLTUR3REFoa1F3RXl0ZENCRFFCUnh4Ym9PUlNDUkRBaWtTWURXalN4ZHNPREpOTE93S1cwSWlJTFdaa2Q1eFhXSHNLNURBVXdrQVFJcEUyQnJ4SzFXNzRhRFBUbG9PTkVUTWd3ZDVSQ1BoQ0FSSFFReUlsQVZvcGVtMUgvNDc1NkhYU0FTTW9jRklna1FRMWFTNEJBTkJIUWlnSzFRRXJVR0JFUUNINGFzSktBaENnaG9TZ0JEV3ZJTmd5R3NtT3lPVDA1dTRSWGxHTEtLQ1E2UGc0Q21CTUloTGF4Z2o5OUFFSkFZekk3OTVTODcvRXBsRDBYQkZOMFkzUEFvQ0JTQVFJbTJRdG5OMy9FQ2xGV2JJbUlJSzBKVEJQNE9MQXlNUUFxUGdFRHhDV0FibE9odENBRnB3d3IramphQThERUlHRWdBZnBGb2pZb2hyQmFjZUZVNS9CMHRBT0VqRURDVVFPZ1grWVBuYlRTMGlrcXFCUUZwZ3BIWGR3aGFIRWdmdzkvUmhCRnVnNERoQkVxdTYvNGNmcEhtclF3QmFjQ0dPMHkxVW5tMndVZTRCUUlnWUJjQmg0NmQzZ0VSYWR6bzhJSFVjR0ZuK2VjZEhjL1FWdEJiYTI3akVnUkFBQVNFY0p6ZGRQNzZremgvL1hwbmdJQk1zV0JuT2ZrN2VCZmRaZGZ4NEFvRVFBQUVaaEE0MGxtdGZndjdhRjFqQWdFaERwaHBOZU1MZ2pjZ0FBSXRDR0NHMW5VNDFnc0l4T042WjhBVkNJQkFOQUlRa1d1Y3JIYWlmK3g1eXpCTk45b1hCaytCQUFoY0o4RFRmUG5JWFA0TnVYN1h2aXRyTFJCdWVBZlRkTzNyOGFneENLZ2w0UGwwdHNodHBkSlJ0Y2tXSXpVckxSRGVFSkhFNHdnMVVYY3htZ21sQkFFUTBKUkFpWDVMUHJSMUkwYnJMQkFXajZrTkVUWHRqeWdXQ0lCQUFRblFGbHJPSTBzV0xOaGJ3TEpMRjlrcUFZRjRTUGNUUkFRQkVHaFB3RG9Sc1VaQUlCN3RleitlQUFFUVNFekFLaEd4UWtBZ0hvbS9GRWdBQkVBZ09nRnJSTVI0QVlGNFJPLzFlQklFUUVBWkFTdEV4R2dCZ1hnbyt6SWdJUkFBZ2ZnRWpCY1JZd1ZrYXAwSFQ5VkZBQUVRQUlHOENQaTBUbVM1cWV0RWpGd0hVck5JTUs5T2czeEJBQVJBZ0FrNHRFN0UyQlhyeGxrZzJOc0szMW9RQUFFTkNYaTBpKzl5MDNieE5jb0NnWGhvK0xWQmtVQUFCSmhBaWZmTzR0OG9rM0FZWTRGQVBFenFscWdMQ0poSmdQNWlIM05wN3l4VExCRWpMQkFTajI0K0RNb1hvbXhtdDBPdFFBQUVUQ0RBdS9qU2I5WFBqOUJ2bGduMU1VSkErQmhhYWd5cnQxVTJvVE9pRGlCZ0NZRTdidXpvZU5xRXVoWmVRUGl3ZTV4aGJrSlhSQjFBd0NJQ3ZyK1ZmN3VLWHVOQyswQ0NCcWhXZHhhOUVWQitFQUFCS3duNGxXcjF5YjhwbFo0dGF1MExLeUIvOEx5Tkx2azlpZ29lNVFZQkVBQUJJdUFMY3FvdkxaV0dpMGlqa0FMQ002NzRLRm9DYm9RanFvZ2RCMlVHQVJCUVJxQ3dhMFFLNXdNSnArdFMwMEU4bFBWZkpBUUNJSkFqZ1dDTlNCRm5aaFZPUUNvMDR3clRkWFBzNnNnYUJFQkFPUUdlM2tzenMzNnVQT0dVRXl5VWdMRFQzUGY5alNrelFmSWdBQUlna0QwQjN4OHMyc3lzd3ZoQWFJUEVyYlFwMmU3c1d4VTVnZ0FJZ0VCbUJBcTFCWHdoQkFSTzg4dzZMeklDQVJESW4wQmhuT3JhRDJIeE5pVVYxeDJpTm9YVFBQK09qUktBQUFpa1Q2QXdUblh0QmVScVorY09PTTNUNzdISUFRUkFRQjhDVTA3MXAvUXBVZU9TYUMwZ0p5WW5uNkJGTnRzYkZ4MTNRUUFFUU1CZ0FyNi8vZDg5VCt2ZlAyMTlJUEI3R1B6RlFOVkFBQVNpRXREYUg2S3RCUUsvUjlUK2hlZEFBQVFNSnFDMVAwUkxBYUc1MEZnc2FQQTNBbFVEQVJDSVRrQm5mNGgyUTFoWTd4RzlZK0ZKRUFBQmF3aG91ZW1pVmdJUzduT0ZXVmZXZkNsUVVSQUFnZWdFdk1scXRlK09VbWtpZXBSMG45UnFDT3R6MTkwSjhVaTN3WkU2Q0lCQVlRbVVkTnN2U3hzQkNZYXVoTmhTMktaRndVRUFCRUFnYlFLMFg1Wk9VM3UxR01MQzBGWGF2UTdwZ3dBSUdFUkFtNm05V2xnZzJLTGRvSzZOcW9BQUNLUk5vSFMxbytPbHRET0prbjd1QXNKRFY5aWlQVXBUNFJrUUFBRVFtQ0tneVZCV3JrTllHTHJDMXdFRVFBQUVwQW5rUHBTVnF3V0NXVmZTSFFjUlFRQUVRS0QwZVVmSDAzbGl5TTBDd1lMQlBKc2RlWU1BQ0JoQ0lOY0ZocmtJQ0ExZDhSa2ZSN0RtdzVBdWpHcUFBQWprUm9DR2tjWStxMWFYNTdIQU1KY2hMSnp4a1Z0ZlE4WWdBQUtHRWNoenI2ek1MUkIybkY5MTNUSEQyaERWQVFFUUFJRThDZmcrV1NHM2xVcEhzeXhFNWhZSWljZHJXVllRZVlFQUNJQ0FCUVFjSndlSGVxWUN3bzV6YXNobEZqUW1xZ2dDSUFBQzJSS2d0U0hIUC9zczArMmdNaHZDd3BxUGJQc1NjZ01CRUxDU1FLWTc5blptaFpnYzUxdm9mUE55VnZraEh4Qm9SdURpNWN0aTlNUkpjZmI4ZVhITzg4UlorbmZ1dkNmNGZ2RHZ5cFVaVWVmUG1TUG16NTByYnVvcEJmZDdGeTBTTjVWS29uekxJc0hYL0JrQ0NHaENvRFJQQ0Q1SGZXY1c1Y25FQW9IalBJdW1SQjdOQ0xCQUhQemRpQmo3NUJQeDBmRVRnV0EwZTFibS9zSXBNVm5kM3kvNkYvZUpoVDA5TXNrZ0RnaW9JcERaQ3ZWTUJPVGpDeGYyVUVhWmpzMnBhZ21rVTB3Q1kyZk9pSU1qbytJUS9lUHJMQU5iSlN3azk5MjVCbUtTSlhqa05VM0FkNXpYYmx1dzRGdlROMUs2U0YxQXlIRyt6S0ZGZ3ltVkg4bUN3RFFCSG40YU9uUllIQndkRFlhb3BqL0k4WUxGaElWazlVQS9ocnB5YkFjTHM4NWtoWHJxQW5Mc3dnVVdEOHk4c3JBSFoxVmxGbzYzRG53ZzNuNy9nTGhZNTcvSXFnenQ4dUZocnY3Rmk4V205ZmZBS21rSEM1K3JJZUE0UTBzWExMaGJUV0tOVTBsVlFMRGZWV1BvdUt1R1FCR0VvMUZOMTY1Y0NTRnBCQWIzVkJOSTNRcEpWVUNPWDdndzVndFJWazBGNmRsTm9LakNVZHRxYkpFTXJsb3BOcTlmVjNzYjF5Q2dtc0NScFYxZHkxVW5HcWFYbW9EQStnZ1I0MVVsZ1pFVEo4VHpyK3hYUHBOS1pSbmpwTVZDOHNpREQ1Q1BaQ0JPTkR3TEFsRUprRC9kZVdUSmdnVjdvMGFJODF4cUFnTHJJMDR6NE5sMkJOanEyUGVyZDhUYjVPc3dNZkN3RmdzSjFwU1kyTHI1MW9tMkd4bGIzTlhWbDBZcFVoRVFXQjlwTkpXOWFZNmRQaTErdk9kbFk2eU9aaTNKMXNpdTd6NEtKM3N6UUxndlN5QTFLeVFWQVlIMUlkdk9pRmRQNEswREI4VHVOMzVSZjl2bzk1dklMd0xmaU5GTm5IbmwwckpDS0YyMWdhMFBPTTdWTXJVMXRaZmVlTk02OGVDMjNrOURkYnVwN2dnZ29Jb0FuUmxTVG1PalJlVVdDS3dQVlUxdWJ6cVQ1Ty80OFo2OTJpd0d6S3NsK21nUjRrNGEwb0pmSks4V01DdmZOS3dRcFJZSXJBK3pPbHdldGZtVU5qamMrY0xQckJjUFpuK1N0bUQ1aDZlZkRUWjl6S010a0tkWkJOS3dRcFJhSUxBK3pPcHdXZGNtRkEvZS9EQ3J3STVyM2xWM1lhbUhkdGp0bnY1clA5d1E4ZUxsUzdSRDc1WEFnWCtKWHNmT25BNnVlZmZlckFLYzYxbVJOajhmMVZhSU1nSEJ6Q3Z6TzErYU5jeEtQT2JOblNQdVhybUt0aFhwcFg5TFNERG1TRldMUldYMHhISGFzUEVqTVhMeVJMQWR2RlJDRVNOOWlZVHVKMDl1bnhhNGlOSHdHQWpVRTFDNk9sMlpnR0RQcS9wMnd2dW9CQ1l2WFJZN1gveFphcnZtaHFLeGV1RDJZRCtxcU9XSzh4eWZMOEliT2FZcEp2Q0p4R2tSUE51VWdNSTlzcFFJeURIUEd4U3VPOVMwd1BnQUJGb1ErT2tyKzhUUTRkKzBlRUx1SXo0QTZ2NDFhOFRhVmF1a0xRMlpuRmxJOXIzelRpcFd5ZHBWSzhUam16ZkxGQXR4UUNBa29Nd0tVU0lnT084amJCZTh4aVhBVTFaNWhibkt3QmJIdGcwYlNEaFdxa3cyZGxwcENRbldpY1J1Q2tTb0o2RElDa2tzSURodHNMNWw4RDRxZ2Y5Tmh6M3hkRjJWNFg0NmUyUFQrdldaV2h5dHlzOWJzUEQySzZwRmtsZXNEOUQyOEFnZ0lFbkE3NnhXKzNwTHBYSEorRUcweE5ONFAzZmRuVWtLZ0xoMkVtQ24rUjZGaStWNHVPcWZ2cmVkOXBQYW9JMTRjTXZ5R2c2MkdQNzVmL3ozNlRQVlZiVDRUM2hyRjJLSUFBS1NCSnpQaFhoQ011NTB0RVFXeUpUMXdRZEdkVStuaUFzUWFFT0FkaW9RTzE1NFVkbGFEOTJzam1iVloydUVoK3o0OENzVmdZL04vZEYzdjZNaUthUmhKd0Z2a3F5UU8wcWxDZG5xSjdKQVNNRUdLV09JaHl4OVMrTzlUZnRiOGF3bEZXRWJXUnk2V1IzTjZzWFdDSmRWMVQ1WHpGQ1ZHRFVyTSs0YlRhQjdyaEJiazlRd2tZQzRycnNqU2VhSWF4OEJIcnJhLzYvSm5lYnNLUC9oMWkzQmVlTkZvOGhEV2ovWStyRGdPaVFOcjVKRmc2R3NwQlN0amU5MHVPN0RTV292TFNBOGRSZWJKaVpCYjJkYy9zRkxlbTQ1Ly9EKzZEdmZvVU9ZK2dzTDhXdDBnTlF1R241S0tpSzhiOWp1TiszYXJiaXdqYTVud1pjRnl6QWt5eVl0SUw3cmJwWE1FOUVzSmNCN095VmQ3OEZPT3hhUFh0cCtwT2lCRndheWlDUU5CMmsyRzUvVWlBQUNFZ1FjMGRIeGxFUzhJSXFVZ0xEem5MN0lXMlF6UlR6N0NQaGtydkpSdEVuRFk5L2VaSVI0aEJ4WVJCN2Z2Q2w4Sy8zS3pua0VFSkFpNFB1RFJ6eFB5cGN0SlNCVHpuT3BzaUtTblFTR0R4OFc0MlNCSkFuc08rQ2pYMDBMdk9BeHFXT2RIZXF3UWt6ckdablZ4NWtueEhhWjNLUUVCTTV6R2RUMnhpSGpnNGF1RGljQ3NMcS9QL0dQYktJQ3BCejVJUkpIbnBhYkpNQUtTVUxQN3JqMG03NUJoa0JzQVlIelhBYXozWEg0citNazAzWjVrU0JQZnpVNXNHL25CMXVTemN5Q0ZXSnlEMG05YmxMTzlOZ0NBdWQ1NmcxcFhBYkRodzRscXRQbWRldkVRaElSMDhPTjgrWWw5b2ZBQ2pHOWw2UldQNGRHQ2g2TW0zcHNBYUVJZDhYTkJNL2JTNERYZlNTWmVjVStqN3czUmN5eTlWYlQ5TjRrUTFrZmtiWEhLOTRSUUNBdUFjZDF0OFIxcHNjU2tPT2V0NUZVcWh5M1lIamVYZ0w4Z3lZYmVGaUhIZWMyQmE3ell3bG1aYkcvQ2F2VGJlb3hTdXZhZmFNUXkrS2tHRXRBYUw3d2xqaUo0MW03Q2ZEVTNTUS9ab05rZmRnd2RGWGZTNzdVMDVOb3dzQW8xb1RVSThYN2FBUmlyd21KTENDMDlxUGI5LzJOMGNxQnAwQkEwTm5oNTZXbjd0cG9mZFQybVh2WC9KMzBLblcyK3JJOFY3NjIzTGd1T0FIZlh4Wm5HQ3V5Z05EYUQ0aEh3ZnRHMXNVL05Eb3FuYVd0MWtjSWpCM3FYK3NmQ04vR2V1VmhMRjZkamdBQ0VnUzY1OGY0clk4c0lBNkdyeVRhd3Q0b1BId2wreVBtT0k2NDcrdHI3SVUzVmZNa2t3Y09qb3hZenc4QXBBZzQ5RnNmZVlQRlNBTEN3MWVDbHJ0TEZRZVJyQ1J3OGZJbDZiVWY1VVUzaTE3YTRzUDJjRHN0TEpTZGtZWFpXTGIzbmdUMWo3RzFTU1FCd2ZCVmdzYXdOT3I0bVUra2E4N0RWd2hDc0I5STl0aGFIc1lhUzdoMUROckFYZ0pSaDdFaUNZamIwUkY3Z1ltOTZGRnpKakJ5VW03NkxnOWY4YllsQ05jSTNMVnloVFNLSkNJdW5Ta2lta0FnOGpCV0pBSEI3Q3NUK2tTMmRUaDFXbTdqeFBLaUwxczVkYmRaNnl3c2xRVC9rd2xKdG8rUnlROXhEQ0lRY1RaV1d3SGh4WU1HWVVGVk1pREFEblRaYWFTOU45K1NRUW1Ma3dWYlpLc2tEODRhUDMyNk9CVkZTWFVqRUdsUllWc0JxYm91QkVTM3B0VytQTDcwK285VkE3ZHJYN3VzQ3lnN29lQ2M1MkZiazZ3Ynk1ejhJdTJOMVZaQTZJRzd6R0dDbW1SQllFeHkrSXFkeGpmUktteUVtUVI0TnBac1NIcDhzR3kraUZkOEFydzNWcnRhdEJRUW1yNjdqRVlqeXUwU3dlY2dVRXZnMHBVcnRXK2pYOU53amV4ZjI5RXpLZDZUc2o0USt1NEtER01WcjcwMUtuRjN1L1BTV3dySVZTRUdOYW9NaWxJUUFyTCtqL0xOWHk1SURiTXZwcXlJWEx3c0tlYlpWeEU1NmtmQXFiYlJnSllDUXBzbll2cXVmbzJxZllsNDdGMG16Sjg3VnlhYStYSElNdU5EdFdTQ3JKakw1SVU0NWhHZ0pSeGZiMVdycGdLQzFlZXRzT0d6TkFqTW0wc25NeVBNSWdEZjBDd2t1SkVWZ1RhcjBwc0tTS1dONlpKVitaRlA4UWpJSG1nMGIrNmM0bFZXOHhKZnd1RlNtcmVRL3NXN3NhT2o2VVNxcGdMU2J1eEwvMnFqaEhrUndNeWZ2TWpQem5kU2RrTEQ3S1J3eDA0Q2psK3BERGFyZWxNQm9TbGNUVlduV1dLNER3SWdBQUlnWUJpQkZsclFVRURJLzFFbUJNc013NERxWkVSZy9od01SV1dFdW0wMk42SXQyakxDQTYwSmtBK3U2U0ZURFFXRS9COFFqOVpNOFdrTEFwaE4xUUtPNUVlWExsMldpamtQTTl1a3VDSFNUQUxOL0NBTkJRVCtqNW53OEM0YkF1Zk9uODhtbzRMbHdnc0NMMTZSRTVDQ1ZSWEYxWk5BVXo5SVF3R0IvMFBQVml4S3FXUVh2WjA3TDdkK3BDaGNwTXRKQ2lLN0lGQzJMYVRMaW9obUVtamlCNWtsSU1INkR3eGhtZGtKTXFyVmZNbnB1T2NtSmpJcVlkR3lrZCtjVW5ZQll0RUlvYnpwRW1qbUI1a2xJTFI5Q2Z3ZjZiYUY4YW5mS25zY0xlMERqNVhUczd0SGtzMHA0WSthelJOMzVBamMyRUFiWmdrSUpRMEJrZU9MV0ZNRVpHZGg4VmovNlBFVDRGaEg0SnduNlJ2QzVwUjFKUEUyQ1lGR2s2dG1DWWpUWXRWaGtzd1IxeDRDL0ZldjdOajdPTTd4bnRWUkRvMStOT3RlbEJ0OHVpTUNDQ2dpUUgrT3pEN2FZNWFBQ0RyS1VGR0dTTVpTQW55S1hsbHlHT3ZneUtpbDFCcFhtNDZURnJKSDB5NHNmYUZ4b3JnTEFoSUVPbDMzcS9YUlpnZ0lMeUNrWVlSeS9VTjREd0p4Q2ZRdjZZc2JKWGllZC9LRkgrUTZ1ck0wdFZtV3g2MkxicjZlRUs1QUlDRUJXdDVSUHVKNTNiWEp6QkFRY3FDWGF6L0VOUWpJRXVoZEpIZTJPZnRCaGc0ZGxzM1d1SGdIUitVdHN2NEVKeGthQnhJVlVrS2dma0hoREFIQkFrSWxqSkVJRWJnMXdlRlFveWZnU09kT3hNTlh3NGMvbE9wUFBJeUkweDJsMENGU0N3S1ZTcVczOXVNWkF0TFIwVEZyakt2MllWeURRRlFDOCtmTkU3Si9BZk9ZL3doRVJQRDBYZGxKQmYxOXZRSlRlS1AyVmp3WGtjQXNSL29NQWFHL2VNb1JFOEpqSU5DU0FNM1lFS3NIK2xzKzArckQ0VU8vYWZXeDhaL3hVTjdiSDN3Z1hjOVZBd1BTY1JFUkJKb1JxSGVrVHdzSVZxQTNRNGI3c2dSVzljc0x5Q0VhKzVjOW1FcTJ2RHJGTy92blA5UHdsWnlJOHZEVjZnVHNkZUtBc3VoRm9ONlJQaTBnV0lHdVYwT1pVSnFGUFQzU3cxaVRkSkxlV3dmay93SXZNaisyUHZhLzgyL1NWU2pUN0t1RmttZW9TMmVLaU5ZUW1GOHoyV3BhUUdqSVljYjBMR3Rvb0tLcEVlQmhySUhGaTZYVGYvVlg3d2lleG1wYlNHSjlNS3Y3MXF5eERSbnFteTJCNmJXQzB3S0NHVmpadG9BdHVkMjc1dStrcThwL2lmOTAzMzdwK0VXTXlET3ZrbGdmUEh6Vm4wQzBpOGdNWmM2VUFQOWRPRDNaYWxwQTNJNk9Xek10QmpLemdrQ1MyVmdNaUdkazJiUTZuZGZBeVBvK21OZmFsU3N4Zk1VZ0VGSWpRSC9ZbGNQRXB3VUVNN0JDSkhoVlNZRC9YTm04Zm4yaUpKOG5LOFFHaC9xbjVEaC9OWUh2ZzYyUHUxWXVUOFFha1VHZ0hZSGFtVmpUQWtLUnBzZTEyaVdBejBFZ0RvSGJhVVcwN0pvUXpvY2Q2dis0WjIrY0xBdjNMQTlkN1huekxlbHRTN2pDekRpSno2bHcwRkRnWEFqd1RLd3c0MEJBZms5N1lJVTM4QW9DcWdtb3NFSjRLR3NmT2RWTkRJSGZnK3FXWk5zU1pqeTRZb1dKZUZBbkRRbUVtaEVJU0dlTm9taFlWaFRKQUFKSnJSQkdzSjkrWkljT203ZFAxbHNIRGlSeW5ET2IzbHR1RVd0WHJlUkxCQkJJblVEbjFLNGxnWURVT2tWU3p4a1pXRWxBaFJYQzRKNS9aYi8wOWg0NmdqLzV4ejhHUTFkSnlzYStqOGMyUDVRa0NjUUZnVmdFL0VxbHhCRWdJTEd3NGVFa0JIaU1Qc24ySnB3M1QrMTk2b1dmR1NFaUxCNDdYL3lYSkVpRHVEenpTdmI4bGNTWkl3RWJDVGloMFJFSUNCRW8yMGdCZGM2ZXdOWU5HOFM4dVhNU1pjd3pzbGhFaWpxOWwwWHczVU9IQXZHNGVPVktJaFlMdjlBakhscDNUNkkwRUJrRTRoSndIZWV2T1U0Z0lGZ0RFaGNmbnBjbDhDWGFZbVB6dW1UVGVqbHZGaEdlbVZVMHh6bzd6Tjk2LzMzeC9MNVhSVkx4NEdIQkIyalZPYll0a2UyTmlKZUFRSm5qWHJOQWZCL2JtQ1FnaWFqeENOejM5VFdKcHZYVzVzYU85ZDF2dkNrbUwxMnV2YTNsOWVTbFMrSWxLaXRQMTFVUitwY3NGdmZlaVcxTFZMQkVHdkVJa0FWUzVoamhFQmJXZ0RBTmhFd0k4Ri9PajIzZW5IZ29LeXdzYjdyNC9XZWVGWjlxdW04V0QxbXh2K1A3enp3bmZ2bkJyOE5pSjNybG9hdkhObTFLbEFZaWc0QXNBVm9MRWhnZERtL2pmdFYxUGRtRUVBOEVaQW53Mm82blhuaFJObnJEZUp2V3J3czJFN3h4M3R5R24yZDlrNjBPSG1aVEpSeGNmcDUxOVlNdER5ZWVrSkExQytSbkZBRi9zbHJ0WVFGWlJnSnl4S2lxb1RLRkljQkRVS3I5R0F0TEpjRkNNcmh5UmZCam13Y005blh3dmxaNzN2eEZZbDlIYmZuWmV1TzY4VDhFRU1pUmdIKzFXdTF6am5uZW9IRGRvUndMZ3F3dEovRFRWL2JSQWtHNXc1TmFvY3REU05qaVlPRmdpK09zcDk2d3Y1c1dDejYyR1VOWHJkb2RuMlZDd0JmVjZ0M09jYy9iNkx2dWE1bGtpVXhBb0FFQjN1dHFSNHByTzFoSWVJdnp3VlVyUkg5Zm4zS3JoSzBOUHNQOTBNaG9zSk51MHRsVkRSQUZ0M3IvNmhheDY5Rkg2YXp6Wk5PZ202V1AreUFRZzREdlY2dmJuSTg5YjZ2anVydGpSTVNqSUtDY0FJdklQNUFqL054NTlYKzExeFkyRkJOZTBIZ3JuOXhINGtLS0luaG9LR3Bnd2VCcHhPekRHU1hoNE8zWDB4S05zRXpzTkdmeHdKVGRrQWhlY3lad1RVRCs0SGs3WGRmZGtYTmhrRDBJMEN3cVQreDQ4Y1hVUmFRV05RdklUYlEycFhmUklwb1ZOamNRRkg0TkZqdVNVUHpKbXdnZVo0SDdFdzFKOGJEVStPa3pxUXhQMVphcjlocmlVVXNEMTdvUXFGYXJ1OWdDZVpZc2tDZDBLUlRLWVRlQlBFUkVaK0k4YlBXRGh4K0c1YUZ6STFsYU5ockNldGFsT2VwWVJHaHBCOUN4MnJ4Uy9aKyt0eDE3TzFIakROQkNRUXhiNmRoTFVTWW1RTlBKdTJnWGs0NHU0QUFCblFqY1NFTkkvL1BKN2VKK1MxZFo4enFQQjJpMS9xN3Z3R0d1VTc5RVdXWVNvSDdxZE1JQ21Ra0Y3L1FoOE1pREcyakcwZHpnSEJEcXAxWUVGbzl0R3g3QUZpVld0SGF4SzBtVFNXNTFqbjMyMlpEdy9jRmlWd1dsTjVtQUxYNFJkcGF6djZQM2xrVW1OeWZxWmdvQjN4OXlqbDI0Y0lUcWc3MndUR2xVUSt2QjAyWjUxVHJ2ZTJWYVlLdmovalYvSng1YXZ4NXJQRXhyWElQclF4c3Bqam5ITDF3WW8rR0Jzc0gxUk5VTUluQndaRVM4Uk51RHBMMWVKQ3RrYkhVOHZ1bWhZS0ZqVm5raUh4QlFRUUFDb29JaTBzaUZBRnNqNzlMNTZFVVZrdm0wMlNPZjVYSHZuWGZDNnNpbEJ5SFRwQVFnSUVrSkluNnVCTTdTd2tNV2ttRVNrcUk0MlNFY3VYWVpaSzZRUUNBZzVBTXB5bmRQWWRXUmxFa0VRaUVaT1hsQ1c0c0V3bUZTajBOZHBnajQ3RVNIZ0tBL0dFSGc0dVVyZEU3NlNPQm9QM1htVE81V0NUdkgrL3Q2eGFyK2ZyRjIxU29NVlJuUnkxQ0pHZ0lRa0JvWXVEU0lBRnNsYjlPTUxkNGxOMHN4WWRFbzB5YU5xMGswZU1QR011MnhoUUFDaGhLQWdCamFzS2hXRFFFV0U5NDE5K0RvcUJnankrUlA5SjZEQ3RPYkJZTTNaTHg5Y1o4bzMwekM4YmNEMTNiNHJja2ZseUJnS0FFSWlLRU5pMnExSU1CRFhlTWtKR09uVDR0enROdnVXZTk4c0QwN3oraTZlT1d5dUhUbC84Nkl6VHZ6M3ZnZjU0aDVOSE1xMkwyMzFDTnVLblVIR3h6MkwxNkNvYWtadFBER0lnSVFFSXNhRzFVRkFSQUFBWlVFZkpxSmhRQUNJQUFDSUFBQzhRbEFRT0l6UXd3UUFBRVFBQUVpQUFGQk53QUJFQUFCRUpBaUFBR1J3b1pJSUFBQ0lBQUNyaVBFT0RDQUFBaUFBQWlBUUJ3Q1pIMk13d0tKUXd6UGdnQUlnQUFJVEJPQWdFeWp3QVVJZ0FBSWdFQWNBaENRT0xUd0xBaUFBQWlBUUVDZ0lzU0U2enZPT0hpQUFBaUFBQWlBUUJ3Q2p1OVB3QUtKUXd6UGdnQUlnQUFJVEJOd3E1WEtxZWwzdUFBQkVBQUJFQUNCQ0FTcXZuOEJGa2dFVUhnRUJFQUFCRUJnSmdIWGNieE9XZ2N5TWZNMjNvSEFiQUlxdGo2Zm5TcnU2RWFBZmc4UVFDQVNBWjhza0U3NllaaEFwNG5FeTRxSHFGUFE5dWFlK09qRXllQ1Zyem1jTzMvZWl2cmJYc241YytlS2VmU1B0NjN2cGNPd2J1b3BCZWVjOExrbkNDQlFTNEMxZ3kyUThkcWJ1TGFQQUl2R3lNbVQ0dkRJcUJnNmRKak94TGhpSHdUVXVDa0JGcFAreFl2RjRLb1ZkRVJ2bjRDWU5FVmwwd2MrYWNjcDUyUFAyK3E0N202YmFvNjZYaU13ZWVtU2VQdURYNHUzM3o4QTBVQ25pRVNBeFdUVCtuWEJDWXhmNnVtSkZBY1BHVW5BcDc4a3Z1a2M4N3hCNGJwRFJsWVJsV3BJZ0F3T0VvNERZdisvdmdQaGFFZ0lOOXNSQ0lWa2NPVUtXQ1R0WUpuNXVTK3ExYnVkMzN0ZXVkTjF4OHlzSTJwVlQrQWtIZVA2ei90ZURjNEdyLzhNNzBFZ0xnRVdrcDNmZlZUQUdvbExydkRQKzM2MXV0d1o4N3p1cTY1N3pWTmErRHFoQXEwSXZIVUFWa2NyUHZoTW5zQWpEMjRROTkrNVJqNEJ4Q3dhQVgreVd1MEpwbFljdTNDQkJhUzdhRFZBZWFNVDJQK3JkOFErK29jQUFta1JZTi9JWnZxSFlBVUJmMmxYbDl2SlZTVVZtYUJoY1FpSW9lMyswMWYyaWFIRHZ6RzBkcWlXTGdUNGo1UkxseThMdGtZUXpDWkFlbkdVYXhpc1JNZUdpdVkyTm4rcElSN210cTl1Tlh2cndBZXdkSFZybEJUS3d4c3BjcktCZ0dBL3JCUUlhNUFraHEwMGFBUUxpOEQ5am9VRXdXZ0M0MXk3Y0MrczRBM2ZRRENEd0tlMGNodytEelBhc29pMTJQM0dtMkxreElraUZoMWxqa0NBTmxJOHhZOEZBa0kra1BFSWNmQklnUWpzZk9GbkJTb3RpbW9pZ2VkZjJTOHVrazhFd1RnQ3dTcDBybFVnSVBSZk1KNWxYRFV0clJBUElZUjdXRm1LQU5YV2dBRDNRUXhsYWRBUUtSUWhORG9DQWZsOHlxT2VRajVJTW1NQ1p6RjBsVEZ4Wk5lS3dDL0pGd0lycEJXaFluNTJkV3JVS3BqRys1VlNhWnpXZ2hTekppajFEQUpzZmFnSzlGZUdLTit5U054S3U3SWkyRUdBcCtHZVBlK0pVMmZPQ0pxcW1UaE1VbnBzaFdCOVNHS1VXaVhBbXNFRkNnU0VMOWdrb1E1VDVtdUVZaEpnNjBQRmxOMzVjK2ZRcXVJN3hYMzBqNjhSN0NQQUlqSjgrTEI0bC82ZG8rc2tnYTBRWHFYT1c4VWpGSjlBdUFhRWF6SXRJTFFqMmxIaCsrWGlWOC9lR296U0dSNUp3MXJhSE8rUkJ4K0VjQ1FGV2ZENEMra2NFRjVaUHJoeXBXQ3Jkb2lFUkRhd0ZjSi8yR0NyRTFtQ2VzV2pQYkJPaFNVS2ZDRDhCbXRCUWlURmZVM3lKZWRhOHcvRzQ5L2VEUEVvYmhkUVhuSVdrc2UvdlNueEVOVEJrUkhsWlVPQytSRGcwYW93NTJrQm9SdkIwdlR3QTd3V2l3QVBYeVd4UUxDUFViSGFPK3ZTY3Y5SVlrSHdDWmR3cG1mZGFxbms1enNkSGNOaHl0TUNjZ01FSkdSU3lOZHhjbnJLQmo2MkZFNU9XWHIyeE51NllZTW9TMDZvWUlmOFFUcnhFc0VBQXBYSzlJeXJhUUdoYW8wYlVEVnJxekNTd1AreGVSMTJVTFcyNDhTb09CK0x2aTNCUm9sSi9zaUpVVXc4bWpLQnlScGpZMXBBZWt1bGlkcXhyWlRMZ09RVkU1RDljckwxc1hiVlNzV2xRWEttRXJpOXIxZndJVkl5NGF5SDljb3kzSFNLd3pPdzdpQ3RDTXMwTFNEQkRaNkpoVkJJQWhjdlg1RXE5OWY2KzZYaUlaS2RCQnd5UTFZTnlQV1pVM1FhSmtLeENkVE93T0thekJBUXYxSjVyOWpWczdmMFo3M3pVcFh2WDl3bkZRK1I3Q1V3SU5sbkxsNlIreVBIWHRKYTFueUdrVEZEUURDRXBXV0RSU3JVSlVrTFpCNFdkMFhpaTRldUUvaGlxZWY2bXhoWEVKQVlzUFI4MUNmQm1HRmt6QkNRRGlHRzlTdzNTcFVXZ1lVOWNqOEdhWlVINmVwUEFMc1Q2TjlHYVpXdzFvSE9lY3dRRURqUzA4S09kRUVBQkVDZzJBVElnVDVlNjBEbjJzd1FrS0I2Y0tRWHU1VlJlaEFBQVJCSWdRQTUwSDlibit3c0FZRWp2UjRSM29NQUNNd2d3S3NDRVd3ajRGT3pEOWRYZXBhQTBBTXp2T3oxRWZBZUJFREFiZ0xZa3NUTzlpY2ZlWHNMaExibmhZQlkxRDk0RHkwRUVJaEQ0QkttNDhiQlpjeXo5UTUwcnRnc0M0UWQ2WFFmSWxLd1pwZGRIY3dIQ0NHQVFCd0NGeTlmaXZQNDlMTUx1N3VucjNGUkxBTDFLOUREMHM4U0VQNkFuQ1V6NXZxR0QrUFZQQUxZWHNLOE5rMjdSbWNuK0cvTStHRWVEaWVMRDAyWEdFMDBvYUdBME0xaFhjcU5ja1FqSUx0TDZsaUNYWHlqbFF4UG1VWkE5b1JDbkVoWTJKN0FXN2dQTlNwOVF3SEJnc0pHcVBTK04yK2UzSEdoNDlpZlNPK0cxYXgwUHMzRmtUMTNSdmFQSE0wUVdGbWN5VXJsL1VZVmJ5Z2c4SU0wUXFYM3ZkNUZOMHNWY1B6TUp6am9SNHFjblpGNEJwYjh6cy9ZOWFDSXZhYVovNFByMGxCQStBUDRRWmhDY1VMdm9sdWtDNHVEZnFUUldSY3hTVjhwUy82Ull4MWszU3JjeFAvQnhXd3FJUFRCc0c3MVFIbWFFMGp5NVV4NmxucnpVdUVUa3dqd1NySkRveDlKVlltM2dlK1ZQTTFRS2tORVVrV2dxZitETTJncUlQQ0RxT0tmVFRyc29KUWRZOFl3VmpadFZQUmN6cDcvc3pnNEtuY3NiWG5SbHdXYzZNWHNBYzM4SDF5YnBnSVMrRUVjWjdpWVZiYXoxTEpuZS9DNDlsc0hQckFUR21vZG1ZQ3M4NXd6R09oYkhEa2ZQS2dSQWQ4ZnJ0OUFzYlowVFFXRUg2cmlnS2xhVnRwZmYyMWdRTHFNYjVPQVlJc0thWHpHUitUWlY2Kys4MjlTOWFSemhzUkt5Vk1NcFRKRUpGVUUvSXJ2djlFcXNaWUNRaDhPdDRxTXovUWl3SDRRMmNWYXNFTDBha3ZkU2pOOCtEZmlyT2RKRldzK1RURWZXQXdMUkFwZXpwRklBMW91S204cElFdExwV0Vxdjl5eTA1d3JibVAyUE1hOGR1Vks2YXJEQ3BGR1ozVEVULy84WjdIL1YrOUkxM0Yxdjd4bExKMHBJaVltUUhNbXhtOHJsVnB1YTlWU1FMZ0VOSjEzYitLU0lJSE1DQ1FaeG1JckpNa1BSV2FWUkVhWkVtRC9tS3oxd2NOWGQ2MWNubWw1a1prYUFnNzVQOXFsMUZaQXFBTzgzaTRSZks0UEFYYWt5ODdHNGxyd2o4WElpUlA2VkFnbHlaVUFXeCsvL09EWDBtVzQ2UXM5R0w2U3BwZHJSRis0YnR2Zi9yWUNNclc5TzRheGNtM0xlSm12WGJVaVhvUzZwNTkvWlQ4YzZuVk1iSHc3ZWVtUzJQbml2eVNxK3FaNzdra1VINUh6STdCMHdZSTMyK1hlVmtDbXB2TzJIQWRybHdrK3o1WUErMEZrbmVsY1VoNnV3RkJXdG0ybVcyNDg2Mm9mK1Qxa2g2NjRQZ3ZKK2xpN1N0NG5weHNUbThwVHJWWmJ6cjRLV2JRVkVINlFqcm1GSHlRa1ZvQlhkcVkvY09lZGlVcktRMWxZRzVJSVlXRWprL00wK0FNaXlkQVZWeDdXUjNHN1FJZnJ2aGFsOUpFRTVBYjRRYUt3MU9xWisrNWNrOGdLNGNyc2Z1Tk44VHY0UTdScTF5d0tNM0w4dU5ndnVlWWpMQitzajVCRU1WLy9VcTIySGI3aW1rVVNFS3hLTDE0bllDdGs4N3IxaVF2K2t6MHZTKysrbWpoekpKQTVnWk4vL0tQZ05rOGFZSDBrSlpoai9EYXJ6MnRMRmtsQU9BS0dzV3F4RmVQNi9xK3ZFYkxibTRRMTVLbTkvN2g3ci9nVVo2ZUhTSXg5NVJsWFA5bjd2OFRGaEdlZXcvb29kQmZ4YWVQTFBWRnJFRmxBcG9heE1Cc3JLbGxObnR1OFBya1Z3bzdVblMvOERDS2lTWnVtVVF5MlBIakdWUktuT1plTGQ5M2Q5ZWlqYVJRUmFXWkVJT3J3RlJjbnNvQmdObFpHcmFjNEc3WkE3aWQvU05MQVB5emZmK1k1REdjbEJhbGgvTitSejBPRmVIRFZOcTI3Unl6c0tXbFlTeFFwQ2dHZWZkVnE4OFQ2TkNJTFNCQ3hVdGxWbndEZTYwOWcwL3AxaVJZWGhqWGs0YXovOXZTem1KMFZBakhnOVJmdnZ4K0lSOUpoSzBiQlExZmMxeEFLUzhCM096cDJ4eWw5TEFIQm9zSTRhUFY1bGgzcVA5eTZKZkdzckxCR1BEdUwxd2p3ZEUrRVloTGdkUjR2VVR2dWVmTXRKUlhnRFJNeGRLVUVaVzZKOE41WFVSWVAxaFl3bG9Ed01CYjJ4cXJGVjV4ckhsWlFNU3NyckRFdk5Oenh3b3Z3aTRSQUN2VEt6dklkTC81TThPYVpLZ0w3UGI2OWJoMkdybFRBekRHTktIdGYxUmN2bG9Cd1pPeU5WWSt3T085NVZwWUtmMGhZWXo1Z2lKM3JRNGNPaDdmd3FqRUJQcEtXL1Izc3kwcHlPRlI5RmRudmNhOENQMXQ5dW5pZktRRmYrUDdMY1hNa1BZZ2ZqbDI0Y0lSaUxZc2ZFekYwSVBBVVdRNHFmMEM0VHJ4OXlrUHI3eEZmNnVuUm9Zb29ReDBCM3RlS2h4MlRyaTZ2UzFZTUxGa3NkbjBIczY3cXVSVHRQZjF0TVhaYlYxZGYzSExIdGtBNGc2ajdwTVF0REo3UGhnRDdRMjVTUEZObTZQQmhXQ1BaTkYrc1hOalhFVm9kcXNXRG5lWS8yTElsVm5ud3NKWUVmQktDblRJbGs3SkF4anl2KzZycnloMVBKbE5LeEZGTzRPeDVUenoxNG92aUhMMnFEckJHVkJPVlM0OTlIYy92ZjFXNXRjbWxZZkZncHptbTdNcTFqV2F4L0t2VmF0OVhTcVh4dU9XU0VoRE81TmhubnczUm1ObGczQXp4dkQ0RTBoUVJyaVg3VzNoc0hNTmEyYlk1RDFmeFJwaXlaNWkzS3kzRW94MmhnbjN1Kzd1WGRuZHZreW0xdklCNDNpQWRPRElra3luaTZFTWdiUkZaV0NxSlFkclNlM0RsQ2doSnlzMGVDc2N2U1R4VXJPdG9WRnlJUnlNcWhiN25rMC9pN3FuankyTlhSRnBBT0NjNDAyUHoxakpDMmlMQ2xZYVFwTmYwV1FoSDBJWVl0a3F2RVhOS1dkWjVIaFkzbVlCNDNuYXlRcDRKRThOcmNRbXdpUHg0ejE0eGR1Wk1xcFdZUDJlT1dEMHdnQmxiQ1NtemMvd3NiWEE1ZFBnM0lrMkxJeXhtNzEvZEV2Zzg1cytkRTk3Q2EvRUorQ1FBVzVkMGRiMHNXNVZFQWpMbFRCK2p6THRsQzRCNGVoSGdWZVpaSFNTMWVxQS9tUDY3cXYvMllCTSt2VWpvV1JvV0RqNnpudjBicXFkaU42b3gvMER3cVlKYk4yd1FFSTlHaEFwOXp5UG4rWElaNTNsWTYwUUN3b2w4N0huUE9xNzdSSmdnWG90UGdGZVo4NXFCckFJUGIvVXZYaHhZSlF0TFBTUW1XZVZjakh4QzBXREJ5TUxhQ0tud0NuTmVKSWo5clVJaWhyMG1jSjZISkJKL1ZYL3ZlZVZPMTJVckJNRWdBZ2RIUnNSTGIvNGlsV20rclREMUxsb1VPTnhYa1hYQ3dzSS9ZamFHWUlpS2RrRG1JYXFQeU9MSXd0cW81Y3g3Vy8xd3k4T0JzTmZleDdVeEJLU243dFlTVVBMdHhKVGVXcVRtWEdmbEYybEdqQVdFaDdsWVRQcjcrdml3Q2Q1S3g4aEF6a3c2dGUzYThOU2hrVkZ4YVBTanhHZHp5SUJpdnYyMHV2eXhUWnV3eGtNR1lGSGlLTEErdUtwS3ZvL0hNS1czS04xR3FwdzhwTVgvZ2g4NXFSU1NSMkxuZS9tV1JXSjFmMy93V25SQnFSV004ZE5ueEtHUFBoTDhtdGIwMnlndHdOYmV0ZzBQWUYrcktMQ0svVXlpcWJ1MVZWY2lJSndnckpCYXJPWmRmMHF6dEhha3RISmRobFlvS0R6a3hmNFQzcHFsZlBQTldsb3BaRmhRb0ZsVE5DVEZRMUduYUtZYnozYkxXekJxdWZNc3E4Y2Vla2owa2tnam1FMkF1dU1SMnZkcXVZcGFxaE1RV0NFcTJrUDdOSFN3UnBwQkNrV0Z6ejhwazdEd1A1NDV4TUxDOTRLUXdqQllhRTF3K256b0ZndkZxVE9maUVtNkh2L2tFM0dLTEF1ZWNwdW5kWEd0OHJQL1oxL0hBMnZXMEFRR0hBUTFtNDZSZHhKUDNhMmxva3hBT05HUEwxd1lvd1RMdFJuZzJqd0M3QnRoSWVFTkZJc1UyS2ZDbGdxTHlUejZ4Kzg1aEs5OHpmZm4xYTUxSVBQaFQ5NEVmeFFFRm90ekpCRGhLOTg4UitMQWU0cXhlT2dvRWtIQjYvN2o0YXJiKzNyRjQ1czN3OWRSeDhia3Q5UnZwWGJkYmNaRXJZQjQzbGFhMHJ1N1dXYTRieFlCUGdkazN6dnZaRDVUeXl5SzJkZUd0eU41Zk5ORG1HR1ZQZnE4YzFScWZYQmxsQW9JSndncmhDbllGU0FreFdodkhxN2lrd054K0ZNeDJrdDFLVlZiSDF3KzlRSUNLMFIxdXhjbVBRaUpuazBWK2pudXZmTk9yQ2JYczRteUtKVnk2NE1MclZ4QU9GRllJVXpCM2dBaDBhUHRJUng2dElNT3BVakQrdUI2cFNNZ3NFSjA2RE81bHlFVWtqK1JnNWs2TUVJR0JOZzUzcis0VHd5dVdCRnNXb245cXpLQXJuOFdxVmdmWE8xVUJJUVRoaFhDRkJDWUFLOTlZREVacGxsYkVKSjAra1FvSEx4M0ZhK0xRUUNCa0VCYTFnZW5uNTZBd0FvSjJ3K3ZVd1I0K3U4bzdldkVNN2RnbFNUdkZvRm8wRlRjQVJJTStEZVM4elEwaGRTc0QrYVZtb0J3NG5UZzFJZjBjZ2RmSTRCQUxRRmVpZjMyK3grSWtaTW5JQ2ExWU5wYzh4ZDJIczJtdW52RlN0b2o3SFpZRzIxNDJmNXhtdFlIczAxWFFMQTYzZmIrRzZuKzRSQVh4S1F4THJZMGdvMGxhUjh3aUVaalJyamJrRUNxMWdmbm1LcUFjQWJZSTRzcElFUWx3SmJKNlBFVDR1RG9xUGpvNUZpd1E2MXRmcFBReXVpbExWaFdrV2lzL3R1QkdhdmxvN0xFYzVZVDhQMFBsM1ozcjBpVFF2b0NBaXNremZZelBtMjJUdmdFUHZhZG1Db290WUxCRG5DZVJWVmVkQXZXYkJqZnUxT3RvSkx6UHRxVk1IVUI0UUljLyt5em45TUJPZDlzVnhoOERnTHRDTENnakowK0xjWnBzMEsyVms3UlpvVjhqa1pSckpUZ0MwZERVdVZGTjEvYjhKR3NERDUvZzNjVlJnQUJaUVFVbmZmUnJqeVpDTWpVcVlWSHFEQTRPNzFkaStEejJBUllTSGhEd3pFU2xYRzY1dGxlNTd6ejR0TGxLOU5wWlNrd29Vandwb3pzdStCZGdXK2kxK0NhdGt1SFdFdzNDeTdTSVpDSjljRkZ6MFJBT0tNL2VONU8xM1YzOERVQ0NHUkI0Q0lKeU5rcEllSHQxSG1iZFJhVnlTdVhBOEhoTXZCMFlnNHNNT2NtcnUrNkc5eXMrMjloOTlUZlAyUkJmTEhVSFh4NXZ0alRJMjZjYzIwSFh4WUlYcmgzRTkzanM5MnhpSzhPSU41bVFZQVBpOXExdEZUYWxVVm1tUW5JbU9kMVgzWGRrMVNwYTN0b1oxRTc1QUVDSUFBQ0ZoR2dQNFRHTGxhcnkrOG9sVnIvTmFTSWlhc29uYmJKOUZLRi9HcjF5YllQNGdFUUFBRVFBQUVaQWo3OW9PL01Tank0Z0psWklDRU5tdGI3TGprOTE0YnY4UW9DSUFBQ0lLQ0FRQWJUZHV0TG1aa0ZFbWJzVnlxd1FrSVllQVVCRUFBQk5RVDhxNzcvOTJxU2lwNUs1Z0p5VzZsMGxKdzh6MFl2SXA0RUFSQUFBUkJvUWNBbjk4QnpYeW1WeGxzOGs4cEhtUXNJMTZKVGlGM3M3RW1sUmtnVUJFQUFCQ3dpUUwrbDR4ZnBOeldQS3VjaUlPeFFkNnJWYlhsVUdIbUNBQWlBZ0VFRU1uZWMxN0xMUlVDNEFEUlBlVmc0emxCdFlYQU5BaUFBQWlBUW1RQnR3ZUR2V2RMVjlYTGtHSW9mekUxQXVCNVhLeFcyUXE2dDVGSmNNU1FIQWlBQUFpWVQ0S0VyY3B6L0tNODY1aW9nZ2RPbldzMFZRSjd3a1RjSWdBQUlTQklJaHE3eWNKelhsamZ6ZFNDMW1ZZlhXQnNTa3NBckNJQUFDTFFsRUF4ZDBWYnRQSUtUYThqVkFnbHJqcUdza0FSZVFRQUVRS0ExQVIyR3JzSVNhaUVnR01vS213T3ZJQUFDSU5DU2dCWkRWMkVKdFJqQ0NndURvYXlRQkY1QkFBUkFZQllCYllhdXdwSnBZWUdFaGVtc1ZMNUYxNWlWRlFMQkt3aUFBQWhNRWRCcDZDcHNGSzBFaEJjWTBqWW5MQ0lJSUFBQ0lBQUMxd2xvTlhRVkZrc3JBZUZDQlFzTXNWZFcyRDU0QlFFUUFJRmdyNnM4Rnd3MmF3S3RmQ0JoSWZud3FjOWQ5ME1xWEc5NEQ2OGdBQUlnWUNNQkdybzZlVnRYMTJJZDY2NmRCY0tRZUNpclVxM2VUWmZ3aCtqWWExQW1FQUNCckFoNDlGdjRqYXd5aTV1UGxnTENsY0RVM3JoTmllZEJBQVFNSThCRFY3dnlYbTNlaXFtMkFzS0ZKbi9Jc3pnN3BGWHo0VE1RQUFGRENRUitEem8vNlRtZDY2ZTFnREE0bkIyaWMvZEIyVUFBQk5JZ1FINlBzYnpPK0loVEgrMEZCUDZRT00ySlowRUFCQXdnRVBnOTd1QmxEWm9IN1FXRStmRVlJSTBGNGl4MXpUc1RpZ2NDSUpDWWdFK3pUN2ZyN1Blb3JXRWhCSVFMVEdPQmU4Z2ZzcXUyOExnR0FSQUFBWU1JK1B3YnArTjZqMmFNU2V5S0ZiQmZWckhhQzZVRkFSQ0lSc0R4L2RlV2RIY1hhaWVPd2xnZ1lSUHdmbG5zWUFyZjR4VUVRQUFFaWs2QWY5TSs5LzNDRGRNWHpnTGhqdko3enl0MzBrcDF1aXdWdmVPZy9DQUFBdFlUOEs1V3E4dUw0dmVvYmEzQ1dTQmMrQUQwdFUwWFNiZ1JRQUFFUUtDd0JIeGFhZjVJRWNXRGlSZFNRTGpnVTVzdUZzN2s0N0lqZ0FBSWdBQVJDSnptZjFNcXZWRlVHb1VWRUFZK3RWSWRNN09LMnZ0UWJoQ3dsMEFnSHZRYlZ1amZyMEw2UU9yNzNNY1hMdXltaW15dHY0LzNJQUFDSUtBaEFkNm1aQzh0VFhoRXc3TEZLbEtoTFpDd3BqZFVxOStqNnlQaGU3eUNBQWlBZ01ZRWp0STJKZnliVmZoZ2hBWENyY0F6c3pwYzkxMnFVRy9oV3dVVkFBRVFNSklBVDlmbG95cUs2alN2YnhSakJJUXJCaEdwYjE2OEJ3RVEwSVdBYWVMQlhJMFNFSzRRMW9nd0JRUVFBQUdkQ0pnb0hzelhDQjlJYlVkaDA1QWNWSGZUUFp4bVdBc0cxeUFBQW5rUk9FOTdYSDNMbEdHcldvakdXU0JoNVQ3MnZHWE90ZFhxeHRZeHJDdGVRUUFFdENYQU02NlcwNHlybzlxV01FSEJqTE5BUWhiY1lOUncyK2c5VnF1SFVQQUtBaUNRSlFIZm9WWG1wb29IZ3pUK3IzT3lSTGFTSmZLU0RYWE44cHVCdkVBQUJGb1NDTVJqU2FtMHQrVlRCZi9RZUFIaDlvR0lGTHlYb3ZnZ1VDd0NWb2dITjRrVkFzSVZoWWd3QlFRUUFJR1VDVmdqSHN6UkdnSGh5a0pFbUFJQ0NJQkFTZ1NzRWc5bWFKV0FjSVVoSWt3QkFRUkFRREVCNjhTRCtWa25JRnhwaUFoVFFBQUJFRkJFd0VyeFlIWldDZ2hYbkVTRTE0bThTNWM0MVpDQklJQUFDTWdRT0UvTEJiNWg4bFRkVmxDTVhRZlNxdEw4MmRRNmtidDVpNEYyeitKekVBQUJFR2hBd0dyeFlCN1dXaUJoWjhBR2pDRUp2SUlBQ0VRbFlPcmVWbEhySHo1bnZZQXdDSWhJMkIzd0NnSWcwSTRBeE9NNklXdUhzSzRqRUlJM09lTTkrdWtlRHFXcUJZTnJFQUNCV2dLa0hlS0lTZWQ1MUZaTzVob0NNa1dOUmFTVFJJUjZ5QjRaa0lnREFpQmdOSUhnR05wSmd3NkRVdEZhR01KcVFQR1k1KzBVcnJ1andVZTRCUUlnWUI4Qm43WmozN1cwVk5wbFg5VmIxeGdDMG9UUGxJZzhSUitEVVJOR3VBMENGaEJneStON05HdnpPUXZxR3J1SytIRnNnZXk0NTIzMHIrM2tpN1VpTFRqaEl4QXdsQUFmQlBYM1pIa01HMXEveE5XQ2dMUkJpQmxhYlFEaFl4QXdrQUQ1UWsrU3Mvd2JKcDRpcUxLNTRFUnZRek9jb2VVNHptdHRIc1hISUFBQ3hTZmdDOThmdWxpdHJvQjR0RzlNV0NEdEdVMC9BYi9JTkFwY2dJQ0pCT0FzajltcUVKQ1l3S1kyWW55YW9zRXZFcE1kSGdjQmpRbDRkUHpzOTB3L1FWQTFmd2lJQkZINFJTU2dJUW9JNkVuQUozL0hHUHdkY28wREg0Z0VOeDRidmFGYVhVNHpOSjZsNk5UL0VFQUFCQXBJZ0tmb1BnZC9oM3pMd1FLUlp4ZkVKTC9JZGxwMHlPdEZNS1NWa0NXaWcwQ0dCRHdTajExWTM1R01PQVFrR2I4Z05vYTBGRUJFRWlDUURRRU1XU25rakNFc0JUQjVTT3UycnE0K0RHa3BnSWtrUUNBOUFoaXlVc3dXRm9oaW9EeExpNGUwQ0d5djRxU1JIQWlBZ0R3QnJDcVhaOWMwSml5UXBtamtQcUF4MVQyODNUT05yKzZoRk9CZ2w4T0lXQ0NnaWtDd01KQjIwVjJNTFVsVUliMmVEaXlRNnl5VVg4RWFVWTRVQ1lKQUhBSndsTWVoSmZFc0JFUUNXcHdvN0dDL3dYR2U5aDFuSThVRDd6anc4Q3dJeUJGZ3EyUDRxdTl2dzNZa2NnQ2p4c0lQV2xSU0NaK0ROWklRSUtLRFFEUUNzRHFpY1ZMeUZBUkVDY1pvaVFUVGZZWFk0Ymp1Rm9vQjl0R3c0U2tRaUVMQWQzei85Yzk5LzBsWUhWRndxWGtHUDJKcU9NWktCZFpJTEZ4NEdBUmFFZUIxSGVPMGo5VTJPTWxiWVVybk04ekNTb2RyeTFSNXBoYTJRbW1KQ0IrQ1FCUUM0YnFPNVJDUEtMalVQd01MUkQzVFdDbnlzRmFuNi82Y0lpMmpmMmlQV1BUd3NLVUVBaWU1VDhOVjlNZllVVXNaYUZGdC9HQnAwUXhDWUZoTGs0WkFNWFFtd091cUp1aEhhL3VTcnE2WGRTNm9MV1dEZ0dqVTBvRTFJa1N3a3AyS2hiYlJxRzFRbE53SmVMUlYwSE9UUWp4M1I2azBrWHRwVUlDQUFINmtOT3dJbUsybFlhT2dTSGtSd095cXZNaEh5QmNDRWdGU1hvL0FQNUlYZWVTckFZSEF6MEVMQW44RUI3a0dyZEdrQ0JDUUptQjB1bDNqSHlsVHVkQm1PalVPeXFLYUFQczVqdEp3MVpNUUR0Vm8xYWVISHlQMVRGTkxFVUtTR2xva25EK0JZRDBIclN2WUNRZDUvbzBSdFFRUWtLaWtOSG9PUXFKUlk2QW9TUWxBT0pJU3pERStCQ1JIK0VtemhwQWtKWWo0T1JLQWNPUUlYMVhXRUJCVkpITk1CMEtTSTN4a0haY0FoQ011TVkyZmg0Qm8zRGh4aThaQzRqak9meFdPZzFYdGNlSGgrYlFKWUZaVjJvUnpTQjhDa2dQMHRMTTg1bm1ETkpWbEMzYjlUWnMwMG85QUFNSVJBVkpSSDRHQUZMWGxJcFM3WmtIaWcvUjROLzFEZTBmZ2hrY1NFd2kySEtGam5mZFdhT1U0dGxkUHpGUGJCUENEb20zVHFDdllsSkFNQ3RkOWlocThUQ21qM2RYaFJVclhDYkMxY1pTR1VmZjhwVnA5R1Z1T1hBZGo2aFYrU0V4dDJTYjFxaHZlNHFmUUI1cXd3dTNJQkRCTUZSbVZXUS9peDhPczlveGNHMWdsa1ZIaHdjWUVBbXVETEk0M3NNRmhZMEEyM0lXQTJOREtiZW9ZV2lVMHhIVVhkWWd5UFk1KzBZYVpwUjlQK3phb2c3eUJyVVlzN1FVMTFjWVBSUTBNWEFweDNQTTIwalRnaDMzSDJUakZBMzNFN280UmlBYjdObmhqUTdJMmpzSzNZWGVIcUswOWZoeHFhZUI2bXNBUnordWVMOFJHY29nK1RJSXlPUFVCK3NzMElhTXZwa1dqNnZ0N0w1RzFBZEV3dXIybEs0Y2ZCR2wwOWtRTXhjUjFuQTJ3VEl4dGQ0aUdzVTJiWHNVZ0lPbXhOVFpsSHVhcUN2RmdqYytFNjRxK1ZMd1duK0hUd1BCVThSb3c3eExqUzU5M0N4UThmOW8rWlZrSE9kOXBxT05CREhWcDM1Z3NHSUo4R2NQMDd6MjZlZytPOElBSS9wTWtBQUdSQklkb3N3bndVTmQvRW1LUXJKTzd5SGR5MTlTZVhQd2crdGxzWEZuY0NRWGpxRStDUVkwd1RGYkdlL0JuWklIZWpqend4YmFqblhPcFpRdEI0ZktnNzZsdGxXdGl3V25TakNrSWhscTRTSzB4QVh5SkczUEIzUlFJc0tEY0tNUXkxM1cvU2o5d2QxVnAxMkRxZ09XcHJOQVhvek9mRmd2aU9FNm4rQjBsYTIrWTlwNzZQL0JqUkllSUo1TVR3SmMyT1VPa2tJQkFLQ28wN0RYWTRUai9oWDRaeXpWRFg1eXk3WDIwbVZpY3duQlVnbzZIcUVvSTJQN2xWQUlSaWFnbEVJb0tkYzV1OXFmUTlPRmJHd2dMWjJwSy81MFdDYTVVYUZYUXhJUlQ5TUZScXVSdkx3b3hEdDhGMDBIUWlZQXBYMENkbUtJc0tSSVk4N3p5VmJKU1dGRDRING5MWDFOMlpmclhYV2U1MUpZaXIzNCtReGltQ2pSQkFqRkJCUnFuOStNc0VuUjlpb2FoSmpwSUxIcExKYjZQQUFLRklKRFhGNnNRY0ZESTRoRmc2NFZXMEplcFkzZnpQN0pndWxsbzZMcUxab1oxOFQxNnoyZWpjS2k5SnYxeHlueXpYV0FMb2ZZWlNqTjhIN3pTNXhjb0R4YUpVL3djZjk1Si95Ym9IcXdJSm9KZ0NvSC9EM1krcjcrNVEwQ3RBQUFBQUVsRlRrU3VRbUNDIi8+CjwvZGVmcz4KPC9zdmc+",m="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItNiAtNiAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxNiIgZmlsbD0iI0UxREZERCIvPjxwYXRoIGZpbGw9IiM2MDVlNWMiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=",p="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ1IDQ1Ij4KPHBhdGggZmlsbD0iI2E3MjAzNyIgc3Ryb2tlPSIjZmZmIiBkPSJNMjIuNSw0NC41YzEyLjE1LDAsMjItOS44NSwyMi0yMlMzNC42NSwuNSwyMi41LC41LC41LDEwLjM1LC41LDIyLjVzOS44NSwyMiwyMiwyMloiLz4KPHBhdGggY2xhc3M9ImNscy0zIiBkPSJNMjAuOTMsMzAuNDJsMy41Ni0xLjUxYy4xMywuODgtLjM0LDEuNzctMS4yLDIuMTQtLjg2LC4zNi0xLjgzLC4wOC0yLjM3LS42MlptNS40My0xNy44M2MyLjA5LDEuMTQsMy42NSwyLjYsNC42OCw0LjM5LDEuMDMsMS43OCwxLjUxLDMuODcsMS40Niw2LjI1LDAsLjQxLS4zNSwuNzQtLjc3LC43My0uNDEsMC0uNzQtLjM1LS43My0uNzcsLjA1LTIuMTEtLjM3LTMuOTMtMS4yNi01LjQ2LS44OS0xLjU0LTIuMjUtMi44MS00LjEtMy44Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWm0tOS4xNSw0LjQyYzIuODYtMS4yNyw2LjItLjA3LDcuNiwyLjc1bC4xLC4yMSwxLjI5LDIuODksMS43LDEuNDdjLjA5LC4wOCwuMTcsLjE3LC4yNywuMzJsLjA2LC4xMWMuMjgsLjYzLDAsMS4zNy0uNjQsMS42NWwtMTAuMzMsNC41N2MtLjE2LC4wNy0uMzMsLjExLS41MSwuMTEtLjY5LDAtMS4yNS0uNTYtMS4yNS0xLjI1di0yLjM0cy0xLjI0LTIuNzktMS4yNC0yLjc5Yy0xLjMxLTIuOTUsMC02LjM5LDIuOTUtNy43Wm0tMS41OCw3LjA5bDEuMzcsMy4wOHYyLjI4czkuNjItNC4yNiw5LjYyLTQuMjZsLTEuNjUtMS40My0xLjQyLTMuMTgtLjA4LS4xOGMtMS4wMy0yLjA4LTMuNTEtMi45Ny01LjY0LTIuMDMtMi4xOSwuOTctMy4xNywzLjUyLTIuMTksNS43MlptMTAuNS03LjkxYy45NywuNTMsMS43NCwxLjI5LDIuMzIsMi4yOSwuNTcsLjk5LC44NSwyLjA1LC44MiwzLjE1LS4wMSwuNDEtLjM1LC43NC0uNzcsLjczLS40MS0uMDEtLjc0LS4zNS0uNzMtLjc3LC4wMi0uODItLjE5LTEuNi0uNjItMi4zNi0uNDQtLjc2LTEuMDEtMS4zMy0xLjc0LTEuNzItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1oiLz4KPHBhdGggZmlsbD0iI2ZmZiIgZD0iTTIwLjkzLDMwLjQybDMuNTYtMS41MWMuMTMsLjg4LS4zNCwxLjc3LTEuMiwyLjE0LS44NiwuMzYtMS44MywuMDgtMi4zNy0uNjJabTUuNDMtMTcuODNjMi4wOSwxLjE0LDMuNjUsMi42LDQuNjgsNC4zOSwxLjAzLDEuNzgsMS41MSwzLjg3LDEuNDYsNi4yNSwwLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLDAtLjc0LS4zNS0uNzMtLjc3LC4wNS0yLjExLS4zNy0zLjkzLTEuMjYtNS40Ni0uODktMS41NC0yLjI1LTIuODEtNC4xLTMuODItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1ptLTkuMTUsNC40MmMyLjg2LTEuMjcsNi4yLS4wNyw3LjYsMi43NWwuMSwuMjEsMS4yOSwyLjg5LDEuNywxLjQ3Yy4wOSwuMDgsLjE3LC4xNywuMjcsLjMybC4wNiwuMTFjLjI4LC42MywwLDEuMzctLjY0LDEuNjVsLTEwLjMzLDQuNTdjLS4xNiwuMDctLjMzLC4xMS0uNTEsLjExLS42OSwwLTEuMjUtLjU2LTEuMjUtMS4yNXYtMi4zNHMtMS4yNC0yLjc5LTEuMjQtMi43OWMtMS4zMS0yLjk1LDAtNi4zOSwyLjk1LTcuN1ptOC45MS0uODJjLjk3LC41MywxLjc0LDEuMjksMi4zMiwyLjI5LC41NywuOTksLjg1LDIuMDUsLjgyLDMuMTUtLjAxLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLS4wMS0uNzQtLjM1LS43My0uNzcsLjAyLS44Mi0uMTktMS42LS42Mi0yLjM2LS40NC0uNzYtMS4wMS0xLjMzLTEuNzQtMS43Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWiIvPgo8L3N2Zz4=",k="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAyMCI+DQogIDxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZhZWNlYiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMi44NTM1NSAyLjE0NjQ2QzIuNjU4MjkgMS45NTEyIDIuMzQxNzEgMS45NTEyIDIuMTQ2NDUgMi4xNDY0NkMxLjk1MTE4IDIuMzQxNzIgMS45NTExOCAyLjY1ODMxIDIuMTQ2NDUgMi44NTM1N0wyLjkwOTM0IDMuNjE2NDZDMi4zNTI3MiA0LjA4NzA1IDIgNC43ODU3OSAyIDUuNTY1ODJWMTIuMjc2NEMyIDEzLjY5MzUgMy4xNjQwNiAxNC44NDIzIDQuNiAxNC44NDIzSDUuMTk5MzdMNS4yIDE3LjAxMzNDNS4yIDE3LjIyNjIgNS4yNjk4OSAxNy40MzM1IDUuMzk5MjEgMTcuNjA0MkM1LjczIDE4LjA0MDYgNi4zNTY2OCAxOC4xMjk4IDYuNzk4OTUgMTcuODAzNEwxMC44MSAxNC44NDIzSDE0LjEzNTFMMTcuMTQ2NCAxNy44NTM2QzE3LjM0MTcgMTguMDQ4OCAxNy42NTgzIDE4LjA0ODggMTcuODUzNiAxNy44NTM2QzE4LjA0ODggMTcuNjU4MyAxOC4wNDg4IDE3LjM0MTcgMTcuODUzNiAxNy4xNDY1TDE1LjU0NTQgMTQuODM4M0MxNS41NDU0IDE0LjgzODMgMTUuNTQ1NCAxNC44MzgzIDE1LjU0NTQgMTQuODM4M0wzLjgyMzUgMy4xMTYzOEMzLjgyMzUgMy4xMTYzOCAzLjgyMzUxIDMuMTE2MzggMy44MjM1IDMuMTE2MzhMMi44NTM1NSAyLjE0NjQ2Wk0xMy4xMzUxIDEzLjg0MjNIMTAuNDgwOUw2LjIwNTAyIDE2Ljk5ODhMNi4yMDM0NiAxNi45OTk3TDYuMiAxN0w2LjE5OTA4IDEzLjg0MjNINC42QzMuNzAzODMgMTMuODQyMyAzIDEzLjEyODggMyAxMi4yNzY0VjUuNTY1ODJDMyA1LjA2NzE0IDMuMjQwOTMgNC42MTU5OSAzLjYyMDM0IDQuMzI3NDZMMTMuMTM1MSAxMy44NDIzWiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMTcgMTIuMjc2NEMxNyAxMi45NjU4IDE2LjUzOTYgMTMuNTY0NCAxNS44ODk0IDEzLjc2OEwxNi42NDg4IDE0LjUyNzVDMTcuNDU0MSAxNC4wOTE1IDE4IDEzLjI0NjkgMTggMTIuMjc2NFY1LjU2NTgyQzE4IDQuMTQ4NzYgMTYuODM1OSAzIDE1LjQgM0g1LjEyMTM0TDYuMTIxMzQgNEgxNS40QzE2LjI5NjIgNCAxNyA0LjcxMzQ4IDE3IDUuNTY1ODJWMTIuMjc2NFoiLz4NCjwvc3ZnPg0K",g="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTIiIGhlaWdodD0iNTIiIHZpZXdCb3g9IjAgMCA1MiA1MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yNiA1MC45NkMzOS43ODUgNTAuOTYgNTAuOTYgMzkuNzg1IDUwLjk2IDI2QzUwLjk2IDEyLjIxNSAzOS43ODUgMS4wNCAyNiAxLjA0QzEyLjIxNSAxLjA0IDEuMDQgMTIuMjE1IDEuMDQgMjZDMS4wNCAzOS43ODUgMTIuMjE1IDUwLjk2IDI2IDUwLjk2WiIgZmlsbD0iI0ZERjZGMyIgc3Ryb2tlPSIjRjRCRkFCIiBzdHJva2Utd2lkdGg9IjEuOTIiLz4NCjxwYXRoIGQ9Ik0yMy40OTk0IDE1Ljk0NTdDMjQuNTY1NyAxNC4wMTgxIDI3LjMzNjcgMTQuMDE4MSAyOC40MDMgMTUuOTQ1NkwzOC4wNDg4IDMzLjM4MTdDMzkuMDgxOSAzNS4yNDkyIDM3LjczMTMgMzcuNTQgMzUuNTk3MSAzNy41NEgxNi4zMDZDMTQuMTcxOCAzNy41NCAxMi44MjExIDM1LjI0OTMgMTMuODU0MSAzMy4zODE4TDIzLjQ5OTQgMTUuOTQ1N1pNMjcuMTk1IDMyLjU2MDVDMjcuMTk1IDMxLjg3MzcgMjYuNjM4MiAzMS4zMTY5IDI1Ljk1MTQgMzEuMzE2OUMyNS4yNjQ2IDMxLjMxNjkgMjQuNzA3OCAzMS44NzM3IDI0LjcwNzggMzIuNTYwNUMyNC43MDc4IDMzLjI0NzMgMjUuMjY0NiAzMy44MDQxIDI1Ljk1MTQgMzMuODA0MUMyNi42MzgyIDMzLjgwNDEgMjcuMTk1IDMzLjI0NzMgMjcuMTk1IDMyLjU2MDVaTTI2Ljg3MjMgMjIuNzgwOEMyNi44MTAxIDIyLjMyNSAyNi40MTkgMjEuOTczOSAyNS45NDYyIDIxLjk3NDNDMjUuNDMwMyAyMS45NzQ3IDI1LjAxMjUgMjIuMzkzMiAyNS4wMTI5IDIyLjkwOUwyNS4wMTc0IDI4LjUxNDlMMjUuMDI2IDI4LjY0MTZDMjUuMDg4MyAyOS4wOTc0IDI1LjQ3OTMgMjkuNDQ4NSAyNS45NTIxIDI5LjQ0ODFDMjYuNDY4IDI5LjQ0NzcgMjYuODg1OCAyOS4wMjkyIDI2Ljg4NTQgMjguNTEzNEwyNi44ODA5IDIyLjkwNzVMMjYuODcyMyAyMi43ODA4WiIgZmlsbD0iI0RBM0IwMSIvPg0KPC9zdmc+"},175772:(e,n,i)=>{"use strict";i.d(n,{kv:()=>c,kk:()=>m,Ul:()=>u,_Z:()=>g,y9:()=>N});var a=i(364819),t=i(73466),r=i(73087),l=i(969013),o=i(388593),s=i(98687),d=i(598569);const c="beta/users/defaultProfilePictureV2?displayName={displayName}",m=3,u={profilePictureType:o.It.User,generateUrl(e,n,i,a,t=o.xi.Small,r,s,m,u,g,N,v,I){if(r)return d.GX;if((0,l.Ku)(e.id)&&!N)return d.Yt;let f="";const h=u&&!g&&e.id?e.id.split("|")[0]:e.id,S=h&&h.indexOf("#")>=0?encodeURIComponent(h):h,T=e.displayName?encodeURIComponent(e.displayName):"";return f=""===e.id||N?c.replace("{displayName}",T):g?k(T,S,s,m,i,a):p(T,S,i,a),f=`${f}&size=${t}`,v&&I&&!N&&(f=`${f}&ETag=${I}`),`${n}${f}`},getPresenceUserId:e=>e.id},p=(e,n,i,t)=>{let r="";return r=i&&t&&!(0,a.isEmpty)(t)?"beta/users/{currentUserObjectId}/profilepicturev2/{id}?displayname={displayname}".replace("{currentUserObjectId}",t).replace("{id}",n).replace("{displayname}",e):"beta/users/{id}/profilepicturev2?displayname={displayname}".replace("{id}",n).replace("{displayname}",e),r},k=(e,n,i,t,r,l)=>{let o="";return o=r&&l&&!(0,a.isEmpty)(l)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}".replace("{currentUserObjectId}",l):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}",i&&t?o=o.replace("{id}",n).replace("{displayName}",e).replace("{conversationId}",i||"").replace("{hostTenantId}",t||""):(o=r&&l&&!(0,a.isEmpty)(l)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}".replace("{currentUserObjectId}",l):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}",o=o.replace("{id}",n).replace("{displayName}",e)),o},g={profilePictureType:o.It.Group,generateUrl(e,n,i,r,l=o.xi.Small){let c="";const u=(e.length>m?e.slice(0,m):e).map((e=>({userId:e.id,displayName:e.displayName}))),p=(e=>{if(1===e.length){const n=e[0].id;if(n===t.j8)return{shouldUseProjectGroupImage:!0,shouldUseDefaultGroupImage:!1};if(n===t.i2)return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!0}}return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!1}})(e);let{shouldUseDefaultGroupImage:k}=p;const{shouldUseProjectGroupImage:g}=p;if(k=!!g||(0,s.oz)(u),k||(0,a.isEmpty)(u))return d.Mz;if(g)return d.$M;c=encodeURIComponent(JSON.stringify(u));let N="";return N=i&&r&&!(0,a.isEmpty)(r)?"beta/users/{currentUserObjectId}/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{currentUserObjectId}",r).replace("{usersArray}",c).replace("{size}",l):"beta/users/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{usersArray}",c).replace("{size}",l),`${n}${N}`},getPresenceUserId(){}},N={profilePictureType:o.It.Team,generateUrl(e,n,i,a){const{displayName:t,groupId:l,pictureETag:o}=e;return(0,r.UB)(n,t,o||"",l,i,a)},getPresenceUserId(){}}},590076:(e,n,i)=>{"use strict";i.d(n,{J:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]}},156816:(e,n,i)=>{"use strict";i.d(n,{T:()=>D,g:()=>b});var a=i(34412),t=i.n(a),r=i(364819),l=i(513432),o=i(884839),s=i(899273),d=i(562292),c=i(405947),m=i(944297),u=i(388593),p=i(98687);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatAvatarUrlQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarCommunityProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"community"},arguments:[{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profilePictureUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}}]}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarDownloadAmsItemQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlobType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadAmsItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"urlOrObjectId"},value:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"applyRetry"},value:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blob"}}]}}]}}]},I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarIsSharedChannelQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}}]}}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarUrlPreviewQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"urlPreview"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}}]},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"connectorProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"integrationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorProfile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"integrationId"},value:{kind:"Variable",name:{kind:"Name",value:"integrationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"isTenantVerifiedDomain"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"domain"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTenantVerifiedDomain"},arguments:[{kind:"Argument",name:{kind:"Name",value:"domain"},value:{kind:"Variable",name:{kind:"Name",value:"domain"}}}]}]}}]};var M=i(590076);const y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"renderInitials"},value:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}}}]}]}}]},A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}},{kind:"Field",name:{kind:"Name",value:"selfAvatarLastupdatedTime"}}]}}]}}]},b=(e,n="avatar-container-hook")=>{const{profilePictureType:i,defaultAvatarUrl:a}=F(e);return C(e,i,n)||a},F=e=>{const{userId:n,conversationId:i,teamId:a,enableMSAProfilePicture:t,showMergedAvatarForGroup:r,isTeamsApp:l,isUnresolvedEmail:o,sharedChannelId:d,entity:c,isEmergencyCallTarget:m}=e,{coreSettings:u}=(0,s.ur)(),k=(0,p.EO)(n,i,a,t,r||!1,l,o,d,c,u);return{profilePictureType:k,defaultAvatarUrl:(0,p.Ng)(k,m)}},C=(e,n,i)=>{const{skipGeneratingUrl:a}=e,[t,r]=l.useState(""),o=l.useRef(!1);return l.useEffect((()=>(o.current=!0,()=>{o.current=!1})),[]),l.useEffect((()=>{if(a)return;(async()=>{const a=await D(e,n,i);o.current&&a&&r(a)})()}),[e,n,i,a]),t},D=async(e,n,i)=>{const{baseImageUrl:a,isEmergencyCallTarget:l,isImageAuthCookieValid:o,enableCachedAvatarCheck:s,isAnonymousAccount:d,enableSampleAvatarFetch:c,enableAvatarUrlQuery:m,profilePictureSize:k,i18n:g}=e,N=(0,p.Ng)(n,l);let v;if(e.avatarUrl?v=(0,p.eB)(e.avatarUrl,k,n===u.It.User):m&&(v=await Q(e,n,i)),e.enableFBSTelemetryForAvatarStatus&&e.scenarioFactory&&((0,r.isEmpty)(a)||!o)){const n={callerInfo:i,skipGeneratingUrl:!!e.skipGeneratingUrl,propsAvatarUrl:e.avatarUrl,cachedUrl:void 0,generatedUrl:N,baseImageUrl:(0,r.isEmpty)(a)?"INVALID":a,isCookieValid:!!o,profilePictureType:e.generator.profilePictureType,isSelfProfileAvatar:!!e.isSelfProfileAvatar,forSharedChannel:!!e.isSharedChannel,isXtapUserUrl:!1,logger:e.logger,scenarioFactory:e.scenarioFactory};(0,p.Qc)(n)}if((0,r.isEmpty)(v)||v&&(0,p.vG)(v,g)){if((0,r.isEmpty)(a))return N;v=await U(e,n,i)}if(!v)return N;if(o||d||n===u.It.Initials)return o&&((e,n,i)=>{e&&t()(n,{method:"GET",credentials:"include",headers:{"x-ms-client-caller":i}}).catch((()=>{}))})(!!c,v,i),v;if(s){if(await(0,p.iU)(v))return v}return N},U=async(e,n,i)=>{const{userId:a,conversationId:t,entity:r,client:l,logger:o,profilePictureSize:s,isSelfProfileAvatar:d,showUpdatedGroupAvatar:c,enableConnectorsProfileInChannels:m,onBehalfOfId:p,scenarioFactory:k}=e;let g;switch(n){case u.It.Communities:g=await R(r,l,o,c);break;case u.It.Connector:const n=await B(l,t,a,o,m);g=n?.data?.connectorProfile?.avatarUrl;break;case u.It.OutgoingWebhook:g=await z(l,t,o,p,k);break;case u.It.App:case u.It.Bot:g=await W(l,a,o,i);break;case u.It.MsaUser:case u.It.MsaGroup:g=await O(a,t,s||u.xi.Small,r,l,o,i,d,c);break;case u.It.User:case u.It.Group:case u.It.Team:case u.It.SharedChannelInviteeTeam:g=await E(e,l,i);break;case u.It.MergedGroup:g=await j(e);break;case u.It.Initials:g=await V(e)}return g},E=async(e,n,i)=>{const{entity:a,profilePictureSize:t,isEmergencyCallTarget:r,generator:l,baseImageUrl:o,logger:s,isSelfProfileAvatar:d,avatarEtag:c}=e;let m,u=c;const{conversationId:p}=e;if(!Array.isArray(a)){const e=a;m=e.upn,e&&!e.displayName&&s.warn(`Avatar without display name, callerInfo: ${i}`)}if(e.isSharedChannel&&p){const{data:a}=await n.query({query:f,variables:{convId:p},context:{callerInfo:"avatar-url-shared-channel"}});if(a?.channelByID?.substrateGroupId||a?.channelByID?.isShared)return w(m,e,n,i)}if(d&&!u){const e=a,t=await n.query({query:A,variables:{userId:e.id},context:{callerInfo:i}});t?.data?.user?.selfAvatarLastupdatedTime&&(u=t?.data?.user?.selfAvatarLastupdatedTime)}return l.generateUrl(a,o||"",!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,t,r,void 0,void 0,void 0,void 0,void 0,d,u)},w=async(e,n,i,a)=>{const{entity:t,profilePictureSize:r,isEmergencyCallTarget:l,generator:o,baseImageUrl:s,logger:d}=n;if(e){const a=!await L(i,e);return o.generateUrl(t,s||"",!!n.isProfilePictureWithObjectIdEnabled,n.currentUserOid,r,l,n.conversationId,n.hostTenantId,!0,a,void 0)}return d.warn(`Avatar: upn not provided for sharedChannel, callerInfo: ${a}`),o.generateUrl(t,s||"",!!n.isProfilePictureWithObjectIdEnabled,n.currentUserOid,r,l,n.conversationId,n.hostTenantId,!0,!0,void 0)},L=async(e,n)=>{const i=n.substring(n.indexOf("@")+1);try{const{data:n}=await e.query({query:T,variables:{domain:i}});return n&&n.isTenantVerifiedDomain}catch{return!1}},O=async(e,n,i,a,t,r,l,o=!1,s=!1)=>{const d=(0,c.Fz)(n);let m;if(e&&n&&Array.isArray(a)||d){const{data:e}=await t.query({query:g,variables:{convId:n},context:{callerInfo:"get-msa-avatar-url"}});if(d&&e?.chat?.picture)return e.chat.picture;m="Chat"===e?.chat?.chatType&&!e?.chat?.isOneOnOne}if(e&&!m){const n=await x(t,e,a.displayName,i,r,l,o);return n?.data?.msaUserProfilePicture}if(n){const e=[],i=a;Array.isArray(i)&&i.forEach((n=>{e.push({userId:n.id,displayName:n.displayName?n.displayName:""})}));const l=await P(t,n,e,r,s);return l?.data?.msaGroupProfilePicture}},x=async(e,n,i,a,t,r,l,o)=>{try{return await e.query({query:y,variables:{userId:n,displayName:i,callerInfo:"avatar-container",profilePictureSize:a,renderInitials:o},fetchPolicy:l?"network-only":"cache-first"})}catch(e){return void t.errorToTelemetry?.(`msaUserProfilePictureQuery failed for msa user: ${e.message}, callerInfo: ${r}`,"msa_user_profile_picture_query",void 0,!0)}},P=async(e,n,i,a,t)=>{i.forEach((e=>{e&&(0,r.isEmpty)(e.displayName)&&n&&a.warn(`Avatar without display name for conversationId: ${n}`)}));try{const a={conversationId:n,pictureReadyUsers:i};return await e.query({query:M.J,variables:{msaGroupInfo:a,callerInfo:"avatar-container"},fetchPolicy:t?"network-only":"cache-first"})}catch{return void a.error(`msaGroupProfilePictureQuery failed for conversationId:  ${n}`)}},V=async e=>{const{entity:n,profilePictureSize:i,isEmergencyCallTarget:a,generator:t,baseImageUrl:r}=e;return t.generateUrl(n,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,i,a,void 0,void 0,!1,!1,!0)},j=async e=>{const{entity:n,profilePictureSize:i,isEmergencyCallTarget:a,generator:t,baseImageUrl:r}=e;return t.generateUrl(n,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,i,a,void 0,void 0,!1,!1,!0)},B=async(e,n,i,a,t)=>{try{if(t&&n&&i){return await e.query({query:S,variables:{convId:n,integrationId:i}})}return}catch(e){return void a.error(`connectors query failed for conversationId: ${n}`)}},z=async(e,n,i,a,t)=>{if(t&&a&&n)try{const r=await(0,d.DW)(e,n);return(await(0,o.tN)(e,i,t,a,!0,"outgoing-webhook-avatar-url",{conversation:{scope:"Team",id:r||""}}))[0].definition.largeImageUrl}catch(e){i.error(`installed apps query failed for conversationId: ${n}`)}},R=async(e,n,i,a)=>{const t=e.teamThreadId||"",r=e.pictureETag;if(r)try{const e=await n.query({query:N,variables:{threadId:t,imageUri:r},fetchPolicy:a?"network-only":"cache-first"});return e?.data?.community?.profilePictureUrl}catch(e){return void i.errorToTelemetry?.(`community profile picture query failed for this : ${t}`,"community_profile_picture_query_failed")}else i.infoToTelemetry?.(`getCommunitiesAvatarUrl function returned undefined for this threadId : ${t}, and imageUri: ${r}`,"get_communities_avatar_url_returned_undefined",void 0,!0)},Q=async(e,n,i)=>{const{client:a,profilePictureSize:t}=e;if(n===u.It.User&&e.userId){const{data:n}=await a.query({query:I,variables:{mriOrEmailArray:[e.userId]},context:{callerInfo:i}});return(0,p.eB)(n.getUsers?.[0].avatarUrl,t,!0)}if(n===u.It.Group&&e.conversationId){const{data:n}=await a.query({query:k,variables:{convId:e.conversationId},context:{callerInfo:i}});return n.chat?.avatarUrl}},W=async(e,n,i,a)=>{const t=await(async(e,n,i,a)=>{try{return await e.query({query:A,variables:{userId:n},context:{callerInfo:a}})}catch(e){return void i.error(`userQuery failed: ${e.message}`)}})(e,n,i,a),r=t?.data?.user?.avatarUrl||t?.data?.user?.imageUri;if(r){if(r.startsWith("blob:"))return r;let n;if((0,m.D$)(r))n=r;else{const i=await e.query({query:h,variables:{url:r},context:{callerInfo:a}});n=i?.data.urlPreview?.thumbnail||i?.data.urlPreview?.url}if(n){const{data:i}=await e.query({query:v,variables:{urlOrObjectId:n,type:"Url",applyRetry:!0}});return i?.downloadAmsItem?.blob}}}},420645:(e,n,i)=>{"use strict";i.d(n,{A:()=>v});var a=i(160606),t=i(969037),r=i(410703),l=i(983168),o=i(741357),s=i(264345),d=i(875094),c=i(930427),m=i(69886),u=i(819972),p=i(733043),k=i(366554),g=i(731687),N=i(358809);const v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsChatQueriesChatQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"groupTemplate"}},{kind:"Field",name:{kind:"Name",value:"themeId"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"isBotBlocked"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"newlyCreatedUserId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatPolicy"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isChannel"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"isRead"}},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"isAdmin"}},{kind:"Field",name:{kind:"Name",value:"isUserAnonymous"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}},{kind:"Field",name:{kind:"Name",value:"lastMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"lastMessageFields"}}]}},{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"}},{kind:"Field",name:{kind:"Name",value:"oneOnOneChatHeaderCallButtonValue"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"hasEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnresolvedFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"isImpersonation"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUserLimitedNames"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUsersLength"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatPolicyDefinedScenario"}},{kind:"Field",name:{kind:"Name",value:"isChatDisabledForRecipients"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"quarantineCounter"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"userAdminSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminDeleteEnabled"}},{kind:"Field",name:{kind:"Name",value:"deleteMessagesEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"resolvedSensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonRecordingMessageMiFragment"}},{kind:"Field",name:{kind:"Name",value:"messagingPolicy"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"textOnlyChat"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"extendedDirectoryRedemptionRequired"}},{kind:"Field",name:{kind:"Name",value:"hasExtendedDirectoryUsers"}},{kind:"Field",name:{kind:"Name",value:"chatScheduleSuggestionSuppressUntil"}},{kind:"Field",name:{kind:"Name",value:"chatHistoryHiddenTime"}},{kind:"Field",name:{kind:"Name",value:"clearHistoryTime"}},{kind:"Field",name:{kind:"Name",value:"userProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProperties"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedConversationItems"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"pinnedMessageItemFields"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"addedByTenantId"}},{kind:"Field",name:{kind:"Name",value:"identityMaskEnabled"}},{kind:"Field",name:{kind:"Name",value:"sensitivityLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCopyBlocked"}}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"}},{kind:"Field",name:{kind:"Name",value:"lastJoinAt"}},{kind:"Field",name:{kind:"Name",value:"isCommentStream"}},{kind:"Field",name:{kind:"Name",value:"isCommentStreamMeetingStarted"}},{kind:"Field",name:{kind:"Name",value:"isConversationThreadDeleted"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUseExternalTagFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatMtoTelemetryFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatWithMtoUserBannerFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatRecapFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUseMtoUserBannerFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatPaneLayoutFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatAddMembersFragment"}},{kind:"Field",name:{kind:"Name",value:"awarenessLiveState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}},{kind:"Field",name:{kind:"Name",value:"groupCopilotInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"allowInstallation"}},{kind:"Field",name:{kind:"Name",value:"allowInteraction"}}]}},{kind:"Field",name:{kind:"Name",value:"pendingBots"}},{kind:"Field",name:{kind:"Name",value:"isConversationalUXEnabled"}},{kind:"Field",name:{kind:"Name",value:"isChatPartialHistoryShared"}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}},{kind:"Field",name:{kind:"Name",value:"showRedDot"}}]}}]}},...a.L.definitions,...t.x.definitions,...r.U.definitions,...l.q.definitions,...o.x.definitions,...s.p.definitions,...d.M.definitions,...c.n.definitions,...m.Y.definitions,...u.I.definitions,...p.W.definitions,...k.P.definitions,...g.F.definitions,...N.h.definitions]}},665980:(e,n,i)=>{"use strict";i.d(n,{DW:()=>t,bE:()=>r,XF:()=>l,Yp:()=>o,u0:()=>s,gL:()=>d});var a=i(142038);const t=()=>(0,a.h)("amsV2Domain")||"",r=()=>(0,a.h)("baseImageUrl")||"",l=()=>(0,a.h)("isImageAuthCookieValid")||!1,o=()=>(0,a.h)("postCriticalPhaseReached")||!1,s=()=>(0,a.h)("completePhaseReached")||!1,d=()=>(0,a.h)("meControlAvatarSrc")||""},142038:(e,n,i)=>{"use strict";i.d(n,{h:()=>r});var a=i(513432),t=i(51713);const r=e=>{const{stateManagementServices:{userWindowStore:n}}=(0,t.C)();return l(n,e)},l=(e,n)=>{const[i,t]=(0,a.useState)(e?.get(n));return(0,a.useEffect)((()=>{const i=e?.subscribe(n,(e=>{t(e)}));return()=>i&&i()}),[e,t,n]),i}},425347:(e,n,i)=>{"use strict";i.d(n,{r$:()=>p,Os:()=>k,Dh:()=>f,wQ:()=>m,wS:()=>v,fm:()=>u});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getUsersForConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProfileData"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProfileData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"companyName"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"xtapUser"}}]}}]}.definitions]};var t=i(678937),r=i(800079),l=i(189888),o=i(754255),s=i(969013);const d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPersonaUserTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},c="Topic",m=e=>{const{ariaLabel:n,behavior:i,disableAccessibilityDefaults:a,externalAppSessionCorrelationId:t,hostConversationId:r,hostTenantId:l,isSharedChannel:o,tabIndex:s,userId:d,handleOnCardOpen:m,handleOnCardClose:u,personaType:p,topicId:k,contextId:g,highlightedText:N,shouldDeferCardOpenToParentWindow:v,displayName:f}=e,h=p===c?{contextId:g,highlightedText:N,hideEntityAndContextQuestion:!0}:void 0;return{cardParameters:{disableAccessibilityDefaults:!!a,personaInfo:{identifiers:{PersonaType:p||"NotResolved",HostAppPersonaId:I({userId:d,isSharedChannel:!!o,hostTenantId:l,hostConversationId:r}),TeamsMri:p!==c?d:void 0,TopicId:k},topicMetadata:h,displayName:f},behavior:{onCardOpen:m,onCardClose:u,disableHover:!1,cardPlacementMode:"AnchorSide",shouldDeferCardOpenToParentWindow:!!v,...i},externalAppSessionCorrelationId:t,ariaLabel:n,clientScenario:"MicrosoftTeams_MultiWindow",cardOpenTime:Date.now()},tabIndex:s}},u=(e,n,i)=>{e.LPC.openCard(n,{...m(i).cardParameters})},p=(e,n)=>{e.LPC.dismissCard((()=>{}),n)},k=async(e,n,i,t,l,s,d,c,m)=>{const{enableTflSms:u}=d.get(o.w.Messaging),{showPersonCardForSMSUser:p,showPersonCardForXTapUser:k}=d.get(o.w.People),{disablePstnPersonaCard:I,disablePersonaCard:f}=d.get(o.w.Calling),{enableFlyoutInlineChat:h,enableSimplifiedFeaturesInFlyoutChat:S}=d.get(o.w.Flyout);if(f||h&&S)return!1;if(e&&r.af.isTFLSmsMri(e))return!!u&&!!p;if(e&&r.af.isTFLOffNetworkUser(e))return!1;if(n&&"attendee"===i&&r.af.isAnonymousTfwUser(e))return!1;if(g(e,d))return!1;if(N(!!I,e))return!1;if(t&&!k){const n=v(e,l||"",s,m,t);if(!n)return m.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:i}=await c.query({query:a,variables:n,context:{callerInfo:"lpc-persona-container"}});if(!i||!i.getUsersForConversation)return m.warn("xTap profile Query returned null data"),!1;const o=i.getUsersForConversation,d=!!(o.length>0&&o[0]&&r.af.isFederatedUser(o[0])&&o[0].xtapUser);return!d||!!k&&d}return!0},g=(e,n)=>{const i=n.get(o.w.Metadata).environment===t.B.life,a=n.get(o.w.PhonelinkSms).enablePhonelinkSms||!1,r=n.get(o.w.HostCapabilities).phoneLinkingBlocked||!1,l=a&&!r;return e&&(0,s.Ku)(e)&&i&&l},N=(e,n)=>e&&(0,s.Ku)(n);function v(e,n,i,a,t){if(!n&&t)return void a.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:t?n:"",isShortProfileRequested:!1,peoplePickerFilters:void 0,isSharedChannel:t,hostTenantId:i}}const I=({userId:e,isSharedChannel:n,hostTenantId:i,hostConversationId:a})=>JSON.stringify({userId:e,isSharedChannel:n,hostTenantId:i,hostConversationId:a});const f=async(e,n,i)=>{const{data:a}=await i.query({query:d,variables:{userId:e},context:{callerInfo:"lpc-persona-container:on-hover"}}),{user:t}=a,{userType:o,profileType:s,type:c}=t||{},m=r.af.isMTOUser({profileType:s})?l.$o.MTOUser:r.af.isB2BMember({profileType:s,userType:o})?l.$o.B2BMember:r.af.isAcsUserMri(e)?l.$o.ACSUser:r.af.isAnonymousTfwUser(e)?l.$o.anonymousUser:o||c,u=n.createDatabag?.();let p;return o&&(p=r.af.getTfwExtendedDirectoryMembership({mri:e,userType:o})),u&&(u.isEDUser=!!p,u.EDUserState=p,u.userTypeSelected=m),u}},401962:(e,n,i)=>{"use strict";i.d(n,{S:()=>N});var a=i(899273),t=i(754255),r=i(937545),l=i(131647),o=i(845768),s=i(884839),d=i(139150),c=i(364819),m=i(513432),u=i(129123),p=i(883970),k=i(554186),g=i(612877);const N=()=>{const e=(0,d.m)(),{entityCommanding:n}=(0,a.ur)(),{enableAppDetailsToChatNavigation:i}=(0,u.w2)(t.w.Extensibility,["enableAppDetailsToChatNavigation"]),c=(0,g.u)();return m.useCallback((async(a,t,d)=>{const m=await(0,s.xR)(e,a,void 0,void 0,"launch-personal-app"),u=m.bots?.[0]?.id,g=I(u),{isM365BotPostInstallNavEnabled:N,navigateToM365BotChat:S}=c(a,g);if(v(m))t?N()?await S(!1):n.platform.launchPersonalPlatformApp(a,!!d):n.platform.launchPersonalApp({appId:a,botMri:g,isNewlyInstalled:!1});else if(f("Personal",m.messageExtensions)){const t=n.platform.launchAppDetailsTutorial({appName:m.name??"",isFirstInstallation:!1,hasCommandBoxCapability:h(m,"Commandbox"),hasComposeCapability:h(m,"Compose")}).subscribe({next:t=>{t.containerState&&t.containerState===r.iW.Confirmed&&(i?n.chat.default({correlation:{source:l.p.PlatformAppDetailsDialog},stateTransition:r.Ar.flush,visibilityState:r.Rp.show}).then((()=>{e.mutate({mutation:p.S,variables:{input:{appId:a,id:(0,k.v4)(),capability:o.$E.MessagingExtension}}})})):n.platform.appDetailsPostInstall({name:"navigateToLastChatState",appCapability:o.$E.MessagingExtension,appId:a,externalId:m.externalId??""}).then((()=>{e.mutate({mutation:p.S,variables:{input:{appId:a,id:(0,k.v4)(),capability:o.$E.MessagingExtension}}})})))},complete:()=>{t.unsubscribe()}})}else;}),[e,c,n.platform,i,n.chat])},v=e=>{const n=(e.meetingExtensionDefinition?.scenes?.length??0)>0,i=(e.meetingExtensionDefinition?.filters?.length??0)>0;return f("Personal",e.staticTabs)||f("Personal",e.bots)||n||i},I=e=>{if(e){const n=e?.startsWith("28:");return n?e:`28:${e}`}},f=(e,n)=>(0,c.some)(n,(n=>(0,c.includes)(n.scopes,e))),h=(e,n)=>e.messageExtensions?.some((e=>e.commands?.some((e=>e.context?e.context.some((e=>e===n)):"Commandbox"===n||"Compose"))))??!1},612877:(e,n,i)=>{"use strict";i.d(n,{u:()=>g});var a=i(513432),t=i(899273),r=i(851075),l=i(937545),o=i(131647),s=i(129123),d=i(754255),c=i(139150),m=i(451281);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetConversationForBotIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationForBot"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetPinnedChatIdsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinnedChats"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsPlatformSharedHooksSetChatPinnedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pinned"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setChatPinned"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"pinned"},value:{kind:"Variable",name:{kind:"Name",value:"pinned"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationPinnedUpdate"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"pinned"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SetChatPinnedMaxLimitReachedError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"maxPinnedChats"}}]}}]}}]}}]},g=()=>{const e=(0,c.m)(),{entityCommanding:n}=(0,t.ur)(),{enableM365BotPostInstallNavigation:i,m365ChatBotIds:g}=(0,s.w2)(d.w.Messaging,["enableM365BotPostInstallNavigation","m365ChatBotIds"]),[N]=(0,m.n)(k),v=(0,r.U)("useLaunchBizChatNavigation");return a.useCallback(((a,t="")=>({isM365BotPostInstallNavEnabled:()=>{const e=[...g||[]];return i&&e.includes(t)},navigateToM365BotChat:async i=>{try{const{data:t}=await e.query({query:u,variables:{appId:a,installedScope:"Personal"},fetchPolicy:"no-cache"});if(t.installedApp?.conversationForBot?.id){let r=!1;const s=t.installedApp.conversationForBot.id;try{const{data:n}=await e.query({query:p});r=!!n?.pinnedChats.edges.some((e=>e.node.id===s))}catch{v.errorToTelemetry?.("failed to get pinned chat ids for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:s})}if(i&&!r)try{await N({variables:{convId:t.installedApp.conversationForBot.id,pinned:!0}})}catch{v.errorToTelemetry?.("failed to set chat pinned for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:s})}await n.chat.chatById(t.installedApp.conversationForBot.id,{entityCommand:{stateTransition:l.Ar.forceFlush,visibilityState:l.Rp.show,correlation:{source:o.p.PlatformAppDetailsDialog}}})}}catch(e){throw v.errorToTelemetry?.(`failed to grab the conversation id from the installed app. appId: ${a}`,"platform_userlifecycle_details_dialog_event",{appId:a}),e}}})),[e,i,n.chat,v,g,N])}},815616:(e,n,i)=>{"use strict";i.d(n,{QA:()=>t,YT:()=>r,lb:()=>l,t2:()=>o,P3:()=>s,Lv:()=>d,dy:()=>c,TU:()=>m});var a=i(99595);const t="com.microsoft.teamspace.tab.web",r="com.microsoft.teamspace.tab.file.staticviewer.pdf",l="com.microsoft.teams.callable-channel",o="44263ed4-f1ac-4e96-93aa-d24dd50459ea",s="b85718a3-6d15-4f59-8fad-b6809c6fc6a9",d="com.microsoft.chattabs.storyline",c="683f3525-d193-4a67-8d91-22093beab1ca",m=[a.b5.PersonalTab,a.b5.ChannelTab,a.b5.PrivateChatTab,a.b5.MeetingChatTab,a.b5.MeetingDetailsTab]},599276:(e,n,i)=>{"use strict";i.d(n,{u:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformTabUtilsChannelByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"defaultOneNoteSectionId"}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"hostTeamGroupId"}},{kind:"Field",name:{kind:"Name",value:"hostTeamId"}},{kind:"Field",name:{kind:"Name",value:"hostTenantId"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}}]}}]}}]}},571400:(e,n,i)=>{"use strict";i.d(n,{W_:()=>d,IW:()=>c,fk:()=>m,RD:()=>u,vd:()=>k,Fs:()=>N,ZB:()=>v,gn:()=>h,Ql:()=>S});var a,t=i(99425),r=i(441161),l=i(719156),o=i(99595),s=i(645095);!function(e){e.Member="member",e.Guest="guest",e.External="external",e.Anonymous="anonymous",e.Unknown="unknown"}(a||(a={}));const d=(e,n,i)=>n===s.vW.None&&e===l.CallType.Conference&&!i,c=(e,n,i)=>n===s.vW.None&&e===l.CallType.P2P&&i,m=(e,n)=>{if(u(e))return a.Anonymous;if(p(e))return a.Guest;if(e&&n){if(k(e.profile?.tenantId,n))return a.External;if(g(e.profile?.tenantId,n))return a.Member}return a.Unknown},u=e=>e?.role===t.a7.Anonymous,p=e=>e?.role===t.a7.Guest,k=(e,n,i)=>(i?.log(`isExternalUser: tenantId-${n}, currentTenantId-${e}`),!(!n||!e||e===n)),g=(e,n)=>!!n&&!!e&&e===n,N=(e,n,i,a,t)=>{const r=e?.baseInfo?.id,l=n?.appDefinition;if(t?.log(`(isValidTabForInMeetingExperience) Tab: ${r}, App: ${l?.name} ${l?.id}, isAnonymousUser: ${i}, enableMeetingSurfaces: ${a}`),!a||((e,n,i)=>{const a=n.appDefinition?.galleryTabs?.[0];let t=!1;if("StaticExtensionTab"===e.__typename){const a=n.appDefinition?.staticTabs?.find((n=>n.entityId===e?.entityId));t=a?.context?.some((e=>e===o.b5.MeetingSidePanel)),i?.log(`(isMeetingOptimizeApp) Static tab ${e?.baseInfo?.id} isMeetingOptimized: ${t}`)}else t=a?.context?.some((e=>e===o._N.MeetingSidePanel))||a?.meetingSurfaces?.some((e=>e===o.H$.SidePanel)),i?.log(`(isMeetingOptimizeApp) Gallery Tab ${e?.baseInfo?.id} isMeetingOptimized: ${t}. `);return!!t})(e,n,t)){const e=!i||(e=>e?.appDefinition?.meetingExtensionDefinition?.isAnonymousAccessAllowed)(n);return t?.log(`(isValidTabForInMeetingExperience) is access to tab '${r}', valid: ${e}`),e}return!1},v=(e,n,i,a,o,s,c,m,u,p)=>{if(!s)return!1;const k=e?.type===t.aS.MsaLife;if(p&&k)return!0;if(h(e,s))return!1;const g=d(i,c,a);if(f(a,g,o))return!1;const N=n===r.A2.Organizer||n===r.A2.Presenter,v=m&&i===l.CallType.P2P;return N||v||u&&I(n,g)},I=(e,n)=>e===r.A2.Attendee&&n,f=(e,n,i)=>i&&(e||n),h=(e,n)=>{if(u(e))return!0;if(p(e))return!0;return!!k(e?.profile.tenantId,n)},S=(e,n)=>`${e};replyChainId=${n}`},562292:(e,n,i)=>{"use strict";i.d(n,{dx:()=>S,Y2:()=>T,ZK:()=>M,ZT:()=>y,DW:()=>A,Xc:()=>b,ZB:()=>C,re:()=>U,gf:()=>E,rP:()=>w,gL:()=>L,Ot:()=>O,V:()=>x,JU:()=>V,SN:()=>j,Hz:()=>B,Zc:()=>z,BJ:()=>R,HD:()=>Q,Os:()=>W,eT:()=>Y,V7:()=>G,iq:()=>_,Sb:()=>Z,vU:()=>H,R7:()=>J,t_:()=>X,$Y:()=>q,Zm:()=>K,JY:()=>$,yA:()=>ee,bF:()=>ne,JT:()=>ie,b5:()=>ae,Fs:()=>te,V_:()=>re,td:()=>le,Vg:()=>oe,DJ:()=>se,ef:()=>ce,RL:()=>me,yL:()=>ue,Rx:()=>pe,Q2:()=>ke,BU:()=>ge,W2:()=>Ne,Cm:()=>ve,C1:()=>Ie,kH:()=>fe,Wo:()=>Se,yJ:()=>Te,CR:()=>ye,pZ:()=>Ae,LQ:()=>be,uh:()=>Fe});var a=i(831854),t=i(648260),r=i(712839),l=i(572909),o=i(715871),s=i(111143),d=i(702183),c=i(726723),m=i(99595),u=i(363678),p=i(645095),k=i(719156),g=i(599276),N=i(571400),v=i(585730),I=i(199448),f=i(405947),h=i(815616);const S=async(e,n,i,a,t)=>{const{data:r,error:l}=await e.query({query:o.$,variables:i?.isChannelMeeting&&i?.messageId?{id:n,queryType:"QueryByMessage",storageOptions:{messageStorage:{messageId:i.messageId},platformTabsQueryType:"QueryByMessage"},options:a}:{id:n,queryType:"QueryByThread",options:a},fetchPolicy:"network-only"});return l&&t?.error(`(getTabsData) Error fetching tabs: ${l.message}`),r},T=async(e,n,i,t,r,l,o)=>{const s=V(t),d=o?"Personal":s?"Team":"GroupChat",c=s?await y(e,n):void 0,{data:m,error:u}=await e.query({query:a.y,variables:{scope:d,conversationId:s?c:n,appId:i}});return u&&(l?.fail({errors:`Error getting app data for app ${i}: ${u.message}`,"App.Id":i,reason:"AppDefinitionError"}),r?.error(`(getAppData) Error getting app data for app ${i}: ${u.message}`)),m&&m.appDefinition||(l?.fail({errors:`App definition not found for app ${i}`,"App.Id":i,reason:"AppDefinitionMissing"}),r?.error(`(getAppData) App definition not found for app ${i}`)),m},M=async(e,n,i,t)=>{const{data:r}=await e.query({query:a.y,variables:{scope:t,conversationId:n,appId:i}});return r},y=async(e,n)=>A(e,n),A=async(e,n)=>{if(!n)return;const{conversationId:i}=U(n);if(!i)return;const a=await e.query({query:g.u,variables:{conversationId:i}}),t=a.data?.channelByID.owningTeam?.id;return t||void 0},b=(e,n,i)=>{if(F(n)){if(!i)return{botMri:e,appId:n.id};{const a=n.definition?.staticTabs?.some((e=>e.entityId===i));if(a)return{botMri:e,appId:n.id,tabEntityId:i}}}},F=e=>!!(e.definition?.galleryTabs?.some((e=>e?.context?.some((e=>e===m._N.MeetingSidePanel))))||e.definition?.galleryTabs?.some((e=>e?.meetingSurfaces?.some((e=>e===m.H$.SidePanel))))||e.definition?.staticTabs?.some((e=>e?.context?.some((e=>e===m.b5.MeetingSidePanel))))),C=async(e,n,i,a)=>{const{data:t,error:r}=await e.query({query:s.F,variables:{tabId:n,threadId:i}});return r&&a?.error(`(getPlatformTab) Error fetching tab: ${r.message}`),t},D=";messageid=",U=e=>{const n=e?.split(";replyChainId=")??[];let i=n[0];const a=n[1];if(i?.includes("channelId")){i=JSON.parse(i).channelId}return i?.includes(D)&&(i=i.split(D)[0]),{conversationId:i,replyChainId:a}},E=e=>{const{replyChainId:n}=U(e);return V(n)?"Team":"GroupChat"},w=async(e,n,i,a,t,r,l,o,s,c,m)=>{const u=[],p=[];if(!e)return u;for(const o of e)if(s&&"StaticExtensionTab"===o.__typename||"ExtensionTab"===o.__typename){const e={tabId:o.baseInfo.id,displayName:decodeURIComponent(o.baseInfo.displayName||""),entityId:o.entityId,tabType:o.__typename,tabPinnedState:o.pinnedState||"UserPinned"},s=await T(n,i,o.baseInfo.appId,r,l,c,m);if((0,N.Fs)(o,s,a,!!t,l)){const n={appId:o.baseInfo.appId,appName:s.appDefinition?.name||"",iconUrl:s.appDefinition?.smallImageUrl||""};e.displayName||(e.displayName=decodeURIComponent(n.appName));const i={tabInfo:e,appInfo:n};u.push(i)}else p.push(o.baseInfo.appId)}return p?.length>0&&(c?.mark(d.BQ.PlatformTabFetchUbarDroppedTabsDueToMeetingContext),l?.log(`convertToTabButtons(${o}) dropped apps: ${p.join(",")}`)),u},L=async(e,n,i,a,t,r,l,o,s,c,m)=>{c?.mark(d.BQ.PlatformTabFetchStart);const u=await S(e,n,t,o,r);r?.log(`getPlatformTabs(${l}): fetched ${u.platformTabs?.length} tabs`),c?.mark(d.BQ.PlatformTabFetchDataComplete);return await w(u.platformTabs,e,n,i,a,t?.messageId,r,l,s,c,m)},O=(e,n)=>{const i=[],a=[];for(const n of e.platformTabsEvent)if("StaticExtensionTab"===n?.__typename||"ExtensionTab"===n?.__typename){const e=n.baseInfo.appId??"",t=n.baseInfo.id??"";i.push(e),a.push(t)}n.log(`tabsEvent appData: ${i.join(",")}`),n.log(`tabsEvent tabData: ${a.join(",")}`)},x=(e,n,i,a,t,r,l,o,s,d)=>{const c=e&&["Scheduled","Recurring"].includes(e)&&(!r||d),m=o&&P(e,n,i),u=l&&(0,N.W_)(n,i,a),p=s&&(0,N.IW)(n,i,a);return t?.log(`isSupportedMeeting: meetingType-${e}, isChannelMeeting- ${r}, isSupportedInPrivateOrChannelMeeting-${c}, \n    callType -${n}, isSupportedInCalendarMeetNow: ${m}, isSupportedInGroupCall: ${u},\n    isSupportedInOneOnOneCall: ${p}: chatSubType - ${i}, isOneOnOne - ${a}`),!!(c||m||u||p)},P=(e,n,i)=>e&&"MeetNow"===e&&n===k.CallType.Conference&&i===p.vW.Meeting,V=e=>!!e&&"0"!==e;function j(e){return V(e)?{platformTabsQueryType:"QueryByMessage",messageStorage:{messageId:e}}:void 0}function B(e){return e?{appInstallScope:"Team"}:{appInstallScope:"GroupChat"}}const z=e=>V(e)?"QueryByMessage":"QueryByThread",R=e=>{switch(e){case t.v.Channel:case t.v.ChannelMeeting:case t.v.ChannelMeetingSchedulingForm:case t.v.SelectAppEntity:return"Team";default:return"GroupChat"}},Q=(e,n)=>n?{appInstallScope:"Personal"}:e?{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeeting"}:{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeeting"},W=e=>{switch(e){case u.hB.privateMeetingSchedulingForm:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeetingSchedulingForm"};case u.hB.chatTab:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"GroupChat"};case u.hB.channelMeetingSchedulingForm:return{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeetingSchedulingForm"};case u.hB.channelTab:return{appInstallScope:"Team",platformTabsEntryPoint:"Channel"};default:return}},Y=e=>{const n=new Error(e.message);return n.name=e.name,n},G=e=>{switch(e){case"GroupChat":return r.bY.group;case"Personal":return r.bY.personal;case"Team":return r.bY.team;default:return}},_=e=>Z({chatId:e?.chatId,teamId:e?.teamId,channelId:e?.channelId}),Z=e=>{const{chatId:n,teamId:i,channelId:a}=e||{};return n?"GroupChat":i||a?"Team":"Personal"},H=e=>K(e)||ne(e)?e.baseInfo.id:"",J=e=>K(e)||ne(e)?e.baseInfo.appId:"",X=e=>ne(e)&&e.entityId||"",q=e=>(K(e)||ne(e))&&e.websiteUrl?e.websiteUrl:null,K=e=>"WebsiteTab"===e?.__typename,$=e=>"FileViewTab"===e?.__typename,ee=e=>e===h.YT,ne=e=>"ExtensionTab"===e?.__typename||ie(e),ie=e=>"StaticExtensionTab"===e?.__typename,ae=e=>"StaticExtensionTab"===e,te=e=>"PlaceholderTab"===e?.__typename,re=e=>!!ie(e)&&e.baseInfo?.context?.includes(m.b5.TeamLevelApp),le=(e,n)=>e?.linkedEntity?.type===l.ck.extensions&&!n,oe=(e,n,i,a,t)=>({threadId:e,tab:{id:n,displayName:"",tabType:"StaticExtensionTab",appInstallScope:i,externalId:t},storageOptions:j(a)}),se=(e,n,i)=>{if(e)return de(e.id,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,n,i)},de=(e,n,i,a,t,r)=>{if(e)return n?c.bF.Meeting:i?a?c.bF.Botchat:c.bF.OneOnOneChat:t||"channelTab"===r?c.bF.Channel:c.bF.GroupChat},ce=[h.lb,h.t2,h.P3,h.YT,h.QA],me=(e,n,i,a,t,r,l,o)=>{if(ce.includes(n))return;const s=(0,I.Mr)(n),c=(0,v.A)(),m=n=>{const o=e.findScenario(n);o&&(o.cancel({errors:"NewScenarioStarting"}),e.clearScenario(o));const d=e.newScenario(n,{clientId:`${n};${c}`});e.hoistScenarioToCore&&e.hoistScenarioToCore(d),d.appendEventData({"App.Id":s,"App.EntryPoint":l?`${i}DefaultLaunch`:i,"PlatformApp.IsMultiWindow":!!t,"PlatformApp.IsDefaultCommand":!!l,"PlatformApp.FromOpenFileInTeams":!!r}),a.log(`phase 1 scenario marker started for entryPoint ${i}`)};!o&&m(d.Cu.PlatformTabFrameLoading),m(d.Cu.PlatformTabLaunch)},ue=(e,n,i)=>{(a=>{e.findScenario(a)?.cancel();const t=(0,v.A)();e.newScenario(a,{clientId:t}).appendEventData({"App.EntryPoint":n}),i?.log(`fetch platform tabs - scenario marker started for entryPoint ${n}`)})(d.Cu.PlatformTabFetchData)},pe=(e,n)=>{switch(e){case t.v.Meeting:case t.v.ChannelMeeting:return m.b5.MeetingSidePanel;case t.v.PrivateMeetingSchedulingForm:case t.v.ChannelMeetingSchedulingForm:return m.b5.MeetingDetailsTab;case t.v.Channel:return m.b5.ChannelTab;case t.v.Chat:return n&&Me(n)?m.b5.MeetingChatTab:m.b5.PrivateChatTab;case t.v.MeetingChat:return m.b5.MeetingChatTab;default:return m.b5.Unknown}},ke=e=>{switch(e){case t.v.Chat:return u.hB.chatTab;case t.v.Channel:return u.hB.channelTab;case t.v.PrivateMeetingSchedulingForm:return u.hB.privateMeetingSchedulingForm;case t.v.ChannelMeetingSchedulingForm:return u.hB.channelMeetingSchedulingForm;default:return u.hB.platformAppView}},ge=(e,n)=>"Desktop"===e&&!1===n,Ne=e=>{switch(e){case r.bY.group:return"GroupChat";case r.bY.personal:return"Personal";case r.bY.team:return"Team";default:return}},ve=(e,n,i)=>({threadId:e.threadId,messageId:e.messageId||i?.messageId,appId:n.appId||e.appId,tabId:e.tabId||n.tabId,tabEntityId:n.tabEntityId||e.tabEntityId}),Ie=(e,n)=>n.find((n=>"StaticExtensionTab"===n.__typename&&n?.baseInfo?.appId===e)),fe=(e,n,i)=>Boolean(e&&e.length>0&&e.filter((e=>he(e,n)&&-1!==e.scopes?.indexOf(i))).length>0),he=(e,n)=>{const i=e?.context;return i&&0!==i.length?-1!==i.indexOf(n):-1!==h.TU.indexOf(n)},Se=(e,n,i)=>{let a;if(n)try{a=e.id&&JSON.parse(e.id)}catch(n){i.error(`entity id ${e.id} json parsing failed`)}else{const n=e.id&&decodeURIComponent(e.id);a=n&&JSON.parse(n)}return a},Te=(e,n,i)=>i?.entryPoint===u.hB.botChat||!(e&&n||i?.chatId),Me=e=>!!e&&e.includes("meeting"),ye=(e,n)=>(n&&e===u.E2.content)??!1,Ae=e=>"WebsiteTab"===e?.platformTab?.__typename&&e?.platformTab?.websiteUrl||"",be=(e,n,i)=>e&&(n||(0,f.Fz)(i)),Fe=e=>e===h.dy},424575:(e,n,i)=>{"use strict";i.d(n,{i:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"baseInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BaseTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"externalAppId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"dateAdded"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}},{kind:"Field",name:{kind:"Name",value:"teamInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"teamSiteDomain"}},{kind:"Field",name:{kind:"Name",value:"teamSitePath"}},{kind:"Field",name:{kind:"Name",value:"teamSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"channelInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"channelRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"channelType"}}]}},{kind:"Field",name:{kind:"Name",value:"tabPermission"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUpdateConfig"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"definedDevicePermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isPredefinedTab"}}]}}]}},946905:(e,n,i)=>{"use strict";i.d(n,{V:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(424575).i.definitions]}},443178:(e,n,i)=>{"use strict";i.d(n,{o:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlaceholderTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(424575).i.definitions]}},670489:(e,n,i)=>{"use strict";i.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyDocumentLibraryTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyDocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"libraryId"}},{kind:"Field",name:{kind:"Name",value:"libraryServerRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteImageUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedDocumentLibraryTitle"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteTitle"}}]}},...i(424575).i.definitions]}},928411:(e,n,i)=>{"use strict";i.d(n,{r:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"removeUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isPlaceholderTab"}}]}},...i(424575).i.definitions]}},543960:(e,n,i)=>{"use strict";i.d(n,{N:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"fileViewTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FileViewTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"providerMetadata"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},...i(424575).i.definitions]}},886370:(e,n,i)=>{"use strict";i.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyWikiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyWikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"wikiTabId"}},{kind:"Field",name:{kind:"Name",value:"wikiDefaultTab"}},{kind:"Field",name:{kind:"Name",value:"hasContent"}},{kind:"Field",name:{kind:"Name",value:"scenarioName"}},{kind:"Field",name:{kind:"Name",value:"isMyWiki"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeetingWiki"}},{kind:"Field",name:{kind:"Name",value:"meetingNotes"}},{kind:"Field",name:{kind:"Name",value:"hasMigratedToOneNote"}}]}},...i(424575).i.definitions]}},966800:(e,n,i)=>{"use strict";i.d(n,{i:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"oneNoteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneNoteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"oneNoteId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"sectionUrl"}},{kind:"Field",name:{kind:"Name",value:"notebookId"}},{kind:"Field",name:{kind:"Name",value:"notebookLocation"}},{kind:"Field",name:{kind:"Name",value:"service"}},{kind:"Field",name:{kind:"Name",value:"subtype"}}]}},...i(424575).i.definitions]}},464539:(e,n,i)=>{"use strict";i.d(n,{F:()=>I});var a=i(975595),t=i(424575);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...t.i.definitions]};var l=i(300319);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"basicTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BasicTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}}]}}]}},...t.i.definitions]};var s=i(448410),d=i(543960),c=i(849011),m=i(966800),u=i(886370),p=i(670489),k=i(443178),g=i(946905);const N={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.i.definitions]},v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.i.definitions]},I={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"basicTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"}}]}},...a.V.definitions,...r.definitions,...l.F.definitions,...o.definitions,...s.L.definitions,...d.N.definitions,...c.i.definitions,...m.i.definitions,...u.H.definitions,...p.H.definitions,...k.o.definitions,...g.V.definitions,...N.definitions,...v.definitions]}},849011:(e,n,i)=>{"use strict";i.d(n,{i:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"powerBiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PowerBiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"originatingTeam"}},{kind:"Field",name:{kind:"Name",value:"originatingTeamId"}},{kind:"Field",name:{kind:"Name",value:"reports"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(424575).i.definitions]}},448410:(e,n,i)=>{"use strict";i.d(n,{L:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(424575).i.definitions]}},975595:(e,n,i)=>{"use strict";i.d(n,{V:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(424575).i.definitions]}},300319:(e,n,i)=>{"use strict";i.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"websiteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebsiteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(424575).i.definitions]}},111143:(e,n,i)=>{"use strict";i.d(n,{F:()=>k});var a=i(448410),t=i(928411),r=i(300319),l=i(975595),o=i(543960),s=i(849011),d=i(966800),c=i(886370),m=i(670489),u=i(443178),p=i(946905);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Tab"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tabId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTab"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tabId"},value:{kind:"Variable",name:{kind:"Name",value:"tabId"}}},{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}}]}}]}},...a.L.definitions,...t.r.definitions,...r.F.definitions,...l.V.definitions,...o.N.definitions,...s.i.definitions,...d.i.definitions,...c.H.definitions,...m.H.definitions,...u.o.definitions,...p.V.definitions]}},715871:(e,n,i)=>{"use strict";i.d(n,{$:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PlatformTabsInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTabs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformTabsQueryType"},value:{kind:"Variable",name:{kind:"Name",value:"queryType"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"platformTabInfo"}}]}}]}},...i(464539).F.definitions]}},244463:(e,n,i)=>{"use strict";i.d(n,{C:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]}},...i(109587).x.definitions]}},771767:(e,n,i)=>{"use strict";var a,t;i.d(n,{cw:()=>a,f0:()=>t,$3:()=>r}),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_240=240]="IS_AT_LEAST_240",e[e.IS_AT_LEAST_290=290]="IS_AT_LEAST_290",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_360=360]="IS_AT_LEAST_360",e[e.IS_AT_LEAST_375=375]="IS_AT_LEAST_375",e[e.IS_AT_LEAST_414=414]="IS_AT_LEAST_414",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_640=640]="IS_AT_LEAST_640",e[e.IS_AT_LEAST_720=720]="IS_AT_LEAST_720",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_834=834]="IS_AT_LEAST_834",e[e.IS_AT_LEAST_947=947]="IS_AT_LEAST_947",e[e.IS_AT_LEAST_1000=1e3]="IS_AT_LEAST_1000",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1350=1350]="IS_AT_LEAST_1350",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2048=2048]="IS_AT_LEAST_2048",e[e.IS_AT_LEAST_2560=2560]="IS_AT_LEAST_2560",e[e.IS_AT_LEAST_3840=3840]="IS_AT_LEAST_3840"}(a||(a={})),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_568=568]="IS_AT_LEAST_568",e[e.IS_AT_LEAST_667=667]="IS_AT_LEAST_667",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1366=1366]="IS_AT_LEAST_1366",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2160=2160]="IS_AT_LEAST_2160",e[e.IS_AT_LEAST_4320=4320]="IS_AT_LEAST_4320"}(t||(t={}));const r=(e,n={})=>{const{isMinWidthBreakpointAtLeast360:i,isMinWidthBreakpointAtLeast480:a,isMinWidthBreakpointAtLeast720:t,isMinWidthBreakpointAtLeast768:r}=e,{offsetForMinWidthBreakpointIsGreaterThan0:l,offsetForMinWidthBreakpointAtLeast360:o,offsetForMinWidthBreakpointAtLeast480:s,offsetForMinWidthBreakpointAtLeast720:d,offsetForMinWidthBreakpointAtLeast768:c}=n,m=(({isMinWidthBreakpointAtLeast240:e,isMinWidthBreakpointAtLeast290:n,isMinWidthBreakpointAtLeast320:i,isMinWidthBreakpointAtLeast360:a,isMinWidthBreakpointAtLeast375:t,isMinWidthBreakpointAtLeast414:r,isMinWidthBreakpointAtLeast480:l,isMinWidthBreakpointAtLeast640:o,isMinWidthBreakpointAtLeast720:s,isMinWidthBreakpointAtLeast768:d,isMinWidthBreakpointAtLeast834:c,isMinWidthBreakpointAtLeast947:m,isMinWidthBreakpointAtLeast1000:u,isMinWidthBreakpointAtLeast1024:p,isMinWidthBreakpointAtLeast1280:k,isMinWidthBreakpointAtLeast1350:g,isMinWidthBreakpointAtLeast1440:N,isMinWidthBreakpointAtLeast1500:v,isMinWidthBreakpointAtLeast1680:I,isMinWidthBreakpointAtLeast1920:f,isMinWidthBreakpointAtLeast2048:h,isMinWidthBreakpointAtLeast2560:S,isMinWidthBreakpointAtLeast3840:T})=>T?3840:S?2560:h?2048:f?1920:I?1680:v?1500:N?1440:g?1350:k?1280:p?1024:u?1e3:m?947:c?834:d?768:s?720:o?640:l?480:r?414:t?375:a?360:i?320:n?290:e?240:239)(e);let u=l??0;r&&"number"==typeof c?u=c:t&&"number"==typeof d?u=d:a&&"number"==typeof s?u=s:i&&"number"==typeof o&&(u=o);const p=(m-u)/10+"rem";return{"--width":p,width:[p,"var(--width)"]}}},645275:(e,n,i)=>{"use strict";i.d(n,{PY:()=>l,eo:()=>o,Lg:()=>s,pM:()=>d,A7:()=>c,ok:()=>m});var a=i(771767),t=i(364819);const r=({dimension:e,MinDimensionBreakpoint:n})=>{let i=n.IS_GREATER_THAN_0;for(const a in n)if(!isNaN(Number(n[a]))){const r=Number(n[a]);if(!((0,t.round)(e)>=r))break;i=r}return i},l=({height:e,width:n,host:i,setWidthCallback:t})=>{const{self:{innerHeight:l,innerWidth:o}}=i;t?.(n);return{minHeightBreakpoint:r({dimension:e,MinDimensionBreakpoint:a.f0}),minWidthBreakpoint:r({dimension:n,MinDimensionBreakpoint:a.cw}),minHeightViewportBreakpoint:r({dimension:l,MinDimensionBreakpoint:a.f0}),minWidthViewportBreakpoint:r({dimension:o,MinDimensionBreakpoint:a.cw})}},o=({minHeightBreakpoint:e,minWidthBreakpoint:n,minHeightViewportBreakpoint:i,minWidthViewportBreakpoint:t}={minHeightBreakpoint:a.f0.IS_GREATER_THAN_0,minWidthBreakpoint:a.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:a.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:a.cw.IS_GREATER_THAN_0})=>({...u({minHeightBreakpoint:e,minHeightViewportBreakpoint:i}),...g({minWidthBreakpoint:n,minWidthViewportBreakpoint:t})}),s=({minHeightBreakpoint:e}={minHeightBreakpoint:a.f0.IS_GREATER_THAN_0})=>({...p({minHeightBreakpoint:e})}),d=({minHeightViewportBreakpoint:e}={minHeightViewportBreakpoint:a.f0.IS_GREATER_THAN_0})=>({...k({minHeightViewportBreakpoint:e})}),c=({minWidthBreakpoint:e}={minWidthBreakpoint:a.cw.IS_GREATER_THAN_0})=>({...N({minWidthBreakpoint:e})}),m=({minWidthViewportBreakpoint:e}={minWidthViewportBreakpoint:a.cw.IS_GREATER_THAN_0})=>({...v({minWidthViewportBreakpoint:e})}),u=({minHeightBreakpoint:e,minHeightViewportBreakpoint:n})=>({...p({minHeightBreakpoint:e}),...k({minHeightViewportBreakpoint:n})}),p=({minHeightBreakpoint:e})=>({isMinHeightBreakpointAtLeast320:e>=a.f0.IS_AT_LEAST_320,isMinHeightBreakpointAtLeast480:e>=a.f0.IS_AT_LEAST_480,isMinHeightBreakpointAtLeast568:e>=a.f0.IS_AT_LEAST_568,isMinHeightBreakpointAtLeast667:e>=a.f0.IS_AT_LEAST_667,isMinHeightBreakpointAtLeast768:e>=a.f0.IS_AT_LEAST_768,isMinHeightBreakpointAtLeast1024:e>=a.f0.IS_AT_LEAST_1024,isMinHeightBreakpointAtLeast1280:e>=a.f0.IS_AT_LEAST_1280,isMinHeightBreakpointAtLeast1366:e>=a.f0.IS_AT_LEAST_1366,isMinHeightBreakpointAtLeast1440:e>=a.f0.IS_AT_LEAST_1440,isMinHeightBreakpointAtLeast1500:e>=a.f0.IS_AT_LEAST_1500,isMinHeightBreakpointAtLeast1680:e>=a.f0.IS_AT_LEAST_1680,isMinHeightBreakpointAtLeast1920:e>=a.f0.IS_AT_LEAST_1920,isMinHeightBreakpointAtLeast2160:e>=a.f0.IS_AT_LEAST_2160,isMinHeightBreakpointAtLeast4320:e>=a.f0.IS_AT_LEAST_4320}),k=({minHeightViewportBreakpoint:e})=>({isMinHeightViewportBreakpointAtLeast320:e>=a.f0.IS_AT_LEAST_320,isMinHeightViewportBreakpointAtLeast480:e>=a.f0.IS_AT_LEAST_480,isMinHeightViewportBreakpointAtLeast568:e>=a.f0.IS_AT_LEAST_568,isMinHeightViewportBreakpointAtLeast667:e>=a.f0.IS_AT_LEAST_667,isMinHeightViewportBreakpointAtLeast768:e>=a.f0.IS_AT_LEAST_768,isMinHeightViewportBreakpointAtLeast1024:e>=a.f0.IS_AT_LEAST_1024,isMinHeightViewportBreakpointAtLeast1280:e>=a.f0.IS_AT_LEAST_1280,isMinHeightViewportBreakpointAtLeast1366:e>=a.f0.IS_AT_LEAST_1366,isMinHeightViewportBreakpointAtLeast1440:e>=a.f0.IS_AT_LEAST_1440,isMinHeightViewportBreakpointAtLeast1500:e>=a.f0.IS_AT_LEAST_1500,isMinHeightViewportBreakpointAtLeast1680:e>=a.f0.IS_AT_LEAST_1680,isMinHeightViewportBreakpointAtLeast1920:e>=a.f0.IS_AT_LEAST_1920,isMinHeightViewportBreakpointAtLeast2160:e>=a.f0.IS_AT_LEAST_2160,isMinHeightViewportBreakpointAtLeast4320:e>=a.f0.IS_AT_LEAST_4320}),g=({minWidthBreakpoint:e,minWidthViewportBreakpoint:n})=>({...N({minWidthBreakpoint:e}),...v({minWidthViewportBreakpoint:n})}),N=({minWidthBreakpoint:e})=>({isMinWidthBreakpointAtLeast240:e>=a.cw.IS_AT_LEAST_240,isMinWidthBreakpointAtLeast290:e>=a.cw.IS_AT_LEAST_290,isMinWidthBreakpointAtLeast320:e>=a.cw.IS_AT_LEAST_320,isMinWidthBreakpointAtLeast360:e>=a.cw.IS_AT_LEAST_360,isMinWidthBreakpointAtLeast375:e>=a.cw.IS_AT_LEAST_375,isMinWidthBreakpointAtLeast414:e>=a.cw.IS_AT_LEAST_414,isMinWidthBreakpointAtLeast480:e>=a.cw.IS_AT_LEAST_480,isMinWidthBreakpointAtLeast640:e>=a.cw.IS_AT_LEAST_640,isMinWidthBreakpointAtLeast720:e>=a.cw.IS_AT_LEAST_720,isMinWidthBreakpointAtLeast768:e>=a.cw.IS_AT_LEAST_768,isMinWidthBreakpointAtLeast834:e>=a.cw.IS_AT_LEAST_834,isMinWidthBreakpointAtLeast947:e>=a.cw.IS_AT_LEAST_947,isMinWidthBreakpointAtLeast1000:e>=a.cw.IS_AT_LEAST_1000,isMinWidthBreakpointAtLeast1024:e>=a.cw.IS_AT_LEAST_1024,isMinWidthBreakpointAtLeast1280:e>=a.cw.IS_AT_LEAST_1280,isMinWidthBreakpointAtLeast1350:e>=a.cw.IS_AT_LEAST_1350,isMinWidthBreakpointAtLeast1440:e>=a.cw.IS_AT_LEAST_1440,isMinWidthBreakpointAtLeast1500:e>=a.cw.IS_AT_LEAST_1500,isMinWidthBreakpointAtLeast1680:e>=a.cw.IS_AT_LEAST_1680,isMinWidthBreakpointAtLeast1920:e>=a.cw.IS_AT_LEAST_1920,isMinWidthBreakpointAtLeast2048:e>=a.cw.IS_AT_LEAST_2048,isMinWidthBreakpointAtLeast2560:e>=a.cw.IS_AT_LEAST_2560,isMinWidthBreakpointAtLeast3840:e>=a.cw.IS_AT_LEAST_3840}),v=({minWidthViewportBreakpoint:e})=>({isMinWidthViewportBreakpointAtLeast240:e>=a.cw.IS_AT_LEAST_240,isMinWidthViewportBreakpointAtLeast290:e>=a.cw.IS_AT_LEAST_290,isMinWidthViewportBreakpointAtLeast320:e>=a.cw.IS_AT_LEAST_320,isMinWidthViewportBreakpointAtLeast360:e>=a.cw.IS_AT_LEAST_360,isMinWidthViewportBreakpointAtLeast375:e>=a.cw.IS_AT_LEAST_375,isMinWidthViewportBreakpointAtLeast414:e>=a.cw.IS_AT_LEAST_414,isMinWidthViewportBreakpointAtLeast480:e>=a.cw.IS_AT_LEAST_480,isMinWidthViewportBreakpointAtLeast640:e>=a.cw.IS_AT_LEAST_640,isMinWidthViewportBreakpointAtLeast720:e>=a.cw.IS_AT_LEAST_720,isMinWidthViewportBreakpointAtLeast768:e>=a.cw.IS_AT_LEAST_768,isMinWidthViewportBreakpointAtLeast834:e>=a.cw.IS_AT_LEAST_834,isMinWidthViewportBreakpointAtLeast947:e>=a.cw.IS_AT_LEAST_947,isMinWidthViewportBreakpointAtLeast1000:e>=a.cw.IS_AT_LEAST_1000,isMinWidthViewportBreakpointAtLeast1024:e>=a.cw.IS_AT_LEAST_1024,isMinWidthViewportBreakpointAtLeast1280:e>=a.cw.IS_AT_LEAST_1280,isMinWidthViewportBreakpointAtLeast1350:e>=a.cw.IS_AT_LEAST_1350,isMinWidthViewportBreakpointAtLeast1440:e>=a.cw.IS_AT_LEAST_1440,isMinWidthViewportBreakpointAtLeast1500:e>=a.cw.IS_AT_LEAST_1500,isMinWidthViewportBreakpointAtLeast1680:e>=a.cw.IS_AT_LEAST_1680,isMinWidthViewportBreakpointAtLeast1920:e>=a.cw.IS_AT_LEAST_1920,isMinWidthViewportBreakpointAtLeast2048:e>=a.cw.IS_AT_LEAST_2048,isMinWidthViewportBreakpointAtLeast2560:e>=a.cw.IS_AT_LEAST_2560})},899623:(e,n,i)=>{"use strict";i.d(n,{l:()=>r});var a=i(364819),t=i(513432);const r=(e,n,i)=>{const r=(0,t.useCallback)((0,a.debounce)(e,n,i),[e,n,i]);return(0,t.useEffect)((()=>r.cancel),[r]),r}},998989:(e,n,i)=>{"use strict";i.d(n,{s:()=>o});var a=i(513432),t=i(643502),r=i(193406),l=i(899273);const o=(e,n,i=!1,r="Url",o="",d=!1,c=!0)=>{const m=a.useCallback(((n,i,a,r)=>(0,t.z)(e,n,i,a,r)),[e]);return s(l.ur,m,n,i,r,o,d,c)},s=(e,n,i,t=!1,l="Url",o="",s=!1,d=!0)=>{const c=a.useRef(!1),{host:m,amsImageCache:u,user:p}=e(),k=a.useRef(),g=a.useRef(s&&p?.id&&u?.has(i,p.id)),[N,v]=a.useState((()=>{const e=g.current&&p?.id?u?.get(i,p.id):void 0;return{result:e,loading:!e,error:void 0}})),I=a.useCallback((e=>c.current&&v(e)),[]),f=a.useCallback((()=>{(async()=>{if(""!==i&&!(0,r.nA)(i,m.location.origin)){let e=await n(i,l,t,o);if(k.current&&"Url"===l&&URL.revokeObjectURL(k.current),p?.id&&s&&u?.has(i,p.id)){const n=e.result?.blob,a=u?.get(i,p.id),t=n&&a?.blob&&n!==a.blob;e.result&&d&&t&&URL.revokeObjectURL(n),e={result:a,loading:!1},g.current=!0}else e.result&&p?.id&&!e?.error&&s&&"Url"===l&&(g.current=u?.add(i,p.id,e.result));k.current=e?.result?.blob??void 0,I(e)}})()}),[n,u,t,l,m.location.origin,o,s,d,I,i,p?.id]);return a.useEffect((()=>{c.current=!0,g.current=s&&p?.id&&u?.has(i,p.id),g.current||f()}),[f,g,u,s,i,p]),a.useEffect((()=>()=>{c.current=!1,"Url"===l&&k.current&&!g.current&&URL.revokeObjectURL(k.current)}),[f,l,g]),[N,f]}},776012:(e,n,i)=>{"use strict";i.d(n,{BR:()=>c,Us:()=>m,ny:()=>u,JO:()=>p,QG:()=>k,In:()=>g});var a=i(957032),t=i(364819),r=i(513432),l=i(553882),o=i(879462),s=i(188468),d=i(94997);const c=r.createContext({}),m=(c.Consumer,()=>r.useContext(c)),u="Microsoft Teams",p=e=>`${e} | ${u}`;class k extends r.PureComponent{constructor(e){super(e),this.currentTitle="",this.currentName="",this.currentBadgeCount=0,this.applyBadgeCount=e=>{this.currentBadgeCount=e,this.applyTitleToDocument()},this.applyTitle=(e,n)=>{this.currentName=e,this.currentTitle=n,this.applyTitleToDocument()},this.applyTitleToDocument=()=>{if(this.props.document){let e=[this.currentName,this.currentTitle,this.props.mtmaPrefix,u].filter(Boolean).join(" | ");this.currentBadgeCount&&(e=`(${this.currentBadgeCount}) ${e}`),this.props.document.title=e}};const n=new l.t(e.defaultAppTitle||""),i=new l.t(""),a=new l.t(0);this.state={biLogger:e.biLogger,chatServiceSubscriptionFilter:{convId:null},setI18nProviderLocale:()=>{},titleObservable:n,nameObservable:i,badgeObservable:a},this.titleSubscription=n.pipe((0,o.p)((e=>!!e)),(0,s.F)(((e,n)=>this.currentTitle===n))).subscribe({next:()=>{const e=this.state.nameObservable.getValue(),n=this.state.titleObservable.getValue();this.applyTitle(e,n)}}),this.nameSubscription=i.pipe((0,o.p)((e=>!!e)),(0,s.F)(((e,n)=>this.currentName===n))).subscribe({next:()=>{const e=this.state.nameObservable.getValue();this.applyTitle(e,"")}}),this.badgeSubscription=a.pipe((0,s.F)(((e,n)=>this.currentBadgeCount===n))).subscribe({next:()=>{const e=this.state.badgeObservable.getValue();this.applyBadgeCount(e)}})}componentWillUnmount(){this.titleSubscription.unsubscribe(),this.state.titleObservable.complete(),this.nameSubscription.unsubscribe(),this.state.nameObservable.complete(),this.badgeSubscription.unsubscribe(),this.state.badgeObservable.complete()}componentDidMount(){this.props.document&&!this.props.document.title&&(this.props.document.title=u)}render(){return(0,a.Y)(N,{children:this.props.children,value:this.state})}}const g=r.memo((({chatServiceSubscriptionFilter:e,children:n})=>{const i=r.useContext(c),t=r.useMemo((()=>({...i,chatServiceSubscriptionFilter:e})),[e,i]);return(0,a.Y)(N,{children:n,value:t})})),N=r.memo((({children:e,value:n})=>(0,a.Y)(c.Provider,{value:(0,d.F)(n,t.isEqual),children:e})))},398128:(e,n,i)=>{"use strict";i.d(n,{by:()=>$n});var a=i(957032),t=i(513432),r=i(952691),l=i(532875),o=i(420076),s=i(375192),d=i(951860),c=i(947640);const m=({children:e})=>(0,a.Y)(t.Fragment,{children:t.Children.map(e,(e=>t.cloneElement(e,{styles:{clipPath:"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)"}})))});var u=i(323321),p=i(795001),k=i(867774),g=i(786255),N=i(49664),v=i(846716),I=i(129123),f=i(754255);const h={isActionButton:!0},S=({isBotSupportCalling:e,startChat:n,startAudioCall:i,startVideoCall:r,isVideoAvailableForConversation:l,videoNotAvailableForConversationReason:o,isAudioAvailableForConversation:s,audioNotAvailableForConversationReason:d})=>{const c=(0,v.PO)(),m=t.useMemo((()=>T(c,o,l,!0)),[c,o,l]),S=t.useMemo((()=>T(c,d,s)),[c,d,s]),{enableBotsCallingSupport:M}=(0,I.w2)(f.w.Extensibility,["enableBotsCallingSupport"]),y=c.stringTranslate("extensibility","app_profile_card_toggleChat_on");return(0,a.Y)(u.s,{hAlign:"start",fill:!0,gap:"gap.small",children:[(0,a.Y)(p.$,{iconOnly:!0,text:!0,icon:(0,a.Y)(k.o,{outline:!0,size:"medium"}),onClick:n,title:y,disabled:!1,variables:h}),M&&e?(0,a.Y)(t.Fragment,{children:[(0,a.Y)(p.$,{iconOnly:!0,text:!0,icon:(0,a.Y)(g.p,{outline:!0,size:"medium"}),onClick:r,title:m,disabled:!l,variables:h}),(0,a.Y)(p.$,{iconOnly:!0,text:!0,icon:(0,a.Y)(N.q,{outline:!0,size:"medium"}),onClick:i,title:S,disabled:!s,variables:h})]}):null]})},T=(e,n,i,a)=>!i&&n?e.stringTranslate("calling",n):e.stringTranslate("messaging",a?"calling_video":"calling_call");var M=i(509336);const y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"videoAvailableForConversationChanged"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"videoAvailableForConversationChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"notAvailableReason"}}]}}]}}]};var A=i(300616),b=i(899273),F=i(851075),C=i(726723),D=i(791403),U=i(702183),E=i(776012),w=i(712839);const L=(e,n,i,a,t,r,l)=>({actionGesture:e,actionOutcome:n,actionScenario:i,actionScenarioType:C.DB.appMgmt,moduleName:a,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,appName:t,extensibilityData:{id:r,capabilityId:l,scenarioCapability:w.n3.bots}}),O=t.memo((({client:e,appProfile:n,botCallingCapabilities:i})=>{const{entityCommanding:r,scenarioFactory:l}=(0,b.ur)(),o=(0,F.U)(O.name),{startChat:s,startCall:d}=(0,A.wM)(r,e,o),c=(0,E.Us)(),{convId:m}=c.chatServiceSubscriptionFilter,{isBotAudioSupported:u,isBotVideoSupported:p,botAudioNotAvailableForConversationReason:k,botVideoNotAvailableForConversationReason:g}={...B(i)},{recordPanelAction:N}=(0,D.ib)(),v=u||p,I=n.botIdOrAppId,f=t.useCallback((()=>{const e=l.newScenario(U.Cu.AppProfileCardStartChat);N(L(C.Od.click,C.nd.select,C.vB.appProfileCardChat,C.Sn.appProfileCardStartChat,n.appName)),s(I,e)}),[I,n.appName,N,s,l]),h=t.useCallback((()=>{const e=l.newScenario(U.Cu.AppProfileCardStartAudioCall);P(n,!1,N),d(I,!1,e)}),[I,n,d,l,N]),T=t.useCallback((()=>{const e=l.newScenario(U.Cu.AppProfileCardStartVideoCall);P(n,!0,N),d(I,!0,e)}),[I,n,d,l,N]),{videoNotAvailableForConversationReason:M,isVideoAvailableForConversation:y}=V(e,m,p,g,o);return(0,a.Y)(S,{startChat:f,startVideoCall:T,startAudioCall:h,isBotSupportCalling:!!v,videoNotAvailableForConversationReason:M,isVideoAvailableForConversation:y&&!!p,audioNotAvailableForConversationReason:k??null,isAudioAvailableForConversation:!!u})})),x=(0,M.W)(O),P=(e,n,i)=>{i(L(C.Od.click,C.nd.nav,C.vB.appProfileCardCall,n?C.Sn.appProfileCardVideoCall:C.Sn.appProfileCardAudioCall,e.appName))},V=(e,n,i,a="bot_calling_video_not_supported",r)=>{const[l,o]=t.useState(null);t.useEffect((()=>{if(!i)return;const a=e.subscribe({query:y,variables:{conversationId:n}}).subscribe((({data:e,errors:n})=>{n&&r.error("Error on callQuery for video conversation subscription"),o(e)}));return()=>{a.unsubscribe()}}),[e,r,n,i]);const s=l?.videoAvailableForConversationChangedEvent;let d=!1,c="calling_video_disabled";return s&&(d=s.isAvailable,c=d?i?null:a:j(s.notAvailableReason,r)),{isVideoAvailableForConversation:d,videoNotAvailableForConversationReason:c}},j=(e,n)=>{switch(e){case"calling_video_disabled":case"calling_video_disabled_by_admin":case"calling_video_disabled_no_device":case"calling_video_disabled_vdi":case"bot_calling_video_not_supported":case"bot_calling_audio_not_supported":return e;default:return n.warn(`_queryVideoAvailableForConversation: wrong videoDisabledReason received: ${e}`),"calling_video_disabled"}},B=e=>{if(!e)return;const n=!!e?.supportsVideo,i=!!e?.supportsCalling;let a="bot_calling_audio_not_supported",t="bot_calling_video_not_supported";return a=i?null:a,t=n?null:t,{isBotVideoSupported:n,isBotAudioSupported:i,botAudioNotAvailableForConversationReason:a,botVideoNotAvailableForConversationReason:t}};var z=i(786394),R=i(245434),Q=i(460413),W=i(104586),Y=i(965804);const G=(0,Y.O)({isAppProfileCardTextInput:{a9b677:"fly5x3f"}}),_=({sendMessage:e,appName:n,className:i})=>{const r=(0,v.PO)(),[l,o]=t.useState(""),s=""===l,d=t.useCallback((e=>{const n=e.target.value;o(n)}),[o]),c=t.useCallback((()=>{e(l),o("")}),[l,e]),m=r.stringTranslate("extensibility","app_profile_card_icons_send"),p=r.stringTranslate("extensibility","app_profile_card_quickMessage",{appName:n}),k=G();return(0,a.Y)(u.s,{column:!0,gap:"gap.small",className:i,children:(0,a.Y)(Q.l,{onSubmit:c,children:(0,a.Y)(u.s,{className:k.isAppProfileCardTextInput,gap:"gap.smaller",children:[(0,a.Y)(z.p,{placeholder:p,onChange:d,value:l}),(0,a.Y)(R.$,{icon:(0,a.Y)(W.q,{}),appearance:"transparent",disabled:s,title:m,type:"submit"})]})})})};var Z=i(806658),H=i(84646);const J=({client:e,appProfile:n,...i})=>{const{entityCommanding:r,scenarioFactory:l}=(0,b.ur)(),o=(0,F.U)(J.name),{sendMessage:s}=(0,A.wM)(r,e,o),{recordPanelAction:d}=(0,D.ib)(),{appName:c,botIdOrAppId:m,appId:u}=n,p=(0,Z.Iz)(m)?m.substring(H.gN.BotPrefix.length):void 0,k=t.useCallback((e=>{const n=l.newScenario(U.Cu.AppProfileCardSendQuickMessage);d(L(C.Od.click,C.nd.submit,C.vB.quickIM,C.Sn.appProfileCardQuickIM,c,u,p)),s(m,e,n)}),[m,c,u,p,d,s,l]);return(0,a.Y)(_,{sendMessage:k,appName:c,...i})},X=(0,M.W)(J);var q=i(908482),K=i(917120),$=i(635158),ee=i(795631),ne=i(526521),ie=i(337601),ae=i(132305),te=i(63801),re=i(84307);const le=({title:e})=>(0,a.Y)(te.n,{state:"success",title:e,variables:{appProfileCardPresenceImage:re.Y.Online}});var oe=i(649228),se=i(902376),de=i(572909);const ce=(0,Y.O)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc",cr1yyl:"f1r4h3gm"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{Frg6f3:["fcgxt0o","f1ujusj6"]},isAppProfileCardLink:{Be2twd7:"f14d40fx",dvvfom:0,w71qe1:0,I8pafv:0,Bkioxbp:0,dwov6y:"ff6ntgw"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"}});var me=i(139150),ue=i(998989),pe=i(912146),ke=i(944297);const ge=({botName:e,iconUrl:n,description:i,developerName:r,privacyUrl:l,termsOfUseUrl:o,botIdOrAppId:s,isShortProfileCard:d,sceneCount:c,showActionButtons:m,isSceneApp:u,sceneName:p,showRectAppImage:k,botCallingCapabilities:g,appId:N,supportsMeetingStreaming:v,botConfiguration:h,appDef:S})=>{const T=t.useMemo((()=>({botIdOrAppId:s,appName:e,appId:N})),[N,s,e]),{host:M}=(0,b.ur)(),y=(0,oe.rO)(),{entity:A}=(0,se.At)(),F=A.type===de.ck.channels?"Team":"GroupChat",C=(0,oe.r8)(S,F),D=A.type===de.ck.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(A):A.id,U=t.useCallback((()=>{y(D,F,S,oe.uk.ReConfig)}),[S,D,y,F]),{enableFetchAPIForNonAdaptiveCardImages:E}=(0,I.w2)(f.w.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),w=(0,me.m)(),[{result:L}]=(0,ue.s)(w,E&&(0,pe.d$)(n,M.location.origin)||(0,ke.D$)(n)?n:"",!0,"Url",void 0,!0),O=L?.blob??n;return u?(0,a.Y)(ve,{botName:e,description:i,iconUrl:O,sceneCount:c,sceneName:p,showRectAppImage:k,privacyUrl:l,termsOfUseUrl:o}):(0,a.Y)(Ne,{appProfile:T,botName:e,description:i,iconUrl:O,isShortProfileCard:d,developerName:r,showRectAppImage:k,botCallingCapabilities:g,supportsMeetingStreaming:v,privacyUrl:l,termsOfUseUrl:o,showActionButtons:m,botConfiguration:C?h:null,launchBotConfig:U})},Ne=({appProfile:e,botName:n,iconUrl:i,description:r,developerName:l,privacyUrl:o,termsOfUseUrl:s,isShortProfileCard:d,showActionButtons:c,showRectAppImage:m,botCallingCapabilities:p,supportsMeetingStreaming:k,botConfiguration:g,launchBotConfig:N})=>{const{enableBotConfiguration:v}=(0,I.w2)(f.w.Extensibility,["enableBotConfiguration"]),h=ce();return(0,a.Y)(K.s,{className:h.isAppProfileCard,children:[(0,a.Y)(u.s,{vAlign:"start",children:(0,a.Y)(fe,{botName:n,description:r,iconUrl:i,isShortProfileCard:d,developerName:l,showRectAppImage:m})}),(0,a.Y)(u.s,{column:!0,children:[v&&g?(0,a.Y)(R.$,{appearance:"transparent",className:h.isBotSettingsButton,onClick:N,icon:(0,a.Y)(ae.Z,{outline:!0,size:"medium"})}):(0,a.Y)(t.Fragment,{}),(0,a.Y)(De,{isShortProfileCard:d,supportsMeetingStreaming:k}),d?null:(0,a.Y)(Ce,{privacyUrl:o,termsOfUseUrl:s}),c?(0,a.Y)(Te,{appProfile:e,botCallingCapabilities:p}):null]})]})},ve=({botName:e,description:n,iconUrl:i,sceneCount:t,sceneName:r,showRectAppImage:l,privacyUrl:o,termsOfUseUrl:s})=>{const d=ce();return(0,a.Y)(K.s,{className:d.isAppProfileCard,children:[(0,a.Y)(u.s,{fill:!0,vAlign:"start",children:(0,a.Y)(Ie,{botName:e,description:n,iconUrl:i,sceneCount:t,sceneName:r,showRectAppImage:l})}),(0,a.Y)(u.s,{column:!0,children:(0,a.Y)(Ce,{privacyUrl:o,termsOfUseUrl:s})})]})},Ie=({botName:e,description:n,iconUrl:i,sceneCount:r,sceneName:l,showRectAppImage:o})=>{const s=ce();return(0,a.Y)(t.Fragment,{children:[(0,a.Y)(u.s,{fill:!0,column:!0,children:[(0,a.Y)(Me,{botName:l}),(0,a.Y)($.D,{size:"small",children:e}),(0,a.Y)(u.s,{gap:"gap.small",vAlign:"center",className:s.sceneAppProfileCard,children:[(0,a.Y)(q.S,{size:"smaller",outline:!0}),(0,a.Y)(Ae,{sceneCount:r})]}),(0,a.Y)(be,{description:n})]}),(0,a.Y)(he,{iconUrl:i,showRectAppImage:o})]})},fe=({botName:e,description:n,developerName:i,iconUrl:r,isShortProfileCard:l,showRectAppImage:o})=>{const{presence:s}=Ee(),d=ce();return(0,a.Y)(t.Fragment,{children:[(0,a.Y)(u.s,{fill:!0,column:!0,className:d.isAppProfileCardDetail,children:[(0,a.Y)(Me,{botName:e}),(0,a.Y)(u.s,{column:!0,gap:"gap.small",children:[(0,a.Y)($.D,{className:d.isAppProfileCardPresence,children:s}),(0,a.Y)(Fe,{description:n}),l?(0,a.Y)(Me,{botName:e,isShortProfileCard:l}):(0,a.Y)(ye,{developerName:i})]})]}),(0,a.Y)(he,{iconUrl:r,showRectAppImage:o})]})},he=({iconUrl:e,showRectAppImage:n})=>{const{appProfileImageBorderRadius:i}=Ue();return n?(0,a.Y)(Se,{iconUrl:e,width:60,height:60,variables:i}):(0,a.Y)(Se,{showStatus:!0,iconUrl:e,width:68,height:60,isHexagon:!0})},Se=({iconUrl:e,showStatus:n,width:i,height:t,isHexagon:r,variables:l})=>{const{presence:o}=Ee(),d=ce(),c=(0,a.Y)(s.S,{src:e,width:i,height:t,variables:l});return(0,a.Y)(K.s,{className:d.isAppProfileCardImageContainer,children:[r?(0,a.Y)(m,{children:c}):c,n&&(0,a.Y)(le,{title:o})]})},Te=({appProfile:e,botCallingCapabilities:n})=>{const i=ce();return(0,a.Y)(u.s,{column:!0,children:[(0,a.Y)(u.s,{fill:!0,className:i.isAppProfileCardActionButton,children:(0,a.Y)(x,{appProfile:e,botCallingCapabilities:n})}),(0,a.Y)(ee.c,{className:i.messageAppDivider}),(0,a.Y)(X,{appProfile:e,className:i.flexItemAlign})]})},Me=({botName:e,isShortProfileCard:n})=>{const i=ce();return(0,a.Y)($.D,{className:n?i.isAppProfileShortCardDescription:i.isAppProfileCardTitle,children:e})},ye=({developerName:e})=>{const n=(0,v.PO)().translate("extensibility","app_profile_card_developer",{developerName:e}),i=ce();return(0,a.Y)($.D,{className:i.isAppProfileCardDeveloper,children:n})},Ae=({sceneCount:e})=>{const n=(0,v.PO)().stringTranslate("extensibility","app_profile_card_scene_count_mf",{sceneCount:e});return(0,a.Y)($.D,{size:"small",children:n})},be=({description:e})=>{const n=ce();return(0,a.Y)($.D,{className:(0,ne.z)(n.isContentClamped,n.isSceneProfileCardDesc),children:e})},Fe=({description:e})=>{const n=ce();return(0,a.Y)($.D,{className:(0,ne.z)(n.isContentClamped,n.isAppProfileCardDescription),children:e})},Ce=({privacyUrl:e,termsOfUseUrl:n})=>{const{termsOfUse:i,privacy:t}=Ee(),r=ce();return(0,a.Y)(u.s,{vAlign:"end",className:r.flexItemGrow,children:[(0,a.Y)(ie.N,{target:"_blank",href:e,className:r.isAppProfileCardLink,children:t}),(0,a.Y)(ie.N,{target:"_blank",href:n,className:(0,ne.z)(r.flexItemPush,r.isAppProfileCardLink),children:i})]})},De=({isShortProfileCard:e,supportsMeetingStreaming:n})=>{const i=(0,v.PO)(),t=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extensibility_addAppDialogAppCardPermission1","extensibility_addAppDialogAppCardPermission2","extension_addAppDialogIdentityPermission2"];n&&!e&&t.push("extension_addAppDialog_Permission_Meeting_Streaming_Access");const r=[],l=ce();for(let n=0;n<=t.length-1;n++)r.push((0,a.Y)(u.s,{gap:"gap.smaller",children:[e?null:(0,a.Y)($.D,{className:l.listStyleBullet,children:""}),(0,a.Y)($.D,{children:i.translate("extensibility",t[n])})]},n));const{whatAppCanDo:o}=Ee();return(0,a.Y)(K.s,{className:l.isAppProfileCardBasicPermission,children:[(0,a.Y)($.D,{className:e?l.isAppProfileCardPermission:void 0,children:o}),(0,a.Y)(u.s,{column:!0,className:l.isAppProfileCardPermissionFlex,children:r})]})},Ue=()=>{const{vars:e}=(0,r.W)();return{isAppProfileCardBasicPermission:e("extensibility",["isAppProfileCardBasicPermission"]),isAppProfileCardPermission:e("extensibility",["isAppProfileCardPermission"]),isAppProfileCardLink:e("extensibility",["isAppProfileCardLink"]),isAppProfileCardDeveloper:e("extensibility",["isAppProfileCardDeveloper"]),listStyleBullet:e("extensibility",["listStyleBullet"]),isAppProfileCardPresence:e("extensibility",["isAppProfileCardPresence"]),isAppProfileCardTitle:e("extensibility",["isAppProfileCardTitle"]),isAppProfileCardDescription:e("extensibility",["isAppProfileCardDescription"]),isAppProfileCardImageContainer:e("extensibility",["isAppProfileCardImageContainer"]),isAppProfileCard:e("extensibility",["isAppProfileCard"]),isAppProfileCardDetail:e("extensibility",["isAppProfileCardDetail"]),isAppProfileCardActionButton:e("extensibility",["isAppProfileCardActionButton"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),messageAppDivider:e("extensibility",["messageAppDivider"]),isAppProfileShortCardDescription:e("extensibility",["isAppProfileShortCardDescription"]),sceneAppProfileCard:e("extensibility",["sceneAppProfileCard"]),isSceneProfileCardDesc:e("extensibility",["isSceneProfileCardDesc"])}},Ee=()=>{const e=(0,v.PO)();return{whatAppCanDo:e.translate("extensibility","app_profile_card_basicPermission_what_app_can_do"),privacy:e.translate("extensibility","app_profile_card_privacy"),termsOfUse:e.translate("extensibility","app_profile_card_terms_of_use"),presence:e.stringTranslate("extensibility","app_profile_card_presence")}};var we=i(884839);var Le=i(401962),Oe=i(253441),xe=i(660363);const Pe=(e,n)=>!!n[e]?.length,Ve=({appDef:e})=>{const n=Pe("galleryTabs",e)||(0,we.vx)("Team",e.staticTabs),i=Pe("bots",e),t=Pe("messageExtensions",e),r=Pe("connectors",e),l=(0,we.vx)("Personal",e.staticTabs);return(0,a.Y)(K.s,{children:[n&&(0,a.Y)(je,{titleKey:"app_details_capability_tab",descriptionKey:"app_details_capability_tab_description"}),i&&(0,a.Y)(je,{titleKey:"app_details_capability_bot",descriptionKey:"app_details_capability_bot_description"}),t&&(0,a.Y)(je,{titleKey:"app_details_capability_message_extension",descriptionKey:"app_details_capability_message_extension_description"}),r&&(0,a.Y)(je,{titleKey:"extension_addAppDialogV3_capability_connector_title",descriptionKey:"app_details_capability_connector_description"}),l&&(0,a.Y)(je,{titleKey:"app_details_capability_personal_app",descriptionKey:"app_details_capability_personal_app_description"})]})},je=({titleKey:e,descriptionKey:n})=>{const i=(0,v.PO)(),l=t.useMemo((()=>i.translate("extensibility",e)),[i,e]),o=t.useMemo((()=>i.translate("extensibility",n)),[i,n]),{vars:s}=(0,r.W)();return(0,a.Y)(K.s,{children:[(0,a.Y)(xe.Y,{as:"h4",content:l,variables:s("extensibility",["isActionableAppProfileCardAppFeatureHeader"])}),o]})};var Be=i(899623);const ze=(0,Y.O)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isActionableAppProfileCardBodySection:{Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardBodySectionTitle:{Bhrd7zp:"flh3ekv"},isActionableAppProfileCardPermissionsList:{dclx09:"fuxrj8o",B6of3ja:"f1bpxv7w"},isActionableAppProfileCardConsent:{Be2twd7:"f1hn7b42",Bj7y4cg:"f11hph32"},isActionableAppProfileCardLink:{mc9l5x:"f1w7gpdv",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",ha4doy:"f1cdqgvm",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1motb3o",Bf4jedk:"f18p0k4z",Bqenvij:"f11ysow2",Be2twd7:"fjoy568",Bhrd7zp:"ff5ikls",mn2c1h:"fuuohzo",B7m74wb:"f9oa3bk",Ba85zgr:0,Bcsz1n9:0,Bidrcva:0,yit76y:0,Bbybgqa:"fczi8j1",Beapcnx:0,i089h6:0,Bvxx0d4:0,rpb332:0,zxir6n:"fbfeg0j",lj723h:"f1bq4y7d",C4gs1y:0,Bde5pd6:0,o06tbt:0,Frfyj5:0,Fnbkun:"f154bhm6",Jwef8y:"fldu4wg",Bi91k9c:"fpwtdan"},isActionableAppProfileCardBodySectionParagraph:{z8tnut:"fz04i0k"},isActionableAppProfileCardHeaderInfoBanner:{B6of3ja:"fwdhe5f",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fc882fo",De3pzq:"f18f03hv",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fffov48",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",sj55zd:"f19n0e5",sshi5w:"f4x5sky",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardDescription:{a9b677:"fly5x3f",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",ygn44y:"f1cmbuwj",Bxyxcbc:"f1it27or",Bh9c35c:"f197wrh9"},isActionableAppProfileCardAppButton:{Bf4jedk:"f13bscln",Huce71:"fz5stix",t21cq0:["fvm675v","f1kdaspl"],Bqenvij:"f1sw78cg",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fbnecyg"},isActionableAppProfileCardAppButtonLoader:{t21cq0:["fvm675v","f1kdaspl"]},isActionableAppProfileCardImageContainer:{a9b677:"ffyv3ta",Bqenvij:"fyhdfh7",qhf8xq:"f10pi13n"},isActionableAppProfileCardFooter:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f8ofw6e",Eo32re:"f1ter9b9",ekhr2s:"f1jf1ovi"},isActionableAppProfileCardTitle:{Be2twd7:"fkhj508",Bhrd7zp:"flh3ekv",Bg96gwp:"f15qi916"},isActionableAppProfileCardBody:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["fcj128b","f1ebihv0"],a9b677:"f14z66ap",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1enuhaj",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:["f4aipn0","f1kihodc"],z9904h:["f32gfn4","f9bbbef"]},isActionableAppProfileCardDivider:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1q5y2p4"},isActionableAppProfileCardHeader:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1ef08qj"},isActionableAppProfileCardHeaderDescription:{sshi5w:"f1s7fcag",Bxyxcbc:"fivuv6",Frg6f3:["f1e3ula6","f153xw4"],t21cq0:["fbjlher","f1wtvaye"]},isActionableAppProfileCard:{a9b677:"f5m2izs",Bqenvij:"fc4x5ql",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fykg1oz",F9q5ga:"f1bldkcc",Bugp6ci:"fyzbmc5",B60y50i:"f107ynw3",Bjq7wn2:"f4ws2lc"},isActionableAppProfileCardActionButtonsWrapper:{Bow7q3s:"fuvumhg"},isActionableAppProfileCardShort:{a9b677:"f5m2izs",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fykg1oz"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{B6of3ja:"fgr6219"},isAppProfileCardLink:{Be2twd7:"f14d40fx",dvvfom:0,w71qe1:0,I8pafv:0,Bkioxbp:0,dwov6y:"fctto54"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"},isActionableAppProfileCardHeaderButtons:{B6of3ja:"fwdhe5f"},isActionableAppProfileCardHeaderButtonsItem:{a9b677:"f14z66ap"}});var Re=i(910316);var Qe;!function(e){e[e.Default=0]="Default",e[e.InfoBanner=1]="InfoBanner"}(Qe||(Qe={}));const We=({appDef:e,botName:n,iconUrl:i,description:r,privacyUrl:l,termsOfUseUrl:o,botIdOrAppId:s,sceneCount:d,showActionButtons:c,hideAppButton:m,isSceneApp:u,sceneName:p,showRectAppImage:k,botCallingCapabilities:g,appId:N,supportsMeetingStreaming:v,isInstalled:h,hasPersonalScope:S,botConfiguration:T})=>{const M=t.useMemo((()=>({botIdOrAppId:s,appName:n,appId:N})),[N,s,n]),{host:y}=(0,b.ur)(),A=(0,oe.rO)(),{entity:F}=(0,se.At)(),C=F.type===de.ck.channels?"Team":"GroupChat",D=F.type===de.ck.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(F):F.id,U=(0,oe.r8)(e,C),E=t.useCallback((()=>{A(D,C,e,oe.uk.ReConfig)}),[e,D,A,C]),{enableFetchAPIForNonAdaptiveCardImages:w}=(0,I.w2)(f.w.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),L=(0,me.m)(),[{result:O}]=(0,ue.s)(L,w&&((0,pe.d$)(i,y.location.origin)||(0,ke.D$)(i))?i:"",!0,"Url",void 0,!0),x=O?.blob??i;return u?(0,a.Y)(ve,{botName:n,description:r,iconUrl:x,sceneCount:d,sceneName:p,showRectAppImage:k,privacyUrl:l,termsOfUseUrl:o}):N?(0,a.Y)(Ye,{appDef:e,appProfile:M,description:r,iconUrl:x,showRectAppImage:k,botCallingCapabilities:g,supportsMeetingStreaming:v,privacyUrl:l,termsOfUseUrl:o,showActionButtons:c,hideAppButton:m,isInstalled:h,hasPersonalScope:S,botConfiguration:U?T:null,launchBotConfig:E}):(0,a.Y)(Ge,{appName:n,iconUrl:x,showRectAppImage:k})},Ye=({appDef:e,appProfile:n,iconUrl:i,description:r,privacyUrl:l,termsOfUseUrl:o,showActionButtons:s,hideAppButton:d,showRectAppImage:c,botCallingCapabilities:m,supportsMeetingStreaming:p,isInstalled:k,hasPersonalScope:g,botConfiguration:N,launchBotConfig:v})=>{const{enableBotConfiguration:h}=(0,I.w2)(f.w.Extensibility,["enableBotConfiguration"]),S=ze(),T=t.useRef(null),M=t.useRef(null),{recordPanelAction:y}=(0,D.ib)(),A=t.useCallback((()=>{if(M.current&&T.current){const{appId:e,appName:i}=n;M.current.scrollTo({top:T.current.offsetTop-M.current.offsetTop,behavior:"smooth"}),y({actionGesture:C.Od.click,actionOutcome:C.nd.scroll,moduleName:C.Sn.appProfileCard,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,extensibilityData:{id:e,name:i}})}}),[n,T,M,y]);return(0,a.Y)(u.s,{column:!0,className:S.isActionableAppProfileCard,"data-tid":"actionable-app-profile-card-content",children:[(0,a.Y)(_e,{appProfile:n,botCallingCapabilities:m,description:r,iconUrl:i,showActionButtons:s,hideAppButton:d,showRectAppImage:c,isInstalled:k,hasPersonalScope:g}),h&&N?(0,a.Y)(R.$,{"data-tid":"bot-settings-button",appearance:"transparent",className:S.isBotSettingsButton,onClick:v,icon:(0,a.Y)(ae.Z,{outline:!0,size:"medium"})}):(0,a.Y)(t.Fragment,{}),(0,a.Y)(ee.c,{className:S.isActionableAppProfileCardDivider}),(0,a.Y)(Ze,{appDef:e,appProfile:n,bodyRef:M,permissionsRef:T,supportsMeetingStreaming:!!p}),(0,a.Y)(ee.c,{className:S.isActionableAppProfileCardDivider}),(0,a.Y)(He,{appProfile:n,showActionButtons:s,onPermissionsClick:A,privacyUrl:l,termsOfUseUrl:o})]})},Ge=({appName:e,iconUrl:n,showRectAppImage:i})=>{const t=ze();return(0,a.Y)(u.s,{column:!0,className:t.isActionableAppProfileCardShort,children:[(0,a.Y)(u.s,{className:t.isActionableAppProfileCardHeader,children:[(0,a.Y)(Je,{iconUrl:n,showRectAppImage:i}),(0,a.Y)(u.s,{column:!0,className:t.isActionableAppProfileCardHeaderDescription,children:(0,a.Y)(Ke,{name:e})})]}),(0,a.Y)(ee.c,{className:t.isActionableAppProfileCardDivider}),(0,a.Y)(tn,{isShortCard:!0})]})},_e=({appProfile:e,botCallingCapabilities:n,description:i,iconUrl:t,showActionButtons:r,hideAppButton:l,showRectAppImage:o,isInstalled:s,hasPersonalScope:d})=>{const{actionableAppProfileCardType:c}=(0,I.w2)(f.w.Extensibility,["actionableAppProfileCardType"]),m=c===Qe.InfoBanner,p=ze();return(0,a.Y)(u.s,{column:!0,className:p.isActionableAppProfileCardHeader,children:[(0,a.Y)(u.s,{children:[(0,a.Y)(Je,{iconUrl:t,showRectAppImage:o}),(0,a.Y)(u.s,{column:!0,className:p.isActionableAppProfileCardHeaderDescription,children:[(0,a.Y)(Ke,{name:e.appName}),(0,a.Y)($e,{description:i})]})]}),(0,a.Y)(u.s,{fill:!0,className:p.isActionableAppProfileCardHeaderButtons,children:[d&&!l?(0,a.Y)(qe,{appId:e.appId,appName:e.appName,isInstalled:s,isInfoBannerType:m}):null,r?(0,a.Y)(u.s,{className:p.isActionableAppProfileCardActionButtonsWrapper,children:(0,a.Y)(x,{appProfile:e,botCallingCapabilities:n})}):null]}),!m||s||l?null:(0,a.Y)(en,{})]})},Ze=({appDef:e,appProfile:{appId:n,appName:i},bodyRef:t,permissionsRef:r,supportsMeetingStreaming:l})=>{const{recordPanelAction:o}=(0,D.ib)(),s=(0,Be.l)((()=>o({actionGesture:C.Od.scroll,actionOutcome:C.nd.read,moduleName:C.Sn.appProfileCard,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,extensibilityData:{id:n,name:i}})),1e3),d=ze();return(0,a.Y)(u.s,{column:!0,ref:t,className:d.isActionableAppProfileCardBody,onScroll:s,children:[(0,a.Y)(rn,{appDef:e}),(0,a.Y)(ee.c,{className:d.isActionableAppProfileCardDivider}),(0,a.Y)(tn,{permissionsRef:r,supportsMeetingStreaming:l})]})},He=({appProfile:e,onPermissionsClick:n,privacyUrl:i,showActionButtons:t,termsOfUseUrl:r})=>{const l=ze();return(0,a.Y)(u.s,{column:!0,className:l.isActionableAppProfileCardFooter,children:[t?(0,a.Y)(X,{appProfile:e}):null,(0,a.Y)(an,{appName:e.appName,onPermissionsClick:n,privacyUrl:i,termsOfUseUrl:r})]})},Je=({iconUrl:e,showRectAppImage:n})=>{const{appProfileImageBorderRadius:i}=on();return n?(0,a.Y)(Xe,{iconUrl:e,width:80,height:72,variables:i}):(0,a.Y)(Xe,{iconUrl:e,width:80,height:72,isHexagon:!0})},Xe=({iconUrl:e,width:n,height:i,isHexagon:t,variables:r})=>{const l=ze(),o=(0,a.Y)(s.S,{src:e,width:n,height:i,variables:r});return(0,a.Y)(K.s,{className:l.isActionableAppProfileCardImageContainer,children:t?(0,a.Y)(m,{children:o}):o})},qe=({appId:e,appName:n,isInstalled:i,isInfoBannerType:r})=>{const{addAppButton:l,addToYourAppsButton:o,openAppButton:s}=sn(),[d,c]=t.useState(!1),[m,u]=t.useState(!1),p=(()=>{const e=(0,me.m)(),{scenarioFactory:n}=(0,b.ur)(),i=(0,F.U)("useInstallPersonalApp"),{enableAppsQueryOptimization:a}=(0,I.w2)(f.w.Extensibility,["enableAppsQueryOptimization"]);return t.useCallback((t=>(0,we.Pe)(e,n,U.Cu.AppProfileCardInstallApp,t,"Personal",i,a)),[e,i,n,a])})(),k=(0,Le.S)(),{recordPanelAction:g}=(0,D.ib)(),N=(0,Oe.H)();t.useEffect((()=>(u(!0),()=>u(!1))),[]);const{enablePersonalAppNavigationV2:v}=(0,I.w2)(f.w.Extensibility,["enablePersonalAppNavigationV2"]),h=t.useCallback((()=>{d||void 0===e||(N(e),c(!0),p(e).then((()=>k(e,!!v,!0))).catch((()=>{m&&c(!1)})),g(ln({isAppInstallAction:!0,appId:e,appName:n})))}),[e,n,d,m,v,p,k,N,g]),S=t.useCallback((()=>{void 0!==e&&(N(e),k(e,!!v,!0)),g(ln({appId:e,appName:n}))}),[e,n,v,k,g,N]),T=i?s:r?l:o,M=ze();return(0,a.Y)(R.$,{disabled:void 0===e,onClick:i?S:h,className:M.isActionableAppProfileCardAppButton,title:T,"data-tid":`app-profile-card-${i?"open":"add"}-app-button`,children:[d&&(0,a.Y)(Re.y,{size:"extra-small",className:M.isActionableAppProfileCardAppButtonLoader}),T]})},Ke=({name:e})=>{const n=ze();return(0,a.Y)($.D,{className:n.isActionableAppProfileCardTitle,children:e})},$e=({description:e})=>{const n=ze();return(0,a.Y)($.D,{className:n.isActionableAppProfileCardDescription,children:e})},en=()=>{const{addAppInfoBanner:e}=sn(),n=ze();return(0,a.Y)(u.s,{gap:"gap.smaller",className:n.isActionableAppProfileCardHeaderInfoBanner,children:[(0,a.Y)(d.m,{}),(0,a.Y)($.D,{children:e})]})},nn=({developerName:e,developerUrl:n})=>{const i=(0,v.PO)(),r=t.useMemo((()=>i.getTransForNs("extensibility")),[i]),l=ze();return(0,a.Y)($.D,{className:l.isActionableAppProfileCardBodySectionParagraph,children:(0,a.Y)(r,{i18nKey:"ext_actionable_app_profile_card_app_features_created_by",children:(0,a.Y)(ie.N,{target:"_blank",href:n,children:e})})})},an=({appName:e,onPermissionsClick:n,privacyUrl:i,termsOfUseUrl:r})=>{const l=(0,v.PO)(),o=t.useMemo((()=>l.getTransForNs("extensibility")),[l]),{termsOfUse:s,privacyPolicy:d,permissions:c}=sn(),m=ze();return(0,a.Y)(u.s,{vAlign:"end",gap:"gap.medium",children:(0,a.Y)($.D,{className:m.isActionableAppProfileCardConsent,children:(0,a.Y)(o,{i18nKey:"ext_actionable_app_profile_card_consent",children:[(0,a.Y)($.D,{children:{appName:e}}),(0,a.Y)(ie.N,{target:"_blank",href:i,children:{privacyPolicy:d}}),(0,a.Y)(ie.N,{target:"_blank",href:r,children:{termsOfUse:s}}),(0,a.Y)(R.$,{appearance:"transparent",onClick:n,className:m.isActionableAppProfileCardLink,children:{permissions:c}})]})})})},tn=({isShortCard:e,permissionsRef:n,supportsMeetingStreaming:i})=>{const r=(0,v.PO)(),{isActionableAppProfileCardPermission:l,isActionableAppProfileCardPermissionsList:o}=on(),s=t.useMemo((()=>{const n=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extensibility_addAppDialogAppCardPermission1","extensibility_addAppDialogAppCardPermission2","extension_addAppDialogIdentityPermission2"];return i&&n.push("extension_addAppDialog_Permission_Meeting_Streaming_Access"),n}),[e,i]),d=t.useMemo((()=>s.map((e=>({key:e,content:r.translate("extensibility",e),variables:l})))),[l,s,r]),{permissionsTitle:m}=sn(),p=ze();return(0,a.Y)(u.s,{column:!0,ref:n,className:p.isActionableAppProfileCardBodySection,children:[(0,a.Y)($.D,{className:p.isActionableAppProfileCardBodySectionTitle,children:m}),(0,a.Y)(c.B,{variables:o,items:d})]})},rn=({appDef:e})=>{const{appFeaturesTitle:n}=sn(),{developerName:i,developerUrl:t}=e,r=ze();return(0,a.Y)(u.s,{column:!0,className:r.isActionableAppProfileCardBodySection,children:[(0,a.Y)($.D,{className:r.isActionableAppProfileCardBodySectionTitle,children:n}),(0,a.Y)(Ve,{appDef:e}),(0,a.Y)(nn,{developerName:i||"",developerUrl:t||""})]})},ln=({isAppInstallAction:e,appId:n,appName:i})=>({actionGesture:C.Od.click,actionOutcome:C.nd.nav,actionScenario:e?C.vB.appCardAdd:C.vB.appCardOpen,actionScenarioType:C.DB.appCardActions,moduleName:C.Sn.appProfileCard,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,extensibilityData:{id:n,name:i}}),on=()=>{const{vars:e}=(0,r.W)();return t.useMemo((()=>({isActionableAppProfileCardActionButtonsWrapper:e("extensibility",["isActionableAppProfileCardActionButtonsWrapper"]),isActionableAppProfileCardAppButton:e("extensibility",["isActionableAppProfileCardAppButton"]),isActionableAppProfileCardPermission:e("extensibility",["isActionableAppProfileCardPermission"]),isActionableAppProfileCardPermissionsList:e("extensibility",["isActionableAppProfileCardPermissionsList"]),isActionableAppProfileCardConsent:e("extensibility",["isActionableAppProfileCardConsent"]),isActionableAppProfileCardDeveloper:e("extensibility",["isActionableAppProfileCardDeveloper"]),isActionableAppProfileCardLink:e("extensibility",["isActionableAppProfileCardLink"]),isActionableAppProfileCardPresence:e("extensibility",["isActionableAppProfileCardPresence"]),isActionableAppProfileCardTitle:e("extensibility",["isActionableAppProfileCardTitle"]),isActionableAppProfileCardDescription:e("extensibility",["isActionableAppProfileCardDescription"]),isActionableAppProfileCardImageContainer:e("extensibility",["isActionableAppProfileCardImageContainer"]),isActionableAppProfileCard:e("extensibility",["isActionableAppProfileCard"]),isActionableAppProfileCardShort:e("extensibility",["isActionableAppProfileCardShort"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),isActionableAppProfileCardHeader:e("extensibility",["isActionableAppProfileCardHeader"]),isActionableAppProfileCardHeaderDescription:e("extensibility",["isActionableAppProfileCardHeaderDescription"]),isActionableAppProfileCardHeaderButtons:e("extensibility",["isActionableAppProfileCardHeaderButtons"]),isActionableAppProfileCardHeaderInfoBanner:e("extensibility",["isActionableAppProfileCardHeaderInfoBanner"]),isActionableAppProfileCardDivider:e("extensibility",["isActionableAppProfileCardDivider"]),isActionableAppProfileCardBody:e("extensibility",["isActionableAppProfileCardBody","customScrollbar"]),isActionableAppProfileCardBodySection:e("extensibility",["isActionableAppProfileCardBodySection"]),isActionableAppProfileCardBodySectionParagrahp:e("extensibility",["isActionableAppProfileCardBodySectionParagrahp"]),isActionableAppProfileCardBodySectionTitle:e("extensibility",["isActionableAppProfileCardBodySectionTitle"]),isActionableAppProfileCardFooter:e("extensibility",["isActionableAppProfileCardFooter"])})),[e])},sn=()=>{const e=(0,v.PO)();return t.useMemo((()=>({addAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_button_text"),addAppInfoBanner:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_info_banner_text"),addToYourAppsButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_to_your_apps_button_text"),appFeaturesTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_app_features_title"),openAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_open_app_button_text"),permissions:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_link_text"),permissionsTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_title"),privacyPolicy:e.stringTranslate("extensibility","ext_actionable_app_profile_card_privacy_policy_link_text"),termsOfUse:e.stringTranslate("extensibility","ext_actionable_app_profile_card_terms_of_use_link_text")})),[e])};var dn=i(645095),cn=i(420645),mn=i(364819);const un={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"mri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}}]};var pn=i(562292),kn=i(878336);const gn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope"}}]}},{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"externalId"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotConfigurationScope"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}.definitions]},Nn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppProfileCardGetInstalledAppsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"}}]}}]}}]}},...gn.definitions]},vn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppProfileCardUseAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"}}]}}]}},...gn.definitions]},In={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppProfileCardUseAppDefinitionQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"}}]}}]}},...gn.definitions]};var fn=i(735915);const hn=[],Sn=(e,n,i,a,t,r)=>{const l=hn.find((l=>l.botOrAppId===e&&l.isWebhook===n&&(0,mn.isEqual)(l.conversationId,a)&&(0,mn.isEqual)(l.connectorSenderGuid,t)&&(0,mn.isEqual)(l.displayName,r)&&(0,mn.isEqual)(l.togetherModeParams,i)));if(l)return l;const o={botOrAppId:e,togetherModeParams:i,conversationId:a,connectorSenderGuid:t,displayName:r,isWebhook:n,isGetAppDefinitionCallInProgress:!1,listeners:[]};return hn.push(o),o},Tn=(e,n)=>{e&&(e.listeners.forEach((e=>{e(n)})),e.isGetAppDefinitionCallInProgress=!1)},Mn=(e,n,i,a,r,l,o=!1,s=!1)=>{const[d,c]=(0,t.useState)(),{loggerFactory:{newLogger:m},scenarioFactory:u,host:{location:{origin:p}},discover:k}=(0,b.ur)(),g=(0,t.useMemo)((()=>m("AppProfileCardContentContainer","app-profile-card-data")),[m]),N=(0,E.Us)(),{convId:v}=N.chatServiceSubscriptionFilter,{appDefinition:h,isSceneApp:S}=i||{},{entity:T}=(0,se.At)(),M=v||a||"",y=(0,t.useRef)(!1),{enableBotAvatarWithAppDefinition:A}=(0,I.w2)(f.w.Extensibility,["enableBotAvatarWithAppDefinition"]),{copilotAppIdForNewChat:F}=(0,I.w2)(f.w.Messaging,["copilotAppIdForNewChat"]);return(0,t.useEffect)((()=>{const e=Sn(n,o,i,a,r,l);return e.listeners.push(c),()=>{e.listeners=e.listeners.filter((e=>e!==c)),0===e.listeners.length&&(e=>{const n=hn.findIndex((n=>n.botOrAppId===e.botOrAppId&&n.isWebhook===e.isWebhook&&(0,mn.isEqual)(n.conversationId,e.conversationId)&&(0,mn.isEqual)(n.connectorSenderGuid,e.connectorSenderGuid)&&(0,mn.isEqual)(n.displayName,e.displayName)&&(0,mn.isEqual)(n.togetherModeParams,e.togetherModeParams)));n>=0&&hn.splice(n,1)})(e)}}),[n,i,a,r,l,o]),(0,t.useEffect)((()=>{let t;y.current=!0;const s=Sn(n,o,i,a,r,l);if(!s.isGetAppDefinitionCallInProgress){s.isGetAppDefinitionCallInProgress=!0,t=u.newScenario(U.Cu.AppProfileCardGetAppDefinition);const i=(0,Z.Iz)(n)?"Bot.Id":"App.Id";t.appendEventData({[i]:n}),h?y.current&&(Tn(s,h),t.stop()):bn(e,n,M,T,S,r,l,o,p,k,A,F).then((e=>{y.current&&(Tn(s,e),t.stop())})).catch((e=>{const i=`Unable to fetch appDefinition for BotOrAppId: ${n}, Failed with error: ${e}`;!M&&i.toLowerCase().includes("conversationId is undefined".toLowerCase())?y.current&&t&&t.stop():(g.error(i,{botOrAppId:n}),y.current&&t&&t.fail({message:i})),s.isGetAppDefinitionCallInProgress=!1}))}return()=>{y.current=!1,t&&t.cancel()}}),[e,n,p,k,S,g,c,u,h,M,r,T,l,o,a,i,s,A,F]),d},yn=async(e,n,i,a,t)=>{if((0,Z.GX)(n)&&i){return{name:i,largeImageUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg=="}}const{data:r}=await e.query({query:un,variables:{mri:n},context:{callerInfo:"app-profile-card-data"}}),l=r?.user;if(l){const e={name:l.displayName||"",largeImageUrl:l.imageUri??""};return e.largeImageUrl&&t&&a&&!An(e.largeImageUrl,a)&&(e.largeImageUrl=await(async(e,n)=>{let i="";try{i=new URL(await e.regionGtm("urlp")).hostname}catch{i="urlp.asm.skype.com"}return`https://${i}/v1/url/content?url=${encodeURIComponent(n)}`})(t,e.largeImageUrl)),e}return null},An=(e,n)=>(0,pe.d$)(e,n)||(0,ke.D$)(e),bn=async(e,n,i,a,t,r,l,o=!1,s,d,c,m)=>{let u,p;const k=a.type===de.ck.channels;if(k)u="Team";else{const a=i?await Ln(e,i):null;if(a){p=a?.chatSubType===dn.vW.Channel;const e=On(n,a);u=p?"Team":e||t?"Personal":"GroupChat"}}return(k||p)&&(i=await(0,pn.DW)(e,i)??""),Fn(e,n,i,r,u,l,o,s,d,c,m)},Fn=async(e,n,i,a,t,r,l=!1,o,s,d,c)=>{const m=(0,Z.Iz)(n),u=(0,Z.GX)(n)&&!!a,p=l?await(async(e,n,i,a)=>{const{data:t}=await e.query({query:In,variables:{conversationId:n,scope:a||"Team",appId:i},context:{callerInfo:"app-profile-card-data-getAppDefinitionForOutgoingWebhook"}});return t?.appDefinition?t.appDefinition:null})(e,i,n,t):u?await(async(e,n,i,a)=>{if(!i)return null;const{data:t}=await e.query({query:vn,variables:{conversationId:n,scope:a,options:{capabilityFilter:["Connector"],connectorId:i}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForConnector"}});return t?.appDefinitions?.length&&t.appDefinitions[0]?t.appDefinitions[0]:null})(e,i,a,t):m?Cn(n,c)?await Dn(e,n,i,t):await(d?(0,fn.fP)(e,n,i,t):(async(e,n,i,a)=>{const{data:t}=await e.query({query:vn,variables:{conversationId:i,scope:a,options:{botId:(0,kn.Uf)(n)}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForBot"}});return t?.appDefinitions?.length&&t.appDefinitions[0]?t.appDefinitions[0]:null})(e,n,i,t)):await(async(e,n,i,a)=>{const{data:t}=await e.query({query:In,variables:{conversationId:i,scope:a,appId:n},context:{callerInfo:"app-profile-card-data-getAppDefinitionForApp"}});return t?.appDefinition?t.appDefinition:null})(e,n,i,t);if(p)return p;return m?await yn(e,n,r,o,s):null},Cn=(e,n)=>!!n&&(0,Z.Iz)(e)&&(0,kn.Uf)(e)===n,Dn=async(e,n,i,a)=>{const t=(0,kn.Uf)(n),r={scope:a||"Personal",conversationId:i},{data:l}=await e.query({query:Nn,variables:{installedContext:r,options:{botId:t,includeUnlicensedApps:!0}},context:{callerInfo:"app-profile-card-data-gcp"}}),o=l?.installedAppsV2?.filter((e=>e?.definition?.bots?.some((e=>e.id===t))));return o?.[0]?.definition?o?.[0]?.definition:null},Un=e=>e?.bots&&e.bots.length>0&&(0,mn.includes)(e.bots[0].scopes,"Personal")||!1,En=(e,n,i)=>{const[a,r]=(0,t.useState)(!1),[l,o]=(0,t.useState)(!1),[s,d]=(0,t.useState)(!0),c=(0,E.Us)(),{scenarioFactory:m}=(0,b.ur)(),u=(0,F.U)("AppProfileCardContentContainer");return(0,t.useEffect)((()=>{const a=Pn(n);if(!a)return;const{convId:t}=c.chatServiceSubscriptionFilter;let l,s=!1;const p=t||i;return p&&(s=!0,l=m.newScenario(U.Cu.UseOneOnOneAndDisabledByTenantChecker),Ln(e,p).then((e=>{s&&(r(!e||On(a,e)),o(!e||xn(a,e)),d(!e||On(a,e)),l.stop())})).catch((()=>{const e=`Failed to get conversation with conversationId:${t} for bot/app:${a}`;u.error(e,{botMri:a}),s&&l&&l.fail({message:e})}))),()=>{s=!1,l&&l.cancel()}}),[c.chatServiceSubscriptionFilter,n,e,u,m,i]),{isDisabledByTenant:l,isOneOnOne:a,isOneOnOneBotChat:s}},wn=(e,n)=>{const[i,a]=(0,t.useState)(!1),{scenarioFactory:r}=(0,b.ur)(),l=(0,F.U)("AppProfileCardContentContainer");return(0,t.useEffect)((()=>{const i=Pn(n);if(!i)return;let t=!0;const o=r.newScenario(U.Cu.UseDisabledByUserChecker);return(0,A.QL)(e,i).then((e=>{t&&(a(!e||xn(i,e)),o.stop())})).catch((()=>{const e=`Failed to get conversation for bot/app:${i}`;l.error(e,{botMri:i}),t&&o&&o.fail({message:e})})),()=>{t=!1,o&&o.cancel()}}),[n,e,l,r]),i},Ln=async(e,n)=>{const i=await e.query({query:cn.A,variables:{convId:n},context:{callerInfo:"app-profile-card-data"}});return i.data?.chat},On=(e,n)=>!!n&&!!n.isOneOnOne&&!!n.memberIds&&-1!==n.memberIds.indexOf(e),xn=(e,n)=>!!n&&!!n.isDisabled&&!!n.memberIds&&-1!==n.memberIds.indexOf(e),Pn=e=>{let n=e&&e.bots&&e.bots.length>0&&e.bots[0].id;if(n){const e=n?.startsWith(H.gN.BotPrefix);n=e?n:`${H.gN.BotPrefix}${n}`}return n||null},Vn=e=>e&&e.meetingExtensionDefinition&&e.meetingExtensionDefinition.scenes&&e.meetingExtensionDefinition.scenes.length>0?e.meetingExtensionDefinition.scenes.length:0,jn=e=>{const n={supportsCalling:!1,supportsVideo:!1},i=e?.bots&&e?.bots[0]?.capabilities;return n.supportsCalling=i?.supportsCalling??!1,n.supportsVideo=i?.supportsVideo??!1,n},Bn=e=>(e?.bots&&e?.bots[0]?.configuration)??null,zn="ext_actionable_app_profile_card_use_is_app_installed_get_installed_apps",Rn=({client:e,botIdOrAppId:n,hideActionButtons:i,hideAppButton:r,appDef:l,togetherModeParams:o,convId:s})=>{const{isOneOnOne:d,isDisabledByTenant:c,isOneOnOneBotChat:m}=En(e,l,s),u=wn(e,l),p=l&&Pn(l),k=l&&Vn(l),g=l&&jn(l),N=l&&Bn(l),{id:v,name:h,privacyUrl:S,termsOfUseUrl:T,largeImageUrl:M,shortDescription:y,meetingExtensionDefinition:A}=l,C=Un(l),D=!C&&!!i,U=((e,n)=>{const[i,a]=t.useState(null),{scenarioFactory:r}=(0,b.ur)(),l=(0,F.U)("useIsAppInstalled"),{enableAppsQueryOptimization:o,enableInstalledAppQueryOptimization:s}=(0,I.w2)(f.w.Extensibility,["enableAppsQueryOptimization","enableInstalledAppQueryOptimization"]);return t.useEffect((()=>{(0,we.tN)(e,l,r,n,o,"use-is-app-installed",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:s}).then((e=>{const n=`Loaded installed apps. Length: ${e.length}`;l.infoToTelemetry?l.infoToTelemetry(n,zn):l.log(`${zn}: ${n}`),a(e.length>0)})).catch((()=>{const e=`Failed to get installed apps by ID for app id: ${n}`;l.errorToTelemetry?l.errorToTelemetry(e,zn):l.error(`${zn}: ${e}`)}))}),[e,l,r,n,o,s]),i})(e,v),E=(e=>{const n="Personal",i=(0,we.vx)(n,e.bots)||(0,we.vx)(n,e.galleryTabs)||(0,we.vx)(n,e.staticTabs),a=(0,we.vx)(n,e.messageExtensions)&&!!e.messageExtensions?.some((e=>(e.commands?.length??0)>0)),t=(e.meetingExtensionDefinition?.scenes?.length??0)>0,r=(e.meetingExtensionDefinition?.filters?.length??0)>0;return i||t||r||a})(l);return(0,a.Y)(We,{appDef:l,botName:Qn(h),privacyUrl:Qn(S),termsOfUseUrl:Qn(T),iconUrl:Qn(M),description:Qn(y),botIdOrAppId:p||n,showRectAppImage:!!o?.isSceneApp||D,sceneCount:k||0,isSceneApp:!!o?.isSceneApp,showActionButtons:C&&!d&&!c&&!u&&!i,hideAppButton:r,sceneName:Qn(o?.sceneName),botCallingCapabilities:g,appId:v,supportsMeetingStreaming:A?.supportsStreaming,hasPersonalScope:E,isInstalled:!!U,botConfiguration:m?null:N})},Qn=e=>e||"",Wn=({client:e,botIdOrAppId:n,hideActionButtons:i,appDef:t,togetherModeParams:r,convId:l})=>{const{isOneOnOne:o,isDisabledByTenant:s,isOneOnOneBotChat:d}=En(e,t,l),c=wn(e,t),m=t&&Pn(t),u=t&&Vn(t),p=t&&jn(t),k=t&&Bn(t),{id:g,name:N,privacyUrl:v,termsOfUseUrl:I,developerName:f,largeImageUrl:h,longDescription:S,shortDescription:T,meetingExtensionDefinition:M}=t,y=Un(t),A=!y&&i||!1,b=!t?.id&&!i;return(0,a.Y)(ge,{botName:Yn(N),privacyUrl:Yn(v),termsOfUseUrl:Yn(I),developerName:Gn(r)?"":Yn(f),iconUrl:Yn(h),description:Gn(r)?Yn(T):Yn(S),botIdOrAppId:m||n,showRectAppImage:Gn(r)||A,isShortProfileCard:b,sceneCount:u||0,isSceneApp:!!Gn(r),showActionButtons:y&&!o&&!s&&!c&&!i&&!b,sceneName:Yn(r&&r.sceneName),botCallingCapabilities:p,appId:g,supportsMeetingStreaming:M?.supportsStreaming,botConfiguration:d?null:k,appDef:t})},Yn=e=>e||"",Gn=e=>e&&e.isSceneApp;var _n=i(619761);const Zn=({className:e})=>(0,a.Y)(K.s,{className:e,children:(0,a.Y)(u.s,{fill:!0,vAlign:"center",hAlign:"center",children:(0,a.Y)(Re.y,{})})});var Hn=i(140336);const Jn=(0,Y.O)({isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"}}),Xn=t.memo((({children:e,client:n,botIdOrAppId:i,hideActionButtons:s,hideAppButton:d,position:c,align:m,offset:u,togetherModeParams:p,autoFocus:k,connectorSenderGuid:g,conversationId:N,onBehalfOfId:v,renderTriggerAsLink:h=!0,displayName:S,tabbableTrigger:T,nonFocusableTrigger:M})=>{const y=t.useContext(_n.I18nContext),{recordPanelAction:A,createDatabag:b}=(0,D.ib)(),F=t.useRef(!1),{enableAppProfileCard:U,enableActionableAppProfileCard:E,enableInstalledAppQueryOptimization:w}=(0,I.w2)(f.w.Extensibility,["enableAppProfileCard","enableActionableAppProfileCard","enableInstalledAppQueryOptimization"]),O=Jn(),{vars:x}=(0,r.W)(),[P,V]=t.useState(!1),j=(0,Z.BG)(i),B=Mn(n,j&&v?v:i,p,N,g,S,j,!!w),z=(0,mn.debounce)((()=>{V(!0)}),1e3),R=t.useCallback(((e,n)=>{const i=n?.open;if(z.cancel(),!0===i?z():V(!1),i&&!F.current){const e=L(C.Od.hover,C.nd.inspect,C.vB.appProfileCardAppear,C.Sn.appProfileCard,B?.name??void 0,B?.id,B?.bots?.[0]?.id);E&&(e.dataBag=b(),e.dataBag.actionableAppProfileCard=!0),A(e)}void 0!==i&&i!==F.current&&(F.current=i)}),[b,A,B,E,F,z]),Q=t.useMemo((()=>Kn(!!E)),[E]);if(!U)return(0,a.Y)(t.Fragment,{children:e});if(null===B)return null;const W=((e,n,i,a)=>{if(i){const{name:t,developerName:r,longDescription:l,shortDescription:o}=i,s=a?.sceneName,d=Vn(i),c=(n?o:l)||"";return e.stringTranslate("extensibility","app_profile_card_app_information_dialog_aria_label",{sceneName:s||"",name:t||"",developerName:r||"",sceneCount:d||0,longDescription:c})}return""})(y,!!E,B,p),Y=e??B?.name;return(0,a.Y)(l.z,{on:"hover",position:c||"before",align:m||"center",offset:u,open:P,onOpenChange:R,autoFocus:k,trapFocus:qn(k),autoSize:!0,content:{"aria-label":W,autoFocus:!0,className:Hn.n,content:B?(0,a.Y)(Q,{botIdOrAppId:i,client:n,appDef:B,hideActionButtons:s,hideAppButton:d,togetherModeParams:p,convId:N}):(0,a.Y)(Zn,{className:O.isAppProfileCard}),variables:{removePopupContentPadding:!0,hasNoBorder:!0}},tabbableTrigger:T,trigger:(0,a.Y)(o.E,{"data-tid":"app-profile-card-trigger",link:!!h,content:Y,variables:x("extensibility",["isFocusableOutlineBorder"]),...M&&{tabIndex:"-1"}}),overflowBoundary:"window",flipBoundary:"window"})})),qn=e=>!!e&&!e,Kn=(e=!1)=>e?Rn:Wn,$n=(0,M.W)(Xn)},814356:(e,n,i)=>{"use strict";i.d(n,{R4:()=>u,IZ:()=>m,A_:()=>p});var a=i(957032),t=i(513432),r=i(959022),l=i(899273);const o={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",width:"1px",position:"absolute"},s=t.forwardRef((({assertive:e,targetDocument:n},i)=>{const[s,d]=t.useState(""),c=t.useRef(),m=(0,l.ur)(),u=m?m.host:window,p=/Mac|iPod|iPhone|iPad/.test(u.navigator.platform),k=t.useCallback((e=>{d(e),null!==c.current&&u.clearTimeout(c.current),c.current=u.setTimeout((()=>{d(""),null!==c.current&&u.clearTimeout(c.current),c.current=null}),2e3)}),[c,u,d]);t.useImperativeHandle(i,(()=>({announce:k}))),t.useEffect((()=>()=>{null!==c.current&&u.clearTimeout(c.current)}),[c,u]);const g=n?n.body:u.document.body;let N=null;if(p){const e=n?n.activeElement:u.document.activeElement;N=e?.closest("*[aria-modal='true']")}const v=N||g;return r.createPortal((0,a.Y)("div",{"aria-live":e?"assertive":"polite","aria-atomic":"true",style:o,children:s}),v)}));var d=i(35871),c=i(106255);const m=({children:e,targetDocument:n})=>{const i=t.useRef(),r=t.useRef(),l=t.useCallback(((e,n)=>{const a=n?r.current:i.current;a&&a.announce(e)}),[r,i]),o=t.useMemo((()=>({announce:l})),[l]),m=t.useMemo((()=>({announce:(e,n)=>{const i=!!n&&!n.polite;l(e,i)}})),[l]);return(0,a.Y)(t.Fragment,{children:[(0,a.Y)(s,{assertive:!1,ref:i,targetDocument:n}),(0,a.Y)(s,{assertive:!0,ref:r,targetDocument:n}),(0,a.Y)(d.AnnounceProvider,{value:m,children:(0,a.Y)(c.AriaLiveContext.Provider,{value:o,children:e})})]})},u=c.AriaLiveContext.Consumer,p=()=>t.useContext(c.AriaLiveContext)},28544:(e,n,i)=>{"use strict";i.d(n,{j:()=>se});var a=i(957032),t=i(364819),r=i(513432),l=i(554186),o=i(398128),s=i(851075),d=i(899273),c=i(665980),m=i(99425),u=i(846716),p=i(484699),k=i(129123),g=i(754255),N=i(169233),v=i(952691),I=i(935197),f=i(139150),h=i(806658),S=i(388593),T=i(98687),M=i(855167),y=i(115100),A=i(937545),b=i(131647),F=i(75106),C=i(513527),D=i(913902),U=i(778803),E=i(526521),w=i(792529),L=i(794171);var O=i(965804);const x=(0,O.O)({avatarObjectFit:{st4lth:"f1ps3kmd"},groupChatAvatarObjectFit:{st4lth:"f1plgu50"}}),P=(0,O.O)({mercuryHexagonalAvatarBorder:{Bw0xxkn:"f13sgyd8"}}),V=(0,O.O)({teamAvatarBorder:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},teamHighContrastAvatarBorder:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f12wbrtg"}});var j=i(175772);const B=r.memo((({simpleAvatarType:e,...n})=>{const{enableFluentV9Avatar:i}=(0,k.w2)(g.w.People,["enableFluentV9Avatar"]);return e?(0,a.Y)(ie,{enableFluentV9Avatar:!!i,simpleAvatarType:e,...n}):(0,a.Y)(z,{...n})})),z=({accessibilityLabel:e,alt:n,presenceUserId:i,profilePictureType:a,presenceSource:t,isPresencePrefetched:l,isEmergencyCallTarget:o,shouldAllowContextMenu:m,isFocusable:u,hexagonal:p,square:N,userId:v,personaType:I,hostConversationId:f,isDoubleClickDisabled:h,narrateProfilePicture:T,callerInfo:M,statusSize:y,isSharedChannel:A,isXtapUserUrl:b,draggable:D,isTeamHeaderEmblemExpanded:U,hidePersonaCard:w,v9ClassName:O,role:j,avatarUrl:B,cacheKey:z,isGroupChatAvatarPresetOrEmojiPicture:Q=!1,displayName:W,onError:Y,...ne})=>{const ie=(0,s.U)("AvatarRenderer"),ae=r.useRef(null),te=(()=>{const{host:e}=(0,d.ur)(),{avatarDoubleClickDelayInMs:n}=(0,k.w2)(g.w.People,["avatarDoubleClickDelayInMs"]),i=r.useRef(null),a=n||0,t=e=>{l(),null!==e&&null!==e.current&&e.current.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},l=()=>{i.current&&e.clearTimeout(i.current),i.current=null};return r.useEffect((()=>()=>{i.current&&(e.clearTimeout(i.current),i.current=null)}),[e,i]),(n,r,o,s)=>{a>0&&!o?(n.preventDefault(),n.stopPropagation(),i.current?l():i.current=e.setTimeout((()=>{t(r),s&&s(n)}),a)):s&&s(n)}})(),re=V(),le=P(),oe=x(),{isOnline:se}=(0,d.WB)(),{themeType:de}=(0,F.z2)(),ce=(0,c.bE)(),[me,ue]=r.useState(!1),[pe,ke]=r.useState(B),[ge,Ne]=r.useState(!1),{entityCommanding:ve,user:Ie,avatarImageCache:fe}=(0,d.ur)(),{enableShowPresenceInCriticalPhase:he}=(0,k.w2)(g.w.Presence,["enableShowPresenceInCriticalPhase"]),{msgEnableSelfChat:Se,allowUserChat:Te,enableChatActionFromAvatar:Me,enableFluentV9Avatar:ye,enableFailedAvatarReloadOnNetworkReconnect:Ae,enableInitialsAvatarOnError:be,enableMercuryDesign:Fe}=R(),{onClick:Ce,onKeyDown:De,onMouseEnter:Ue,onMouseLeave:Ee}=(0,C.q0)({userId:v,personaType:I,hostConversationId:f}),we=H(T,e),Le=r.useCallback((e=>{ue(e.isError),ke(e.currentUrl),Ne(e.shouldReload)}),[]),Oe=(0,E.z)((a===S.It.Team||N)&&re.teamAvatarBorder,de===L.SV.Contrast&&re.teamHighContrastAvatarBorder,O,!!Fe&&!!p&&le.mercuryHexagonalAvatarBorder),xe=ee(!!Ae,me,se,ge,B,a,o,!!be,ce,W||""),Pe=q(a,u,N),Ve={...ne.variables,...Pe},je={profilePictureType:a,imageUrl:xe,isEmergencyCallTarget:o,logger:ie,avatarState:{currentUrl:pe,isError:me,shouldReload:ge},isOnline:se,setAvatarState:Le},Be=ye?void 0:Z(i,t,l,y),ze=!!p,Re={...G(!!u,xe,n,D,e,Q?oe.groupChatAvatarObjectFit:oe.avatarObjectFit),onError:e=>{$(je,Y)},onLoad:e=>{(e=>{try{const n=new URL(e);if("https:"!==n.protocol)return!1;const i=n.searchParams.get("size");if(null!==i&&i!==S.xi.Small)return!1}catch(e){return!1}return!0})(xe)&&fe?.add(z||xe,xe),K(je)},onContextMenu:e=>J(e,m),onDoubleClick:e=>{X(h,Te,Me,v,a,Ie,ve,Se),e.stopPropagation()},onClickCapture:e=>te(e,ae,h,Ce),...!w&&!ze&&{onKeyDown:De,onMouseEnter:Ue,onMouseLeave:Ee}},Qe={root:{isTeamHeaderEmblemExpanded:U},image:{...we,...Re,variables:Ve},status:Be?{...Be,variables:Ve}:Be,...ne},We=Qe["data-tid"],Ye=we["aria-label"];return _(i,t,Qe,Re,ae,Oe,Pe,p,!!ye,We,j,!!u,Ye,!!he,T)},R=()=>{const{msgEnableSelfChat:e}=(0,k.w2)(g.w.Host,["msgEnableSelfChat"]),{allowUserChat:n,enableChatActionFromAvatar:i}=(0,k.w2)(g.w.Messaging,["allowUserChat","enableChatActionFromAvatar"]),{enableFluentV9Avatar:a,enableFailedAvatarReloadOnNetworkReconnect:t,enableInitialsAvatarOnError:r}=(0,k.w2)(g.w.People,["enableFluentV9Avatar","enableFailedAvatarReloadOnNetworkReconnect","enableInitialsAvatarOnError"]),{enableMercuryDesign:l}=(0,k.w2)(g.w.MercuryDesign,["enableMercuryDesign"]);return{msgEnableSelfChat:e,allowUserChat:n,enableChatActionFromAvatar:i,enableFluentV9Avatar:a,enableFailedAvatarReloadOnNetworkReconnect:t,enableInitialsAvatarOnError:r,enableMercuryDesign:l}},Q=e=>{if(!(0,M.ab)(y.Jj.POST_CRITICAL)||!e.presenceUserId)return(0,a.Y)(W,{...e,isFocusable:!1});const{hexagonal:n,presenceUserId:i,presenceSource:t,avatarRef:r,commonImgAttributes:l,role:o,isFocusable:s,v9AllStyles:d,dataTid:c,ariaLabel:m,size:u,narrateProfilePicture:p}=e;return(0,a.Y)(Y,{hexagonal:!!n,presenceUserId:i,presenceSource:t||"ups",avatarRef:r,commonImgAttributes:{...l,role:o||(s?"img":"presentation")},v9AllStyles:d,dataTid:c,ariaLabel:m,size:u,narrateProfilePicture:p})},W=({hexagonal:e,dataTid:n,v9AllStyles:i,commonImgAttributes:t,size:r,isFocusable:l,role:o,avatarRef:s})=>e?(0,a.Y)(D.A,{commonImgAttributes:t,className:i,size:(0,T.BY)(r)}):(0,a.Y)(w.e,{"data-tid":n,image:{...t},ref:s,className:i,size:(0,T.BY)(r),role:o||(l?"img":"presentation")}),Y=({hexagonal:e,presenceUserId:n,presenceSource:i,avatarRef:t,commonImgAttributes:r,v9AllStyles:l,dataTid:o,size:s,ariaLabel:d,narrateProfilePicture:c,role:m})=>{const u=(0,U.qI)(n,i);let p=!0;return c&&(p=!1),e?(0,a.Y)(D.A,{"aria-label":d,badgeProps:u,commonImgAttributes:r,className:l,size:(0,T.BY)(s)}):(0,a.Y)(w.e,{"aria-hidden":p,"aria-label":d,badge:u,"data-tid":o,image:{...r},ref:t,className:l,size:(0,T.BY)(s),role:m})},G=(e,n,i,a,t,r)=>({alt:i,src:n,draggable:a,...e&&{"data-is-focusable":!0,"aria-haspopup":!0,"aria-hidden":!1,"aria-label":t,tabIndex:0},className:r}),_=(e,n,i,t,r,l,o,s,d,c,m,u,p,k,g)=>{const N=s?D.A:I.e;return d?e&&k?(0,a.Y)(Y,{hexagonal:!!s,presenceUserId:e,presenceSource:n||"ups",avatarRef:r,commonImgAttributes:{...t,role:m||(u?"img":"presentation")},v9AllStyles:l,dataTid:c,ariaLabel:p,size:i?.size,narrateProfilePicture:g}):(0,a.Y)(Q,{hexagonal:!!s,presenceUserId:e,presenceSource:n||"ups",commonImgAttributes:t,v9AllStyles:l,size:i?.size,avatarRef:r,role:m??"presentation",isFocusable:u,dataTid:c}):(0,a.Y)(N,{...i,variables:{...i?.variables,...o},ref:r})},Z=(e,n,i,t)=>e?{children:(r,l)=>{const o=t?{size:t}:{};return(0,a.Y)(U.Fd,{userId:e,ProvidedStatus:r,presenceSource:n,isPresencePrefetched:i,...l,...o})}}:void 0,H=(e,n)=>{const i={};return"boolean"==typeof e&&(i["aria-hidden"]=!e),n&&(i["aria-label"]=n),i},J=(e,n)=>{n||(e.preventDefault(),e.stopPropagation())},X=async(e,n,i,a,t,r,l,o)=>{!e&&n&&i&&a&&!(0,h.FL)(a)&&t===S.It.User&&(o||r?.id!==a)&&await l.chat.chatWithUsers({userIds:[a],entityCommand:{stateTransition:A.Ar.new,visibilityState:A.Rp.show,correlation:{source:b.p.Avatar}}})},q=(e,n,i)=>({...(e===S.It.Team||i)&&{isTeamProfilePicture:!0},...n&&{hasCursorPointer:!0}}),K=e=>{e.avatarState.isError?e.isOnline&&e.avatarState.shouldReload?e.setAvatarState({...e.avatarState,isError:!1,shouldReload:!1}):e.logger.debug("Avatar onLoad. Returning without triggering state change."):e.setAvatarState({...e.avatarState,isError:!1})},$=(e,n)=>e.avatarState.isError?(e.avatarState.shouldReload?e.setAvatarState({currentUrl:(0,T.Ng)(e.profilePictureType,e.isEmergencyCallTarget),isError:!0,shouldReload:!1}):e.logger.debug("Avatar onError. Returning without triggering state change"),!1):(e.logger.warn("Avatar load failed. Handling onError by setting currentUrl in state to default image."),e.setAvatarState({currentUrl:"",isError:!0,shouldReload:!e.isOnline}),n&&n(),!1),ee=(e,n,i,a,r,l,o,s,d,c)=>{let m=r;if(n&&(!e||!i||!a)&&(m=(0,T.Ng)(l,o),s&&l===S.It.User)){(0,t.isEmpty)(c)&&(c=ne(r));m=`${d}${j.kv.replace("{displayName}",encodeURIComponent(c))}`}return m},ne=e=>{const n=new URLSearchParams(e.slice(e.indexOf("?")));return n.get("displayName")||n.get("displayname")||""},ie=({simpleAvatarType:e,enableFluentV9Avatar:n,onError:i,...t})=>{const l=t["data-tid"];if(n)return(0,a.Y)(w.e,{className:t.v9ClassName,size:(0,T.BY)(t.size),"data-tid":l,...t.label&&{initials:{children:(0,a.Y)(r.Fragment,{children:t.label})}},...t.v9Icon&&{icon:t.v9Icon},...t.name&&{name:t.name},...t.avatarUrl&&{image:{src:t.avatarUrl,...i?{onError:i}:{}}}});{const{variables:e}=t;return(0,a.Y)(I.e,{variables:e,size:t.size,"data-tid":l,...t.label&&{label:{children:(0,a.Y)(r.Fragment,{children:t.label})}},...t.icon&&{icon:t.icon},...t.name&&{name:t.name},...t.avatarUrl&&{image:{src:t.avatarUrl,...i?{onError:i}:{},...t.variables?{variables:t.variables}:{}}}})}};var ae=i(156816);const te=[S.It.User,S.It.Group,S.It.Team],re=(e,n,i,a,t=S.xi.Small)=>{const{user:r,avatarImageCache:l,coreSettings:o}=(0,d.ur)(),{enableAvatarUrlCacheLookup:s}=(0,k.w2)(g.w.ImageCache,["enableAvatarUrlCacheLookup"]),{enableMSAProfilePicture:c}=(0,k.w2)(g.w.People,["enableMSAProfilePicture"]),m=(0,T.L9)(e,n),{entity:u}=(0,T.WF)(e,n);if(!s||!l||r?.id===m)return null;const p=(0,T.EO)(m,i,e?.groupId||e?.teamThreadId,c,a||!1,void 0,void 0,void 0,u,o);if(!te.includes(p))return null;const N=[t];if(u&&(e=>"id"in e&&!!e.id)(u))N.push("user"),N.push(u.id),N.push(u.displayName),N.push(u.imageUri);else if(u&&(e=>Array.isArray(e))(u)&&u.length>1)N.push("group"),N.push(u.map((e=>`${e.id}-${e.displayName}`)).slice(0,j.kk).join("-"));else{if(!u||!(e=>"groupId"in e&&!!e.groupId)(u))return null;N.push("team"),N.push(u.groupId),N.push(u.displayName),N.push(u.pictureETag)}const v=N.filter(Boolean).join("-"),I=l?.getUrl(v);return{cacheKey:v,cachedUrl:I}};var le=i(213991);const oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isSelfProfileAvatar"},value:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"updateType"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}}]}}]}}]},se=({simpleAvatarType:e,avatarUrl:n,isMeetingChat:i,...r})=>{const{vars:l}=(0,v.W)();if(e)return(0,a.Y)(B,{simpleAvatarType:e,avatarUrl:n||"",profilePictureType:S.It.Simple,...r});if(i){const e=Array.isArray(r.variables)?r.variables:[];return(0,a.Y)(I.e,{icon:(0,a.Y)(N.zJo,{}),variables:l("search",(0,t.merge)(["meetingChatAvatar"],e))})}return(0,a.Y)(de,{avatarUrl:n,...r})},de=({users:e,team:n,profilePictureSize:i,isEmergencyCallTarget:a,requesterObjectId:t,baseImageUrl:r,skipAvatarQuery:l,avatarUrl:o,onError:c,...m})=>{const u=(0,s.U)("AvatarContainer"),{user:p,scenarioFactory:k}=(0,d.ur)(),g=(0,T.L9)(n,e),N=p?.id===g,{baseUrlFromHook:v,isCookieValid:I,client:f}=pe(),S=ke(),{isAnonymousAccount:M,currentUserObjectId:y}=ge(),A=t||y,{entity:b,generator:F}=(0,T.WF)(n,e),C=r||v,D=(e=>{const n=(0,s.U)("MsaProfileAvatarSubscription"),{data:i,loading:a,error:t}=(0,le.R)(oe,{skip:!e,variables:{isSelfProfileAvatar:e}});return(t||!a&&!i&&e)&&n.error("msa profile avatar subscription failed"),i?.msaProfileAvatarChangedEvent})(N&&S.enableMsaSelfProfileAvatarUpdateSubscription);o=Ne(!!g,o,A,i,n,e);const U=ue(o||e?.[0]?.avatarUrl,i,!!g&&(0,h.AF)(g),!n&&!g&&!!m.conversationId,S.enableCacheCheckOnAvatarUrlFromCaller,I),{cacheKey:E,cachedUrl:w}=re(n,e,m.conversationId,m.showMergedAvatarForGroup,i)||{},L=l||!!U||!!w;L&&u.debug(`Skipping generating avatar URL. skipAvatarQuery: ${l}, propsAvatarUrl: ${U}, cachedUrl: ${w}, callerInfo: ${m.callerInfo}`);const O=ce(m),x=(0,ae.g)({avatarEtag:(0,T.Dm)(D,p,g),baseImageUrl:C,client:f,currentUserOid:A,entity:b,generator:F,isAnonymousAccount:M,isEmergencyCallTarget:a,isImageAuthCookieValid:I,logger:u,profilePictureSize:i,scenarioFactory:k,teamId:n?.groupId||n?.teamThreadId,userId:g,skipGeneratingUrl:L,...S,...O},m.callerInfo),P=U||w||x,V=(0,T.X3)(P),{onError:j}=me({callerInfo:m.callerInfo,skipGeneratingUrl:L,propsAvatarUrl:U,cachedUrl:w,generatedUrl:x,baseImageUrl:C,isCookieValid:I,generator:F,isSelfProfileAvatar:N,forSharedChannel:!!O.isSharedChannel,isXtapUserUrl:V,logger:u,scenarioFactory:k,onErrorFromProps:c});return ve({generator:F,entity:b,userId:g,conversationId:O.conversationId,hostTenantId:O.hostTenantId,avatarUrl:P,draggable:!1,isBotAvatar:(0,T.Ch)(g?e?.[0]:void 0),cacheKey:E,isXtapUserUrl:V,isEmergencyCallTarget:a,onError:j,...m})},ce=e=>{const{conversationId:n,showMergedAvatarForGroup:i,showUpdatedGroupAvatar:a,onBehalfOfId:t,hostTenantId:r,isSharedChannel:l}=e;return{conversationId:n,showMergedAvatarForGroup:i,showUpdatedGroupAvatar:a,onBehalfOfId:t,hostTenantId:r,isSharedChannel:l}},me=({callerInfo:e,skipGeneratingUrl:n,propsAvatarUrl:i,cachedUrl:a,generatedUrl:t,baseImageUrl:l,isCookieValid:o,generator:s,isSelfProfileAvatar:d,forSharedChannel:c,isXtapUserUrl:m,logger:u,scenarioFactory:p,onErrorFromProps:k})=>{const g=ke(),N=r.useMemo((()=>({callerInfo:e,skipGeneratingUrl:n,propsAvatarUrl:i,cachedUrl:a,generatedUrl:t,baseImageUrl:l,isCookieValid:o,profilePictureType:s.profilePictureType,isSelfProfileAvatar:d,forSharedChannel:c,isXtapUserUrl:m,logger:u,scenarioFactory:p})),[l,a,t,s.profilePictureType,o,d,m,u,c,i,e,p,n]),v=r.useMemo((()=>((e,n,i)=>n||(e?()=>{(0,T.Qc)(i)}:void 0))(g.enableFBSTelemetryForAvatarStatus,k,N)),[g.enableFBSTelemetryForAvatarStatus,N,k]);return{onErrorArgs:N,onError:v}},ue=(e,n,i,a,t,l)=>{const o=(0,T.eB)(e,n,i),s=t&&!l&&!!o,d=s?(0,T.UI)(o,i,a):o,[c,m]=r.useState(d),u=r.useRef(!1);return r.useEffect((()=>(u.current=!0,s&&d!==o?(0,T.iU)(o).then((e=>{const n=e?o:d;u.current&&m(n)})):m(o),()=>{u.current=!1})),[s,d,o]),s?c:o},pe=()=>({baseUrlFromHook:(0,c.bE)(),isCookieValid:(0,c.XF)(),client:(0,f.m)()}),ke=()=>{const{enableMSAProfilePicture:e,enableMsaSelfProfileAvatarUpdateSubscription:n,enableCachedAvatarCheck:i,enableProfilePicturesWithObjectId:a,enableSampleAvatarFetch:t,enableAvatarUrlQuery:r,enableFBSTelemetryForAvatarStatus:l,enableCacheCheckOnAvatarUrlFromCaller:o}=(0,k.w2)(g.w.People,["enableMSAProfilePicture","enableMsaSelfProfileAvatarUpdateSubscription","enableCachedAvatarCheck","enableProfilePicturesWithObjectId","enableSampleAvatarFetch","enableAvatarUrlQuery","enableFBSTelemetryForAvatarStatus","enableCacheCheckOnAvatarUrlFromCaller"]),{enableConnectorsProfileInChannels:s}=(0,k.w2)(g.w.Extensibility,["enableConnectorsProfileInChannels"]),{customViewBots:d}=(0,k.w2)(g.w.Calling,["customViewBots"]),{enableEntityMoreInfo:c}=(0,k.w2)(g.w.Core,["enableEntityMoreInfo"]),m=!!(d&&d.length>0);return{enableCachedAvatarCheck:!!i,enableConnectorsProfileInChannels:!!s,enableMSAProfilePicture:!!e,enableFBSTelemetryForAvatarStatus:!!l,isProfilePictureWithObjectIdEnabled:!!a,enableSampleAvatarFetch:!!t,enableAvatarUrlQuery:!!r,customViewBots:d||[],enableMsaSelfProfileAvatarUpdateSubscription:!!n,enableCacheCheckOnAvatarUrlFromCaller:!!o,enableEntityMoreInfo:!!c,isCustomViewBots:m,customViewBotIds:m?d[0]:{}}},ge=()=>{const{authenticationUser:e}=(0,d.ur)(),n=e?.type===m.aS.Anonymous,i=e?.type===m.aS.Msa||e?.type===m.aS.MsaLife,a=e?.id;return{isAnonymousAccount:n,isTflUser:i,currentUserObjectId:a}},Ne=(e,n,i,a,t,r)=>{const l=(0,u.PO)(),o=(0,c.bE)(),{user:s}=(0,d.ur)(),{displayName:m,entity:p,generator:k}=(0,T.WF)(t,r),g=(0,T.xG)(!!e,l,n,m),N=p?.id===s?.id,v=ke();return g?k.generateUrl(p,o,v.isProfilePictureWithObjectIdEnabled,i,a,!1,void 0,void 0,void 0,void 0,void 0,N):n},ve=({avatarUrl:e,generator:n,hidePersonaCard:i,isEmergencyCallTarget:t,isFocusable:s,role:d,shouldAllowContextMenu:c,userId:m,isDoubleClickDisabled:u,statusSize:k,isSharedChannel:g,conversationId:N,hostTenantId:v,draggable:I,connectorSenderGuid:f,onBehalfOfId:h,displayName:S,isBotAvatar:M,square:y,cacheKey:A,showPresence:b,entity:F,isXtapUserUrl:C,...D})=>{const U=r.useMemo((()=>(0,l.v4)()),[]),E=ke(),{isTflUser:w}=ge(),L=(0,T.C0)(m,b,n,F),O=(0,a.Y)(B,{accessibilityLabel:D.accessibilityLabel,presenceUserId:L,profilePictureType:n.profilePictureType,role:d||(s?"button":"presentation"),shouldAllowContextMenu:c,isEmergencyCallTarget:t,isFocusable:s,hexagonal:!y&&M&&!(0,T.uC)(m,E.customViewBotIds),square:y,userId:m,isDoubleClickDisabled:M&&w||u,statusSize:k,avatarUrl:e,draggable:I,isSharedChannel:g,isXtapUserUrl:C,hidePersonaCard:i,cacheKey:A,displayName:S,...D}),x=i||E.enableEntityMoreInfo||!m?O:(0,a.Y)(p.FN,{userId:m,isSharedChannel:g,hostConversationId:N,hostTenantId:v,disableAccessibilityDefaults:!0,externalAppSessionCorrelationId:U,displayName:S,callerInfo:D.callerInfo,"data-tid":"avatar",children:O},m);return i||!m||!(0,T.oG)(m)&&M?!i&&m&&M?(0,a.Y)(o.by,{botIdOrAppId:m,connectorSenderGuid:f,conversationId:N,onBehalfOfId:h,displayName:S,renderTriggerAsLink:!1,nonFocusableTrigger:!0,children:O},m):O:x}},649228:(e,n,i)=>{"use strict";i.d(n,{uk:()=>a,r8:()=>f,rO:()=>T});var a,t=i(513432),r=i(129123),l=i(754255),o=i(668989),s=i(899273),d=i(851075),c=i(619761),m=i(43372),u=i(226107),p=i(84646),k=i(364819),g=i(99595),N=i(554186),v=i(634955),I=i(702183);!function(e){e.InitialConfig="config",e.ReConfig="reconfig"}(a||(a={}));const f=(e,n)=>{if(e.bots?.[0]?.configuration){if(n===g.jr.Team)return h(e)?e.bots[0].configuration.team:null;if(n===g.jr.GroupChat)return S(e)?e.bots[0].configuration.groupChat:null}return null},h=e=>null!==e.bots?.[0]?.configuration?.team?.fetchTask,S=e=>null!==e.bots?.[0]?.configuration?.groupChat?.fetchTask,T=()=>{const{enableBotConfiguration:e}=(0,r.w2)(l.w.Extensibility,["enableBotConfiguration"]),{scenarioFactory:n}=(0,s.ur)(),i=(0,d.U)("BotConfigLauncher"),a=t.useContext(c.I18nContext),{entityCommanding:o}=(0,s.ur)(),m=(0,v.U)();return t.useCallback(((t,r,l,s)=>{const d=n.newScenario(I.Cu.ExtBotConfig),c=f(l,r);c&&e&&(d.appendEventData({configEntryPoint:s}),M(l,c,t,a,i,o,r,m,d))}),[e,i,o,m,a,n])},M=async(e,n,i,a,t,r,l,o,s)=>{const d=y(e,i,a,n);if(n&&d)try{const n=(0,N.v4)();r.platform.launchTaskModule(n,{taskModuleOptions:{input:d,launchContext:l===g.jr.GroupChat?{type:m.Y.chat,parentMessageId:o.replyChainId,...o,chatId:i,launchId:n}:{type:m.Y.channel,channelId:o.channelId,parentMessageId:o.replyChainId,teamId:i,launchId:n}}}).subscribe({complete:()=>{t.log(`task module complete for entrypoint ${d.entryPoint}`),s.stop({"App.Id":e.id,"Bot.Id":e.bots?.[0].id})},error:n=>{const i=`error launching task module for entry point ${d.entryPoint}. errorCode: ${n.ErrorCode}, errorName: ${n.name}, innerErrorCode: ${n.innerError?.code}`;t.error(`${i} Error:`,n),s.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:i})}})}catch(n){t.log("error","Error while launching task module",n),s.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:"Error in launching task module with bot config entry point"})}},y=(e,n,i,a)=>({appName:e.name||"",appIcon:e.largeImageUrl||"",appId:e.id,isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,validDomains:e.validDomains||[],tenantId:e.tenantId||"",entryPoint:u.t7.BotConfig,botInvokeParams:{threadId:n,botMri:(0,k.first)(e.bots)?.id?`${p.gN.BotPrefix}${(0,k.first)(e.bots)?.id}`:""},fetchTask:a.fetchTask||!1,taskInfo:(0,o.Jm)(i,a.taskInfo)??{},isMicrosoftOwned:e.isMicrosoftOwned||!1,externalId:e.externalId||""})},944414:(e,n,i)=>{"use strict";i.d(n,{i8:()=>g,T$:()=>k});var a=i(957032),t=i(513432),r=i(865763),l=i(626388),o=i(139150),s=i(568834),d=i(553882);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"call"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonCallUpdateFragment"}}]}}]}},...i(221427).k.definitions]};var m=i(544417),u=i(364819);const[p,k]=(0,r.V)("CallDataProviderContext"),g=e=>{const n=(0,o.m)(),{teamsCallId:i,children:r}=e,[k,g]=t.useMemo((()=>i?((e,n)=>{const i=new d.t(n),a=e.subscribe(i);return[i,()=>a.unsubscribe()]})(n.watchQuery({query:c,variables:{id:i}}),(()=>{const e=(0,m.H)(i,n);return e?{loading:!1,error:void 0,networkStatus:l.p.ready,data:{call:e}}:{loading:!0,error:void 0,networkStatus:l.p.ready,data:{call:null}}})()):[new s.c((e=>e.complete())),u.noop]),[n,i]);return t.useEffect((()=>()=>g()),[g]),(0,a.Y)(p,{source$:k,children:r})}},69915:(e,n,i)=>{"use strict";i.d(n,{G:()=>k,Z:()=>g});var a=i(513432),t=i(944414),r=i(432720),l=i(188468),o=i(364819),s=i(129123),d=i(754255),c=i(422816),m=i(624333),u=i(94997),p=i(225558);function k(e,n){const i=(0,u.F)(e),p=a.useCallback((({loading:e,errors:n,data:a})=>({loading:e,error:n&&n.length>0&&new c.K({graphQLErrors:n})||void 0,data:a?.call&&{call:(0,o.pick)(a.call,i)}||void 0})),[i]),k=a.useCallback((e=>e.pipe((0,r.T)(p),(0,l.F)(((e,n)=>e.loading===n.loading&&(0,o.isEqual)(e.data?.call,n.data?.call)&&(0,m.a)(e.error,n.error))))),[p]),{doNotRestartObservableOnErrors:g}=(0,s.w2)(d.w.Calling,["doNotRestartObservableOnErrors"]),[N]=(0,t.T$)(k,n,p,!g&&void 0);return!N&&n?{data:void 0,loading:!1,error:void 0}:N??{data:void 0,loading:!0,error:void 0}}const g=(e,n,i)=>{const{data:t,complete:r}=(0,p.I)({fragmentName:n,fragment:e,from:{__typename:"Call",id:i}});return a.useMemo((()=>({data:r?{call:t}:null,error:void 0,complete:r})),[t,r])}},219633:(e,n,i)=>{"use strict";i.d(n,{i:()=>r,q:()=>o});var a=i(957032),t=i(513432);const r=({channelData:e,children:n,isLoadingData:i})=>{const r=t.useMemo((()=>({channelType:e?.channelType,displayName:e?.displayName,id:e?.id,createdAt:e?.createdAt,description:e?.description,isGeneral:e?.isGeneral,isArchived:e?.isArchived,isDeleted:e?.isDeleted,isUserMember:e?.isUserMember,isUserMuted:e?.isUserMuted,isShown:e?.isShown,isChannelExternallyShared:e?.isChannelExternallyShared,isLie:e?.isLie,realThreadId:e?.realThreadId,parentTeamId:e?.parentTeamId,isSharedWithParentTeam:e?.isSharedWithParentTeam,isCreationFailed:e?.isCreationFailed,substrateGroupId:e?.substrateGroupId,hostTeamId:e?.hostTeamId,hostTenantId:e?.hostTenantId,hostTeamGroupId:e?.hostTeamGroupId,memberRole:e?.memberRole,membershipSummary:e?.membershipSummary,sensitivityLabel:e?.sensitivityLabel,owningTeam:e?.owningTeam,sharepointSiteUrl:e?.sharepointSiteUrl,spaceAdminSettings:e?.spaceAdminSettings,moderation:e?.moderation,isSubCommunity:!(!e?.hostTeamId||!e?.id)&&e.hostTeamId!==e.id,ifConvUxChannel:e?.ifConvUxChannel})),[e?.channelType,e?.displayName,e?.id,e?.createdAt,e?.description,e?.isGeneral,e?.isArchived,e?.isDeleted,e?.isUserMember,e?.isUserMuted,e?.isChannelExternallyShared,e?.isLie,e?.realThreadId,e?.parentTeamId,e?.isSharedWithParentTeam,e?.isCreationFailed,e?.substrateGroupId,e?.hostTeamId,e?.hostTenantId,e?.hostTeamGroupId,e?.memberRole,e?.membershipSummary,e?.sensitivityLabel,e?.owningTeam,e?.sharepointSiteUrl,e?.spaceAdminSettings,e?.moderation,e?.ifConvUxChannel,e?.isShown]);return(0,a.Y)(l.Provider,{value:i?void 0:r,children:n})},l=t.createContext(void 0),o=()=>t.useContext(l)},855167:(e,n,i)=>{"use strict";i.d(n,{ab:()=>k,SX:()=>g,IN:()=>N,eh:()=>v,Qz:()=>I,Ur:()=>f});var a=i(957032),t=i(513432),r=i(432720),l=i(188468),o=i(160847),s=i(161295);const{useCallback:d,useEffect:c,useMemo:m,useRef:u,useState:p}=t,k=e=>{const{layoutPhaseStateMachineRef:n}=(0,s.yf)(),i=n.current,a=u(i),[t,d]=p(i.currentPhase>=e),k=m((()=>a.current.currentPhaseObservable.pipe((0,r.T)((n=>n>=e)),(0,l.F)())),[e,a]),g=(0,o.J)(k,{next:t?()=>t:d},!0);return c((()=>()=>g()),[g]),t&&g(),a.current===i||t?t||a.current.currentPhase>=e||i.currentPhase>=e:(d(!0),!0)},g=e=>{const{layoutPhaseStateMachineRef:n}=(0,s.yf)();return d((()=>n.current.currentPhase>=e),[n,e])},N=()=>{const{reportFirstPaintCallbackRef:e}=(0,s.yf)();e.current()},v=({component:e,fallback:n,minimumAppPhase:i})=>t=>k(i)?(0,a.Y)(e,{...t}):n?(0,a.Y)(n,{}):null,I=()=>{const{useAppPhasePostCriticalOnEveryPhaseCycle:e}=(0,s.yf)();return e()},f=()=>{const{useAppPhaseCompleteOnEveryPhaseCycle:e}=(0,s.yf)();return e()}},51713:(e,n,i)=>{"use strict";i.d(n,{u:()=>s,C:()=>d});var a=i(957032),t=i(364819),r=i(513432),l=i(94997);const o=r.createContext(void 0),s=e=>{const{children:n,...i}=e,r={...i,activeWindowService:i.activeWindowsService.getWindowLayoutService(i.windowId),context:{hostCommunicationService:i.hostCommunicationService}};return(0,a.Y)(o.Provider,{value:(0,l.F)(r,t.isEqual),children:n})},d=()=>r.useContext(o)},19962:(e,n,i)=>{"use strict";i.d(n,{wT:()=>c,g6:()=>m});var a=i(957032),t=i(513432),r=i(94997);const{createContext:l,memo:o,useContext:s}=t,d=l({UNSAFE_overflowAndFlipBoundaryRef:null});d.displayName="UNSAFE_OverflowAndFlipBoundaryContext";const c=o((e=>{const{children:n,...i}=e;return(0,a.Y)(d.Provider,{value:(0,r.F)(i),children:n})}));c.displayName="UNSAFE_OverflowAndFlipBoundaryContextProvider";const m=()=>s(d)},161295:(e,n,i)=>{"use strict";i.d(n,{Sz:()=>c,yf:()=>m});var a=i(957032),t=i(513432),r=i(94997);const{createContext:l,memo:o,useContext:s}=t,d=l(void 0),c=o((({children:e,...n})=>(0,a.Y)(d.Provider,{value:(0,r.F)(n),children:e}))),m=()=>s(d)},902376:(e,n,i)=>{"use strict";i.d(n,{ex:()=>d,At:()=>c,l3:()=>m});var a=i(957032),t=i(364819),r=i(513432),l=i(94997);const{memo:o}=r,s=r.createContext(void 0),d=o((({children:e,commandReportingCallbacks:n,doesChildViewEntityMatch:i=(()=>!1),UNSAFE_doesMainViewEntityMatch:r=(()=>!1),...o})=>(0,a.Y)(s.Provider,{value:(0,l.F)({...o,...n,doesChildViewEntityMatch:i,UNSAFE_doesMainViewEntityMatch:r},t.isEqual),children:e}))),c=(s.Consumer,()=>r.useContext(s)),m=e=>function(n){const i=c();return(0,a.Y)(e,{...{...n,viewContext:i}})}},75106:(e,n,i)=>{"use strict";i.d(n,{X4:()=>l,z2:()=>o});var a=i(957032),t=i(513432);const r=t.createContext({}),l=t.memo((({children:e,setCoreThemeType:n,themeType:i,themeOptions:l})=>{const o=t.useMemo((()=>({setCoreThemeType:n,themeType:i,themeOptions:l})),[n,i,l]);return(0,a.Y)(r.Provider,{value:o,children:e})})),o=()=>t.useContext(r)},796179:(e,n,i)=>{"use strict";i.d(n,{YE:()=>s,jK:()=>k,ns:()=>g,KB:()=>m,zc:()=>f,nb:()=>I,hC:()=>p,XQ:()=>u});var a=i(554186),t=i(863344),r=i(754255),l=i(501045);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsCortexTopicsSdkAuthenticationAcquireTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},s="https://substrate.office.com",d=new Map,c=6e4;function m(e){return(0,t.KB)(e)}async function u(e,n,i,a,t){const r=m(i);return r?(await g(n,i,a,r),e(r)):t?t():void 0}function p(e,n,i,a,t){const r=m(i);return r?(g(n,i,a,r),e(r)):t?t():void 0}function k(e,n){const i=(0,a.v4)();return async(a,t)=>{const r=v(e,n);if(d.has(r)){const e=d.get(r);e?.token&&a(e.token,i)}else t("No token in Reference",i)}}async function g(e,n,i,a){const{enableSilentLokiAuthTokenRetrieval:t,lokiTokenResourceUrl:o}=i.get(r.w.People),{enableCallKMApiDirectly:d}=i.get(r.w.Messaging),c=N(e,n,o||l.rs,t,a),m=d?N(e,n,s,t,a):Promise.resolve();return Promise.all([c,m]).then((()=>{}))}async function N(e,n,i,a,t){let r;const l={resourceUrl:i};t||(t=m(n));const s=d.get(v(i,n));if(s){if(Date.now()-s.lastRefreshTime<c)return}t&&(r=t.createQosEvent("Cortex.TopicAnnotations.RenewToken.Execute"));try{let t;if(e){const{data:s}=await e.query({query:o,variables:{resource:i,acquireTokenOptions:{silent:a}},fetchPolicy:"network-only"});t={token:s?.authenticationToken?.token,lastRefreshTime:Date.now()},t.token?(d.set(v(i,n),{token:t.token,lastRefreshTime:t.lastRefreshTime}),r?.logSuccess(l)):r?.logUnexpectedFailure("NoTokenReceived",void 0,l)}else r?.logUnexpectedFailure("NoApolloClient",void 0,l)}catch(e){r?.logUnexpectedFailure("ErrorThrowRetrievingToken",e,l)}}function v(e,n){return`${e}_${n.userAadObjectId??""}_${n.tenantAadObjectId??""}`}function I(e,n,i,a){const{enableCortexTopicsAuthRefactor:t}=i.get(r.w.Messaging),l=m(n);return t&&a?p(e,a,n,i):l?e(l):void 0}async function f(e,n,i,a){const{enableCortexTopicsAuthRefactor:t}=i.get(r.w.Messaging),l=m(n);return t&&a?u(e,a,n,i):l?e(l):void 0}},513527:(e,n,i)=>{"use strict";i.d(n,{q0:()=>m,KZ:()=>u,Kb:()=>p});var a=i(513432),t=i(129123),r=i(754255),l=i(697673),o=i(763588),s=i(899623);const{useCallback:d,useMemo:c}=a,m=({userId:e,displayName:n,personaType:i,hostConversationId:a,ariaLabel:m,tabIndex:u})=>{const{enableEntityMoreInfo:p}=(0,t.w2)(r.w.Core,["enableEntityMoreInfo"]),k=(0,o.useNovaEventing)(),g=d(((e,{userId:n,ariaLabel:i,tabIndex:a,displayName:t,personaType:r,hostConversationId:o})=>{if(n){const{left:s,top:d,width:c,height:m}=e.target.getBoundingClientRect();k.bubble({event:l.AZ.requestPersonMoreInfo({eventType:e.type,height:m,left:s,top:d,width:c,userId:n,displayName:t,personaType:r,hostConversationId:o,ariaLabel:i,tabIndex:a}),reactEvent:e})}}),[k]),N=d((t=>{p&&g(t,{userId:e,ariaLabel:m,tabIndex:u,displayName:n,personaType:i,hostConversationId:a})}),[p,g,e,m,u,n,i,a]),v=(0,s.l)(N,500),I=d((t=>{v.cancel(),p&&g(t,{userId:e,ariaLabel:m,tabIndex:u,displayName:n,personaType:i,hostConversationId:a})}),[p,v,g,e,m,u,n,i,a]),f=d((i=>{!p||"Enter"!==i.key&&" "!==i.key||g(i,{userId:e,ariaLabel:m,tabIndex:u,displayName:n})}),[p,g,e,m,u,n]),h=d((e=>{v.cancel()}),[v]);return c((()=>({onClick:I,onKeyDown:f,onMouseEnter:v,onMouseLeave:h})),[I,f,v,h])},u=({userId:e,displayName:n,ariaLabel:i,tabIndex:a})=>{const{enableEntityMoreInfo:s}=(0,t.w2)(r.w.Core,["enableEntityMoreInfo"]),m=(0,o.useNovaEventing)(),u=d(((e,{userId:n,ariaLabel:i,tabIndex:a,displayName:t})=>{if(n){const{left:r,top:o,width:s,height:d}=e.target.getBoundingClientRect();m.bubble({event:l.AZ.requestPersonMoreOrgInfo({eventType:e.type,height:d,left:r,top:o,width:s,userId:n,displayName:t,ariaLabel:i,tabIndex:a}),reactEvent:e})}}),[m]),p=d((t=>{s&&u(t,{userId:e,ariaLabel:i,tabIndex:a,displayName:n})}),[s,u,e,i,a,n]),k=d((t=>{!s||"Enter"!==t.key&&" "!==t.key||u(t,{userId:e,ariaLabel:i,tabIndex:a,displayName:n})}),[s,u,e,i,a,n]);return c((()=>({onClick:p,onKeyDown:k})),[p,k])},p=({userId:e,ariaLabel:n,tabIndex:i,topicId:a})=>{const{enableEntityMoreInfo:s}=(0,t.w2)(r.w.Core,["enableEntityMoreInfo"]),m=(0,o.useNovaEventing)(),u=d(((e,{userId:n,ariaLabel:i,tabIndex:a,topicId:t})=>{if(n){const{left:r,top:o,width:s,height:d}=e.target.getBoundingClientRect();m.bubble({event:l.AZ.requestTopicMoreInfo({eventType:e.type,height:d,left:r,top:o,width:s,userId:n,ariaLabel:i,tabIndex:a,topicId:t}),reactEvent:e})}}),[m]),p=d((t=>s?u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a}):void 0),[s,u,e,n,i,a]),k=d((t=>{!s||"Enter"!==t.key&&" "!==t.key||u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a})}),[s,u,e,n,i,a]),g=d((t=>s?u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a}):void 0),[s,u,e,n,i,a]);return c((()=>({onClick:p,onKeyDown:k,onMouseEnter:g})),[p,k,g])}},980427:(e,n,i)=>{"use strict";i.d(n,{t:()=>s});var a=i(957032),t=i(513432),r=i(899273),l=i(199448);class o extends t.PureComponent{constructor(e){super(e),this.render=()=>{const{children:e,fallbackUI:n=null}=this.props,{error:i}=this.state;return i?"function"==typeof n?n(i,this.resetError.bind(this)):n:e},this.handleError=(e,n)=>{if((0,l.XC)(e))throw e;const{errorHandler:i,onErrorCallback:a,scenarios:t,rethrowError:r,loggerName:o}=this.props;if(a&&a(e),i){if(i(e,n),r)throw e;return}let s="";try{s=JSON.stringify(e)}catch(n){s=`Failed to stringify error: ${e}`}if(t?.forEach((e=>{e.fail({reason:`Error in ${o}: ${s}`})})),this.logger.error(`error: \n    ${s}\n    componentStack: \n    ${n.componentStack}`),r)throw e};const{loggerName:n,newLogger:i}=this.props;this.state={error:null},this.logger=i(n,"components-error-boundary")}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,n){this.logger.error(`Error message: ${e?.message}.`),this.handleError(e,n)}resetError(){this.setState({error:null})}}const s=e=>(0,a.Y)(o,{...e,newLogger:(0,r.ur)().loggerFactory.newLogger})},913902:(e,n,i)=>{"use strict";i.d(n,{A:()=>S});var a=i(957032),t=i(513432),r=i(959022),l=i(899273),o=i(129123),s=i(754255),d=i(935197);const c=e=>{const{hexagonal:n,...i}=e;if(n){const e=(e,n)=>{const{"aria-label":t,src:r,...l}=n;return(0,a.Y)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%",children:[(0,a.Y)("title",{children:i.name||l.alt||""}),(0,a.Y)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,a.Y)(e,{as:"image",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:r,"aria-label":t||i.name||l.alt||"",...l})]})};return(0,a.Y)(d.e,{...i,image:{..."object"==typeof i.image&&i.image,children:e}})}return(0,a.Y)(d.e,{...i})};var m=i(792529),u=i(526521),p=i(851075),k=i(702183),g=i(643502),N=i(139150),v=i(944297);const I=(0,i(965804).O)({transparent:{sj55zd:"f44pa96",De3pzq:"f3rmtva",Bic5iru:"f1pspie5"}}),f=({alt:e,badge:n,name:i,size:r,src:o,className:s,setShouldFallbackToDefault:d,setBlobUrl:c,enableFetchApiForBotAvatar:f,setError:h,error:S})=>{const T=I(),M=(0,N.m)(),y=(0,p.U)("custom-avatar-v9"),{scenarioFactory:A}=(0,l.ur)();let b=A.findScenario(k.Cu.ExtBotAvatar);b||(b=A.newScenario(k.Cu.ExtBotAvatar),b.appendEventData({"App.Name":i}));const F=(e,n)=>{b?.mark(k.BQ.ExtBotAvatarFetchApi,{errors:n??""},e),"failure"===e&&(y.errorToTelemetry?.("CustomAvatarV9:: bot avatar did not load properly, rendering fallback","platform_bot_avatar_error"),d&&d(!0),h&&h(!0))};return(0,a.Y)(t.Fragment,{children:(0,a.Y)(m.e,{badge:n,className:(0,u.z)(T.transparent,s),icon:{children:()=>(0,a.Y)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%","aria-label":e,children:[(0,a.Y)("title",{children:""}),(0,a.Y)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,a.Y)("image",{clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:o})]})},initials:null,name:i,size:r,onError:async()=>{try{if(f)if(o&&(0,v.D$)(o)){const e=await(0,g.z)(M,o,"Url",!0);if(e.result?.blob)c&&c(e.result.blob),F("success");else{F("failure",`CustomAvatarV9:: amsDownload did not return a blob for app: ${i}`)}}else{F("failure",`CustomAvatarV9:: non-AMS image did not load properly for app: ${i}`)}else d&&d(!0)}catch(e){F("failure",`CustomAvatarv9:: Failed to load bot avatar for app: ${i}`)}},onLoad:()=>{S?b?.fail():b?.stop()}})})},h=(0,a.Y)("svg",{xmlns:"http://w3.org/2000/svg",style:{width:0,height:0,position:"absolute"},children:(0,a.Y)("defs",{role:"presentation",children:(0,a.Y)("clipPath",{id:"bot-hexagon-clip-path",children:(0,a.Y)("path",{d:"M23.93,2H10.07C9,2,8.01,2.57,7.47,3.5l-6.92,12c-0.54,0.93-0.54,2.07,0,3l6.93,12c0.54,0.93,1.53,1.5,2.6,1.5h13.85c1.07,0,2.06-0.57,2.6-1.5l6.93-12c0.54-0.93,0.54-2.07,0-3l-6.93-12C25.99,2.57,25,2,23.93,2z"})})})}),S=e=>{const{host:n}=(0,l.ur)(),{enableFluentV9Avatar:i}=(0,o.w2)(s.w.People,["enableFluentV9Avatar"]),{enableFetchApiForBotAvatar:d}=(0,o.w2)(s.w.Extensibility,["enableFetchApiForBotAvatar"]),m=(e=>{const n="bot-hexagon-clip-path-container";let i=e.document.body.querySelector(`[id='${n}']`);return i||(i=e.document.createElement("div"),i.id=n,e.document.body.insertBefore(i,e.document.body.childNodes[0])),i})(n),[u,p]=t.useState(!1),[k,g]=t.useState(""),[N,v]=t.useState(!1);return t.useEffect((()=>{m.hasChildNodes()||r.render(h,m)}),[m]),i?(0,a.Y)(f,{src:k&&d?k:u?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=":e.commonImgAttributes?.src,alt:e.commonImgAttributes?.alt,badge:e.badgeProps,size:"number"==typeof e.size?e.size:void 0,setShouldFallbackToDefault:p,setBlobUrl:g,enableFetchApiForBotAvatar:!!d,error:N,setError:v,...e}):(0,a.Y)(c,{hexagonal:!0,...e})}},501045:(e,n,i)=>{"use strict";i.d(n,{rs:()=>o,Y:()=>l,Py:()=>s});var a=i(554186),t=i(678937);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},l=(e,n)=>{if("df"===n)return"Df";if("msit"===n)return"Msit";switch(e){case t.B.prod:case t.B.life:return"Prod";case t.B.gcc:return"GccModerate";case t.B.gcchigh:return"GccHigh";case t.B.dod:return"DoD";case t.B.ag08:return"AG08";case t.B.ag09:return"AG09";case t.B.gallatin:return"Gallatin";default:return"Unknown"}},o="https://unknownregion.loki.delve.office.com",s=(e,n,i)=>{const t=(0,a.v4)();return async(a,l)=>{try{let o;e.current?o=(await e.current.query({query:r,variables:{resource:n,acquireTokenOptions:{silent:i}},fetchPolicy:"network-only"})).data?.authenticationToken?.token:l("Error no apollo client to retrieve token",t),o?a(o,t):l("No auth token found",t)}catch{l("Error retrieving auth token",t)}}}},649453:(e,n,i)=>{"use strict";i.d(n,{CA:()=>u,uw:()=>p});var a=i(957032),t=i(513432),r=i(880139),l=i(509336);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}},{kind:"Field",name:{kind:"Name",value:"lastLoggedInUserMri"}}]}}]}}]};var s=i(94997),d=i(364819);const c=t.createContext({IsLivePersonaCardInitialized:!1,LastLoggedInUserMri:void 0}),m=e=>{const n={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized,LastLoggedInUserMri:e.LastLoggedInUserMri};return(0,a.Y)(c.Provider,{value:(0,s.F)(n,d.isEqual),children:e.children})},u=(0,l.W)((e=>(0,a.Y)(r.X,{query:o,children:({data:n,loading:i,error:t})=>{const r=!i&&!t&&!!n&&!!n.lpcState&&n.lpcState.isLivePersonaCardInitialized;return(0,a.Y)(m,{children:e.children,IsLivePersonaCardInitialized:r,LastLoggedInUserMri:n?.lpcState.lastLoggedInUserMri})}}))),p=()=>t.useContext(c)},865763:(e,n,i)=>{"use strict";i.d(n,{V:()=>N,j:()=>h});var a=i(957032),t=i(364819),r=i(513432),l=i(100365),o=i(553882),s=i(879462),d=i(773587),c=i(188468),m=i(624333),u=i(432720);const p=e=>n=>n.pipe((0,u.T)((n=>e?(0,t.pick)(n,e):n)),(0,s.p)((e=>!(0,t.isEmpty)(e))));var k=i(160847),g=i(94997);const N=(e,n=l.w)=>{const i=r.createContext(n);return i.displayName=e,[v(i),I(i),f(i)]},v=({Provider:e})=>({source$:n,children:i})=>(0,a.Y)(e,{value:n,children:i}),I=e=>(n,i=!1,a,s=!0)=>{(0,t.isBoolean)(n)&&(s=i,i=n,n=void 0);const d=r.useContext(e),c=r.useRef(l.w),m=r.useMemo((()=>n?d.pipe(n):d),[d,n]),u=r.useRef(),p=r.useRef(!1),[g,N]=r.useState(!1),v=r.useCallback((e=>{const n=e.getValue();return void 0!==n&&a?a(n):n}),[a]);if(c.current!==d&&d instanceof o.t)try{p.current=!0,u.current=v(d),c.current=d}catch(e){return}const I=r.useCallback((e=>{if(p.current&&(p.current=!1,d instanceof o.t)){const e=v(d);if((0,t.isEqual)(e,u.current))return}u.current!==e&&(u.current=e,N((e=>!e)))}),[v,d]),f=i?t.noop:I,h=(0,k.J)(m,{next:f},s);return[i?void 0:u.current,h]},f=e=>()=>r.useContext(e),h=e=>(n,i,a=!1)=>{const l=(0,g.F)(n),o=r.useRef(),u=r.useCallback((e=>a?e.pipe(p(l),(0,s.p)((e=>!(0,t.isEqual)(e,o.current))),(0,d.M)((e=>{o.current=e}))):e.pipe(p(l),(0,c.F)(m.a))),[l,a]),[k]=e(u);return k||i}},484699:(e,n,i)=>{"use strict";i.d(n,{FN:()=>S});var a=i(957032),t=i(513432),r=i(364819),l=i(69915),o=i(855167),s=i(899273),d=i(851075),c=i(726723),m=i(754255),u=i(115100),p=i(796179),k=i(897604),g=i(980427),N=i(649453),v=i(139150);const I=(0,i(965804).O)({defaultPersona:{mc9l5x:"fau6ura",Bqenvij:"f3052tw"}});var f=i(425347);const h=e=>{const n=(0,o.ab)(u.Jj.POST_CRITICAL),i=(0,N.uw)(),h=(0,v.m)(),{host:{LivePersonaCardHoverTargetV2:S},coreSettings:T}=(0,s.ur)(),M=((e,n,i,a)=>{const[r,o]=t.useState(!0),s=t.useRef(!1),{userId:d,hostConversationId:c,hostTenantId:m,isSharedChannel:u}=e,{data:p}=(0,l.G)(["meetingDetails","meetingRole"]),k=!!p?.call?.meetingDetails?.meetingCapability?.maskIdentitiesForRole,g=p?.call?.meetingRole??"";return t.useEffect((()=>(s.current=!0,(async()=>{const e=await(0,f.Os)(d,k,g,!!u,c,m,n,i,a);s.current&&o(e)})(),()=>{s.current=!1})),[i,n,a,d,k,g,c,m,u]),r})(e,T,h,(0,d.U)("PersonaInner")),y=(e=>{const{host:n,userBiService:i,coreSettings:a,authenticationUser:r}=(0,s.ur)(),l=(0,d.U)("PersonaRenderer"),o=(0,v.m)(),{topicId:u,personaType:g}=e,N=t.useCallback((()=>{n.document.dispatchEvent(new MouseEvent("mousemove"))}),[n]),{ariaLabel:I,behavior:h,disableAccessibilityDefaults:S,externalAppSessionCorrelationId:T,hostConversationId:M,hostTenantId:y,isSharedChannel:A,tabIndex:b,userId:F,displayName:C,module:D,source:U,highlightedText:E}=e,w=t.useCallback((async()=>{if(n.document.addEventListener("mouseleave",N),"Topic"===g&&u){const e=(0,p.KB)({userAadObjectId:r?.profile.objectId,tenantAadObjectId:r?.profile.tenantId});e?.logEvent(k.P.TopicCardOpen,{topicId:u,module:D??"",source:U??""})}const e=await(0,f.Dh)(F,i,o),a={panelRegion:c.rP.popover,panelType:c.HP.LivePersonaCard,dataBag:e};i.recordPanelView(a,l)}),[r,n,N,l,i,o,u,g,D,U,F]),L=t.useCallback((()=>{n.document.removeEventListener("mouseleave",N);const e={actionGesture:c.Od.mouseleave,actionOutcome:c.nd.closePanel,actionScenarioType:c.DB.people,actionScenario:c.vB.closePanel,moduleName:c.Sn.lpcClose,panelRegion:c.rP.popover,panelType:c.HP.LivePersonaCard};i.recordPanelAction(e,l)}),[n,i,l,N]),O=!!a.get(m.w.People).isInIframe,x=t.useMemo((()=>(0,f.wQ)({ariaLabel:I,behavior:h,disableAccessibilityDefaults:S,externalAppSessionCorrelationId:T,hostConversationId:M,hostTenantId:y,isSharedChannel:A,tabIndex:b,userId:F,handleOnCardOpen:w,handleOnCardClose:L,personaType:g,topicId:u,shouldDeferCardOpenToParentWindow:O,displayName:C,module:D,source:U,highlightedText:E})),[I,h,S,T,M,y,A,b,F,w,L,u,g,O,C,D,U,E]);return t.useEffect((()=>()=>{n.document.removeEventListener("mouseleave",N)}),[n,N]),x})(e),{enableEntityMoreInfo:A}=T.get(m.w.Core),{enableFluentV9Avatar:b}=T.get(m.w.People),F=((e,n)=>{const i={"data-tid":n.callerInfo},t=I();return e?(0,a.Y)("div",{className:n.classNames||t.defaultPersona,...i,children:n.children}):n.children})(b,e);return!A&&n&&!(0,r.isEmpty)(e.userId)&&M&&i?.IsLivePersonaCardInitialized&&S?(0,a.Y)(g.t,{fallbackUI:(0,a.Y)(t.Fragment,{children:e.children}),loggerName:"PersonaInner",children:(0,a.Y)(S,{...y,children:F})}):M?(0,a.Y)(t.Fragment,{children:e.children}):(0,a.Y)(t.Fragment,{children:F})},S=t.memo((e=>h(e)))},634955:(e,n,i)=>{"use strict";i.d(n,{U:()=>s,Q:()=>d});var a=i(902376),t=i(572909),r=i(363678),l=i(513432),o=i(878336);const s=()=>{const{entity:e,getEntityOptions:n}=(0,a.At)();return l.useMemo((()=>d(e,n)),[e,n])},d=(e,n)=>{let i={};const a=e&&e.type;switch(a){case t.ck.extensions:i=c(e,n),i={...i,...n(t.ck.extensions,u(e.action))};break;case t.ck.communities:case t.ck.channels:case t.ck.connectorinstanceconfiguration:i=e.id?{channelId:(0,o.a9)(e)}:{channelId:void 0};break;case t.ck.chats:const r=e.id?.split(";replyChainId=")??[],l=r[0],s=r[1];i={chatId:l,channelId:s?l:void 0,replyChainId:s,channelMeetingMessageId:s};break;case t.ck.platformapp:if(e.action===t.SY.config){const e=n(t.ck.platformapp,t.SY.config),a=e?.messageId&&"0"!==e.messageId,r={chatId:e?.convId,channelId:a?e?.convId:void 0,parentMessageId:a?e.messageId:void 0,channelMeetingMessageId:a?e.messageId:void 0,eventId:e?.eventId};i={...i,...r}}else i={...n(t.ck.platformapp,t.SY.create)};break;case t.ck.platformStage:case t.ck.platformstagewithoutchat:case t.ck.platformstagemodal:i=m(a,n);break;case t.ck.yammerqna:const d=n(t.ck.yammerqna,t.SY.view);i={chatId:d?.conversationId,...d}}return i},c=(e,n)=>{if(e.linkedEntity?.id)switch(e.linkedEntity.type){case t.ck.chats:return{chatId:e.linkedEntity.id};case t.ck.communities:case t.ck.channels:case t.ck.extensions:case t.ck.schoolteams:return JSON.parse(e.linkedEntity.id);case t.ck.calls:return function(e){const{options:n}=e;if(!n)return{};const{convId:i,messageId:a}=JSON.parse(n);return function(e){return!!e&&"0"!==e}(a)?{channelId:i,chatId:i,parentMessageId:a,channelMeetingMessageId:a}:{chatId:i}}(e);case t.ck.schedulingform:return function(e,n){if(!e.linkedEntity?.id)return{};const{threadId:i,messageId:a}=e.id&&JSON.parse(e.id)||{},{channelId:r}=e.linkedEntity.id&&JSON.parse(e.linkedEntity.id)||{},{isChannelMeeting:l,messageId:o}=function(e,n){let{isChannelMeeting:i,messageId:a}=n(t.ck.extensions,u(e.action));if(void 0===i){const{options:n}=e;if(n){const{isChannelMeeting:e,backFilledOptions:{messageId:t}}=JSON.parse(n);i=e,a=t}}return{isChannelMeeting:i,messageId:a}}(e,n);return l?{channelId:r,chatId:i,parentMessageId:a??o,channelMeetingMessageId:a??o}:{chatId:i}}(e,n)}return{}},m=(e,n)=>{const i=((e,n)=>e===t.ck.platformStage?n(t.ck.platformStage,t.SY.create):e===t.ck.platformstagewithoutchat?n(t.ck.platformstagewithoutchat,t.SY.view):n(t.ck.platformstagemodal,t.SY.view))(e,n);return i.entryPoint===r.hB.adaptiveCardCollabStage||i.entryPoint===r.hB.adaptiveCardStageModal?i.replyChainId?{channelId:i.channelId??i.convId,replyChainId:i.replyChainId,entityId:i?.entityId,chatId:void 0}:{chatId:i.convId,entityId:i?.entityId}:i.replyChainId||i.channelId?{channelId:i.channelId??i.convId,replyChainId:i.replyChainId,entityId:i.entityId,parentMessageId:i.messageId,channelMeetingMessageId:i.messageId,chatId:i.messageId?i.channelId??i.convId:void 0}:{chatId:i.convId,entityId:i.entityId}};function u(e){return e===t.SY.loading?t.SY.loading:t.SY.view}},253441:(e,n,i)=>{"use strict";i.d(n,{H:()=>m});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"recordAppUsage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordAppUsage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(16214).j.definitions]};var t=i(899273),r=i(851075),l=i(451281),o=i(513432),s=i(702183),d=i(129123),c=i(754255);const m=()=>{const{enableAppUsageRecording:e}=(0,d.w2)(c.w.Extensibility,["enableAppUsageRecording"]),{scenarioFactory:n}=(0,t.ur)(),i=(0,r.U)("useRecordAppUsage"),[m]=(0,l.n)(a);return o.useCallback((async(a,t)=>{if(!e)return;const r=n.newScenario(s.Cu.ExtRecordAppUsage);try{await m({variables:{appId:a}}),r.appendEventData({"App.Id":a,"App.EntryPoint":t}),r.stop()}catch(e){r.fail({"App.Id":a,"App.EntryPoint":t,errors:JSON.stringify(e),message:"Failed to record app usage."}),i.error("Failed to record app usage.")}}),[e,i,m,n])}},778803:(e,n,i)=>{"use strict";i.d(n,{Fd:()=>V,CD:()=>E,kR:()=>x,xQ:()=>L,qI:()=>O});var a=i(957032),t=i(513432),r=i(139150),l=i(213991),o=i(545154),s=i(83596),d=i(846716),c=i(84307);const m="Disabled",u={InAConferenceCall:{backgroundImage:c.Y.OnThePhone,title:"status_inACall"},InACall:{backgroundImage:c.Y.OnThePhone,title:"status_inACall"},Presenting:{backgroundImage:c.Y.DoNotDisturb,title:"status_presenting"},OffWork:{backgroundImage:c.Y.Offline,title:"status_offline"},InAMeeting:{backgroundImage:c.Y.Busy,title:"status_inAMeeting"},Available:{backgroundImage:c.Y.Online,title:"status_online"},Inactive:{backgroundImage:c.Y.Away,title:"status_away"},Busy:{backgroundImage:c.Y.Busy,title:"status_busy"},DoNotDisturb:{backgroundImage:c.Y.DoNotDisturb,title:"status_doNotDisturb"},BeRightBack:{backgroundImage:c.Y.BeRightBack,title:"status_beRightBack"},Away:{backgroundImage:c.Y.Away,title:"status_away"},OutOfOffice:{backgroundImage:c.Y.Away,title:"status_away"},Offline:{backgroundImage:c.Y.Offline,title:"status_offline"},UrgentInterruptionsOnly:{backgroundImage:c.Y.DoNotDisturb,title:"status_doNotDisturb"},PresenceUnknown:{backgroundImage:c.Y.Unknown,title:"status_unknown"},AvailableIdle:{backgroundImage:c.Y.Idle,title:"status_away"},BusyIdle:{backgroundImage:c.Y.Idle,title:"status_away"},OnShift:{backgroundImage:c.Y.OnShift,title:"status_onShift"},OffShift:{backgroundImage:c.Y.OffShift,title:"status_offShift"},[m]:{backgroundImage:c.Y.Disabled,title:"status_disabled"}},p={status_inACall:"inACall",status_presenting:"presenting",status_offline:"offline",status_inAMeeting:"inAMeeting",status_online:"online",status_away:"away",status_Busy:"busy",status_doNotDisturb:"doNotDisturb",status_beRightBack:"beRightBack",status_unknown:"unknown",status_onShift:"onShift",status_offShift:"offShift",status_disabled:"disabled",status_blocked:"blocked"},k={InAConferenceCall:{backgroundImage:c.Y.OnThePhoneOof,title:u.InAConferenceCall.title},InACall:{backgroundImage:c.Y.OnThePhoneOof,title:u.InACall.title},Presenting:{backgroundImage:c.Y.DoNotDisturbOof,title:u.Presenting.title},InAMeeting:{backgroundImage:c.Y.BusyOof,title:u.InAMeeting.title},Busy:{backgroundImage:c.Y.BusyOof,title:u.Busy.title},DoNotDisturb:{backgroundImage:c.Y.DoNotDisturbOof,title:u.DoNotDisturb.title},Available:{backgroundImage:c.Y.OnlineOof,title:u.Available.title}},g=e=>{const{title:n,backgroundImage:i}=e,a={status:"unknown",outOfOffice:!1};switch(n){case"status_online":a.status="available";break;case"status_busy":case"status_inAMeeting":case"status_inACall":a.status="busy";break;case"status_presenting":case"status_doNotDisturb":case"status_focusing":a.status="do-not-disturb";break;case"status_away":case"status_beRightBack":a.status="away";break;case"status_offline":a.status="offline";break;case"out_of_office_title":a.status="out-of-office";break;case"status_blocked":case"status_disabled":a.status="blocked";break;default:a.status="unknown"}switch(i){case c.Y.OutOfOffice:case c.Y.OnThePhoneOof:case c.Y.DoNotDisturbOof:case c.Y.BusyOof:case c.Y.OnlineOof:a.outOfOffice=!0}return a},N=(e,n)=>{switch(e){case"Available":return n.stringTranslate("nova","me_control_presence_activity_available");case"Away":case"Inactive":return n.stringTranslate("nova","me_control_presence_activity_away");case"BeRightBack":return n.stringTranslate("nova","me_control_presence_activity_be_right_back");case"Busy":return n.stringTranslate("nova","me_control_presence_activity_busy");case"DoNotDisturb":case"UrgentInterruptionsOnly":return n.stringTranslate("nova","me_control_presence_activity_do_not_disturb");case"InACall":case"InAConferenceCall":return n.stringTranslate("nova","me_control_presence_activity_in_a_call");case"InAMeeting":return n.stringTranslate("nova","me_control_presence_activity_in_a_meeting");case"Offline":case"OffWork":return n.stringTranslate("nova","me_control_presence_activity_offline");case"PresenceUnknown":default:return n.stringTranslate("nova","me_control_presence_activity_unknown");case"Presenting":return n.stringTranslate("nova","me_control_presence_activity_presenting")}},v=e=>!!e&&["Available","Busy","InAMeeting","InACall","InAConferenceCall","DoNotDisturb","Presenting","UrgentInterruptionsOnly"].includes(e);const I=(0,i(965804).O)({presenceIcon:{t21cq0:["f8zmjen","fjf1xye"],Bz10aip:"fxr4zw7"}}),f=e=>{const n=I(),i=(0,d.PO)(),{status:{backgroundImage:t,title:r,subTitle:l},ProvidedStatus:c,size:m,styles:u,userId:k,variables:N}=e,v=i.stringTranslate("messaging",r),f=l?`${v}, ${i.stringTranslate("messaging",l)}`:v,{status:h,outOfOffice:S}=g(e.status),T={id:`presence-pill-${k}`,title:f,style:{backgroundImage:`url('${t}')`,backgroundColor:o.L.colorNeutralBackground1},styles:u,size:m,variables:N},M=p[r]||"presence";return c?(0,a.Y)(c,{...T,"data-tid":"presence","data-pstatus":M}):(0,a.Y)(s.n,{id:`presence-pill-${k}`,className:n.presenceIcon,outOfOffice:S,status:h,size:"extra-small",title:f,"data-tid":"presence","data-pstatus":M})};var h=i(899273),S=i(115100),T=i(244463),M=i(129123),y=i(754255),A=i(855167);const b={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPresenceFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}},{kind:"Field",name:{kind:"Name",value:"workLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"locationSource"}},{kind:"Field",name:{kind:"Name",value:"approximateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"idType"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]};var F=i(833582),C=i(253070);const D={backgroundImage:c.Y.Unknown,title:"status_unknown"},U={backgroundImage:c.Y.Blocked,title:"status_blocked"},E=(e,n)=>{const i=w(e);if(!n)return i;const a=((e,n,i,a,t)=>a&&!v(e)?t.stringTranslate("nova","me_control_presence_out_of_office"):a&&v(e)?t.stringTranslate("nova","me_control_presence_activity_with_out_of_office",{activity:N(e,t)}):i&&"DoNotDisturb"===n&&"Presenting"!==e?t.stringTranslate("nova","me_control_presence_activity_focusing"):N(e,t))(e?.activity??null,e?.availability??null,e?.isFocus??null,e?.isOutOfOffice??null,n);return{...i,ariaLabel:a}},w=e=>{if(!e)return D;const{isOutOfOffice:n,flwPresence:i,isFocus:a}=e,{isBlocked:t,isDisabled:r}=e;if(r)return u[m];if(t)return U;const l=e.activity,o=e.availability;if(!i||"None"===i)return a&&("DoNotDisturb"===l||!l&&"DoNotDisturb"===o)?(e=>{const n="status_focusing";return e?{backgroundImage:c.Y.FocusingOof,title:n,subTitle:"out_of_office_title"}:{backgroundImage:c.Y.Focusing,title:n}})(n):n?((e,n)=>{const i=e?k[e]:k[n],a="out_of_office_title";return i?{...i,subTitle:a}:{backgroundImage:c.Y.OutOfOffice,title:a}})(l,o):l?u[l]:u[o];if("OffShift"===i)return u.OffShift;if(!l)return"Busy"===o?u[o]:u.OnShift;switch(l){case"InAConferenceCall":case"InACall":case"InAMeeting":case"Presenting":case"Busy":return u[l];default:return u.OnShift}},L=(e,n)=>{const i=(0,r.m)(),a=(0,d.PO)(),[o,s]=t.useState(!0);t.useEffect((()=>{(0,C.unstable_scheduleCallback)(C.unstable_LowPriority,(()=>{s(!1)}))}),[]);const{data:c}=(0,l.R)(T.C,{variables:{userId:e,source:n},skip:o}),{setUserPresence:m}=(0,F.$)(),u=c?.presenceUpdateEvent??((e,n)=>{try{return e.readFragment({id:`Presence:${n}`,fragment:b})??void 0}catch(e){return}})(i,e);return t.useEffect((()=>{m(u)}),[u,m]),E(u,a)},O=(e,n)=>{const i=L(e,n),a=g(i);return a.id=`presence-pill-${e}`,a["aria-label"]=i.ariaLabel,a.title=i.ariaLabel,a},x=(e,n,i,a)=>!(!e||i&&i===a||"status_unknown"!==n.title&&"status_offline"!==n.title),P=e=>{const{userId:n,presenceSource:i}=e,{enableHideOfflinePresenceInTFL:t}=(0,M.w2)(y.w.Presence,["enableHideOfflinePresenceInTFL"]),{user:r}=(0,h.ur)(),l=L(n||"",i||"ups"),{ProvidedStatus:o,...s}=e;return x(!!t,l,n,r?.id)?null:(0,a.Y)(f,{status:{backgroundImage:l.backgroundImage,title:l.title,subTitle:l.subTitle},ProvidedStatus:o,userId:n||"",...s})},V=e=>(0,A.ab)(S.Jj.POST_CRITICAL)?(0,a.Y)(P,{...e}):null},84307:(e,n,i)=>{"use strict";i.d(n,{Y:()=>F});var a=i(118356),t=i.n(a),r=i(567322),l=i.n(r),o=i(870586),s=i.n(o),d=i(78727),c=i.n(d),m=i(791542),u=i.n(m),p=i(152248),k=i.n(p),g=i(444257),N=i.n(g),v=i(952388),I=i.n(v),f=i(834818),h=i.n(f),S=i(604322),T=i.n(S),M=i(603313),y=i.n(M),A=i(960935),b=i.n(A);const F={Online:t(),OnShift:t(),DoNotDisturb:l(),Focusing:l(),Busy:s(),OnThePhone:s(),Away:c(),Idle:c(),BeRightBack:c(),Offline:u(),OffShift:u(),OutOfOffice:k(),Unknown:N(),OnlineOof:I(),BusyOof:h(),OnThePhoneOof:h(),DoNotDisturbOof:T(),FocusingOof:T(),Disabled:y(),Blocked:b()}},833582:(e,n,i)=>{"use strict";i.d(n,{G:()=>l,$:()=>o});var a=i(957032),t=i(513432);const r=t.createContext({userPresence:void 0,setUserPresence:()=>{}}),l=({children:e})=>{const[n,i]=t.useState();return(0,a.Y)(r.Provider,{value:{userPresence:n,setUserPresence:i},children:e})},o=()=>t.useContext(r)},476184:(e,n,i)=>{"use strict";i.d(n,{v9:()=>F,wN:()=>C,Ft:()=>U,My:()=>E,RF:()=>O,Xt:()=>B,m9:()=>z,J9:()=>R,Ff:()=>Q,mU:()=>W,gO:()=>Y,P3:()=>G,bg:()=>_});var a=i(957032),t=i(513432),r=i(959022),l=i(100365),o=i(568834),s=i(879462),d=i(432720),c=i(878138),m=i(188468),u=i(899273),p=i(160847),k=i(771767),g=i(645275),N=i(364819);const{createContext:v,memo:I,useContext:f,useMemo:h,useState:S,useRef:T,useCallback:M}=t,y={minHeightBreakpoint:k.f0.IS_GREATER_THAN_0,minWidthBreakpoint:k.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:k.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:k.cw.IS_GREATER_THAN_0},A={responsiveBreakpoints:{...y},responsiveBreakpointsVariables:(0,g.eo)(y)},b=v(A),F=(e,n)=>n?new o.c((i=>{const a=new e.ResizeObserver((([e])=>i.next(e)));return a.observe(n),()=>a.disconnect()})):l.w,C=()=>e=>e.pipe((0,s.p)((e=>e.contentRect.width>0))),D=(e,n,i)=>F(e,n).pipe((0,c.B)(250),((e,n)=>i=>i.pipe(C(),(0,d.T)((i=>(0,g.PY)({height:i.contentRect.height,width:i.contentRect.width,host:e,setWidthCallback:n})))))(e,i),(0,m.F)()),U=I((({children:e,containerRef:n,initialSize:i,setWidthCallback:t})=>{const{host:l}=(0,u.ur)(),[o,s]=S((()=>{const e={minHeightBreakpoint:i?.minHeightBreakpoint??k.f0.IS_GREATER_THAN_0,minWidthBreakpoint:i?.minWidthBreakpoint??k.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:l.self.innerHeight??k.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:l.self.innerWidth??k.cw.IS_GREATER_THAN_0};return{responsiveBreakpoints:e,responsiveBreakpointsVariables:(0,g.eo)(e)}})),d=h((()=>new Set),[]),c=M((e=>{const n={responsiveBreakpoints:e,responsiveBreakpointsVariables:(0,g.eo)(e)};(0,r.unstable_batchedUpdates)((()=>{s(n),d.forEach((e=>e.next(n)))}))}),[s,d]),m=n.current,v=h((()=>D(l,m,t)),[l,m,t]);(0,p.J)(v,{next:c},!0);const I=T(o);I.current=o;const f=T((e=>{const n={next:(N.noop,i=>{const a=w(e,i);(0,N.isEqual)(a,n.value)||(n.value=a,n.onNext?.(a))}),value:w(e,I.current),unsubscribe:(N.noop,()=>d.delete(n))};return d.add(n),n}));return(0,a.Y)(b.Provider,{value:o,children:(0,a.Y)(L.Provider,{value:f.current,children:e})})})),E=()=>f(b).responsiveBreakpoints,w=(e,n)=>{const i={};for(const a of e)i[a]=a in n.responsiveBreakpoints?n.responsiveBreakpoints[a]:n.responsiveBreakpointsVariables[a];return i},L=v((e=>({next:N.noop,value:w(e,A),unsubscribe:N.noop}))),O=e=>{const n=function(e){const n=t.useRef(e);n.current===e||(0,N.isEqual)(n.current,e)||(n.current=e);return n.current}(e),i=t.useContext(L),a=t.useMemo((()=>i(n)),[i,n]),[r,l]=t.useState(a.value);return a.onNext=l,t.useEffect((()=>()=>a.unsubscribe()),[a]),a.value};const x=["minHeightBreakpoint"],P=["minWidthBreakpoint"],V=["minHeightViewportBreakpoint"],j=["minWidthViewportBreakpoint"],B=()=>O(x),z=()=>O(P),R=({children:e})=>(0,a.Y)(b.Consumer,{children:n=>e(n)}),Q=()=>f(b).responsiveBreakpointsVariables,W=e=>{let n=B();return n=e||n,h((()=>(0,g.Lg)(n)),[n])},Y=e=>{let n=O(V);return n=e||n,h((()=>(0,g.pM)(n)),[n])},G=e=>{let n=z();return n=e||n,h((()=>(0,g.A7)(n)),[n])},_=e=>{let n=O(j);return n=e||n,h((()=>(0,g.ok)(n)),[n])}},337601:(e,n,i)=>{"use strict";i.d(n,{N:()=>d});var a=i(513432),t=i(266713),r=i(284942),l=i(526521),o=i(618278);const s=(0,i(965804).O)({root:{oivjwe:"f1h8hb77",dvvfom:"f1x7u7e9",w71qe1:"f13mvf36",Bkioxbp:"f1cmlufx",C4gs1y:"f10aw75t",Beapcnx:"fsle3fq",Jkg3mj:"f17ae5zn"},subtle:{C4gs1y:"f18y0hww",Beapcnx:"f8r86f8"},inline:{dvvfom:"f1lqvz6u"},inlineSubtle:{dvvfom:"f1842k2q"},disabled:{dvvfom:"f1x7u7e9",C4gs1y:"f1y8dcps",Beapcnx:"f16x84av"}}),d=a.forwardRef(((e,n)=>{const i=(0,t.f)(e,n);i.root.dir="string"==typeof e.children?"auto":void 0,(0,r.r)(i);const{appearance:a,disabled:d,inline:c}=i,m=s();return i.root.className=(0,l.z)(i.root.className,m.root,"subtle"===a&&m.subtle,c&&m.inline,"subtle"===a&&c&&m.inlineSubtle,d&&m.disabled,e.className),(0,o.q)(i)}))},136027:(e,n,i)=>{"use strict";i.d(n,{P6:()=>u,oD:()=>k});var a=i(957032),t=i(513432),r=i(849731),l=i(823769),o=i(413455),s=i(364819),d=i(899273),c=i(973893);const m="333ms";var u;!function(e){e[e.Fail=0]="Fail",e[e.Loading=1]="Loading",e[e.Succeed=2]="Succeed"}(u||(u={}));class p extends t.PureComponent{constructor(){super(...arguments),this._loaderImage=null,this.state={...this._getInitialState(this.props)},this._getImageComponent=e=>{const{fixedAspectRatio:n,variables:i,isInlineImageWrapper:t,isImageInlineOrAttached:o,dataImageMode:s}=this.props,{maxHeight:d,maxWidth:c}=this.state,u=this._shouldShowImage(),p=this._shouldAddPlaceholder();return(0,a.Y)(r.s,{as:"span",itemType:s,style:{...!o&&{maxHeight:n?`${d}rem`:void 0,maxWidth:`${c}rem`}},variables:{...i,hasFixedAspectRatio:n,isRelativePositioned:p,isInlineImageWrapper:t},children:[(0,a.Y)(l.X,{visible:u,name:"fadeInInPlace",duration:m,iterationCount:"1",fillMode:"forwards",children:e}),this._getImagePlaceholder()]})},this._getHeightsAndWidths=()=>{const{width:e,height:n}=this.props;let i,a=20;if(e&&n){const t=this._getMaxHeightAndMaxWidth(n,e);a=t.maxHeight,i=t.maxWidth}return{height:n,maxHeight:a,maxWidth:i,width:e}},this._getImagePlaceholder=()=>{const{placeholder:e,preLoadState:n}=this.props,{loadState:i}=this.state;if(e&&this._shouldAddPlaceholder())return i===u.Fail||n===u.Fail?e.failureCbElem:e.loadingCbElem},this._loadImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(u.Succeed),this.setState({src:this.props.src,loadState:u.Succeed})},this._errorImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(u.Fail),this.setState({src:this.props.src,loadState:u.Fail})},this._lazyLoadImage=()=>{const{host:{Image:e}}=this.props;this._loaderImage=new e,this._loaderImage.addEventListener("load",this._loadImageEventListener,{once:!0}),this._loaderImage.addEventListener("error",this._errorImageEventListener,{once:!0}),this._loaderImage.src=this.props.src},this._shouldShowImage=()=>{const{preLoadState:e}=this.props,{loadState:n}=this.state;return e===u.Succeed||n===u.Succeed},this._shouldAddPlaceholder=()=>{const{placeholder:e}=this.props;return!this._shouldShowImage()&&!!e}}componentDidMount(){(0,s.isEmpty)(this.props.src)||this._lazyLoadImage()}componentWillUnmount(){this._loaderImage?.removeEventListener("load",this._loadImageEventListener),this._loaderImage?.removeEventListener("error",this._errorImageEventListener)}componentDidUpdate(e,n){const{src:i,preLoadState:a,scenarioHandler:t}=this.props,{loadState:r}=this.state;a===u.Succeed&&this.setState({src:i});const l=a===u.Fail||r===u.Fail;if(e.src===i||l)l&&t&&t(u.Fail);else{const{height:e,maxHeight:n,maxWidth:i,width:a}=this._getHeightsAndWidths();this._lazyLoadImage(),this.setState({height:e,loadState:u.Loading,maxHeight:n,maxWidth:i,width:a})}}render(){const{alt:e,as:n,fixedAspectRatio:i,height:t,id:s,itemType:d,placeholder:u,preLoadState:p,scenarioHandler:k,src:g,styles:N,variables:v,width:I,host:f,isInlineImageWrapper:h,isImageInlineOrAttached:S,isMosaicIcon:T,dataImageMode:M,dataGifSrc:y,...A}=this.props,{height:b,maxHeight:F,maxWidth:C,src:D,width:U,loadState:E}=this.state,w=`lazy-image-${E}`,L="lazy-image",O=this._shouldShowImage();let x;const P=this._shouldAddPlaceholder();if(U&&b){let t=c.Y5.NONE;return S&&(t=(0,c.AJ)(U,b)),x=(0,a.Y)(o._,{as:n,"data-tid":w,"data-inp":L,alt:e,className:"ui-known-width-and-height",id:s,itemType:d,"data-image-type":t,"data-image-mode":M,"data-gif-src":y,src:i?"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7":D,style:{...!S&&{maxHeight:`${F}rem`,maxWidth:`${C}rem`},...i&&{backgroundImage:`url("${D}")`}},styles:{...i?{backgroundPosition:"center",backgroundSize:"cover",height:"100%",width:"100%"}:N,...T&&{padding:0}},variables:{...v,hasKnownWidthAndHeight:!0,isImageInlineOrAttached:S},...A}),this._getImageComponent(x)}return i?(x=(0,a.Y)(o._,{as:n,"data-tid":w,"data-inp":L,alt:e,id:s,itemType:d,src:D,className:"ui-unknown-width-or-height","data-image-type":S?c.Y5.STANDARD:null,"data-image-mode":M,"data-gif-src":y,style:{...i&&{backgroundImage:`url("${D}")`}},variables:{...v,responsiveImageUnknownHeightAndWidth:!0},...A}),this._getImageComponent(x)):(0,a.Y)(r.s,{as:"span",variables:{...v,isRelativePositioned:P},children:[(0,a.Y)(l.X,{visible:O,name:"fadeInInPlace",duration:m,iterationCount:"1",fillMode:"forwards",children:(0,a.Y)(o._,{as:n,"data-tid":w,"data-inp":L,"aria-label":e,className:"ui-unknown-width-or-height","data-image-type":S?c.Y5.STANDARD:null,"data-image-mode":M,"data-gif-src":y,id:s,itemType:d,role:"img",style:{backgroundImage:`url("${D}")`,...!S&&{paddingTop:`${F}rem`}},styles:{...N,...S&&{backgroundSize:"cover"}},variables:{...v,hasUnknownWidthOrHeight:!0},...A})}),this._getImagePlaceholder()]})}_getInitialState(e){const{width:n,height:i,isVideoThumbnail:a,preLoadState:t}=e,r=t===u.Succeed;let l,o,s=20;if(n&&i){const e=this._getMaxHeightAndMaxWidth(i,n,a);s=e.maxHeight,l=e.maxWidth,o=`0 0 ${n} ${i}`}else o=`0 0 1 ${s}`;return{height:i,maxHeight:s,maxWidth:l,src:r?e.src:`data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="${o}"%3E%3C/svg%3E`,width:n,loadState:r?u.Succeed:u.Loading}}_getMaxHeightAndMaxWidth(e,n,i){const a=n/e;let t=e/10,r=n/10>62?62:n/10;return(t>48||a<.5)&&(i||(t=48),r=a*t),{maxHeight:t,maxWidth:r}}}const k=e=>{const{host:n}=(0,d.ur)();return(0,a.Y)(p,{...e,host:n})}},532875:(e,n,i)=>{"use strict";i.d(n,{z:()=>c});var a=i(957032),t=i(513432),r=i(670214),l=i(129123),o=i(754255),s=i(19962);const d=({children:e})=>{const{disallowAppRegionOverrides:n}=(0,l.w2)(o.w.Core,["disallowAppRegionOverrides"]);return(0,a.Y)(t.Fragment,{children:e({disallowAppRegionOverrides:!!n})})},c=e=>{const{UNSAFE_overflowAndFlipBoundaryRef:n}=(0,s.g6)(),{disableOverflowAndFlipBoundaryContext:i,...t}=e,o=i?{}:{flipBoundary:n?.current||"window",overflowBoundary:n?.current||"window"};l.w2._isMockFunction;return(0,a.Y)(d,{children:({disallowAppRegionOverrides:e})=>(e&&(t.content={...t.content,variables:{...t.content?.variables,disallowAppRegionOverrides:e}}),(0,a.Y)(r.z,{...t,...o}))})}},375192:(e,n,i)=>{"use strict";i.d(n,{S:()=>o});var a=i(957032),t=i(513432),r=i(476184),l=i(136027);const o=e=>{const n=(0,r.Ff)(),{variables:i}=e,o=t.useMemo((()=>({...i,...n})),[n,i]);return(0,a.Y)(l.oD,{...e,variables:o})}},78727:(e,n,i)=>{e.exports=i.p+"133bf0a0b104ec3dfc5b9ab207e54873.svg"},960935:(e,n,i)=>{e.exports=i.p+"c52bdfa460d7b878541ff0d9833e3c7b.svg"},870586:(e,n,i)=>{e.exports=i.p+"93bf1cc8b8b8092aab2c385d85d22c8d.svg"},834818:(e,n,i)=>{e.exports=i.p+"79f07ba26ed583574678b31546848509.svg"},603313:(e,n,i)=>{e.exports=i.p+"33c8b3e3c8d71273ed9abc4d1bec9bcc.svg"},567322:(e,n,i)=>{e.exports=i.p+"5d07fdf28991f39897b8734021141a6f.svg"},604322:(e,n,i)=>{e.exports=i.p+"0d10d16cedc7b8262d0863ae455bb683.svg"},791542:(e,n,i)=>{e.exports=i.p+"774888c01ebff051c2cad178c17079b3.svg"},118356:(e,n,i)=>{e.exports=i.p+"36fd037c0c6525c9044c5c8ef757c740.svg"},952388:(e,n,i)=>{e.exports=i.p+"5066e146579e847ea9f2d818aab586bb.svg"},152248:(e,n,i)=>{e.exports=i.p+"7aa4c2455abe8a0c8cfa1e8e4b93494c.svg"},444257:(e,n,i)=>{e.exports=i.p+"e0420569cdac40ed7e659a1dae697de8.svg"},25916:(e,n,i)=>{"use strict";i.d(n,{hT:()=>a});i(364819);const a={chat:0,channel:0}},648260:(e,n,i)=>{"use strict";i.d(n,{v:()=>a});const a={Chat:"Chat",EduEmptyState:"EduEmptyState",Meeting:"Meeting",Channel:"Channel",ChannelMeeting:"ChannelMeeting",PrivateMeetingSchedulingForm:"PrivateMeetingSchedulingForm",ChannelMeetingSchedulingForm:"ChannelMeetingSchedulingForm",SingleTeamGridView:"SingleTeamGridView",MeetingChat:"MeetingChat",SelectAppEntity:"SelectAppEntity",ChatMakeAsATab:"ChatMakeAsATab",ChannelMakeAsATab:"ChannelMakeAsATab"}},226107:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{t7:()=>a,ne:()=>t,j4:()=>r,ZM:()=>l}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp",e[e.Workflows=9]="Workflows",e[e.VirtualEvent=10]="VirtualEvent",e[e.BotFeedback=11]="BotFeedback"}(a||(a={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(t||(t={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(r||(r={}));const l={message:"message",compose:"compose",commandBox:"commandBox",copilot:"copilot",thirdParty:"thirdParty",filesOnedrive:"filesOnedrive",filesSharepoint:"filesSharepoint"}},43372:(e,n,i)=>{"use strict";var a;i.d(n,{Y:()=>a}),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab",e[e.powerbar=3]="powerbar"}(a||(a={}))},845768:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{$E:()=>a,lO:()=>t,KN:()=>r}),function(e){e.Bot="Bot",e.Connector="Connector",e.MessagingExtension="MessagingExtension",e.Tab="Tab"}(a||(a={})),function(e){e.None="None",e.Files="Files",e.Links="Links",e.Location="Location",e.People="People",e.PinnedMessages="PinnedMessages",e.Photos="Photos",e.Pinned="Pinned",e.Search="Search",e.Tasks="Tasks",e.TimeZone="TimeZone",e.Highlights="Highlights"}(t||(t={})),function(e){e.ORG="org",e.PROJECT="project"}(r||(r={}))},115100:(e,n,i)=>{"use strict";i.d(n,{Jj:()=>a,SN:()=>t,Oe:()=>r,As:()=>o});var a,t,r,l=i(693973);!function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(a||(a={})),function(e){e.LINE_LOADER="line-loader"}(t||(t={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.PHASE_STATE_MACHINE_DISPOSED="phase-state-machine-disposed",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(r||(r={}));const o={[l.sk.HEADER]:{height:{collapsed:"6.1rem",expanded:"30rem"}}}},678937:(e,n,i)=>{"use strict";var a;i.d(n,{B:()=>a}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(a||(a={}))},712839:(e,n,i)=>{"use strict";var a,t,r,l,o,s;i.d(n,{bY:()=>a,gG:()=>t,n3:()=>r,f4:()=>l,r$:()=>o,BN:()=>s}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(a||(a={})),function(e){e.installed="installed",e.notInstalled="notInstalled",e.preconsented="preconsented"}(t||(t={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(r||(r={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig",e[e.storeapp=9]="storeapp",e[e.workflows=10]="workflows",e[e.virtualEvent=11]="virtualEvent",e[e.personalApp=12]="personalApp",e[e.stageViewOpenSDKApi=13]="stageViewOpenSDKApi",e[e.personalAppsFlyout=14]="personalAppsFlyout",e[e.personalAppsFlyoutSearch=15]="personalAppsFlyoutSearch",e[e.botFeedback=16]="botFeedback"}(l||(l={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(o||(o={})),function(e){e.carousel="carousel",e.list="list"}(s||(s={}))},883970:(e,n,i)=>{"use strict";i.d(n,{S:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateInContextStoreLaunchInstalledAppResultMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InContextStoreLaunchInstalledAppInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateInContextStoreLaunchInstalledAppResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},973120:(e,n,i)=>{"use strict";i.d(n,{J:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyInput"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},706397:(e,n,i)=>{"use strict";i.d(n,{h:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"customBots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointUrl"}},{kind:"Field",name:{kind:"Name",value:"secret"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}},{kind:"Field",name:{kind:"Name",value:"supportsAnonymousAccess"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}},{kind:"Field",name:{kind:"Name",value:"manifestVersion"}},{kind:"Field",name:{kind:"Name",value:"blockedConfigurations"}}]}},...i(816879).x.definitions]}},16214:(e,n,i)=>{"use strict";i.d(n,{j:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appsUsageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppsUsage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIds"}},{kind:"Field",name:{kind:"Name",value:"appActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}},{kind:"Field",name:{kind:"Name",value:"appScenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"sceneId"}}]}},{kind:"Field",name:{kind:"Name",value:"appsMru"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"lastUsedTimeStamp"}}]}}]}}]}},816879:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}}]}},781241:(e,n,i)=>{"use strict";i.d(n,{mR:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastMeetingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastMeeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composerStreamId"}},{kind:"Field",name:{kind:"Name",value:"broadcastState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastStateFields"}}]}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastCommandsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"broadcastMaxAllowedDuration"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastStateFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastCommandsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastProducerAvailableCommands"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setLayout"}},{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"stop"}},{kind:"Field",name:{kind:"Name",value:"updateMediaState"}},{kind:"Field",name:{kind:"Name",value:"restart"}}]}}]}.definitions]}},325180:(e,n,i)=>{"use strict";i.d(n,{s:()=>r});var a=i(221427),t=i(442107);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonCallUpdateFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonCallMuteFragment"},directives:[{kind:"Directive",name:{kind:"Name",value:"nonreactive"}},{kind:"Directive",name:{kind:"Name",value:"mask"}}]}]}},...a.k.definitions,...t.c.definitions]}},983168:(e,n,i)=>{"use strict";i.d(n,{q:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},410703:(e,n,i)=>{"use strict";i.d(n,{U:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},442107:(e,n,i)=>{"use strict";i.d(n,{c:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonCallMuteFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isMutePending"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}}]}},221427:(e,n,i)=>{"use strict";i.d(n,{k:()=>l});var a=i(551668),t=i(781241),r=i(941721);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonCallUpdateFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"callType"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"callMode"}},{kind:"Field",name:{kind:"Name",value:"extendedCallState"}},{kind:"Field",name:{kind:"Name",value:"groupKeyManagerMri"}},{kind:"Field",name:{kind:"Name",value:"transferorMri"}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isSpeakerMuted"}},{kind:"Field",name:{kind:"Name",value:"isCallParked"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"selfRaiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"isSpotlightFeatureEnabled"}},{kind:"Field",name:{kind:"Name",value:"isCompositorEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWeatherpersonCompositionEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWatermarkEnabled"}},{kind:"Field",name:{kind:"Name",value:"isTogetherModePinned"}},{kind:"Field",name:{kind:"Name",value:"isMultilingualMeeting"}},{kind:"Field",name:{kind:"Name",value:"supportedSharingLayouts"}},{kind:"Field",name:{kind:"Name",value:"isAplCustomBackgroundEnabled"}},{kind:"Field",name:{kind:"Name",value:"aplCustomBackgroundId"}},{kind:"Field",name:{kind:"Name",value:"isPPTWeatherpersonEnabled"}},{kind:"Field",name:{kind:"Name",value:"isExtensibleAppWeatherpersonEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTSbSAndReporterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTCameoEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTSharingAvailable"}},{kind:"Field",name:{kind:"Name",value:"isCameoPresenterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isAnnotationSharerWindowOn"}},{kind:"Field",name:{kind:"Name",value:"meetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"organizerUpn"}}]}},{kind:"Field",name:{kind:"Name",value:"screenSharingBounds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}},{kind:"Field",name:{kind:"Name",value:"multipleScreenshareActive"}},{kind:"Field",name:{kind:"Name",value:"isMovePrivateViewingToPPTEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWhiteboardVideoEffectOn"}},{kind:"Field",name:{kind:"Name",value:"sharingLayoutMode"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomsFeatureEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRaiseHandsEnabledForStreaming"}},{kind:"Field",name:{kind:"Name",value:"isNdiEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRaiseHandsAllowed"}},{kind:"Field",name:{kind:"Name",value:"isVideoOn"}},{kind:"Field",name:{kind:"Name",value:"closedCaptionsLanguage"}},{kind:"Field",name:{kind:"Name",value:"optimalVideoCount"}},{kind:"Field",name:{kind:"Name",value:"isIncomingVideoOn"}},{kind:"Field",name:{kind:"Name",value:"isScreenSharingOn"}},{kind:"Field",name:{kind:"Name",value:"isSharingMuted"}},{kind:"Field",name:{kind:"Name",value:"sharingSourceType"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"isMergeable"}},{kind:"Field",name:{kind:"Name",value:"isPSTNEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRejoinable"}},{kind:"Field",name:{kind:"Name",value:"failureType"}},{kind:"Field",name:{kind:"Name",value:"abortReason"}},{kind:"Field",name:{kind:"Name",value:"hadRelayWhitelistingIssue"}},{kind:"Field",name:{kind:"Name",value:"isRoomEndedByOrganizer"}},{kind:"Field",name:{kind:"Name",value:"isRoomEndedByTimer"}},{kind:"Field",name:{kind:"Name",value:"hadReconnectingIssue"}},{kind:"Field",name:{kind:"Name",value:"wasNotAdmittedForLongTime"}},{kind:"Field",name:{kind:"Name",value:"isPushToTalkEnabled"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTransferAllowed"}},{kind:"Field",name:{kind:"Name",value:"isCallParkAvailable"}},{kind:"Field",name:{kind:"Name",value:"isVideoPreviewDisabled"}},{kind:"Field",name:{kind:"Name",value:"isVideoBackgroundSettingsDisabled"}},{kind:"Field",name:{kind:"Name",value:"isPSTNCallbackOptionDisabled"}},{kind:"Field",name:{kind:"Name",value:"isSafeTransferAllowed"}},{kind:"Field",name:{kind:"Name",value:"isCloudRecordingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isLocalRecordingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isTranscriptionAllowed"}},{kind:"Field",name:{kind:"Name",value:"isIpVideoAllowed"}},{kind:"Field",name:{kind:"Name",value:"isSingleOutgoingVideoEnabled"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomsAllowed"}},{kind:"Field",name:{kind:"Name",value:"isDocumentCollaborationAllowed"}},{kind:"Field",name:{kind:"Name",value:"isPowerPointSharingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isWhiteboardAllowed"}},{kind:"Field",name:{kind:"Name",value:"allowedRecorder"}},{kind:"Field",name:{kind:"Name",value:"meetingLegalUrl"}},{kind:"Field",name:{kind:"Name",value:"isExternalTenantContentSharingDisabled"}},{kind:"Field",name:{kind:"Name",value:"interpretationEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"conversationType"}},{kind:"Field",name:{kind:"Name",value:"dominantSpeakerInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dominantSpeakerInfoFields"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"isBroadcast"}},{kind:"Field",name:{kind:"Name",value:"broadcastMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastMeetingFields"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedCallType"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isOneToOnePstn"}},{kind:"Field",name:{kind:"Name",value:"isScreenshareFromChat"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"isInterop"}},{kind:"Field",name:{kind:"Name",value:"isVoicemailGreeting"}},{kind:"Field",name:{kind:"Name",value:"isEchoBotCall"}},{kind:"Field",name:{kind:"Name",value:"isContentOnlyMode"}},{kind:"Field",name:{kind:"Name",value:"isEmergencyCall"}},{kind:"Field",name:{kind:"Name",value:"isConsultCall"}},{kind:"Field",name:{kind:"Name",value:"isSkypeForConsumerCall"}},{kind:"Field",name:{kind:"Name",value:"isMeetingTransferred"}},{kind:"Field",name:{kind:"Name",value:"isHolographicCall"}},{kind:"Field",name:{kind:"Name",value:"isVideoTeleConferencingCall"}},{kind:"Field",name:{kind:"Name",value:"isAudioDropInCall"}},{kind:"Field",name:{kind:"Name",value:"isGroupCall"}}]}},{kind:"Field",name:{kind:"Name",value:"consultContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consultingWith"}},{kind:"Field",name:{kind:"Name",value:"canTransfer"}}]}},{kind:"Field",name:{kind:"Name",value:"canBeRetried"}},{kind:"Field",name:{kind:"Name",value:"isPresenterConnected"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"isCoachSupported"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"screenSharingControlStateAsViewer"}},{kind:"Field",name:{kind:"Name",value:"callerMri"}},{kind:"Field",name:{kind:"Name",value:"canAddParticipants"}},{kind:"Field",name:{kind:"Name",value:"callHeldAt"}},{kind:"Field",name:{kind:"Name",value:"selfCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUnmuteSelf"}},{kind:"Field",name:{kind:"Name",value:"canMuteOthers"}}]}},{kind:"Field",name:{kind:"Name",value:"emergencyCallInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"myRoleInEmergencyCall"}},{kind:"Field",name:{kind:"Name",value:"callerLocation"}},{kind:"Field",name:{kind:"Name",value:"callerNumber"}},{kind:"Field",name:{kind:"Name",value:"emergencyCalleeMri"}},{kind:"Field",name:{kind:"Name",value:"chatExists"}}]}},{kind:"Field",name:{kind:"Name",value:"reconciledOriginalId"}},{kind:"Field",name:{kind:"Name",value:"pstnCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDialInEnabled"}},{kind:"Field",name:{kind:"Name",value:"isDialOutEnabled"}},{kind:"Field",name:{kind:"Name",value:"isLbrEnabledUser"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardingDestinationType"}},{kind:"Field",name:{kind:"Name",value:"callStateProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"hyperLinkInTitle"}},{kind:"Field",name:{kind:"Name",value:"descriptionText"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"useOutlineIcon"}},{kind:"Field",name:{kind:"Name",value:"telemetryContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isScdEnabled"}},{kind:"Field",name:{kind:"Name",value:"isScdAvailable"}},{kind:"Field",name:{kind:"Name",value:"terminatedReason"}},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsParticipantDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantMainMeetingDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"showJoinRoomButton"}},{kind:"Field",name:{kind:"Name",value:"assignedRoomName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsCount"}},{kind:"Field",name:{kind:"Name",value:"openBreakoutRoomsCount"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"remainingRoomDuration"}},{kind:"Field",name:{kind:"Name",value:"initializedAt"}},{kind:"Field",name:{kind:"Name",value:"remainingRoomDurationMs"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoom"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomMain"}},{kind:"Field",name:{kind:"Name",value:"additionalData"}},{kind:"Field",name:{kind:"Name",value:"participantInControl"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"participantId"}}]}},{kind:"Field",name:{kind:"Name",value:"managerUserIds"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomInvite"}},{kind:"Field",name:{kind:"Name",value:"isMainMeetingInvite"}},{kind:"Field",name:{kind:"Name",value:"initiatedTime"}},{kind:"Field",name:{kind:"Name",value:"maskedIdentityDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"}},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"}},{kind:"Field",name:{kind:"Name",value:"maskedId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockMeeting"}},{kind:"Field",name:{kind:"Name",value:"allowMeetingReactions"}},{kind:"Field",name:{kind:"Name",value:"copilotMode"}},{kind:"Field",name:{kind:"Name",value:"isHostViewModeActive"}},{kind:"Field",name:{kind:"Name",value:"yammerQNAEnabled"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkScreenShareEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkVideoEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkScreenShareSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"opacity"}},{kind:"Field",name:{kind:"Name",value:"pattern"}}]}},{kind:"Field",name:{kind:"Name",value:"watermarkVideoSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"opacity"}},{kind:"Field",name:{kind:"Name",value:"pattern"}}]}},{kind:"Field",name:{kind:"Name",value:"sensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"maskIdentitiesForRole"}},{kind:"Field",name:{kind:"Name",value:"forceAttendeeStreaming"}},{kind:"Field",name:{kind:"Name",value:"meetingEndToEndEncryptionEnabled"}},{kind:"Field",name:{kind:"Name",value:"streamingModeActive"}},{kind:"Field",name:{kind:"Name",value:"allowTranslatedCaptions"}},{kind:"Field",name:{kind:"Name",value:"enableParticipantRenaming"}},{kind:"Field",name:{kind:"Name",value:"isPresenterCapabilitiesReduced"}},{kind:"Field",name:{kind:"Name",value:"hasCommentStream"}},{kind:"Field",name:{kind:"Name",value:"usersCanAdmitFromLobby"}},{kind:"Field",name:{kind:"Name",value:"whoCanAccessTranscriptAndRecording"}},{kind:"Field",name:{kind:"Name",value:"transcriptAndRecordingUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"upn"}}]}},{kind:"Field",name:{kind:"Name",value:"groupCopilotDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"}}]}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}}]}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isChannelMeeting"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeeting"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"anyWaterMarkLegacyUserEverInMeeting"}},{kind:"Field",name:{kind:"Name",value:"masterEventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"subject"}}]}},{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"subject"}}]}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"channelObjectId"}},{kind:"Field",name:{kind:"Name",value:"channelTenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingArtifacts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactsCollection"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasLiveInterpretation"}},{kind:"Field",name:{kind:"Name",value:"isAiInterpretationEnabled"}},{kind:"Field",name:{kind:"Name",value:"groups"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"interpreters"}}]}},{kind:"Field",name:{kind:"Name",value:"floor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"liveInterpreterCount"}}]}},{kind:"Field",name:{kind:"Name",value:"selfInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"}},{kind:"Field",name:{kind:"Name",value:"isAiInterpretationEnabledForSelf"}},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"interpretationVolumeRate"}},{kind:"Field",name:{kind:"Name",value:"selfBidirectionalInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"appliedInteractivityLevel"}},{kind:"Field",name:{kind:"Name",value:"sharingPresenterIds"}},{kind:"Field",name:{kind:"Name",value:"isHighFidelityAudioEnabled"}},{kind:"Field",name:{kind:"Name",value:"hasOverflowRoom"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoRejoin"}},{kind:"Field",name:{kind:"Name",value:"vdiCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"video"}},{kind:"Field",name:{kind:"Name",value:"screenshare"}},{kind:"Field",name:{kind:"Name",value:"appshare"}},{kind:"Field",name:{kind:"Name",value:"hid"}},{kind:"Field",name:{kind:"Name",value:"multimonitorscreenshare"}},{kind:"Field",name:{kind:"Name",value:"remoteaudionotifications"}},{kind:"Field",name:{kind:"Name",value:"compositedevices"}},{kind:"Field",name:{kind:"Name",value:"multiwindow"}},{kind:"Field",name:{kind:"Name",value:"datachannel"}},{kind:"Field",name:{kind:"Name",value:"givecontrol"}},{kind:"Field",name:{kind:"Name",value:"sharesystemaudio"}},{kind:"Field",name:{kind:"Name",value:"backgroundeffects"}}]}},{kind:"Field",name:{kind:"Name",value:"rtmpInProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rtmpEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"stagingRoomProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventActive"}},{kind:"Field",name:{kind:"Name",value:"eventEnded"}},{kind:"Field",name:{kind:"Name",value:"stagingRoomEnabled"}},{kind:"Field",name:{kind:"Name",value:"eventIsLoading"}}]}},{kind:"Field",name:{kind:"Name",value:"callLimits"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sponsor"}}]}},{kind:"Field",name:{kind:"Name",value:"callEndDiagnosticsInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callControllerCode"}},{kind:"Field",name:{kind:"Name",value:"callControllerSubCode"}}]}},{kind:"Field",name:{kind:"Name",value:"acceptedElsewhereBy"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}}]}},{kind:"Field",name:{kind:"Name",value:"isImmersiveViewActive"}},{kind:"Field",name:{kind:"Name",value:"isImmersiveViewActiveLoading"}},{kind:"Field",name:{kind:"Name",value:"userEndpointCount"}},{kind:"Field",name:{kind:"Name",value:"isAppHandlingAudio"}},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"}},{kind:"Field",name:{kind:"Name",value:"brandingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultTheme"}},{kind:"Field",name:{kind:"Name",value:"meetingBrandingThemes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"identity"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"enabled"}},{kind:"Field",name:{kind:"Name",value:"brandAccentColor"}},{kind:"Field",name:{kind:"Name",value:"logoImageLightUri"}},{kind:"Field",name:{kind:"Name",value:"logoImageDarkUri"}},{kind:"Field",name:{kind:"Name",value:"backgroundImageLightUri"}},{kind:"Field",name:{kind:"Name",value:"backgroundImageDarkUri"}}]}},{kind:"Field",name:{kind:"Name",value:"lobbyLogoBrandingImages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"transcriptOrganizerId"}},{kind:"Field",name:{kind:"Name",value:"transferTargetDisplayName"}},{kind:"Field",name:{kind:"Name",value:"isApplianceMode"}},{kind:"Field",name:{kind:"Name",value:"intent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"participants"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"isServerHold"}},{kind:"Field",name:{kind:"Name",value:"callOrigin"}},{kind:"Field",name:{kind:"Name",value:"participantType"}},{kind:"Field",name:{kind:"Name",value:"backroomChatThreadId"}},{kind:"Field",name:{kind:"Name",value:"isSomeoneInImmersiveView"}},{kind:"Field",name:{kind:"Name",value:"isSomeoneInImmersiveSpace"}},{kind:"Field",name:{kind:"Name",value:"isOfficePreloadAllowed"}},{kind:"Field",name:{kind:"Name",value:"nativeMeetingStageCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"}},{kind:"Field",name:{kind:"Name",value:"level"}}]}},{kind:"Field",name:{kind:"Name",value:"monitoredAgentState"}},{kind:"Field",name:{kind:"Name",value:"invitationData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"proximitySource"}},{kind:"Field",name:{kind:"Name",value:"deviceType"}}]}},{kind:"Field",name:{kind:"Name",value:"isAcsInteropCall"}},{kind:"Field",name:{kind:"Name",value:"isScreenshareFromChatCallEscalated"}},{kind:"Field",name:{kind:"Name",value:"isPstnCallEscalated"}},{kind:"Field",name:{kind:"Name",value:"callQueueInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"enableCaptcha"}},{kind:"Field",name:{kind:"Name",value:"roomPeopleCount"}},{kind:"Field",name:{kind:"Name",value:"isCallMonitored"}},{kind:"Field",name:{kind:"Name",value:"monitoredAgentState"}},{kind:"Field",name:{kind:"Name",value:"sipMeetingMetaData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}}]}}]}},...a.T.definitions,...t.mR.definitions,...r.PP.definitions]}},358809:(e,n,i)=>{"use strict";i.d(n,{h:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatAddMembersFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"isMeeting"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}}]}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}}]}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}}]}}]}},69886:(e,n,i)=>{"use strict";i.d(n,{Y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatMtoTelemetryFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedMTOUser"}}]}}]}},731687:(e,n,i)=>{"use strict";i.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatPaneLayoutFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}}]}}]}}]}},733043:(e,n,i)=>{"use strict";i.d(n,{W:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatRecapFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hasRecap"}}]}}]}},819972:(e,n,i)=>{"use strict";i.d(n,{I:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatWithMtoUserBannerFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"firstMtoMember"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"homeMri"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"mtoHomeUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatWithFederatedIdentities"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInTheirHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"memberHomeTenantMris"}}]}}]}}]}},741357:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonRecordingMessageMiFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}},930427:(e,n,i)=>{"use strict";i.d(n,{n:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUseExternalTagFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}},{kind:"Field",name:{kind:"Name",value:"isMeeting"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}}]}}]}}]}},366554:(e,n,i)=>{"use strict";i.d(n,{P:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUseMtoUserBannerFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"memberHomeTenantMris"}}]}}]}}]}},551668:(e,n,i)=>{"use strict";i.d(n,{T:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"dominantSpeakerInfoFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DominantSpeakerInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerList"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}},570947:(e,n,i)=>{"use strict";i.d(n,{B:()=>o});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstallerIdentity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installerType"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"azureAdAppId"}}]}}]};var t=i(802093),r=i(706397);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewGlobalPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isUnlicensed"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"installerIdentity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}},{kind:"Field",name:{kind:"Name",value:"botMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"registrationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceAppId"}}]}}]}}]}},...a.definitions,...t.O.definitions,...r.h.definitions,...l.definitions]}},160606:(e,n,i)=>{"use strict";i.d(n,{L:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"lastMessageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LastMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"sourceType"}}]}}]}}]}},941721:(e,n,i)=>{"use strict";i.d(n,{iv:()=>a,nn:()=>t,PP:()=>r});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactCollection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactCollection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactV2"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactV2"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactMetadataEntries"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactMetadataEntries"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactMetadataEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"linkScope"}},{kind:"Field",name:{kind:"Name",value:"hostClient"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"}}]}}]}.definitions]}.definitions]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"reserveMeetingArtifactResponse"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReserveMeetingArtifactResponse"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLeader"}},{kind:"Field",name:{kind:"Name",value:"secret"}},{kind:"Field",name:{kind:"Name",value:"resourceState"}},{kind:"Field",name:{kind:"Name",value:"expiry"}},{kind:"Field",name:{kind:"Name",value:"collab"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactCollection"}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactsCollection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactsCollection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactV2Interface"}}]}},{kind:"Field",name:{kind:"Name",value:"errorState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MsTeamsDataFragmentsCommonMeetingArtifacts_meetingArtifactsErrorState"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactV2Interface"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Interface"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Transcript"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2TranscriptV2"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"webUrl"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"driveId"}},{kind:"Field",name:{kind:"Name",value:"driveItemId"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"transcriptId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Recording"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"ownerOid"}},{kind:"Field",name:{kind:"Name",value:"ownerTid"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"threadMessageId"}},{kind:"Field",name:{kind:"Name",value:"driveItemId"}},{kind:"Field",name:{kind:"Name",value:"driveId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Notes"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"linkScope"}},{kind:"Field",name:{kind:"Name",value:"hostClient"}},{kind:"Field",name:{kind:"Name",value:"addedBy"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2MeetingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"correlationProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CorrelationPropertiesFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Default"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"additionDateTime"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CorrelationPropertiesFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CorrelationProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"referenceId"}},{kind:"Field",name:{kind:"Name",value:"traceId"}},{kind:"Field",name:{kind:"Name",value:"logicalId"}}]}}]}.definitions]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MsTeamsDataFragmentsCommonMeetingArtifacts_meetingArtifactsErrorState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactsErrorState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"subCode"}},{kind:"Field",name:{kind:"Name",value:"subError"}}]}}]}.definitions]}},802093:(e,n,i)=>{"use strict";i.d(n,{O:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}}]}},875094:(e,n,i)=>{"use strict";i.d(n,{M:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"pinnedMessageItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},109587:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userPresenceData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}},{kind:"Field",name:{kind:"Name",value:"workLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"locationSource"}},{kind:"Field",name:{kind:"Name",value:"approximateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"idType"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]}},969037:(e,n,i)=>{"use strict";i.d(n,{z:()=>a,x:()=>t});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"featureSettingsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserFeatureSettingsInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coExistenceMode"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatEnabled"}}]}}]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"decoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"emailsInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"address"}},{kind:"Field",name:{kind:"Name",value:"isPrimary"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}},{kind:"Field",name:{kind:"Name",value:"department"}},{kind:"Field",name:{kind:"Name",value:"featureSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"featureSettingsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"userType"}}]}},...a.definitions]}},264345:(e,n,i)=>{"use strict";i.d(n,{p:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProperties"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationUserProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isMutedInChannel"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"maskId"}}]}}]}},489556:(e,n,i)=>{"use strict";i.d(n,{yW:()=>u,wz:()=>g,sb:()=>N,Pm:()=>v,PW:()=>I,rB:()=>f,Id:()=>S,aN:()=>T,jC:()=>M,lv:()=>y,B7:()=>A,vL:()=>C,yC:()=>D,bY:()=>U,S7:()=>E,Dy:()=>P,Tc:()=>j});var a=i(84646),t=i(580458),r=i(806658),l=i(475728),o=i(640483),s=i(404879);const d="default",c="CallableChannelOboCall",m="callParkService",u="delegates",p="call-log",k="sla-call-history",g=";",N=e=>{switch(e){case"default":return o.b6.Default;case"screenSharing":case"ScreenSharing":return o.b6.ScreenSharing;case"emergencyGroupCall":return o.b6.EmergencyGroupCall;default:return o.b6.Unknown}},v=e=>e?{...e,type:e.type||d}:void 0,I=e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&{...e.onBehalfOf,type:d},details:e.details&&{...e.details,type:d}}),f={displayName:"Unknown",id:"28:unknown",type:d},h=(e,n,i="value")=>{if(!e)return"";const a=`${i}="`,t=e.find((e=>e.indexOf(n)>=0))?.match(new RegExp(`${i}="(.*?)"`,"g"));return t?t[0].substr(a.length,t[0].length-a.length-1):""},S=(e,n,i,t,r)=>{let l,o,s,d,c=(new Date).toISOString();if(r===a.Go.CallTranscript){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId,isExportedToOdsp:e.isExportedToOdsp}}}catch(n){return void e.error("failed to parse transcription content.",n)}})(e,i);if(!n)return;l=n.callId,o=n.userParticipantId,s=n.transcriptMsg}else if(r===a.Go.CallLogTranscript){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,""))),{CallId:i,UserParticipantId:a,ThreadId:t,MessageId:r}=e;return{callId:i,userParticipantId:a,transcriptMsg:{linkedMessage:{conversationId:t,messageId:r}}}}catch(n){return void e.error("failed to parse transcription content.",n)}})(e,i);if(!n)return;l=n.callId,o=n.userParticipantId,s=n.transcriptMsg}else if(r===a.Go.CallLogRecording){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,""))),{CallId:i,UserParticipantId:a,ThreadId:t,MessageId:r,ContentTypes:l}=e;return{callId:i,userParticipantId:a,recordingMsg:{contentTypes:l,linkedMessage:{conversationId:t,messageId:r}}}}catch(n){return void e.error("failed to parse recording message content.",n)}})(e,i);if(!n)return;l=n.callId,o=n.userParticipantId,d=n.recordingMsg}else if(r===a.Go.CallRecording){const e=((e,n)=>{if(!e)return;const i=e.match(/<.*?>/g),t=h(i,'<Id type="callId"'),r=h(i,"<RecordingContent contentTypes=","contentTypes"),l=h(i,'<Id type="OriginatorParticipantId"'),o=h(i,"<RecordingInitiatorId ");return{callId:t,userParticipantId:l,recordingMsg:{conversationId:a.SG,messageId:n||"",initiatorId:o,content:e,contentTypes:r}}})(i,t);if(!e)return;l=e.callId,o=e.userParticipantId,d=e.recordingMsg}else l=n.callId,o=n?.userParticipantId,c=n.startTime;return{callId:l??"",userParticipantId:o,transcript:s,recordings:d&&[d]||[],startTime:c??""}},T=(e,n)=>"-1"===e?n:e,M=({skypeMessage:e,loggerFactory:n})=>{const i=e.conversationid,a=e.messagetype,r=e.content,{callHistoryInput:d,isSlaCallHistory:c}=A(e),m=T(e.id,e.clientmessageid);if(O(d,i))return;const u=n.newLogger("CallHistoryHelper","data-resolvers-calling");try{const i=x(d),{callDirection:p,callState:k,callType:h,callPhoneLineType:T,connectTime:M,endTime:y,eventTranscript:A,isDeleted:O,originatorParticipant:V,participantList:B,sessionType:z,sharedCorrelationId:R,targetParticipant:Q,threadId:W,spamProperties:Y,callAttributes:G,forwardingInfo:_,transferInfo:Z,sharedLineAppearanceParticipantList:H,targetDelegator:J}=i,X=P(i),q=S(u,i,r,m,a);if(!q)return;let K=v(V);K||(K=f,u.warn(`Could not parse valid participant from ${d}`));const $=(e=>"private"===e?s.v1.private:null)(T),ee=(e=>{switch(e){case"missed":return o.A2.Missed;case"accepted":return o.A2.Accepted;case"declined":return o.A2.Declined;case"acceptedElsewhere":return o.A2.AcceptedElsewhere;default:return o.A2.Unknown}})(k),ne=(e=>"incoming"===e?o.QO.Incoming:"outgoing"===e?o.QO.Outgoing:o.QO.Unknown)(p),ie=D(B,Q?.type,V?.type,G?.transferor?.type,Z?.parkType),ae=L(u,i),{validTargetParticipant:te,forwarderParticipant:re,forwardedTargetParticipant:le}=b(ee,Q,_,G,c,!!ae.isSharedLineAppearanceActivated,J),{transferorParticipant:oe,transferTargetParticipant:se}=F(G,Z,ie),de=(e=>"twoParty"===e?o.nz.TwoParty:"multiParty"===e?o.nz.MultiParty:o.nz.Unknown)(h),ce=X&&I(X),{isCallQueue:me}=(0,l._2)({callType:de,applicationContent:ce}),ue=ne===o.QO.Outgoing,pe=ne===o.QO.Incoming,ke=ne===o.QO.Incoming&&ee===o.A2.Missed,ge=ee===o.A2.Declined,Ne=ee===o.A2.AcceptedElsewhere,ve=z===o.b6.EmergencyGroupCall&&B?.length>1,Ie=(0,l.rV)({endTime:y,connectTime:M,targetParticipant:Q}),fe=e.originalarrivaltime;return{id:`${m}${g}${q.callId}`,callStartTime:new Date(q.startTime).getTime(),applicationContent:ce,callDirection:ne,originalArrivalTime:fe,isMissed:ke,isIncoming:pe,isOutgoing:ue,isDeclined:ge,isAcceptedElsewhere:Ne,isEmergencyGroupCall:ve,isCallQueue:me,callState:ee,callType:de,callPhoneLineType:$,durationInMs:Ie,connectTime:M,endTime:y,isDeleted:O,messageId:m,messageType:(0,t.h)(n,a,e.properties),originatorParticipant:K,participantList:B?B.map(v):[],targetParticipant:te,threadId:W,sessionType:N(z),sharedCorrelationId:R??"",spamRiskLevel:Y?Y.riskLevel:null,...q,transferorParticipant:oe,transferTargetParticipant:se,transferTime:Z?.transferTime,transferStatus:Z?.transferStatus&&C(Z.transferStatus),forwarderParticipant:re,forwardedTargetParticipant:le,forwardedTargetType:E(_?.forwardingDestinationType),forwardingType:U(_?.forwardingType),isSharedLineAppearanceCallHistory:c,...c?w(u,i):ae,sharedLineAppearanceParticipantList:H?H.map(v):[],sharedLineAppearanceCallActionList:A?j(A):[]}}catch(e){u.warn(`UnhandledException in message transformation: ${e}`)}},y=({targetParticipant:e,originatorParticipant:n,applicationContent:i},a,t)=>e&&n&&a?t?i?.onBehalfOf?.id:i?.details?.id||null:null,A=e=>{const{properties:n,callLogsOwnerId:i}=e,a={callHistoryInput:void 0,isSlaCallHistory:!!i};return n&&(n[k]?(a.callHistoryInput=n[k],a.isSlaCallHistory=!0):n[p]&&(a.callHistoryInput=n[p])),a},b=(e,n,i,a,t,r,l)=>{let s,d,c=n&&v(n);return e===o.A2.Accepted&&i?.acceptedBy&&(s=t?l&&v(l):c,c=v(i.acceptedBy)),a?.forwardedFrom&&(s=v(a.forwardedFrom)),(e===o.A2.AcceptedElsewhere||t||r)&&i?.acceptedBy&&(d=v(i.acceptedBy)),a?.delegator&&(s=v(a.delegator)),{validTargetParticipant:c,forwarderParticipant:s,forwardedTargetParticipant:d}},F=(e,n,i)=>{let a,t;return i||(e?.transferor&&(a=v(e.transferor)),n?.transferor&&(a=v(n.transferor)),n?.transferTarget&&(t=v(n.transferTarget))),{transferorParticipant:a,transferTargetParticipant:t}},C=e=>{switch(e){case"transferred":return o.An.Transferred;case"transferAccepted":return o.An.TransferAccepted;case"transferFailed":return o.An.TransferFailed;case"transferSucceeded":return o.An.TransferSucceeded;default:return o.An.Unknown}},D=(e,n,i,a,t)=>{const r=t&&"none"!==t&&"Unknown"!==t;return r||r&&!!e?.find((e=>e.type&&e.type===m))||n===m||i===m||a===m},U=e=>{switch(e){case"immediate":return o.W1.Immediate;case"simultaneous":return o.W1.Simultaneous;default:return}},E=e=>{switch(e){case"user":return o.nk.SingleTarget;case"group":return o.nk.Group;case"delegates":return o.nk.MyDelegates;case"voicemail":return o.nk.Voicemail;default:return}},w=(e,n)=>{const{sharedLineAppearanceForwardType:i,originatorDelegator:a,targetDelegator:t}=n;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{forwardingType:U(i),originatorDelegator:a&&v(a),targetDelegator:t&&v(t)}},L=(e,n)=>{const{callAttributes:i,forwardingInfo:a,sharedLineAppearanceActivated:t}=n,l=i?.onBehalfOf?.id&&(0,r.AF)(i.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(t||i?.delegator||l||a?.forwardingDestinationType===u),originatorDelegator:l&&i?.onBehalfOf?v(i.onBehalfOf):void 0,targetDelegator:i?.delegator?v(i.delegator):void 0}},O=(e,n)=>void 0===n?!e:n!==a.SG&&n!==a.Vn,x=e=>e?JSON.parse(e):{},P=e=>{const{applicationContent:n,callAttributes:i,onBehalfOfContext:a}=e;let t;return t=a&&!n?{type:c,configId:a.id||"",onBehalfOf:{type:i?.onBehalfOf?.type||c,id:i?.onBehalfOf?.id||"",displayName:i?.onBehalfOf?.displayName||""}}:n,t},V=e=>{const n=(e=>{switch(e){case"hold":return o.ry.Hold;case"resume":return o.ry.Resume;case"barge":return o.ry.Barge;default:return}})(e.callAction),i=v(e.actionOriginator);if(!n||!i)return;return{callAction:n,callActionTime:e.actionTime,callActionOriginator:i}},j=e=>{const n=[];return e.forEach((e=>{const i=V(e);i&&n.push(i)})),n}},404879:(e,n,i)=>{"use strict";i.d(n,{v1:()=>a});const a={private:"private"}},92001:(e,n,i)=>{"use strict";i.d(n,{lu:()=>o,fO:()=>s,s6:()=>d,BB:()=>c,nH:()=>m,IF:()=>u,gz:()=>p});var a=i(84646),t=i(645095),r=i(797922),l=i(851433);const o=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},s=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e)),d=e=>{if(!e||!(0,r.IV)(e))return null;if((0,r.mz)(e)===t.Cu.Standard){return(e=>{if(!e)return null;let n,i;try{i=e[a.iy.ChannelSettings]&&JSON.parse(e[a.iy.ChannelSettings])}catch{return null}if(!i)return null;switch(i?.allowReplies){case t.sB.Moderators:n="Moderators";break;case t.sB.Everyone:default:n="Everyone"}return n})(e.threadProperties)}return null};function c(e){switch(e){case t.QU.Private:return"Private";case t.QU.Shared:return"Shared";case t.QU.Standalone:return"Standalone";case t.QU.None:default:return"Standard"}}const m=e=>e?!0===e.memberProperties?.isModerator||!1:null,u=(e,n)=>(void 0===n||!!n)&&["convUxChannelId","19:nfkhRXVXWe8hUxiG-grRtzCVBAN_skNpkHPrNTOUGuw1@thread.skype","19:LyT6enSeaOJhiEB7sJtB7ZrriqWBJyIbgL1NHgAquuc1@thread.skype","19:nISaw8P6lNz0ZJmr4amyLX5-AgX-e-YhG1vDqYQBmlE1@thread.skype","19:xcCdGxI-2BWA7Qr2QX8GUFkTT3TQwAty8iejNf6YGMM1@thread.skype","19:b8df9671cf3445d7a0f15af4c8b2f316@thread.skype","19:1d6b31b4d80e427fbd5613498e38ad3d@thread.tacv2","19:7679bbb70b9d448bbab80f3f2858f2c1@thread.tacv2","19:4acd6b200d3a46d9baf005be9104ac80@thread.tacv2","19:a9e02c530678498bb10f06ca79563dd8@thread.tacv2","19:5d54180cb2294e628c2577275e2f02c4@thread.tacv2","19:yCimlamqYpQ3RD5Hl0bPz-wvala1ToUwhh7kHKOMbUU1@thread.tacv2","19:84810aa931ba4de2be56c772b4c1e134@thread.skype"].includes(e),p=(e,n)=>!(0,l.Su)(e,n)},405947:(e,n,i)=>{"use strict";i.d(n,{NX:()=>ie,Lm:()=>ne,PN:()=>ce,qd:()=>le,Kj:()=>de,Uv:()=>oe,rG:()=>re,oq:()=>se,Dc:()=>mi,vc:()=>Sn,Lv:()=>un,f4:()=>Qe,jI:()=>Ve,qU:()=>Pe,KH:()=>ei,fN:()=>_n,C2:()=>Re,BJ:()=>tn,BO:()=>De,QM:()=>Ee,Lf:()=>Mi,qn:()=>Ei,zG:()=>yi,Zk:()=>Ui,eL:()=>bi,UL:()=>Nn,Wk:()=>gn,J3:()=>vn,G_:()=>Ai,r9:()=>Xn,rX:()=>kn,ES:()=>fi,zL:()=>hi,A:()=>Yn,Sd:()=>ri,PH:()=>ai,__:()=>$n,Fz:()=>ni,gj:()=>ci,l7:()=>ti,qK:()=>Si,Hi:()=>Ii,q5:()=>pi,H2:()=>li,wD:()=>Qn,fc:()=>ii,WC:()=>oi,zX:()=>di,Rx:()=>Di,W0:()=>Zn,w1:()=>Xe,xO:()=>Fi,S3:()=>Ue,XO:()=>_e,OS:()=>Un,Xq:()=>Be,Jd:()=>Kn,OB:()=>Cn,FC:()=>Fn,Cs:()=>Ln,Qk:()=>xn,hE:()=>Dn,RS:()=>Ye,FQ:()=>We,fO:()=>Ke,Fx:()=>xe,t0:()=>pn,MH:()=>mn,O8:()=>Mn,jp:()=>Oe,Gg:()=>Vn,NB:()=>Wn,qQ:()=>An,dM:()=>be,JY:()=>Bn,ze:()=>Rn,AK:()=>qe,fi:()=>pe,bo:()=>Ie,sV:()=>Ae,nT:()=>En,RE:()=>wn,_u:()=>we,TH:()=>ze,Ox:()=>qn,LQ:()=>Jn,sW:()=>ke,HU:()=>Hn,cg:()=>Gn,Og:()=>vi});var a=i(754255),t=i(726723),r=i(878336),l=i(343468),o=i(848703),s=i(806658),d=i(84646),c=i(580458),m=i(851433),u=i(680499),p=i(645095),k=i(797922),g=i(737915),N=i(385857),v=i(431779),I=i(193406),f=i(668625),h=i(639884),S=i(364819),T=i(489556),M=i(832901),y=i(810886),A=i(717828),b=i(800079),F=i(114978),C=i(435793),D=i(414664),U=i(906166),E=i(92001);const w=(e,n)=>e?.from!==n&&!!e?.mentions?.some((e=>"everyone"===e.mentionType));var L=i(641319);const O=e=>e&&e.vivaTopicsAnnotations?(e=>{try{return(e=>{const{ApiVersion:n,EntityAnnotation:i,TraceId:a,ClientRequestId:t}=e,{SectionMatches:r}=i;return{apiVersion:n,entityAnnotation:{sectionMatches:r.map((e=>{const{EntityMatches:n,SectionId:i}=e;return{entityMatches:n.map((e=>{const{Entities:n,HighlightedName:i,Length:a,StartPos:t,OccurrenceIndex:r,TotalOccurrences:l,Relevance:o}=e;return{entities:n.map((e=>{const{DisplayName:n,Id:i,RelevanceScore:a,Source:t,Type:r}=e;return{displayName:n,id:i,relevanceScore:a,source:t,type:r}})),highlightedName:i,length:a,startPos:t,occurrenceIndex:r,totalOccurrences:l,relevance:{annotationScore:o.AnnotationScore}}})),sectionId:i}}))},traceId:a,clientRequestId:t}})((0,L.n)(e))}catch(e){return}})(e.vivaTopicsAnnotations)??null:null;var x=i(37321);const P=/^([^(]+)[(]?/;function V(e,n){const i=function(e){let n="";if(!e?.displayName)return n;const i=e.displayName??"",a=e.givenName??"",t=e.surname??"",r=null!==a&&i.startsWith(a),l=null!==t&&i.startsWith(t);if(null!==a&&r&&!l)n=a;else if(l&&!r){const e=P.exec(i);e&&e.length>1&&(n=e[1].trim())}return n=n||i,n||""}(n);return i||(e?e.split(" ")[0]:"")}var j=i(678937),B=i(870785);const z=(e,n,i)=>{const{enableGroupChatInviteFlow:t}=i.get(a.w.Messaging),r=(0,x.Ib)(e);return!!t&&!n&&!r},R=(e,n)=>{const{enableMeetingChatAcceptBlockFlow:i}=n.get(a.w.Calling);return!!i&&(0,g.CR)(e)},Q=(e,n,i,a,t)=>{if(a)return!1;const r=!!(0,s.oZ)(e.id);return((e,n,i)=>{const a=(0,k.xl)(e);return!(!n||!i||a)})(e.id,i,!!e.usersProps?.hasConsumerUser)||((e,n,i,a,t)=>{let r=!1,l=[];if(a){const n=[];e.members?.forEach((e=>{const i=a[e.id];i&&n.push(i)})),r=!!(0,x.vu)(n,t).length,l=n.map((e=>e.id))}else{const n=(0,k.EO)(e);r=n&&n!==t||(e.members||[]).some((e=>e.tenantId&&e.tenantId!==t)),l=e.members?.map((e=>e.id))||[]}return(0,s.wD)(e.id,n,i,r||n,l)})(e,r,i,n,t)||(l=e.id,(0,k.xl)(l));var l};var W=i(4718),Y=i(899607);const G=e=>{const{conversation:n,profilesMap:i,coreSettings:t,i18n:r,loggerFactory:l,currentUserMri:o,currentUserTenantId:m,addSenderName:u=!1,onlyUseLastMessageSender:p=!1}=e,g=!!(0,k.CN)(n),N=!!(0,k.LN)(n),I=(0,v.$)(n?.lastMessage?.from??""),f=i[I],h=((e,n,i,t,r,l,o)=>{let s;const{environment:c}=i.get(a.w.Metadata),m=c===j.B.life,u=e.properties?.interopconversationstatus;switch(u){case d.$y.ExtendedDirectoryAcceptPending:s=t.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:o?.displayName||t.stringTranslate("peoplePicker","unknown_user")});break;case d.$y.AcceptPending:s=z(e.id,r,i)||Q(e,n,r,m,l)||R(e,i)||(0,B.PF)(e)?t.stringTranslate("messaging","tmp_group_chat_invite_flow_chat_list_preview"):t.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:o?.displayName||t.stringTranslate("peoplePicker","unknown_user")});break;case d.$y.Blocked:s=t.stringTranslate("people","blocked_sfc_chat_preview_message")}return s})(n,p?void 0:i,t,r,g,m,f);if(h)return h;const S=n.lastMessage;if(!S){return(0,k.Yt)(n.id)?r.stringTranslate("messaging","chats_messageDraftPreview_default"):""}if(S.properties?.deletetime)return r.stringTranslate("messaging","chats_messagePreview_lastMessage_deleted");const T=(0,c.h)(l,S.messagetype,S.properties);let M=(0,Y.v)(n,r,T,t);if(""===M.trim()&&(M=(0,W.V)(S,r,l)),!M)return"";if((0,s.e6)(S)&&(0,D.Mr)(n,t))return r.stringTranslate("messaging","tmp_chat_list_message_preview_reply_message");if(!u)return M;const y=I===o,A=function(e,n,i,a,t,r){const l=V(n,i);return e===d.Go.Call||e===d.Go.AddMember||e===d.Go.CallRecording||e===d.Go.CallLocalRecording||e===d.Go.CallTranscript||t&&!a?(0,s.Iz)(i?.mri??"")&&!r?{key:"chats_messagePreview_withDisplayName",displayName:l}:{key:"chats_messagePreview_withoutDisplayName"}:a?{key:"chats_messagePreview_fromSelf"}:l?{key:"chats_messagePreview_withDisplayName",displayName:l}:{key:"chats_messagePreview_withoutDisplayName"}}(T,S.imdisplayname,f,y,!!g,!!N);return M=r.stringTranslate("messaging",A.key,{message:M,displayName:A.displayName}),M},_="Action.Compose".toLowerCase(),Z="Action.ODSL".toLowerCase(),H="ImBack".toLowerCase(),J="Teams.chatMessage".toLowerCase();class X{constructor(e){this.parse=e=>this.toSuggestedActionsSchema(e),this.toTargetedUsers=e=>{if(!e)return[];if(!Array.isArray(e))throw new Error(`Suggested action target users should be an array. Target users: ${JSON.stringify(e)}`);const n=[];for(const i of e){if("string"!=typeof i)throw new Error(`Suggested action target users should be an array of strings. Target users: ${JSON.stringify(e)}`);n.push(i)}return n},this.toActionsSchema=e=>{if(!e||(0,S.isEmpty)(e))return[];if(!Array.isArray(e))throw new Error(`Suggested actions should be an array. Actions: ${JSON.stringify(e)}`);const n=[];for(const i of e){const e=this.toSuggestedAction(i);e&&n.push(e)}return n},this.toSuggestedAction=e=>{if(!e||"object"!=typeof e)throw new Error(`suggested action is null or not on object. ${JSON.stringify(e)}`);if("string"!=typeof e.title||"string"!=typeof e.type)throw new Error(`suggested action fiels should be string. ${JSON.stringify(e)}`);const n=e=>"string"!=typeof e?JSON.stringify(e):e;switch(e.type.toLowerCase()){case H:return{__typename:"SuggestedActionImBack",title:e.title,text:n(e.value||"")};case _:return this.toActionComposeSchema(e);case Z:return{__typename:"SuggestedActionODSL",title:e.title,value:n(e.value||"")};default:return this.logger.log(`Unsupported action. Type: ${e.type}`),null}},this.logger=e.newLogger("toSuggestedActions","data-resolvers-common")}toSuggestedActionsSchema(e){try{const n=this.toTargetedUsers(e.to),i=this.toActionsSchema(e.actions);return(0,S.isEmpty)(i)?null:{__typename:"SuggestedActions",to:n,actions:i}}catch(e){return this.logger.log(`Error parsing suggested actions. Error: ${e}`),null}}toActionComposeSchema({title:e,value:n}){try{const i=n;if(i&&i instanceof Object&&"string"==typeof i.type&&i.type.toLowerCase()===J&&i.data&&"object"==typeof i.data){const n=i.data;let a=null;if(n.body&&"object"==typeof n.body){const e=n.body;"string"==typeof e.content&&(a=e.content)}if(!a)return null;const t=this.toAttachmentsSchema(n.attachments),r=this.toMentionsSchema(n.mentions);return{__typename:"SuggestedActionCompose",title:e,content:a,attachments:t,mentions:r}}this.logger.log(`Unsupported action. Value: ${n}`)}catch(e){this.logger.log(`Invalid suggested action value. Error: ${e} Value: ${n}`)}return null}toAttachmentsSchema(e){return e&&Array.isArray(e)?e.map((e=>{if(!e||"object"!=typeof e||"string"!=typeof e.contentUrl||"string"!=typeof e.id||"string"!=typeof e.name)throw new Error(`Attachment fields should be string. ${JSON.stringify(e)}`);return{contentUrl:e.contentUrl,id:e.id,name:e.name}})):(this.logger.log("no attachments found in the suggested action value"),null)}toMentionsSchema(e){if(e&&Array.isArray(e)){const n=[];return e.forEach((e=>{if(!e||"object"!=typeof e||!e.mentioned||"object"!=typeof e.mentioned||!e.mentioned.user||"object"!=typeof e.mentioned.user||"string"!=typeof e.id&&"number"!=typeof e.id||"string"!=typeof e.mentioned.user.id)throw new Error(`Invalid mention object. ${JSON.stringify(e)}`);n.push({id:e.id.toString(),mri:e.mentioned.user.id})})),n}return this.logger.log("no mentions found in the suggested action value"),null}}var q=i(840917);const K="http://schema.skype.com",$=`${K}/StarredMessage`,ee=`${K}/Mention`,ne=`${K}/File`,ie=2,ae=v.$,te=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var re;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(re||(re={}));const le="preview-",oe="newchat",se="welcomePage",de="bizChatMetaOSChatListEntryPoint",ce="holisticRecapChatListEntryPoint",me=(e,n,i=!1)=>{if(!e?.emotions)return null;const a=e.emotions.map((({key:e,users:n})=>({key:e,users:n.map((({mri:e,time:n,value:i})=>({id:ae(e),time:n,value:i}))).sort(((e,n)=>e.time-n.time))})));return i&&a.sort(((e,i)=>(n?.emotions?.[i.key]??i.users.length??0)-(n?.emotions?.[e.key]??e.users.length??0))),a},ue=e=>{if(!e||!e.emotions)return null;const n=e.emotions;return Object.keys(n).map((e=>({key:e,count:n[e]})))},pe=(e,n,i)=>e&&e.mentions?Ne(e.mentions,n,i):null,ke=(e,n,i)=>e&&e.onbehalfof?Ne(e.onbehalfof,n,i):null,ge=(e,n)=>{if(!n||!n.atp)return null;const i=n.atp;try{return"string"==typeof i?JSON.parse(i):i}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${n}`),null}},Ne=(e,n,i)=>{try{if("string"==typeof e&&(0,s.AF)(e))return null;const i="string"==typeof e?JSON.parse(e):e;return i?.length?i.map((({itemid:e,mri:i,displayName:a,mentionType:t})=>({id:`${n}_${e}_${i}`,userId:i,itemId:e,displayName:a,mentionType:t}))):null}catch(e){const a=i?.newLogger("Chat Helper","data-resolvers-common");return a?.errorToTelemetry?.(`UnhandledException in messageId: ${n}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},ve=(e,n,i,a)=>{if(!n||!n.files)return null;const t=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(n?.files),r=0;return e=e.filter((e=>"deeplink"===e.type)),r=e.length,e=e.filter((e=>e)),r!==e.length&&(t?.errorToTelemetry?.(`toDeepLinks::Files contains falsy value. Filtered out.::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),r=e.length),e=e.filter((e=>e.id)),r!==e.length&&t?.errorToTelemetry?.(`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),e.map((({id:e,title:n,fileInfo:i,channelId:t,state:r})=>({id:e,title:n,state:r,serverRelativeUrl:i.serverRelativeUrl,channelId:t||a,siteUrl:i.siteUrl,objectUrl:i.fileUrl})))}catch(e){return t?.errorToTelemetry?.(`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),null}},Ie=e=>e&&JSON.stringify((0,S.map)(e,(({content:e,...n})=>({...n,content:JSON.parse(e)})))),fe=(e,n)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const n=["http","https"],i=JSON.parse(e.links),a=[],t=[];return i.forEach((e=>{he(e,a,n),Se(e,t,n)})),{urlPreview:t.length>0?t[0]:null,embeddedLinks:a}}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},he=(e,n,i)=>{const{url:a,fileShareUrlMeta:t,title:r,description:l}=e,o=(0,I.Jf)(a,i);t&&n.push({objectUrl:o,title:r,description:l,fileShareUrlMeta:t})},Se=(e,n,i)=>{const{url:a,preview:t,previewenabled:r}=e,{previewurl:l,previewmeta:o,title:s,description:d}=t||{},c=(0,I.Jf)(a,i);n.push({url:c,thumbnail:(0,I.Jf)(l,i),title:s,description:d,previewEnabled:r,thumbnailMeta:o?{width:o.width,height:o.height}:null})},Te=(e,n,i,a)=>{let t=a&&a.policyViolation;const r=a&&a.genericStreamMetadata;if(!t&&!r)return null;const l={};if("string"==typeof t)try{t=JSON.parse(t)}catch(i){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${n}. Error: ${i}`)}t&&(l.policyViolation=t);let o=r&&r.policyTip;if("string"==typeof r)try{o=JSON.parse(r).policyTip}catch(i){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${n}. Error: ${i}`)}if(o){const e=a&&a.subject;l.dlpData={id:n,content:i,policyTip:o,subject:e}}return l},Me=e=>{if(!e.scheduledmeetinginfo||(0,S.isNil)(e.scheduledmeetinginfo.eventType))return null;const{iCalUid:n,...i}=e.scheduledmeetinginfo;return{iCalUID:n,...i}},ye=e=>{const{iCalUID:n,...i}=e;return{scheduledmeetinginfo:{...i,iCalUid:n}}},Ae=e=>{const{itemId:n,meetingTitle:i,meetingActionType:a,scheduledMeetingInfo:t,...r}=e,l={...r,...ye(t),itemid:n,meetingtitle:i,"@type":a};return JSON.stringify(l)},be=(e,n)=>{if(!n||!n.meeting)return null;try{const e=JSON.parse(n.meeting),{organizerId:i,tenantId:a,meetingJoinUrl:t,location:r,itemid:l,meetingtitle:o,rsvpTo:s,body:c}=e;return(0,F.fy)({meetingActionType:e[d.rF.MeetingType],organizerId:i,tenantId:a,meetingJoinUrl:t,location:r,itemId:l,meetingTitle:o,rsvpTo:s,body:c,scheduledMeetingInfo:Me(e)})}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${n}`),null}},Fe=(e,n,i,a)=>{const t=n||i;if(t)return t;if(a&&te.has(e)){const e=a.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},Ce=(e,n)=>"-1"===e?n:e,De=(0,o.A)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),Ue=(e,n)=>{if(e.length<=1)return e;const i=De(n),a=[...e];return a.sort(((e,n)=>i.compare(e.displayName||"",n.displayName||""))),a},Ee=(e,n,i)=>{const a=Ue(e,i),t=[],r=[];return(0,S.forEach)(a,(e=>{const{id:i,displayName:a}=e;if(i!==n&&!b.af.isTFLOffNetworkUser(i)&&a){if(r.push(a),20===r.length)return!1;t.length<3&&t.push(e)}return!0})),{membersLimited:t,memberDisplayNamesLimited:r}},we=(e,n,i,a,t,l,o,d,c,m)=>{if(!e?.id)return;const u=Oe(e,n,a,t,i,!!l),{id:p,messagetype:k,properties:g,callId:N,skypeguid:v,composetime:I,content:f,contentHash:h,conversationid:S,crossPostData:M}=e,y=(0,U.UM)(n,g?.languageStamp,o?.targetLanguageCode,f,c),A=(0,U.qt)(o,y,u.translatedContent,u.translationStatus),b=O(g),F=(0,U.rl)(p,y?.code,d);return{...u,__typename:"Message",__model:e,contentHash:h,interopDeliveryState:Ni(g?.deliveryState),smsDeliveryReports:g&&g.smsDeliveryReports?g.smsDeliveryReports:null,announcement:_e(g),notification:ui(n,g),notifications:gi(n,g),meeting:be(n,g),onBehalfOf:ke(g,p,n),callId:Fe(k,N,v||g&&g.skypeguid,f),callLog:g&&(0,T.jC)({skypeMessage:e,loggerFactory:n}),skypeguid:v,composeTime:I,isCallStartedMessage:(0,r.dG)(f,k),replyPermission:g?.replyPermission??null,atpSharepointData:ge(n,g),isDeletedByAdmin:g?.adminDelete||!1,suggestedActions:Le(n,g),forwardedMessageContext:Ge(g,f),conversationId:S,vivaTopicsAnnotations:b,crossPostStatus:M?(0,E.lu)(M.status):void 0,crossPostFailedChannels:M?.failedChannels,isWrittenInPreferredLanguage:!A,languageSeenBefore:F,sourceLanguageCode:y?.code??null,repliesSummary:m,parentMessageId:(0,s.gB)(e.conversationLink,u.id||"")}},Le=(e,n)=>n&&n.suggestedActions?new X(e).parse(n.suggestedActions):null,Oe=({id:e,content:n,originalarrivaltime:i,from:a,messagetype:t,annotationsSummary:r,userHasStarred:l,properties:o,clientmessageid:d,version:m,prioritizeimdisplayname:u,imdisplayname:p,translation:k,conversationid:g,conversationLink:N,sendPipelineStatus:v,draftDetails:I},f,h,S,T,y=!1)=>{let A=n;h&&(A=h);const b=(0,x.LA)(f,o,S),F=(0,U.eQ)(k),D="Done"===F?.translationStatus?(0,C.yT)()[0].toString():m,E=(0,U.UM)(f,o?.languageStamp),w=(0,s.A$)(I);return{id:Ce(e,d),content:A,originalArrivalTime:i,from:ae(a),messageType:(0,c.h)(f,t,o),isImportant:(0,M.IA)(o?.importance),importance:(0,M.mJ)(o?.importance),emotionsSummary:ue(r),emotions:me(o,r,y),mentions:pe(o,e,f),cards:b,files:(0,x.Fx)(f,o),deeplinks:ve(f,o,e,g||N),...fe(o,f),deleteTime:o?.deletetime,editTime:o?.edittime,scheduledSendTime:w?new Date(w).toISOString():null,draftId:o?.draftId||(w?e:null),version:D,userHasSaved:l,renamedDisplayName:u?p:null,imDisplayName:p,clientMessageId:d,dlpContext:Te(f,e,n,o),atpSharepointData:ge(f,o),status:T||"Delivered",hardDeleteReason:o?.hardDeleteReason,hardDeleteTime:o?.hardDeleteTime,onBehalfOf:ke(o,e,f),sourceLanguageCode:E?.code??null,...F,sendPipelineStatus:v}},xe=({content:e,contentHash:n,id:i,messageType:a,originalArrivalTime:t,type:r,version:l})=>({__typename:"Message",__model:null,content:e,contentHash:n,id:i,messageType:a,originalArrivalTime:new Date(t).toISOString(),type:r,version:l});function Pe(e,n){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:n,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,mentions:null,status:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,userHasSaved:null,isSystemMessage:!1,canShowEveryoneMentionBadge:!1}}function Ve(e,n){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:n,timeStamp:n,clientMessageId:(0,A.sN)()}}const je=()=>({members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null,hasGuestUser:!1,isImpersonation:!1});function Be(e){const n=new Date,i=n.toISOString(),a=n.getTime().toString();return{...je(),__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:"Chat",type:"Chat",lastMessage:Pe(a,i),consumptionHorizon:Ve(e,i),addedBy:null,addedByTenantId:null,sensitivityLabel:null}}const ze=(e,n,i,a=!1)=>{const{annotationsSummary:t,id:r,from:l,messageType:o,properties:s,version:d,...m}=e;if(!r)return null;try{const e=O(s);return{__typename:"Message",__model:null,id:r,from:l,messageType:(0,c.h)(i,o,s),version:(0,S.isNumber)(d)?d.toString():void 0,isImportant:(0,M.IA)(s&&s.importance),importance:(0,M.mJ)(s&&s.importance),interopDeliveryState:Ni(s?.deliveryState),smsDeliveryReports:s?.smsDeliveryReports||null,emotions:me(s,t,a),emotionsSummary:ue(t),announcement:_e(s),mentions:pe(s,r,i),onBehalfOf:ke(s,r,i),cards:(0,x.LA)(i,s),files:(0,x.Fx)(i,s),deeplinks:ve(i,s,r,n),...fe(s,i),deleteTime:s&&s.deletetime,editTime:s&&s.edittime,isDeletedByAdmin:s&&s.adminDelete,scheduledSendTime:s?.sendAt||null,draftId:s?.draftId||null,forwardedMessageContext:Ge(s,m.content||""),hardDeleteTime:s&&s.hardDeleteTime,hardDeleteReason:s&&s.hardDeleteReason,suggestedActions:Le(i,s),status:"Delivered",dlpContext:Te(i,r,m.content,s),meeting:be(i,s),callId:s&&s.skypeguid,callLog:s&&(0,T.jC)({skypeMessage:{properties:s,id:r,conversationid:n,messagetype:o,content:m.content,originalarrivaltime:m.originalArrivalTime},loggerFactory:i}),sourceLanguageCode:(0,U.UM)(i,s?.languageStamp)?.code??null,vivaTopicsAnnotations:e,...m}}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{__model:null,id:r,from:l,messageType:(0,c.h)(i,o,s),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null,...m}}},Re=({originalArrivalTime:e,timeStamp:n,clientMessageId:i})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(n).toISOString(),clientMessageId:i}),Qe=(e,n,i,a)=>We({id:e,properties:{[d.H0.ConsumptionHorizon]:(0,m.cc)(a)},threadProperties:i,type:n}),We=e=>({id:e.id,...Re((0,m.Yg)(e))}),Ye=e=>({id:e.id,...Re((0,m.qb)(e))}),Ge=(e,n)=>{if(!e||!e.originalMessageContext)return null;const i=n.indexOf(u.Du.ForwardedContentStart),a=n.lastIndexOf(u.Du.ForwardedContentEnd),t=n.slice(i,a+u.Du.ForwardedContentEnd.length),r="string"==typeof e.originalMessageContext?JSON.parse(e.originalMessageContext):e.originalMessageContext,l={fluid:t.includes("http://schema.skype.com/FluidEmbedCard")||t.includes("http://schema.skype.com/FluidEmbedLink")||t.includes("http://schema.skype.com/FluidLink")};return{originalSenderMri:r.originalSender,originalArrivalTime:r.originalSentTime,originalMessageId:r.messageId,originalMessageContent:t,originalThreadId:r.originalThreadId,originalChannelPostSubject:e?.subject,originalMessageContains:l}},_e=e=>{const n={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e?.cards)return n;const i="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!i||0===i.length)return n;const a=i.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!a)return n;const t=Ze(a);return{title:e.title?e.title:"",originalImageUrl:t.originalImageUrl,croppedImageUrl:t.croppedImageUrl,colorTheme:t.colorTheme,croppedImageHeight:t.croppedImageHeight,croppedImageWidth:t.croppedImageWidth,croppedImageAltText:t.croppedImageAltText,isTeamsIllustration:t.isTeamsIllustration}},Ze=e=>{let n=(0,S.get)(e,"content.imageData.origImage.src",null),i=(0,S.get)(e,"content.imageData.croppedImage.src",null);const a=(0,S.get)(e,"content.imageData.croppedImage.imageHeight",null),t=(0,S.get)(e,"content.imageData.croppedImage.imageWidth",null),r=(0,S.get)(e,"content.imageData.croppedImage.imageAltText",null),l=(0,S.get)(e,"content.imageData.isTeamsIllustration",null);let o=(0,S.get)(e,"content.imageData.colorTheme",null)||(0,S.get)(e,"content.colorTheme",null);return n=void 0===n?null:n,i=void 0===i?null:i,o=void 0===o?null:o,{originalImageUrl:n,croppedImageUrl:i,croppedImageHeight:a,croppedImageWidth:t,croppedImageAltText:r,colorTheme:o,isTeamsIllustration:l}},He=(e,n,i)=>{try{const i=Je(n),a=i?.map((n=>({activityReplyToId:n.replyToId,activityTimestamp:n.timestamp,convId:e,suggestedReplies:n.suggestedActions.actions.filter((e=>e?.channelData?.id&&e?.channelData?.utcTime)).map((e=>{const i={targetMessageId:e?.channelData?.targetMessageId||n.replyToId,type:e?.channelData?.type||"reply"};return{suggestionChannelData:{...e?.channelData,...i},value:e.value||e.title,title:e.title,whisperId:n.id}}))})));return a&&0!==a.length?{suggestedRepliesCollections:a}:null}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},Je=e=>{const n=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>e?.type===d.jQ&&e?.from?.id===d.OD&&e?.timestamp&&e?.suggestedActions?.actions?.some((e=>e.type===d.m8||e.type===d.Wg))));return n&&0!==n.length?n:null},Xe=(e,n,i)=>{const a=n&&n[d.H0.SmartReplies];return a&&"string"==typeof a?((e,n,i)=>{try{const a=JSON.parse(n);return He(e,a,i)}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,a,i):null},qe=e=>{switch(e){case p.Wf.None:return"Unknown";case p.Wf.Adhoc:return"Adhoc";case p.Wf.Scheduled:return"Scheduled";case p.Wf.Recurring:return"Recurring";case p.Wf.Broadcast:return"Broadcast";case p.Wf.MeetNow:return"MeetNow"}},Ke=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function $e(e,n){if(!e||!n)return!1;return(0,k.CF)(e,n)>0}function en(e,n,i,a,t,r=!1,l=!1,o,d,c=!1){const m=(0,x.vu)(e,i),u=e.find((({id:e})=>e===n))||null,p=Jn(e),k=(0,s.Yo)(e,t,[],o).members||[];return{memberIds:k.map((({id:e})=>e)),...Ee(k,n,a),...un(m),...Sn(n,k),me:u,isUserMember:!!u,tflOffNetworkUser:(0,S.first)(p),tflOffNetworkUserLength:p.length,hasBotMember:k.some((({id:e})=>(0,s.Iz)(e))),hasFederatedUser:!!m.length||r,hasTflConsumerUser:Nn(k)||l,hasEnterpriseUser:hn(k),hasUnknownEnterpriseUser:fn(k),hasUnknownConsumerUser:In(k),hasUnresolvedFederatedUser:m.some(b.af.isUnknownUser),hasTflSmsUnverifiedUser:gn(k),hasTflSmsVerifiedUser:vn(k),isRetentionHorizonSet:$e(d,o),hasExtendedDirectoryUsers:Ti(k),pendingBots:Ci(d),hasGuestUser:c}}function nn(e,n,i){if(e&&!(0,S.isEmpty)(e))return An(we(e,n,void 0,void 0,void 0,i))}const an=e=>"string"==typeof e?"true"===e.toLowerCase():e,tn=e=>{const n=Object.keys(e??{}).filter((e=>e.includes(d.iy.Liveness))).map((n=>({key:n,value:String(e[n])})));return(0,S.isEmpty)(n)?null:n};function rn(e,n,i,t,r,l,o,c,m){const{id:u,lastMessage:v}=e,I=!!i?.get(a.w.Messaging).expandedReactionsConfigs?.chat?.enableSend,f=!!i?.get(a.w.Chat).enableBlockOneOnOneChatTopic,h=nn(v,t,I),T=l?.id||"",M=!!(0,k.CN)(e),y=(0,E.s6)(e),A=(0,E.nH)(e),b=((e,n,i,t,r,l,o)=>{const{id:d,lastMessage:c}=e,m=nn(c,t,!!i?.get(a.w.Messaging).expandedReactionsConfigs?.chat?.enableSend),u=l?.id||"",p=ni(d);if(!m)return null;let k=c?.preview??"";if("string"!=typeof k&&!k){const a=(0,S.keyBy)(n,"id");i&&o&&(k=G({conversation:e,profilesMap:a,coreSettings:i,i18n:o,loggerFactory:t,currentUserMri:u,currentUserTenantId:r??"",addSenderName:!0}))}const g=function(e,n){return!!e?.mentions?.some((e=>e.userId===n))}(m,u),N=!!i&&(0,D.Mr)(e,i)&&!!c&&(0,s.e6)(c);return{...m,preview:k,clientMessageId:p?Date.now().toString():m?.clientMessageId,originalArrivalTime:p?e.clientArrivalTime:m?.originalArrivalTime,isSystemMessage:(v=m,!!v&&(v.messageType&&(0,s.bf)(v.messageType)||function(e){return!!e.deleteTime}(v))||N),hasMention:g,canShowEveryoneMentionBadge:w(m||void 0,u)&&!g};var v})(e,n,i,t,r,l,c),F=en(n,T,r,o,e.threadProperties,e.usersProps?.hasFederatedUser,e.usersProps?.hasConsumerUser,i,e,e.usersProps?.hasGuestUser),C=function(e,n,i,a,t){const{id:r,properties:l,threadProperties:o,lastL2MessageIdNotFromSelf:s}=n,c=Ye(n);return{lastL2MessageIdNotFromSelf:bn(s),chatSubType:Ln(o.threadType),chatType:xn(o.threadType),consumptionHorizon:We(n),consumptionHorizonBookmark:c,quickReplyAugmentation:Xe(r,l,i),creator:o[d.iy.Creator],importState:yn(o[d.iy.ImportState]),isDisabled:Yn(o.isDisabled),disabledReason:Mn(o.disabledReason),isLastMessageFromMe:o.isLastMessageFromMe,meetingInformation:Ln(o.threadType)===p.vW.Channel?void 0:Zn(r,o[d.iy.Meeting]),sensitivityLabel:o[d.iy.SensitivityLabelId]?{id:o[d.iy.SensitivityLabelId],isCopyBlocked:o[d.iy.SensitivityLabelIsCopyBlocked]}:void 0,tenantId:o[d.iy.TenantId],title:e?void 0:"backroom"===o.meetingChatType&&t?o.topic?.concat(t.stringTranslate("messaging","chat_header_backroom_chat")):o.topic,userConsumptionHorizon:c,interopConversationStatus:Vn(l[d.H0.InteropConversationStatus]),gapDetectionEnabled:an(o.gapDetectionEnabled),cfet:kn(o.cfet),consumerGroupId:o[d.iy.ConsumerGroupId],guardianChatInfo:o[d.iy.GuardianChatInfo],groupTemplate:si(o[d.iy.GroupTemplate]),themeId:o[d.iy.ThemeId],picture:o[d.iy.Picture],addedBy:l?.addedBy||null,addedByTenantId:l?.addedByTenantId||null,meetingChatPolicy:Bn(o[d.iy.MeetingChatPolicy]),chatScheduleSuggestionSuppressUntil:l?.chatScheduleSuggestionSuppressUntil,isCommentStream:(0,g._5)(o,a,n.id),createdAt:o[d.iy.CreatedAt],lastJoinAt:o[d.iy.LastJoinAt],commentStreamPolicy:Bn(o.liveChatPolicy),meetingChatType:Rn(o?.meetingChatType)}}(f&&M&&0===F.tflOffNetworkUserLength&&!F.hasTflSmsUnverifiedUser&&!F.hasTflSmsVerifiedUser,e,t,i,c),U=(0,k.OA)(e.properties),L=ln(e,U,i),O=(0,k.vz)(e,i).toString(),x=(0,k.Nb)(e),{enableForwardMessageUnreadMarkers:P,disableGroupCopilotChatHistoryCheck:V,disableGroupCopilotMeetingChatHistoryCheck:j,groupCopilotMeetingChatHistoryAccessTimeThresholdMs:B}=i?.get(a.w.Messaging)??{enableForwardMessageUnreadMarkers:!1,disableGroupCopilotMeetingChatHistoryCheck:!1},z=C.lastL2MessageIdNotFromSelf??null,R=(0,s.Qi)(u),Q=(0,k.ZV)(e,T),W=on(!!V,Q,R,!!j,B,C.createdAt);return{...e,...F,...C,...dn(e.memberProperties),lastL2MessageIdNotFromSelf:z,shortTitle:e.chatTitle?.shortTitle,longTitle:e.chatTitle?.longTitle,id:u,isRead:Ii(e,l?.id||"",P??!1),isMuted:(0,k.ME)(e,m,i,T),oneOnOneChatHeaderCallButtonValue:m?.mruChatHeaderCallOption,isHidden:R?(0,N.go)(L,h?.originalArrivalTime,O,U,i):(0,N.gw)(L,h?.originalArrivalTime,O),isOneOnOne:M,isOneOnOneBotChat:M&&F.hasBotMember,isBotBlocked:sn(e.threadProperties?.messagingdisabled),isModerator:A,isFederated:(0,s.oZ)(u),isMeeting:R,isSfB:(0,g.t0)(u),isChannel:(0,k.IV)(e),lastMessage:b,awarenessLiveState:tn(e.threadProperties),members:[],clearHistoryTime:O,chatHistoryHiddenTime:L,type:null,...Hn(e.threadProperties.pinnedItems),quarantineCounter:x,replyPermission:y||null,canCurrentUserAccessFullChatHistory:W}}const ln=(e,n,i)=>{const t=e.properties?.unpinnedTime;return t||!i?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications?t?.toString():"Declined"===n?Date.now().toString():null},on=(e,n,i,a,t,r)=>{if(e)return!0;if((0,S.isNil)(n)||!isNaN(Number(n))&&0===Number(n))return!0;if(i){if(a)return!0;if(!(0,S.isNil)(t)&&!isNaN(Number(t))&&!isNaN(Number(r))&&Number(r)>0){return n-Number(r)<=t}}return!1},sn=e=>"string"==typeof e?"true"===e.toLowerCase():Boolean(e),dn=e=>{const n=e?.[d.UO.RelationshipState];return{extendedDirectoryRedemptionRequired:n?.edRedemptionRequired}},cn=(e,n)=>(0,S.map)(n,(n=>e[n.id]||function(e){return(0,y.qK)({...e,mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName,role:e.role??""})}(n))),mn=(e,n,i,a,t,r,l,o,s)=>{try{const d=`${r?.id}`,c=pi(e.id,[...e.members||[]],d)?[{id:d}]:e.members;return rn(e,cn(n,c),i,a,t,r,l,o,s)}catch(n){return a.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${n}`),{...e,lastL2MessageIdNotFromSelf:null,id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null,lastMessage:null}}},un=e=>{const n=e.filter((e=>!b.af.isUnknownUser(e)&&e.featureSettings?.coExistenceMode!==l.bi.TeamsOnly&&!!e.displayName));return{nonTeamsFederatedUserLimitedNames:n.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:n.length}},pn=(e,n,i)=>{const a=e.threadProperties.tenantid,t=(0,f.j)(e.threadProperties.meeting).meetingJoinUrl??"",r=(0,k.Nb)(e);try{const i=cn(n,e.members);return((e,n,i,a,t)=>({id:e,members:n,tenantId:i,meetingJoinUrl:a,quarantineCounter:t}))(e.id,i,a,t,r)}catch(n){return i.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${n}`),{id:e.id,members:[],...a&&{tenantId:a},...t&&{meetingJoinUrl:t}}}},kn=e=>"string"==typeof e?"true"===e?.toLowerCase():!!e,gn=e=>e.some((({id:e})=>(0,s.gZ)(e))),Nn=e=>e.some((e=>b.af.isTFLConsumerUser(e))),vn=e=>e.some((e=>b.af.isTFLSmsVerifiedMri(e?.id))),In=e=>e.some((e=>(0,s.W4)(e.id)&&b.af.isUnknownUser(e))),fn=e=>e.some((e=>b.af.isEnterpriseUserMri(e.id)&&b.af.isUnknownUser(e))),hn=e=>e.some((e=>b.af.isEnterpriseUserMri(e.id))),Sn=(e,n)=>{let i=!0;const a=n&&n.some((n=>{if(!n.isFederated&&!(0,s.oG)(n.id,d.LE)&&n.id!==e&&n.featureSettings){const e=n.featureSettings.isPrivateChatEnabled;return null==e?(i=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:i,isChatDisabledForRecipients:a}},Tn={opted_out:"OptedOut",claimed:"Claimed",deprovisioned:"Deprovisioned"},Mn=e=>{if(!e)return;const n=(0,f.j)(e);return{newlyCreatedUserId:n.userId,code:Tn[n.code]}},yn=e=>{if(e)return(0,h.K)()("Importing","Completed").find((n=>n===e))},An=e=>({...e,preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__typename:"LastMessage"}),bn=e=>e?`${e}`:null,Fn=({id:e,members:n,consumptionHorizon:i,userConsumptionHorizon:a,lastMessage:t,creator:r,meetingInformation:l,isDisabled:o,disabledReason:s,importState:c,isMuted:m,isLastMessageFromMe:u,isRead:p,isOneOnOne:k,isOneOnOneBotChat:g,isSticky:N,isExternal:v,consumerGroupId:I,templateType:f,chatType:h,historyHiddenTime:T,createdAt:M,interopConversationStatus:A,quickReplyAugmentation:b,meetingPolicy:F,addedBy:C,addedByTenantId:D,sensitivityLabel:U,meetingChatType:E,lastL2MessageIdNFS:w,...L},O,x,P,V)=>{try{const T=(0,S.map)(n,(e=>(0,y.qK)(e))),M=t&&An(ze(t,e,O)),j=l&&{id:e,subject:l.subject,startTime:l.startTime,scenario:l.scenario,endTime:l.endTime,iCalUid:l.iCalUid,location:l.location,exchangeId:l.exchangeId,meetingType:l.meetingType?qe(l.meetingType):"Unknown",resolvedSensitivityLabelId:l.resolvedSensitivityLabelId,isCopyRestrictionEnforced:l.isCopyRestrictionEnforced,templateDetails:l.templateDetails,meetingJoinUrl:l.meetingJoinUrl,messagingPolicy:l.messagingPolicy},B=!(!k&&!N&&f!==d.iy.ImmutableRoster),z=U&&U.id?{id:U.id,isCopyBlocked:U.protectTeamsLabelAction?.isCopyRestrictionEnforced||!1}:void 0,R=bn(w);return{__typename:"Conversation",...en(T,P?.id||"",x,V),...L,id:e,consumptionHorizon:i&&{__typename:"ConsumptionHorizon",...Qe(e,d.Cr.Chat,{lastjoinat:L.lastJoinAt},i)},consumptionHorizonBookmark:a&&{__typename:"ConsumptionHorizonBookmark",...Qe(e,d.Cr.Chat,{lastjoinat:L.lastJoinAt},a)},userConsumptionHorizon:a&&{__typename:"ConsumptionHorizonBookmark",...Qe(e,d.Cr.Chat,{lastjoinat:L.lastJoinAt},a)},lastL2MessageIdNotFromSelf:R,lastMessage:M,members:[],creator:r,meetingInformation:j,isDisabled:!!o,disabledReason:Mn(s),importState:yn(c),isMuted:m,isLastMessageFromMe:!!u,isRead:p,isOneOnOne:B,cfet:v,consumerGroupId:I,isOneOnOneBotChat:!!g,chatType:xn(h),interopConversationStatus:Vn(A),quickReplyAugmentation:b&&He(e,b,O),addedBy:C,addedByTenantId:D,meetingChatPolicy:Bn(F),sensitivityLabel:z,meetingChatType:Rn(E)}}catch(n){O.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${n}`);return{...L,id:e,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:T,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null}}},Cn=({id:e,members:n,tenantId:i,meetingInformation:a},t)=>{try{const t=(0,S.map)(n,(e=>(0,y.qK)(e)));return{__typename:"ConversationMembers",id:e,tenantId:i=i??"",meetingJoinUrl:a?.meetingJoinUrl??"",members:t}}catch(n){t.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${n}`);return{id:e,members:[]}}},Dn=(e,n,i,a,t)=>({node:Fn(e,n,i,a,t),cursor:e.createdAt||e.id}),Un=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function En(e){return JSON.stringify((0,S.map)(e,(e=>{const n=e.mentionType,i=e.displayName;return{"@type":ee,itemid:e.itemId,mri:e.userId,mentionType:n,displayName:i}})))}function wn(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const n=e.mentionType,i=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:n,displayName:i}})))}const Ln=e=>{if(e)return"space"===e||"topic"===e?p.vW.Channel:"meeting"===e?p.vW.Meeting:p.vW.None},On=new Map([["chat","Chat"],["phonechat","PhoneChat"],["phonelink1on1chat","Phonelink1on1Chat"],["phonelinkgroupchat","PhonelinkGroupChat"],["meeting","Meeting"],["sfbinteropchat","SfBInteropChat"]]),xn=e=>{let n=null;return null==e||(n=On.get(e),void 0===n&&(n=null)),n},Pn=new Map([["AcceptPending","AcceptPending"],["ExtendedDirectoryAcceptPending","ExtendedDirectoryAcceptPending"],["Accepted","Accepted"],["Blocked","Blocked"],["Quarantined","Quarantined"]]),Vn=e=>e&&Pn.get(e)||null,jn=new Map([["ChatEnabled","ChatEnabled"],["ChatDisabled","ChatDisabled"],["InMeeting","InMeeting"],["ChatEnabledAnonymousDisabled","ChatEnabledAnonymousDisabled"],["InMeetingAnonymousDisabled","InMeetingAnonymousDisabled"]]),Bn=e=>e&&jn.get(e)||null,zn=new Map([["backroom","Backroom"]]),Rn=e=>e&&zn.get(e)||null,Qn=e=>!!e&&"PhoneChat"===e,Wn=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},Yn=e=>(0,S.isString)(e)?"true"===e.toLowerCase():e||!1,Gn=({id:e,conversationid:n,imdisplayname:i,from:a,composetime:t},r)=>e&&{"@type":$,mri:ae(a),imdisplayname:i,messageId:e,parentMessageId:r??e,threadId:n,isUnresolvedEmailUser:!1,originalComposeTime:t},_n=(e,n,i)=>{const a=i.find((i=>{try{const a=JSON.parse((i.properties||{}).starred),t=a&&a["@type"]===$&&a.threadId===n?a.messageId:void 0;return e===t}catch(e){return!1}}));return a&&a.id},Zn=(e,n)=>{if(!n)return;const i=JSON.parse(n);return Object.keys(n).length?{id:e,...i,meetingJoinUrl:i.meetingJoinUrl||i.meetingJoinURL,meetingType:i.meetingType?qe(p.Wf[i.meetingType]):"Unknown"}:void 0},Hn=e=>{if(e)try{const n=JSON.parse(e);return{pinnedConversationItems:n.reduce(((e,n)=>("Message"===n.itemType&&e.push({__typename:"Message",__model:null,id:n.itemId}),e)),[])}}catch{return}},Jn=e=>e.filter((({id:e})=>b.af.isTFLOffNetworkUser(e))),Xn=(e,n,i)=>{const a=me(i.properties);return!!a&&a.some((i=>i.key===e&&!!i.users&&i.users.some((e=>e.id===n))))},qn=e=>{let n;switch(e){case u.rI.Error:n="Error";break;case u.rI.Sending:n="Sending";break;case u.rI.Retrying:n="Retrying";break;default:n="Delivered"}return n},Kn=async({resourceType:e,resource:n},i,a)=>{if("ThreadUpdate"===e)try{const{id:e="",members:a}=n,t=a?await i(a,e):[];return{__typename:"ConversationMembers",id:e,members:t}}catch(e){a.newLogger("toChatMembersEvent","data-resolvers-common").error(`Failed getting thread members: ${e}`)}},$n=e=>(0,g.t0)(e)||(0,s.oZ)(e)||(0,k.xl)(e),ei=(e,n)=>(0,S.filter)(e,(0,S.omit)(n,"__typename")),ni=e=>!!e&&-1!==e.indexOf(le),ii=e=>!!e?.startsWith("tfl:preview-"),ai=e=>!!e&&(-1!==e.indexOf(d.iB)||-1!==e.indexOf(d.hd)),ti=e=>e===oe,ri=e=>ti(e)||ni(e),li=e=>(0,g.t0)(e)&&ri(e),oi=e=>{switch(e){case re.FAMILY:case re.FRIENDS:case re.PROJECT:case re.WORKPLACE:case re.TRIP_PLANNING:case re.GET_TOGETHER:case re.LOCAL_COMMUNITY:case re.HOLIDAY_PLANNING:return!0}return!1},si=e=>{const n=e&&(0,f.j)(e).id;return oi(n)?n:void 0},di=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),ci=e=>!!e&&e.includes("meeting"),mi=(e,n,i,a,r,l,o,s)=>{if(!e)return;const d="Phonelink1on1Chat"===n,c="PhonelinkGroupChat"===n,m=i?t.bF.Meeting:a?r?t.bF.Botchat:Qn(n)?t.bF.SMSOneOnOneChat:(0,k.xl)(e)?t.bF.SfcInteropChat:(0,g.t0)(e)?t.bF.SfbInteropChat:l?t.bF.NativeFederatedChat:o?t.bF.FederatedChat:(0,k.qL)(e)&&d?t.bF.Phonelink1on1Chat:t.bF.OneOnOneChat:(0,k.L5)(e)?t.bF.StreamOfNotes:(0,k.qL)(e)&&c?t.bF.PhonelinkGroupChat:(e=>!!e&&e===p.vW.Channel)(s)?t.bF.Channel:t.bF.GroupChat;return m},ui=(e,n)=>{if(!n||!n.notification)return null;try{const e=n.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in chat message notification transformation: ${n}`),null}},pi=(e,n,i)=>i&&(0,k.L5)(e)&&(!n||0===n.length),ki=e=>{if((0,S.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,S.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},gi=(e,n)=>{if(!n||!n.notifications)return null;try{const e="string"==typeof n.notifications?JSON.parse(n.notifications):n.notifications;return e&&e.map((({surface:e,contentType:n,content:i})=>({surface:e,contentType:n,content:{value:{height:ki(i.value?.height)??void 0,width:ki(i.value?.width)??void 0,title:i.value?.title??"",url:i.value?.url??""},actions:i.actions??[]}})))}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${n}`),null}};function Ni(e){if(e)return"string"==typeof e?e:e.state}const vi=(e,n,i)=>{const t=i.get(a.w.Messaging).commCopilotSummarizationRequestConfig;return t?{gptVersion:t.gptVersion,summaryMode:t.summaryMode,input:{type:t.threadType,id:e,lookbackperiod:n},promptSetting:{temperature:"1.0"}}:null},Ii=(e,n,i=!1)=>(0,S.isEmpty)(e.lastMessage)&&(0,k.Z9)(e)||(0,m.Pr)(e,n,i),fi=e=>e.chatSubType===p.vW.Channel,hi=e=>{if(fi(e)){const n=e.threadProperties?.[d.iy.SpaceTypes],i=n?parseInt(n,10):0;return!!!e.threadProperties?.[d.iy.SubstrateGroupId]&&i!==p.QU.Private}return!1};function Si(e,n,i){if(!e.members)return!1;const a=e.members.find((e=>e.id!==i));return!!a&&(e.source===u.To.PutConversationLie&&2===e.members.length&&!!n[a.id])}const Ti=e=>e.some((e=>b.af.isExtendedDirectoryUser(e))),Mi=(e,n)=>{if(Ii(e,n.currentUserMri)||!e.lastMessage)return!1;const i=e.lastMessage.properties,a=pe(i,e.lastMessage.id,n.loggerFactory),t=a?.some((({mentionType:e})=>"everyone"===e)),r=e.lastMessage.from&&!e.lastMessage.from.includes(n.currentUserMri);return!(!t||!r)},yi=(e,n)=>{if(Ii(e,n.currentUserMri))return!1;const i=e.lastMessage?.properties,a=i?.importance;return!(!a||!(0,M.IA)(a))},Ai=(e,n)=>{if(Ii(e,n.currentUserMri))return!1;const i=e.lastMessage?.properties,a=i?.importance;return!(!a||!(0,M.fH)(a))},bi=(e,n)=>{if(Ii(e,n.currentUserMri)||!e.lastMessage)return!1;const i=e.lastMessage.properties,a=pe(i,e.lastMessage.id,n.loggerFactory);return!!(a&&a.length>0&&a.some((e=>e.userId===n.currentUserMri)))},Fi=(e,n)=>{if(Ii(e,n.currentUserMri)||!e.lastMessage)return 0;const i=e.lastMessage.properties,a=pe(i,e.lastMessage.id,n.loggerFactory);let t=0;return a&&a.forEach((e=>{e.userId===n.currentUserMri&&t++})),t},Ci=e=>{if(e&&ni(e.id)){const n=e.properties.pendingBotMembers;if(n){return(0,f.j)(n)}}},Di=e=>{const n=e.split(";");return{conversationId:n[0],replyChainId:n.find((e=>e.startsWith("replyChainId=")))?.split("=")[1]||null,messageId:n.find((e=>e.startsWith("messageId=")))?.split("=")[1]||null}},Ui=(e,n)=>{const i=n.loggerFactory.newLogger("Chat Helper","data-resolvers-common"),a=(0,q.re)(e,i);if(a&&a.hasActiveCall){const e=a?.metadata?.[0]?.conversationType;if(e===d._M.AdHocMeeting||e===d._M.ScheduledMeeting)return!0}return!1},Ei=(e,n)=>{const i=n.loggerFactory.newLogger("Chat Helper","data-resolvers-common"),a=(0,q.re)(e,i);if(a&&a.hasActiveCall){const e=a?.metadata?.[0]?.conversationType;if(e===d._M.HuddleGroupCall)return!0}return!1}},37321:(e,n,i)=>{"use strict";i.d(n,{LA:()=>d,Fx:()=>p,Ib:()=>k,vu:()=>g});var a=i(364819),t=i(84646),r=i(639884),l=i(193406),o=i(199448),s=i(850434);const d=(e,n,i)=>{if(!n||!n.cards||"string"!=typeof n.cards&&!i)return null;try{let e=String(n.cards);i&&(e=i);return JSON.parse(e).map((({appIcon:e,appId:n,appName:i,cardClientId:a,content:t,contentType:r,locale:l,userSpecificContent:o})=>({appIcon:e,appId:n||"",appName:i,cardClientId:a,content:JSON.stringify(t),contentType:r,locale:l,...!!o&&{userSpecificContent:o}})))}catch(n){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}};var c;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(c||(c={}));const m=(e,n)=>{try{const n=JSON.parse(e);if(!n||!n.code)return;const i=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(n.code);return{code:i,type:(e=>{switch(e){case c.Sharepoint:return"Sharepoint";case c.WOPI:return"WOPI";case c.Google:return"Google";case c.OneDrive:return"OneDrive";case c.Recent:return"Recent";case c.Aggregate:return"Aggregate";case c.FileSystem:return"FileSystem";case c.Search:return"Search";case c.AllFiles:return"AllFiles";case c.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}})(parseInt(n.type,10))}}catch(e){return void n.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},u=(e,n)=>{{const i=2,a=["http","https"],{filePreview:t,chicletBreadcrumbs:d,fileInfo:c,anchorFileId:u,progressComplete:p,isUploadError:k,fileChicletState:g,providerData:N}=e,{shareUrl:v,shareId:I,itemId:f}=c,h=t||{},S=g?.serviceName,{id:T,baseUrl:M,objectUrl:y,type:A,title:b,state:F}=((e,n)=>{const{version:i}=e;let{id:a,baseUrl:t,objectUrl:r,type:l,title:d,state:c}=e;if(i!==n&&(({itemid:a,fileName:d,fileType:l,fileInfo:{fileUrl:r,siteUrl:t}}=e),c=e.fileChicletState?.state),"string"!=typeof a)throw(0,o.$5)("ChatHelpers",s.O4.Undefined,"toFiles",{id:a,version:i,type:l},"File id is missing");return{id:a,baseUrl:t,objectUrl:r,type:l,title:d,state:c}})(e,i),C="active"!==F&&"hidden"!==F,D=m(N,n),U=(0,r.K)()("aggregatefiles","customspo","downloads","p2p","personal","recent","teams","teamsSdk"),E=(0,r.K)()("active","deleted","reference","hidden");return{id:T,itemId:f,chicletBreadcrumbs:d,baseUrl:(0,l.Jf)(M,a),objectUrl:(0,l.Jf)(y,a),shareId:I,shareUrl:v,type:A,title:b,fileId:T,isReferencedFile:C,anchorFileId:u,progressComplete:p&&parseInt(p,10)||null,serviceName:S&&U.find((e=>e===S)),state:F&&E.find((e=>e===F)),hasUploadFailed:k,providerDataV2:D,...h}}},p=(e,n)=>{if(!n||!n.files||"string"!=typeof n.files)return null;try{let i=JSON.parse(n.files);i=i.filter((e=>"deeplink"!==e.type));return(0,a.map)(i,(n=>u(n,e)))}catch(e){return null}},k=e=>!!e&&e.includes(t.nu),g=(e,n)=>e.filter((({tenantId:e,isFederated:i})=>i||n&&e&&e!==n))},4718:(e,n,i)=>{"use strict";i.d(n,{V:()=>l,f:()=>o});var a=i(605288),t=i(37321);const r="bfb101ece45946be988be560a74322f2";function l(e,n,i){return o(n,i,e.properties)}function o(e,n,i){const l=(0,t.Fx)(n,i),o=(0,t.LA)(n,i);return l?.length?e.stringTranslate("messaging","chats_messagePreview_sent_a_file"):o?.some((e=>e.contentType===a.s.Audio))?e.stringTranslate("messaging","recent_conversations_sent_an_voice_message"):o?.some((e=>e.cardClientId===r))?e.stringTranslate("messaging","recent_conversations_sent_a_location_message"):o?.some((e=>e.contentType===a.s.FluidEmbed))?e.stringTranslate("messaging","fluid_message_preview"):""}},899607:(e,n,i)=>{"use strict";i.d(n,{v:()=>o,K:()=>s});var a=i(754255),t=i(797922),r=i(84646),l=i(516147);function o(e,n,i,r){const l=e.lastMessage?.content||"",o=r?.get(a.w.Messaging)?.enableGroupChatAudioDropin,d=!(!o||!(0,t.K$)(e)),{copilotAppsIds:c}=r?.get(a.w.Messaging)??{};return s(l,i,n,d,e.lastMessage?.properties||{},c)}function s(e,n,i,a,t,o){const s=!e&&!!t?.forwardTemplateId;switch(n){case r.Go.MediaCard:return e||i.stringTranslate("messaging","chats_messagePreview_sent_a_card");case r.Go.CallLocalRecording:case r.Go.CallRecording:return function(e,n,i){if(i===r.Go.CallRecording&&!/<RecordingContent[^>]*contentTypes="Recording/.test(e))return"";if(/<RecordingStatus[^>]*status="Initial"/.test(e))return n.stringTranslate("messaging","chats_messagePreview_call_recording_ongoing");if(/<RecordingStatus[^>]*status="ChunkFinished"/.test(e))return n.stringTranslate("messaging","chats_messagePreview_call_recording_processing");if(/<RecordingStatus[^>]*status="Success"/.test(e))return i===r.Go.CallRecording?n.stringTranslate("messaging","chats_messagePreview_call_recording"):n.stringTranslate("messaging","chats_messagePreview_call_recording_processing");return""}(e,i,n);case r.Go.AddMember:const t=function(e){const n=new RegExp(`<target>${r.gN.BotPrefix}([^<]*)</target>`),i=e.match(n);return i?i[1]:null}(e);return function(e){const n={initiator:"",targets:[]};return(0,l.r)(e,{initiator:e=>{n.initiator=e.trim()},target:e=>{const i=e.trim();i!==n.initiator&&n.targets.push(i)}}),n.initiator&&0===n.targets?.length}(e)?i.stringTranslate("messaging","chats_messagePreview_user_joined"):t?function(e,n){return!(!e||!n?.some((n=>`${n}`===e)))}(t,o)?i.stringTranslate("messaging","chats_messagePreview_copilot_user_added"):i.stringTranslate("messaging","chats_messagePreview_bot_user_added"):i.stringTranslate("messaging","chats_messagePreview_user_added");case r.Go.CallTranscript:return i.stringTranslate("messaging","chats_messagePreview_call_transcript");case r.Go.Collaborate:return"";case r.Go.Embed:if(!e)return i.stringTranslate("messaging","fluid_message_preview");break;case r.Go.PhonelinkMms:return i.stringTranslate("messaging","chats_messagePreview_phonelink_mms");case r.Go.Call:if(a){if(function(e,n){if(!d(e,n))return!1;const i=-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e);return/<partlist/.test(e)&&!i}(e,n))return i.stringTranslate("messaging","chats_messagePreview_audio_drop_in_call_started");if(function(e,n){if(!d(e,n))return!1;return-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e)}(e,n))return i.stringTranslate("messaging","chats_messagePreview_audio_drop_in_call_ended")}}return/^<img\b[^>]*>$/.test(e)?i.stringTranslate("messaging","chats_messagePreview_sent_an_image"):function(e){return/<video[^>]*>[^<>]*<\/video>/.test(e)}(e)?i.stringTranslate("messaging","chats_messagePreview_sent_an_inline_video"):s?i.stringTranslate("messaging","chats_messagePreview_forwarded_message"):e}function d(e,n){return n===r.Go.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>')}},717828:(e,n,i)=>{"use strict";i.d(n,{Pf:()=>d,sN:()=>c,MM:()=>m});var a=i(364819),t=i(435793),r=i(754255),l=i(199448),o=i(850434),s=i(806658);const d=(e,n,i)=>{let t=[];if((0,a.isEmpty)(e)||(0,a.isEmpty)(n)){const a=`Invalid user ids when generating chat id from members: userId1=${e}, userId2=${n}`;throw i.error(a),(0,l.$5)(a,o.O4.InvalidInput,"chatIdFromMembers")}t=(0,s.Iz)(e)&&!(0,s.Iz)(n)?[(0,s.m9)(n),(0,s.m9)(e)]:!(0,s.Iz)(e)&&(0,s.Iz)(n)?[(0,s.m9)(e),(0,s.m9)(n)]:[(0,s.m9)(e),(0,s.m9)(n)].sort();const r=(0,s.Xb)(e),d=(0,s.Xb)(n);if(r||d){if(r===d)return`19:${r}:${t[0]}_${t[1]}@unq.gbl.spaces`;i.warn(`Both users are in different clouds: ${r} and ${d}. This should be a federated chat, falling back to default chat ID generation.`)}return`19:${t[0]}_${t[1]}@unq.gbl.spaces`};function c(){const[e,n]=(0,t.yT)(2);return`${e}${n}`.substr(0,19)}function m(e){const{ageGroup:n}=e.get(r.w.AgeConsent);return"MinorWithMsaParentalConsent"===n||"MinorWithoutMsaParentalConsent"===n||"MinorNoMsaParentalConsentRequired"===n||"MinorWithoutParentalConsent"===n||"MinorWithParentalConsent"===n||"MinorNoParentalConsentRequired"===n}},114978:(e,n,i)=>{"use strict";i.d(n,{fy:()=>l,V4:()=>o});var a=i(199448),t=i(850434),r=i(364819);const l=e=>{const{scheduledMeetingInfo:n}=e,i=s(n);if(i.length)throw(0,a.$5)(t.Ir.DataLayerClient,t.O4.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${i.join(", ")}`);return e},o=async e=>{if(e){const n=(await i.e(115042).then(i.bind(i,43507)))?.z;return n.object({meetingTitle:n.string().nullish().catch(void 0),meetingActionType:n.string().nullish().catch(void 0),tenantId:n.string().nullish().catch(void 0),organizerId:n.string().nullish().catch(void 0),meetingJoinUrl:n.string().nullish().catch(void 0),location:n.string().nullish().catch(void 0),body:n.string().nullish().catch(void 0),rsvpTo:n.string().nullish().catch(void 0),scheduledMeetingInfo:n.custom().transform((e=>{if(!s(e).length)return e}))}).parse(e)}return e},s=e=>{if(!e)return[];const n="meeting.scheduledMeetingInfo";let i=m(e,["startTime","endTime","eventType"],n);const{eventRecurrenceRange:a,eventRecurrencePattern:t}=e;return i=[...i,...d(a,n),...c(t,n)],i},d=(e,n)=>m(e,["startDate"],`${n}.eventRecurrenceRange`),c=(e,n)=>{let i=[];if(e){const{daily:a,weekly:t,monthly:l,yearly:o,relativeMonthly:s,relativeYearly:d}=e;i=[...m(e,["patternType"],`${n}.eventRecurrencePattern`),...m(a,["interval"],`${n}.eventRecurrencePattern.daily`),...m(t,["interval","daysOfTheWeek"],`${n}.eventRecurrencePattern.weekly`),...m(l,["interval","dayOfMonth"],`${n}.eventRecurrencePattern.monthly`),...m(o,["month","dayOfTheMonth"],`${n}.eventRecurrencePattern.yearly`),...m(s,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${n}.eventRecurrencePattern.relativeMonthly`),...m(d,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${n}.eventRecurrencePattern.relativeYearly`)],t&&t.daysOfTheWeek&&t.daysOfTheWeek.some((e=>(0,r.isNil)(e)))&&i.push(`${n}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return i},m=(e,n,i)=>{const a=[];return(0,r.isNil)(e)||n.forEach((n=>{(0,r.isNil)(e[n])&&a.push(`${i}.${String(n)}`)})),a}},832901:(e,n,i)=>{"use strict";var a,t;i.d(n,{aY:()=>t,IA:()=>r,fH:()=>l,zS:()=>o,mJ:()=>s}),function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(a||(a={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(t||(t={}));const r=e=>"Important"===s(e),l=e=>"Urgent"===s(e),o=e=>t[e]||t.Standard,s=e=>{switch(e){case t.Important:case a.Important:return"Important";case t.Urgent:case a.Urgent:return"Urgent";case t.Standard:case a.Standard:default:return"Standard"}}},840917:(e,n,i)=>{"use strict";i.d(n,{re:()=>l});var a=i(84646),t=i(645095),r=i(668625);const l=(e,n)=>{const i=[];return e&&e.threadProperties&&Object.keys(e.threadProperties).forEach((l=>{if(l.includes(a.iy.Liveness)){const a=(0,r.j)(e.threadProperties[l]);if(!a||1e3*a.expiration<Date.now())a||n.errorToTelemetry?.(`awareness_conversationLiveState threadProperties value for ${e.id} is ${a}`,"channel_active_calls_null_value",void 0,!0);else{if(a.meetingInfo&&a.meetingInfo.meetingType)switch(a.meetingInfo.meetingType){case t.ef.Unknown:a.meetingInfo.meetingType="UNKNOWN";break;case t.ef.Private:a.meetingInfo.meetingType="PRIVATE";break;case t.ef.Channel:a.meetingInfo.meetingType="CHANNEL"}i.push(a)}}})),{hasActiveCall:i.length>0,metadata:i}}},73466:(e,n,i)=>{"use strict";i.d(n,{i2:()=>a,j8:()=>t,Fo:()=>l});const a="suggested-org-group-chat",t="suggested-project-group-chat",r=[a,t];function l(e){return r.includes(e)}},73087:(e,n,i)=>{"use strict";i.d(n,{vV:()=>o,SU:()=>s,Qr:()=>d,UB:()=>c,$U:()=>m});var a=i(645095),t=i(797922),r=i(870785),l=i(364819);const o=e=>{switch(e){case a.nP.Moderate:return"Moderate";case a.nP.NoRestriction:return"NoRestriction";case a.nP.Strict:default:return"Strict"}},s=(e,n,i,a)=>c(n,e.threadProperties.spaceThreadTopic,e.threadProperties.pictureETag,e.threadProperties.groupId,i,a),d=(e,n,i,a,t)=>c(i,e.threadProperties.topicThreadTopic,n?.threadProperties.pictureETag,n?.threadProperties.groupId,a,t),c=(e,n,i,a,t,r)=>{const o=encodeURIComponent(n);return t&&r&&!(0,l.isEmpty)(r)?e+"beta/users/{objectId}/profilepicturev2/teams/{teamGroupId}?etag={etag}&displayName={displayName}&voidCache=true".replace("{objectId}",r).replace("{teamGroupId}",a||"").replace("{etag}",i||"").replace("{displayName}",o):e+"beta/teams/{teamGroupId}/profilepicturev2?etag={etag}&displayName={displayName}&voidCache=true".replace("{teamGroupId}",a||"").replace("{etag}",i||"").replace("{displayName}",o)};function m(e,n,i,a,l){const o=a?"Parent team":"Channel";return(0,t.oy)(e)?{isDiscarded:!0,reasonToDiscard:`${o} is deleted`}:(0,r.f3)(e,n)?{isDiscarded:!0,reasonToDiscard:`${o} is deleted by conversation property`}:(0,t.F$)(e)&&!(0,t.BA)(e)&&i?{isDiscarded:!0,reasonToDiscard:`${o} is archived and not favorite`}:l&&(0,t.F$)(e)?{isDiscarded:!0,reasonToDiscard:`${o} is cross post channel selection and archived`}:a&&!(0,t.Gw)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of the parent team"}:(0,t.Zp)(e)&&!(0,t.Gw)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of private channel"}:{isDiscarded:!1,reasonToDiscard:"None"}}},906166:(e,n,i)=>{"use strict";i.d(n,{Wu:()=>a,wJ:()=>s,KN:()=>c,bX:()=>m,W3:()=>k,fj:()=>g,UM:()=>N,qt:()=>I,eQ:()=>h,rl:()=>S});var a,t=i(136723),r=i(554186),l=i(645095),o=i(809391);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(a||(a={}));const s=new RegExp("https?://[^\\s]+","i"),d="-",c=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let n=e.indexOf(d,1);if(-1===n)return e;let i=e.indexOf(d,n+1);return-1===i&&(i=e.length),i-n==5&&(n=i),e.substring(0,n)},m=e=>{const n=e?c(e):"",i=(0,t.get)("tcurlang")||n;return{targetLanguage:i,knownLanguages:[i]}},u=(e,n)=>(e=>{switch(e){case l.Uf.Success:return"Done";case l.Uf.MessageNotFound:return"MessageNotFound";case l.Uf.VersionNotFound:return"VersionNotFound";case l.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case l.Uf.SkipTranslation:case l.Uf.ContentIsEmpty:return"TranslationNotNeeded";default:return"UnknownError"}})(((e,n)=>{const i=l.Uf[e];return void 0!==i?i:(n?.error(`Unable to parse translation result code: ${e}`),l.Uf.UnknownError)})(e,n)),p=async(e,n,i,a,t,r,o,s,d)=>{try{return await e.translateMessages(n,i,a,t,r,o,d)}catch(e){return s.error(`Failed to translate ${o}: ${e}`),r.map((({id:e,version:n})=>({id:e,version:n||"",detectedLanguage:{languageId:"",score:0},resultCode:l.Uf[l.Uf.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}},k=async(e,n,i,a,t,l,o)=>{const{targetLanguage:s,knownLanguages:d}=i,c=(0,r.v4)(),m=t.map((({messageId:e,version:n})=>n?{id:e,version:n}:{id:e}));return{convId:a,targetLangCode:s,correlationId:c,translations:(await p(e,a,n,s,d,m,c,l,o)).map((e=>({messageId:e.id,content:e.translatedContent||"",sourceLangCode:e.detectedLanguage?.languageId||"",resultCode:u(e.resultCode,l),version:e.version})))}},g=async(e,n,i)=>{try{return(await e.getSupportedTranslationLanguages(n)).map((({languageTag:e,languageName:n})=>({languageCode:e,languageName:n})))}catch(e){return i.error(`Unable to retrieve languages: ${e}`),[]}},N=(e,n,i,t,r)=>{if("string"!=typeof n)return null;try{const e=(0,o.J)(n),l=e.languages?.split(";")?.map((e=>{const[n,i]=e.split(":");return{code:n,score:parseInt(i,10)}})),s=l[0].code;if("null"===s)return null;let d=l.length;d>0&&""===l[d-1].code&&(l.pop(),d--);const c=void 0!==e.length,m=d>0&&"length"===l[d-1].code;if(!(c||m))return{code:s,confidenceLevel:a.LOW};const u=JSON.parse(r??"{}").settingsData,p=u?.find((n=>n.detector===e.detector));if(!(p&&i&&t&&p.minConfidence))return{code:s,confidenceLevel:a.LOW};const k=((e,n)=>{const i=e.minCharMap,a=e.minCharMapOverrides,t=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return a?.[n]??i?.[t.get(n)??""]??i?.others??5})(p,s),g=p.minConfidence??70,N=l.find((e=>e.code===i))?.score;if(i!==s){let n=0;if(c&&(n=parseInt(e.length,10)||0),m&&(n=v(l)),n<k)return{code:s,confidenceLevel:a.LOW};if(N&&N>=g)return{code:i,confidenceLevel:a.LOW}}return{code:s,confidenceLevel:a.HIGH}}catch(i){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${n}.`),null}},v=e=>{const n=e.pop();return n?.score||0},I=(e,n,i,t)=>{const r=n?.code;if(!e||!r||n?.confidenceLevel===a.LOW)return!1;const l=e.knownLanguages;if(r===e.targetLanguageCode||l.includes(r))return!1;switch(e.translationMode){case"SUGGEST_TRANSLATION":return!0;case"ALWAYS_TRANSLATE":if(i&&"ShowOriginalMessage"===t)return!0}return!1},f=(e,n)=>{if(!e)return"ShowOriginalMessage";if(!n)return"Done";switch(n){case l.Uf.Success:return"Done";case l.Uf.SkipTranslation:return"TranslationNotNeeded";case l.Uf.MessageNotFound:return"MessageNotFound";case l.Uf.VersionNotFound:return"VersionNotFound";case l.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case l.Uf.UnsupportedSourceLanguage:return"UnsupportedSourceLanguage";default:return"UnknownError"}},h=e=>{const{body:n,subject:i,title:a,toggled:t,detectedLanguageName:r,sourceLanguageCode:l,targetLanguageCode:o,isOnDemandTranslation:s,isInProgress:d,error:c}=e||{};if(d)return{translationStatus:"InProcess"};return(void 0!==n||void 0!==c)&&r&&l&&o?{translationStatus:f(!!t,c),translatedSubject:i,translatedContent:n,translatedTitle:a,isOnDemandTranslation:s,sourceLanguageName:r,sourceLanguageCode:l}:void 0},S=(e,n,i)=>{if(!i)return!1;let a=null;return i&&(a=i.find((e=>e.languageCode===n))),!(!a||a.messageId===e)}},810886:(e,n,i)=>{"use strict";i.d(n,{qK:()=>s,N4:()=>d,p_:()=>N});var a=i(189888),t=i(800079),r=i(969013),l=i(806658),o=i(364819);const s=(e,n,i,a)=>{const r=t.af.getRequestCount(e),{accountEnabled:l,mri:o,objectId:s,displayName:d,givenName:k,surname:N,type:I,jobTitle:f,userPrincipalName:h,email:S,tenantId:T,sipProxyAddress:M,mobile:y,telephoneNumber:A,tenantName:b,decoratedDisplayName:F,cid:C,description:D,externalCalendarEmailAddress:U,homeMri:E,homeTenantId:w,mtoLabel:L,profileType:O,avatarETag:x}=e,P={__typename:"User",accountEnabled:l,id:v(e),objectId:s,mri:o,displayName:d,givenName:k,surname:N,type:I,jobTitle:f,userPrincipalName:h,email:S,tenantId:i||T||null,sipProxyAddress:M,mobile:y,telephoneNumber:A,requestCount:r,preferredUserName:n,tenantName:b||null,decoratedDisplayName:F||null,cid:C,description:D,externalCalendarEmailAddress:U,emailForQuery:a,homeMri:E,homeTenantId:w,mtoLabel:L,profileType:O,avatarETag:x};return function(e,n){const i=e.department;i&&(n.department=i)}(e,P),p(e,P),u(e,P),c(e,P),m(e,P),g(P),P},d=e=>{const{id:n,displayName:i,description:a,email:t,phone:r,mri:l,requestCount:o,syncSource:s}=e;return{__typename:"User",id:n,mri:l,objectId:l,displayName:i,userPrincipalName:l,givenName:i,surname:i,description:a,email:t,mobile:r,telephoneNumber:r,requestCount:o,syncSource:s}},c=(e,n)=>{if(function(e){const n=e;return void 0!==n.isFederated||void 0!==n.isAnonymousB2bUser||"federated"===n.type?.toLowerCase()}(e)){const{isFederated:i,fetchErrorCode:a,isAnonymousB2bUser:t}=e;n.isFederated=i||"federated"===e.type?.toLowerCase(),n.fetchErrorCode=a,n.isAnonymousB2bUser=t}else n.isFederated=null,n.fetchErrorCode=null,n.isAnonymousB2bUser=null},m=(e,n)=>{e.featureSettings&&(n.featureSettings=e.featureSettings),e.isBlocked&&(n.isBlocked=e.isBlocked),e.cid&&(n.cid=e.cid),e.isIbBarred&&(n.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(n.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(n.phonesInfo=(0,o.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(n.emailsInfo=(0,o.cloneDeep)(e.emailsInfo)),e.xtapUser&&(n.xtapUser=e.xtapUser),e.companyName&&(n.companyName=e.companyName),e.tenantName&&(n.tenantName=e.tenantName),e.imageUri&&(n.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(n.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(n.avatarUrl=e.avatarUrl),n.isShortProfile=e.isShortProfile},u=(e,n)=>{(function(e){return void 0!==e.userType}(e)||function(e){const n=e;return n.type?n.type===a.Pk.botType:(0,l.Iz)(e.mri)}(e)||function(e){return"aduser"===e.type?.toLowerCase()||"aduser"===e.$$subType?.toLowerCase()}(e))&&(n.userType=e.userType,n.description=e.description,n.isUnified=e.isUnified,n.securityEnabled=e.securityEnabled,n.featureSettings=e.featureSettings,n.imageUri=e.imageUri,n.userLocation=e.userLocation)},p=(e,n)=>{const i=e.phones;i&&(n.phones=i.map((e=>k(e))))},k=e=>({number:e.number,type:e.type}),g=e=>{const{mri:n}=e;if((0,r.Ku)(n)&&!e.displayName){const i=(0,r.IK)(n);e.displayName=i,e.givenName=i}else if(n&&(0,l.gZ)(n)&&!e.displayName){const i=(0,l.eu)(n);e.displayName=i,e.givenName=i}else e.displayName||(e.displayName="Unknown User");return e},N=e=>!!e&&!("string"!=typeof e||!t.af.isTFLSmsVerifiedMri(e)),v=e=>e.mri||e.objectId||e.concatenatedId},697673:(e,n,i)=>{"use strict";i.d(n,{mu:()=>t,AZ:()=>r});const a="EntityMoreInfo",t={requestPersonMoreInfo:"requestPersonMoreInfo",requestPersonMoreOrgInfo:"requestPersonMoreOrgInfo",requestTopicMoreInfo:"requestTopicMoreInfo"},r={requestPersonMoreInfo:e=>({originator:a,type:t.requestPersonMoreInfo,data:()=>({...e})}),requestPersonMoreOrgInfo:e=>({originator:a,type:t.requestPersonMoreOrgInfo,data:()=>({...e})}),requestTopicMoreInfo:e=>({originator:a,type:t.requestTopicMoreInfo,data:()=>({...e})})}},363678:(e,n,i)=>{"use strict";i.d(n,{hQ:()=>t,E2:()=>r,YV:()=>l,h1:()=>o,Cu:()=>s,hB:()=>d,hV:()=>c});var a,t,r,l,o,s,d,c;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(a||(a={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(t||(t={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(r||(r={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(l||(l={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(o||(o={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(s||(s={})),function(e){e.activityFeed="activityFeed",e.card="card",e.connectorConfiguration="connectorConfiguration",e.deepLink="deepLink",e.deepLinkStageView="deepLinkStageView",e.deepLinkQuickAccess="deepLinkQuickAccess",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.adaptiveCardStageModal="adaptiveCardStageModal",e.platformAppView="platformAppView",e.chatTab="chatTab",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig",e.storeApp="storeApp",e.stageViewOpenSDKApi="stageViewOpenSDKApi",e.workflows="workflows",e.virtualEvent="virtualEvent",e.botChat="botChat",e.precache="precache"}(d||(d={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB",e.teamsMaglev="TEAMS-MAGLEV"}(c||(c={}))},735915:(e,n,i)=>{"use strict";i.d(n,{Xh:()=>o,fP:()=>l});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"botId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"botId"},value:{kind:"Variable",name:{kind:"Name",value:"botId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"ListValue",values:[{kind:"EnumValue",value:"Personal"}]}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"botId"},value:{kind:"Variable",name:{kind:"Name",value:"botId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope"}}]}},{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotConfigurationScope"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}.definitions]}.definitions]};var t=i(294613),r=i(878336);async function l(e,n,i,t){const{data:l}=await e.query({query:a,variables:{botId:(0,r.Uf)(n),conversationId:i,scope:t}});let s;return l?.installedApps&&l.installedApps.length>0&&(s=o(l.installedApps.map((e=>e?.definition)))),s&&s.length>0||!l?.appDefinitions||(s=o([...l.appDefinitions])),s?.[0]}const o=e=>e?.sort(((e,n)=>(0,t.Z)(n?.version??"0",e?.version??"0")))},99595:(e,n,i)=>{"use strict";i.d(n,{jr:()=>a,gM:()=>t,UB:()=>r,jq:()=>l,m7:()=>o,RS:()=>s,H$:()=>d,_N:()=>c,b5:()=>m,DU:()=>u,iV:()=>p,DP:()=>k,_e:()=>g,zK:()=>N,c3:()=>v,Pq:()=>I,RX:()=>f,H:()=>h,ew:()=>S,ez:()=>U,d9:()=>E,qf:()=>w,Gh:()=>L,RJ:()=>O,FG:()=>x,A1:()=>P,L2:()=>V,IT:()=>j});const a={Team:"Team",Personal:"Personal",GroupChat:"GroupChat"};var t,r,l;!function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(t||(t={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(r||(r={})),function(e){e.UserAppPin="UserAppPin",e.TenantAppPolicyChange="TenantAppPolicyChange"}(l||(l={}));const o={Tab:"Tab",Bot:"Bot",Messaging:"Messaging",Connector:"Connector",StaticTab:"StaticTab",CUSTOMBOT:"CUSTOMBOT"};var s;!function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced",e.Mutated="Mutated",e.HashUpdate="HashUpdate"}(s||(s={}));const d={Unknown:"Unknown",SidePanel:"SidePanel",Stage:"Stage"};var c;!function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(c||(c={}));const m={Unknown:"Unknown",PersonalTab:"PersonalTab",ChannelTab:"ChannelTab",PrivateChatTab:"PrivateChatTab",MeetingChatTab:"MeetingChatTab",MeetingDetailsTab:"MeetingDetailsTab",MeetingSidePanel:"MeetingSidePanel",MeetingStage:"MeetingStage",TeamLevelApp:"TeamLevelApp"};var u,p,k;!function(e){e.Application="Application",e.Delegated="Delegated"}(u||(u={})),function(e){e.Unknown="Unknown",e.Enabled="Enabled",e.Disabled="Disabled"}(p||(p={})),function(e){e.BotBased="botBased",e.ApiBased="apiBased"}(k||(k={}));const g={MRU:"MRU",AlphabeticalAsc:"AlphabeticalAsc",AlphabeticalDesc:"AlphabeticalDesc"};var N,v,I,f,h;!function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(N||(N={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(v||(v={})),function(e){e.User="User",e.AzureAdApp="AzureAdApp"}(I||(I={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(f||(f={})),function(e){e.Federation="Federation"}(h||(h={}));const S={Unknown:"Unknown",TeamsApp:"TeamsApp",TaosSharedApp:"TaosSharedApp"};var T,M,y,A,b,F,C,D;!function(e){e.Mail="mail"}(T||(T={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(M||(M={})),function(e){e.General="general"}(y||(y={})),function(e){e.Short="short",e.Long="long"}(A||(A={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee",e.OnlineMeetingDetailsOrganizer="onlineMeetingDetailsOrganizer",e.LogEventMeetingDetailsAttendee="logEventMeetingDetailsAttendee",e.Default="default"}(b||(b={})),function(e){e.After="after",e.Before="before"}(F||(F={})),function(e){e.Button="button",e.Menu="menu"}(C||(C={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(D||(D={}));var U,E,w,L,O,x,P,V,j;!function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra",e.OAuth2_0="oAuth2.0"}(U||(U={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(E||(E={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(w||(w={})),function(e){e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.NotInstalled="NotInstalled",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(L||(L={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition",e.OpenAiPlugins="OpenAiPlugins"}(O||(O={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(x||(x={})),function(e){e.chats="chats",e.channels="channels",e.channelMeetings="meetings"}(P||(P={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned",e.AdminPrepinned="AdminPrepinned"}(V||(V={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(j||(j={}))},242519:(e,n,i)=>{"use strict";i.d(n,{OV:()=>s,I4:()=>d,$G:()=>c,T8:()=>m,rE:()=>u,Ak:()=>k,Bd:()=>g,qI:()=>N,il:()=>v,M7:()=>I,qJ:()=>h,B7:()=>T});var a=i(84646),t=i(797922),r=i(364819),l=i(806658),o=i(473107);function s(e){const[n,i,t]=function(e){const n=3,i=e.split(";");return i&&i.length===n&&i[0]&&!isNaN(Number(i[0]))&&i[1]&&!isNaN(Number(i[1]))&&i[2]&&!(0,r.isNil)(Number(i[2]))?i:a.S0.split(";")}(e),l=Number(i)||0;return{originalArrivalTime:Number(n)||0,timeStamp:l,clientMessageId:t}}const d=(e,n)=>(0,t.r0)(n.type)?e.chat:(0,t.Mn)(n.type)?e.channel:void 0;function c(e,n){const i=s(e.properties&&e.properties[a.H0.ConsumptionHorizon]||a.S0);if(n){const a=d(n,e)||-1;if(M(e,i.originalArrivalTime,a))return i;i.originalArrivalTime=Math.max(i.originalArrivalTime,a)}return i}function m(e,n,i){const a=n.consumptionHorizon,t=a?.split(";")?.[0]||0,r=Number(t)||0;let l=r;if(i){const a=d(i,e)||-1,t=Number(n.replyChainId);if(M(e,r,a)||!isNaN(t)&&t>a)return{originalArrivalTime:r,timeStamp:0,clientMessageId:""};l=Math.max(r,a)}return{originalArrivalTime:l,timeStamp:0,clientMessageId:""}}function u(e,n){let i=s(p(e.properties)||a.S0);if(n){(d(n,e)||-1)>=i.timeStamp&&(i={originalArrivalTime:0,timeStamp:0,clientMessageId:"0"})}return i}const p=e=>e?.userConsumptionHorizon||e?.consumptionHorizonBookmark||null;function k(e,n){const i=s(e.properties&&e.properties[a.H0.ReplyChainListConsumptionHorizon]||a.S0);if(n){const a=d(n,e)||-1;if(M(e,i.originalArrivalTime,a))return i;i.originalArrivalTime=Math.max(i.originalArrivalTime,a),i.timeStamp=Math.max(i.timeStamp,a)}return i}function g(e){let n=e.lastMessageTimeUtc;if((0,r.isNil)(n)){const i=e.lastMessage?.originalarrivaltime;n=i&&new Date(i).getTime()||0}return n}const N=(e,n)=>{const i=c(e,n),a=u(e,n);return g(e)<=i.originalArrivalTime&&0===a.originalArrivalTime},v=(e,n,i,t=!1)=>{if("newchat"===e.id||(e=>!!e&&-1!==e.indexOf("preview-"))(e.id))return!0;let r=I(e,n,i,t);if(!r&&(e=>!!e&&e.includes(a.nu))(e.id)&&e.lastContentMessageTime&&e.lastMessage&&((0,l.o3)(e.lastMessage)||(0,l.bf)(e.lastMessage.messagetype))){const n=new Date(e.lastContentMessageTime).getTime(),a=c(e,i),t=u(e,i);r=n<=a.originalArrivalTime&&0===t.originalArrivalTime}return r},I=(e,n,i,t=!1)=>{let o="";e.lastMessage&&((0,l.o3)(e.lastMessage)?o=f(e.lastMessage)||"":e.lastMessage.from&&(o=(0,r.last)(e.lastMessage.from.split("/"))||""));const s=N(e,i),d=0===u(e,i).originalArrivalTime,c=-1!==o.indexOf(n);return!!t&&c&&!!e.lastMessage?.properties?.[a.rF.OriginalMessageContext]?s:s||c&&d},f=e=>{let n="";if((0,l.o3)(e)&&e.content){const i=e.content.match(/<initiator>(.*?)<\/initiator>/i);i&&i[1]&&(n=i[1].trim())}return n},h=(e,n)=>{const{clientMessageId:i,originalArrivalTime:a}=u(e,n),t=0!==a?new Date(a).toISOString():o.EJ;return!!i&&"0"!==i&&S(t)},S=e=>{e=e?.toString();return 0!==new Date(e&&"0"!==e?e:o.EJ).valueOf()},T=(e,n,i)=>{const t=h(e,i);let r=!1;if(e.lastMessage?.messagetype===a.Go.CallRecording){const n=new Date(e.lastContentMessageTime||o.EJ),{originalArrivalTime:a}=c(e,i);r=n>new Date(a||o.EJ)}else r=!N(e,i);const l=e.lastMessage?.from,s=!!(l&&n&&l?.indexOf(n)>-1);return t||r&&!s},M=(e,n,i)=>(0,t.r0)(e.type)&&e.threadProperties?.lastjoinat>i&&!S(n)},851433:(e,n,i)=>{"use strict";i.d(n,{cc:()=>y,Yg:()=>v,qb:()=>I,PS:()=>A,iL:()=>h,zk:()=>f,Su:()=>S,XC:()=>M,IH:()=>p,H9:()=>m,Pr:()=>T,Dj:()=>u,Fq:()=>k});var a=i(364819),t=i(25916),r=i(634664);const l=()=>o.instance;class o{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:t.hT,timestamp:void 0}}static get instance(){return o._instance||(o._instance=new o),o._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:n}){this._enabled=e,n.infoToTelemetry?.("Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:t.hT}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:n}){this.isEnabled?(this._currentAppConsumptionHorizon=(0,a.clone)(e),n.infoToTelemetry?.(`AppConsumptionHorizon updated to '${(0,r.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)):n.warnToTelemetry?.(`Tried updating appConsumptionHorizon while singleton was disabled '${(0,r.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var s=i(242519),d=i(84646),c=i(797922);const m=e=>(0,s.qI)(e,N()?l().currentAppConsumptionHorizon:void 0),u=(e,n)=>(0,s.M7)(e,n,N()?l().currentAppConsumptionHorizon:void 0),p=e=>function(e){if(!e.properties)return!1;const n=e.properties[d.H0.LastImportantImTime];return function(e){if(!e)return 0;const n=new Date(e);return n?n.getTime():0}(n)>Number(g(e).originalArrivalTime)}(e),k=e=>{const n=e.threadProperties[d.iy.SharedInSpaces];return!!n&&n.includes(e.parentId)},g=e=>(0,a.isEmpty)(e.properties&&e.properties[d.H0.ConsumptionHorizonBookmark])?v(e):I(e);function N(){return o.instance.isEnabled}const v=e=>(0,s.$G)(e,N()?l().currentAppConsumptionHorizon:void 0),I=e=>(0,s.rE)(e,N()?l().currentAppConsumptionHorizon:void 0),f=e=>(0,s.Ak)(e,N()?l().currentAppConsumptionHorizon:void 0),h=(e,n)=>(0,s.T8)(e,n,N()?l().currentAppConsumptionHorizon:void 0),S=(e,n)=>(0,s.B7)(e,n,N()?l().currentAppConsumptionHorizon:void 0),T=(e,n,i=!1)=>(0,s.il)(e,n,N()?l().currentAppConsumptionHorizon:void 0,i),M=e=>(0,s.qJ)(e,N()?l().currentAppConsumptionHorizon:void 0),y=e=>{let n="";return e&&(n=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),n};function A(e,n){if((0,c.Z9)(e)&&(0,s.il)(e,n,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};if((0,c.IV)(e)&&!(0,s.B7)(e,n,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};const i=(0,s.I4)(l().currentAppConsumptionHorizon,e),a=(0,s.rE)(e,void 0),t=(0,s.Bd)(e),r=y({originalArrivalTime:t,timeStamp:Date.now().valueOf(),clientMessageId:e.lastMessage?.clientmessageid||"0"});let o;return i&&(0,s.qJ)(e,void 0)&&i>=a.timeStamp&&(o=d.S0),{updatedConsumptionHorizon:r,updatedConsumptionHorizonBookmark:o}}},385857:(e,n,i)=>{"use strict";i.d(n,{gw:()=>l,go:()=>o,lb:()=>s});var a=i(754255),t=i(806658),r=i(870785);const l=(e,n,i)=>{const a=(0,r.xB)(e),t=n?new Date(n).getTime():0,l=i?parseInt(i,10):null;return!!(l&&l>=t)||!!a&&!(t&&a<t)},o=(e,n,i,t,o)=>{if(o?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications&&"Declined"===t){return!!(0,r.xB)(e)}return l(e,n,i)},s=(e,n,i,a,r,s)=>(0,t.Qi)(e)?o(n,i,a,r,s):l(n,i,a)},870785:(e,n,i)=>{"use strict";i.d(n,{Rr:()=>d,zk:()=>c,YH:()=>m,UF:()=>u,wD:()=>p,Fp:()=>k,PF:()=>g,GD:()=>N,f3:()=>v,xB:()=>I});var a=i(850434),t=i(754255),r=i(84646),l=i(806658),o=i(797922),s=i(737915);const d=(e,n)=>{const i=(0,o.IJ)(e),a=(0,o.Zl)(e)&&e.memberProperties?.[r.UO.ExplicitlyAdded],t=(0,o.IV)(e)&&!(0,o.Z9)(e)&&!i&&!(0,o.Zp)(e)&&!(0,s.Cy)(e)&&!a&&!(0,o.E0)(e);if((0,o.Gw)(e,n)){const i=(0,o.Y5)(e,n,!0);return!!(0,s.cR)(i)&&t}return t},c=(e,n,i,t)=>{const l=e.threadProperties[r.iy.SharedInSpaces];if(!l)return!1;{let e=[];try{e=JSON.parse(l)}catch(e){return i.error(`Error parsing ${r.iy.SharedInSpaces} property`,t,a.O4.Deserialization),!1}for(const i of e)if(i.spaceThreadId===n)return!0}return!1},m=(e,n,i,a)=>{const t=e.threadProperties[r.iy.SharedInSpaces];try{const e=t&&JSON.parse(t)||[];return e.find((e=>n.includes(e.spaceThreadId)))?.spaceThreadId||""}catch(n){return i.warn(`Couldnt get external team id for the channel ${e.id}`,a),""}},u=(e,n,i)=>{if(e){if(!(0,o.IV)(e))return;const a=e.threadProperties[r.iy.SharedInSpaces],t=[];if(a){const r=p(a,n,i,e.id);if(!r)return;for(const e of r)t.push(e.spaceThreadId);return t}}},p=(e,n,i,a)=>{let t=[];try{t=JSON.parse(e)}catch(e){return void(n.errorToTelemetry&&n.errorToTelemetry(`Error parsing ${r.iy.SharedInSpaces} property for conversationid ${a}`,"team_has_channels_get_shared_teams_failed",i,!0))}return t},k=e=>!(!(0,o.CN)(e)||!e.members?.some((e=>(0,l.Ku)(e.id)))),g=e=>k(e)&&(0,o.FA)(e)?"true"===e.threadProperties?.[r.iy.IsStickyThread]:e.id.includes(r.SE)&&"True"===e.threadProperties?.[r.iy.IsSmsThread],N=e=>{const{enablePaidSmsChat:n,teamsUserPhoneNumbers:i}=e.get(t.w.Messaging);return!(!n||!i?.phoneNumbers?.find((e=>"Primary"===e?.assignmentCategory&&e?.acquiredCapabilities?.includes("InboundA2PSms")&&e?.acquiredCapabilities?.includes("OutboundA2PSms"))))},v=(e,n)=>!!(0,o.IV)(e)&&((0,o.oy)(e)||!n.get(t.w.Sync).disableDeletedConversationPropertyCheck&&(0,o.bI)(e)),I=e=>e&&e!==r.zo.toString()?parseInt(e,10):null},737915:(e,n,i)=>{"use strict";i.d(n,{Jy:()=>Q,Ph:()=>m,rf:()=>u,CA:()=>D,IB:()=>z,FV:()=>R,oB:()=>x,BV:()=>C,IG:()=>P,_5:()=>U,oQ:()=>j,Ns:()=>O,qX:()=>y,y$:()=>g,aY:()=>k,Wq:()=>h,vQ:()=>M,GW:()=>b,n2:()=>F,CR:()=>E,j7:()=>w,Cy:()=>A,oI:()=>p,FF:()=>S,t0:()=>T,SL:()=>B,nK:()=>f,kO:()=>L,cR:()=>V,tH:()=>N});var a=i(754255),t=i(84646),r=i(574566),l=i(364819),o=i(680499),s=i(806658),d=i(473107);var c=i(645095);const m=({isActionToAccept:e,isUserBlocked:n,isInQuarantine:i,quarantineCounter:r,creator:l,currentUserMri:o},s)=>{let d=t.$y.Accepted;if(e){if(n){const e=l===o,{maxInviteFreeQuarantineCounter:n}=s.get(a.w.People),c=r>=(n||0);i&&!e?d=t.$y.AcceptPending:e&&c&&(d=t.$y.Quarantined)}}else d=t.$y.Blocked;return d},u=(e,n)=>e===t.j5.Accept?t.$y.Accepted:e===t.j5.Block?t.$y.Blocked:e===t.j5.Unblock&&n?t.$y.Accepted:t.$y.AcceptPending,p=e=>!!e?.startsWith(t.gN.PhonelinkSmsPrefix),k=(e,n)=>g(e.id,n)&&h(e,n),g=(e,n)=>{if(!I(e))return!1;const{overrideThreadTypeForPrivateFeeds:i}=n.get(a.w.Sync);return(!(0,s.JO)(e)||!i)&&!p(e)},N=(e,n,i)=>{if(!e)return"";if((0,s.zh)(e,!0)){i.errorToTelemetry?.(`Reply chain ID found in conversation ID: ${e}. CallerInfo: ${n}`,"cdl_conversations_fetch",{reason:n,conversationId:e},!0);const{isValid:a,conversationId:t}=(0,s.my)(e);if(a)return t}return e},v=/^\d+[:]{1}.+/,I=e=>!(0,l.isUndefined)(e)&&e!==t.bY&&!p(e)&&!e.includes(t.pK)&&!e.includes(t.LH)&&v.test(e),f=e=>e.startsWith(t.zD)?"MRI conv id":e,h=(e,n)=>!(S(e)&&!function(e){const{msgEnableSfbCloudFromBVD:n}=e.get(a.w.Messaging),{isSfbCloud:i,isSipEnabled:t,isSfbCloudInBVD:r,isSipEnabledInBVD:l}=e.get(a.w.UserResources);return!!(n?l&&r:t&&i)}(n));function S(e){return((0,l.isString)(e)?e:e.id).endsWith(t.lo)}const T=e=>!!e&&S(e),M=e=>{const n=e.memberProperties?.[t.UO.RelationshipState];return!!n?.edRedemptionRequired},y=e=>{const n=e.memberProperties?.[t.UO.RelationshipState];return!!n?.blockTime};const A=e=>!!e.memberProperties?.[t.UO.IsModerator],b=e=>e.threadProperties&&!!e.threadProperties[t.iy.ParentSpaces],F=e=>e.threadProperties&&e.threadProperties[t.iy.ThreadType]===r.b.Team&&b(e),C=e=>{if(e.threadProperties&&e.threadProperties?.[t.iy.ParentSpaces])try{const n=JSON.parse(e.threadProperties?.[t.iy.ParentSpaces]);return n&&n.linkedSpaceInfoItems&&n.linkedSpaceInfoItems[0]&&n.linkedSpaceInfoItems[0].spaceThreadId&&n.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},D=e=>{if(e.threadProperties)try{const n=e.threadProperties.meeting,i=n?JSON.parse(n):void 0;return i?i.meetingType:void 0}catch{return}},U=(e,n,i)=>{if(n){const{enableStreamChatFeature:e,forceCommentStreamForConversations:t}=n.get(a.w.Calling);if(!e)return!1;if(i&&(t??[]).includes(i))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const n=e.toLowerCase();return"true"===n||"on"===n||"1"===n}return!1}(e.isLiveChatEnabled)},E=e=>w(e.type),w=e=>!!e&&e.toLowerCase&&e.toLowerCase()===t.Cr.Meeting.toLowerCase(),L=e=>{let n;if(E(e)&&e.threadProperties.meeting)try{const i=JSON.parse(e.threadProperties.meeting);i.subject&&(n=i.subject)}catch{return n}return n},O=e=>e===t.Go.Text||e===t.Go.RichText||e===t.Go.HTML,x=e=>!!e.members?.some((e=>(0,s.W4)(e.id))),P=e=>e.id===o.lD.CallLogConversationId||e.id===o.lD.SharedCallLogConversationId||(0,s._5)(e?.threadProperties?.threadType),V=e=>{if(e===t.uN)return!1;const n=1209600*d.om*.5;if(!e||isNaN(e))return!0;return e-Date.now()<n},j=e=>e?.threadProperties&&(e?.threadProperties[t.iy.ThreadType]===r.b.Community||e?.threadProperties[t.iy.SpaceType]===t.iy.SpaceType_Community),B=e=>e?.threadProperties&&e?.threadProperties[t.iy.ThreadType]===r.b.SubCommunity,z=e=>e.threadProperties&&e.threadProperties[t.iy.SubstrateGroupId]||"",R=e=>{const n=e.threadProperties?.[t.iy.ThreadSubType]?.toLowerCase();return n||c.jZ.Unknown},Q=e=>{const n=e.threadProperties&&e.threadProperties[t.iy.ThreadType];return W(n)},W=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"}},797922:(e,n,i)=>{"use strict";i.d(n,{UZ:()=>p,kp:()=>k,xL:()=>g,CT:()=>N,oy:()=>v,bI:()=>I,I_:()=>f,bJ:()=>h,kW:()=>S,lz:()=>T,GK:()=>M,Yt:()=>y,FA:()=>A,PP:()=>F,j8:()=>C,E0:()=>D,IJ:()=>U,bl:()=>E,yT:()=>w,Rt:()=>L,BA:()=>x,s8:()=>P,nX:()=>V,Z9:()=>j,r0:()=>B,pB:()=>z,lE:()=>R,as:()=>Q,_Y:()=>W,IV:()=>Y,Mn:()=>G,Zl:()=>_,xt:()=>Z,SG:()=>H,Zp:()=>J,mT:()=>X,Vj:()=>q,HV:()=>K,yW:()=>$,CF:()=>ee,ZV:()=>ne,vz:()=>ie,B6:()=>ae,oh:()=>te,LK:()=>re,Y5:()=>le,Gw:()=>oe,mz:()=>se,aJ:()=>de,iF:()=>ce,h1:()=>me,NX:()=>ue,K$:()=>pe,CN:()=>ke,LN:()=>ge,qL:()=>ve,je:()=>Ie,mv:()=>fe,sx:()=>he,Cy:()=>Se,$i:()=>Ae,kE:()=>be,d2:()=>Fe,__:()=>Ce,CE:()=>De,Yp:()=>Ue,XS:()=>Ee,Ce:()=>we,rD:()=>Le,xl:()=>Oe,L5:()=>xe,Xv:()=>Pe,UC:()=>Ve,Dt:()=>je,kA:()=>Be,V8:()=>ze,$T:()=>Re,W:()=>Qe,Ps:()=>We,Vb:()=>Ye,Gy:()=>Ge,ZT:()=>_e,WH:()=>Ze,rq:()=>He,OW:()=>Je,EO:()=>Ke,F$:()=>$e,T4:()=>en,MO:()=>nn,Nb:()=>an,OK:()=>tn,n_:()=>rn,$x:()=>ln,ze:()=>on,bX:()=>sn,nG:()=>dn,OA:()=>cn,AJ:()=>mn,ME:()=>un,mb:()=>pn,f9:()=>kn,S9:()=>gn,QP:()=>Nn,Bt:()=>vn,mp:()=>In});var a=i(680499),t=i(364819),r=i(754255),l=i(806658),o=i(84646),s=i(574566),d=i(645095),c=i(737915),m=i(404603),u=i(694296);var p;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(p||(p={}));const k=e=>{const n=A(e);return(0,c.FF)(e)?n:n||(0,c.t0)(e)},g=e=>e.threadProperties?.[o.iy.Creator]||null,N=e=>e.threadProperties&&e.threadProperties[o.iy.CreatedAt]?e.threadProperties[o.iy.CreatedAt]:null,v=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const n=e.threadProperties.isDeleted||e.threadProperties[o.iy.IsDeleted];return!!n&&("boolean"==typeof n?n:"function"==typeof n.toLowerCase&&"true"===n.toLowerCase())},I=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const n=e.properties.isDeleted||e.properties[o.H0.isDeleted];return!!n&&("boolean"==typeof n?n:"function"==typeof n.toLowerCase&&"true"===n.toLowerCase())},f=(e,n)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const i=ie(e,n);return 0!==i&&(!(0,t.isNil)(e.lastMessageTimeUtc)&&i>=e.lastMessageTimeUtc)},h=e=>!(!e.properties||!e.properties[o.H0.Followed])&&"true"===e.properties[o.H0.Followed]?.toLowerCase(),S=e=>!(!e.properties||!e.properties[o.H0.Collapsed])&&"true"===e.properties[o.H0.Collapsed]?.toLowerCase(),T=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,M=e=>T(e)||!oe(e);function y(e){return e.includes(o.pK)||e.includes(o.LH)||e===o.bY}const A=e=>(0,l.ye)(e.id,e?.threadProperties?.threadType)&&y(e.id),b="lwgChannelLie-",F=e=>`${b}${e}`,C=e=>e.startsWith(b),D=e=>Y(e)&&e.properties&&!!e.properties.isLie,U=e=>e.threadProperties&&(e.threadProperties[o.iy.ThreadType]===s.b.Team||e.threadProperties[o.iy.ThreadType]===s.b.Community)&&!(0,c.GW)(e),E=e=>!(e.threadProperties[o.iy.ParentSpaces]||!e.threadProperties[o.iy.SubstrateGroupId]||!e.threadProperties[o.iy.GroupId]||e.threadProperties[o.iy.ThreadSubType]),w=e=>U(e)&&!E(e),L=e=>J(e)?We(e)||"":ue(e)||"";function O(e){return!!e.threadProperties&&e.threadProperties[o.iy.ThreadType]===s.b.Team}const x=e=>{if(e.properties){if(e.properties[o.H0.Favorite])return"true"===e.properties[o.H0.Favorite]?.toLowerCase();if(O(e))return!0}return!1},P=e=>!e.properties||void 0===e.properties[o.H0.GeneralChannelFavorite]||null===e.properties[o.H0.GeneralChannelFavorite]||"true"===e.properties[o.H0.GeneralChannelFavorite]?.toLowerCase(),V=e=>{const n=U(e);return n&&P(e)||!n&&x(e)},j=(e,n=!1)=>B(e.type,n),B=(e,n=!1)=>!(0,t.isNil)(e)&&(e.toLowerCase()===o.Cr.Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhoneChat.toLowerCase()||e.toLowerCase()===o.Cr.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===o.Cr.OneOnOne.toLowerCase()||e.toLowerCase()===o.Cr.StreamOfNotes.toLowerCase()||!n&&(0,c.j7)(e)),z=e=>e.type===o.Cr.RCC,R=e=>e.id===a.lD.NotificationConversationId||(0,l.p3)(e?.threadProperties?.threadType),Q=e=>e===a.lD.AnnotationsConversationId,W=e=>e.id===a.lD.DraftsConversationId,Y=e=>G(e.type),G=e=>e===o.Cr.Team||e===o.Cr.Topic,_=e=>se(e)===d.Cu.Shared,Z=e=>se(e)===d.Cu.Standard,H=e=>[o.SG,o.Vn].includes(e.id),J=e=>(0,c.n2)(e)&&(0,c.BV)(e)&&se(e)===d.Cu.Private,X=e=>U(e)&&!!e.memberProperties&&!!e.memberProperties[o.UO.ChannelOnlyMember],q=e=>{if(!(0,c.CR)(e))return!1;const n=(0,c.CA)(e);return!!n&&n===o.Wf.MeetNow},K=e=>{if(!(0,c.CR)(e))return!1;const n=(0,c.CA)(e);return!!n&&n===o.Wf.Scheduled},$=(e,n)=>e.from.substring(e.from.indexOf("/")+1)===(-1===n.indexOf(o.kv)?o.kv+n:n),ee=(e,n)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=n.get(r.w.Sync),a=i||_(e)?e.threadProperties.retentionHorizonV2:0;return a&&isFinite(Number(a))?Number(a):0},ne=(e,n)=>e?.members?.find((e=>e.id===n))?.shareHistoryTime??0,ie=(e,n)=>{if(!e.properties)return 0;if(I(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const i=(!n||!!n.get(r.w.Messaging).enableDeleteChat)&&j(e)?e.properties.clearHistoryTime:0;return i&&isFinite(Number(i))?Number(i):0},ae=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,te=(e,n,i)=>{const a=ee(n,i);return!isNaN(Number(e))&&!isNaN(a)&&Number(e)<a},re=(e,n,i)=>{const a=ie(n,i),t=Number(e);return!isNaN(t)&&!isNaN(a)&&t<a},le=(e,n,i=!1)=>{if((0,l.ye)(e.id,e?.threadProperties?.threadType)&&!T(e)){if(e.memberProperties&&!(0,t.isEmpty)(e.memberProperties)&&i)return e.memberProperties[o.UO.ExpirationTime];if(e.members&&n){const i=(0,t.find)(e.members,(e=>e&&e.id===n));return i&&i.memberExpirationTime}return e.memberProperties&&e.memberProperties[o.UO.ExpirationTime]}},oe=(e,n)=>!(0,l.ye)(e.id,e?.threadProperties?.threadType)||!T(e)&&!v(e)&&((0,t.isArray)(e.members)&&n?(0,t.some)(e.members,(e=>e&&e.id===n)):!(e.threadProperties&&Y(e)&&!e.threadProperties[o.iy.LastLeaveAt]&&!e.threadProperties[o.iy.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[o.iy.LastLeaveAt]&&(!e.threadProperties[o.iy.LastJoinAt]||e.threadProperties[o.iy.LastJoinAt]<e.threadProperties[o.iy.LastLeaveAt])));function se(e){if(!e||!Y(e))return;const n=e.threadProperties[o.iy.SpaceTypes],i=n?parseInt(n,10):0,a=!!e.threadProperties[o.iy.SubstrateGroupId],t=(0,c.FV)(e);return E(e)?d.Cu.Standalone:a?t===d.jZ.PrivateChannel?d.Cu.Private:d.Cu.Shared:(i&d.QU.Private)===d.QU.Private?d.Cu.Private:d.Cu.Standard}const de=(e,n)=>{if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=e.lastMessage?.from;if(!i)return!1;return n===(0,t.last)(i.split("/"))},ce=(e,n)=>(0,t.reduce)(e.members,((e,i)=>{const a=i.id;return a&&a!==n&&e.push(a),e}),[]),me=(e,n,i)=>{let a;const r=!e.members||!!e.members&&(0,t.some)(e.members,(e=>!e));if(i&&!r){const t=ce(e,n);a=A(e)&&1===t.length?i[t[0]]:i[e.id]}return a},ue=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(j(e)){let n=e.threadProperties.topic;if(n&&-1!==n.indexOf(":")&&(n=void 0),!n&&(0,c.CR)(e)){const i=(0,c.kO)(e);i&&(n=i)}return n}if(O(e)&&Ae(e)){const n=We(e);if(n&&n.trim())return n}else{const n=e.threadProperties.topic,i=e.threadProperties[o.iy.TopicThreadTopic];if(i&&i.trim())return i;if(n&&n.trim())return n}}return""},pe=(e,n=!1)=>j(e,!0)&&!xe(e.id)&&!ke(e,n),ke=(e,n=!1)=>{const i=e.members&&e.members.length<=2;return j(e,!0)&&i&&(Se(e)||A(e)||ye(e)||!n&&Me(e)||Ne(e))&&!e.members?.some((e=>(0,l.mD)(e.id)))},ge=e=>ke(e)&&e.members?.some((({id:e})=>(0,l.Iz)(e))),Ne=e=>e.members&&e.members.length<=2&&Te(e)&&(e.type===o.Cr.PhoneChat||e.threadProperties&&e.threadProperties[o.iy.ThreadType]===s.b.PhoneChat),ve=e=>(0,c.oI)(e),Ie=e=>ve(e.id),fe=e=>!!e&&((0,l.Ku)(e)||(0,l.gZ)(e)||(0,l.aL)(e)||(0,l.vd)(e)),he=e=>e.type===o.Cr.PhonelinkGroupChat,Se=e=>e.type===o.Cr.Phonelink1on1Chat,Te=e=>(0,t.some)(e.members,(e=>!!e.id&&e.id.startsWith(o.gN.Pstn))),Me=e=>j(e,!0)&&e.members&&2===e.members.length&&!(0,t.isNil)(e.threadProperties)&&parseInt(e.threadProperties[o.iy.CreatedAt],10)<o.If,ye=e=>!!e.id&&e.id.indexOf(o.W0)>-1||(0,l.CM)(e.threadProperties),Ae=e=>e.threadProperties&&e.threadProperties[o.iy.ThreadType]===s.b.Topic||J(e)||_(e)||(0,c.SL)(e)||D(e),be=e=>(0,c.t0)(e),Fe=e=>Oe(e&&e.id),Ce=e=>be(e)||(e=>Ue(e))(e)||Fe(e),De=e=>Ue(e)||(0,c.t0)(e),Ue=e=>{const n=(0,t.isString)(e)?e:e.id;return(0,t.endsWith)(n,o.L)||(0,t.endsWith)(n,o.s8)||(0,t.startsWith)(n,o.iB)},Ee=e=>Ue(e)||Je(e),we=e=>Ue(e)||Xe(e),Le=(e,n)=>Ke(e)!==n,Oe=e=>!!e&&((0,t.endsWith)(e,o.wx)||(0,t.startsWith)(e,o.Rq)),xe=e=>e===o.cB,Pe=e=>!(e.id!==o.cB||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),Ve=e=>{const n=(0,t.endsWith)(e,o.L)||(0,t.endsWith)(e,o.s8)||(0,t.startsWith)(e,o.iB),i=e.endsWith(o.lo),a=Oe(e);return n||i||a},je=e=>{const n=le(e),i=n&&n<Date.now();return oe(e)&&!i},Be=e=>{if(e.threadProperties&&e.threadProperties[o.iy.Topics]){const n=e.threadProperties[o.iy.Topics];if("["!==n.substr(0,1))return n.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(n)}catch{return[]}}return[]},ze=(e,n)=>{const i=Be(e);for(const e of i)if(e.id===n)return e.isShared??!1;return!1},Re=(e,n)=>{const i=Be(e);for(const e of i)if(e.id===n)return e.archivalLevel?.trim().toLowerCase()},Qe=e=>!!e?.some((e=>(0,l.Iz)(e))),We=e=>{if(e.threadProperties){if(e.threadProperties[o.iy.XTeamName])return e.threadProperties[o.iy.XTeamName];if(e.type===o.Cr.Team&&e.threadProperties.topic)return e.threadProperties.topic}},Ye=e=>{const n=Be(e),i=We(e);return n.map((n=>{const a={},t=n.name;return a[o.iy.CreatedAt]=parseInt(n.createdat,10),a[o.iy.Picture]=n.picture,a[o.iy.IsDeleted]=n.isdeleted,a[o.iy.XTeamName]=n.isShared?t:i,a.topic=t,a[o.iy.TopicThreadTopic]=t,{threadProperties:a,id:n.id,members:[],messages:"",properties:{},version:0,type:o.Cr.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},Ge=e=>{if(e.parentId)return e.parentId;if((0,c.GW)(e))try{const n=JSON.parse(e.threadProperties[o.iy.ParentSpaces]),i=n.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,t.isEmpty)(i))return i}catch{return}},_e=e=>{const n=e.threadProperties&&e.threadProperties[o.iy.SpaceId];return(U(e)?e.id:(0,c.GW)(e)?Ge(e):n)||e.teamId},Ze=e=>{const n=e?e.trim().toLowerCase():void 0;return"true"!==n&&("false"===n||void 0)},He=e=>e.threadProperties&&((0,t.isBoolean)(e.threadProperties[o.iy.GapDetectionEnabled])?e.threadProperties[o.iy.GapDetectionEnabled]:"true"===(0,t.lowerCase)(e.threadProperties[o.iy.GapDetectionEnabled])),Je=e=>!!ke(e)&&Xe(e),Xe=e=>{const n=Ke(e);return n&&!Ue(e)&&(0,t.some)(e.members,(e=>e.tenantId&&e.tenantId!==n))||qe(e.id)||qe(e.localClientId||"")},qe=e=>(0,t.startsWith)(e,o.hd),Ke=e=>e.threadProperties&&e.threadProperties[o.iy.TenantId],$e=e=>{const n=e.threadProperties[o.iy.ArchivalLevel],i=U(e)&&!!n&&n.toLowerCase()===o.L6.Space.toLowerCase(),a=Y(e)&&!!n&&(n.toLowerCase()===o.L6.Topic.toLowerCase()||n.toLowerCase()===o.L6.Space.toLowerCase());return i||a},en=e=>{if(!e||!e.properties)return!1;const n=e.properties[o.H0.isPinned];return!!n&&("boolean"==typeof n?n:"string"==typeof n&&"true"===n.toLowerCase())},nn=e=>{const n=e.memberProperties?.[o.UO.RelationshipState];return!!n?.inQuarantine},an=e=>{const n=e.memberProperties?.[o.UO.RelationshipState];return"number"==typeof n?.quarantineCounter?n?.quarantineCounter:0},tn=e=>!!e.memberProperties?.[o.UO.ExplicitlyAdded],rn=e=>e?.properties?.suppressLastMessageUpdate===o.XR.Sender,ln=e=>ke(e)&&!e.usersProps?.hasFederatedUser&&(0,t.every)(e.members,(e=>e.id?.startsWith(o.kv)))||!1,on=e=>!(!U(e)||parseInt(e.threadProperties?.[o.iy.SpaceTypes],10)!==d.QU.TenantWide),sn=(e,n)=>!!(n&&""!==n&&e.threadProperties&&e.threadProperties[o.iy.TenantId]&&e.threadProperties[o.iy.TenantId]!==n),dn=(e,n)=>!(!U(e)||sn(e,n)||on(e)||v(e)||!oe(e)||X(e)),cn=e=>{if(e?.meetingInfo)try{const n=["Accepted","Declined","Follow","Tentative","None"],i=JSON.parse(e.meetingInfo)?.rsvpStatus;return i&&n.includes(i)?i:"None"}catch(e){return"None"}return"None"},mn=(e,n,i,a)=>{if(a&&i?.get(r.w.Chat).enableRSVPBasedMeetingChatNotifications&&a===e.threadProperties[o.iy.Creator])return!1;const{meetingChatNotification:t=m.AP.MeetingsUserParticipatesIn,meetingChatNotificationForAcceptedMeetings:l=m.AP.MeetingsUserIsInvitedTo,meetingChatNotificationForTentativeMeetings:s=m.AP.MeetingsUserParticipatesIn}={...n},d=m.AP.MeetingsUserIsInvitedTo,c=t!==d;if(!i?.get(r.w.Chat).enableRSVPBasedMeetingChatNotifications)return c||!1;const u=l!==d,p=s!==d;try{const n=e?.properties;switch(cn(n)){case"Declined":case"Follow":return!0;case"Accepted":return u||!1;default:return p||!1}}catch(e){return p||!1}},un=(e,n,i,a)=>{const t=Ze(e?.properties?.alerts);return void 0!==t?t:!!(0,l.Qi)(e.id)&&mn(e,n,i,a)};function pn(e){if(!Y(e)||w(e)||J(e))return!1;const n=le(e);return n!==o.uN&&(!n||n<Date.now())}const kn=e=>gn(e)&&_(e),gn=e=>Y(e)&&!v(e)&&!$e(e)&&V(e)&&oe(e),Nn=(e,n)=>{const i=e.threadProperties[o.iy.CreatedAt]||"0";return fn(i)<n},vn=(e,n)=>e.threadProperties[o.iy.Creator]===n,In=e=>U(e)&&"General"!==e.threadProperties[o.iy.TopicThreadTopic],fn=e=>(0,u.Ql)(parseInt(e,10),Date.now(),"seconds")},580458:(e,n,i)=>{"use strict";i.d(n,{h:()=>t});var a=i(84646);const t=(e,n,i)=>{if(n===a.Go.HTML){if(r(e,i))return a.Go.Collaborate;if(l(e,i))return a.Go.Embed}return n},r=(e,n)=>{const i=o(e,n);if(!i)return!1;const a=i.find((e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!a&&!!a.content.componentUrl},l=(e,n)=>{const i=o(e,n);if(!i)return!1;const a=i.find((e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!a&&!!a.content.componentUrl},o=(e,n)=>{if(n?.cards)try{return JSON.parse(n.cards)}catch(n){e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards.")}return null}},404603:(e,n,i)=>{"use strict";i.d(n,{AP:()=>a,nM:()=>t,$Q:()=>r,KO:()=>l,I_:()=>o,vn:()=>s});const a={MeetingsUserIsInvitedTo:"MeetingsUserIsInvitedTo",MeetingsUserParticipatesIn:"MeetingsUserParticipatesIn",MeetingsManuallyUnmuted:"MeetingsManuallyUnmuted"},t={VOICE_CALL:"VOICE_CALL",VIDEO_CALL:"VIDEO_CALL"},r={aggregatedLikeInChatAndChannel:"AggregatedLikeInChatAndChannel",aggregatedMentionsInTeamAndChannel:"AggregatedMentionsInTeamAndChannel",aggregatedPersonalMention:"AggregatedPersonalMention",aggregatedReplyAndReplyToReply:"AggregatedReplyAndReplyToReply",alertSound:"alertSound",alertSoundType:"alertSoundType",alertUrgentSoundType:"alertUrgentSoundType",allowUrgentNotifications:"allowUrgentNotifications",appNotificationEnabled:"appNotificationEnabled",callTransferFailed:"CallTransferFailed",chat:"Chat",dLPNotifySender:"DLP_NotifySender",downloaded:"Download_Downloaded",downloadFailed:"Download_DownloadFailed",downloadStarted:"Download_DownloadStarted",emailDigestDelay:"EmailDigestDelay",emailNotificationDelay:"EmailNotificationDelay",error:"Error",followChannelNewMessage:"Follow_ChannelNewMessage",followChannelReplyMessage:" Follow_ChannelReplyMessage",globalMention:"Global_Mention",globalSoundAndPreview:"GlobalSoundAndPreview",hideNotificationDuringCallsAndMeetings:"HideNotificationDuringCallsAndMeetings",huddleStartedNotification:"HuddleStartedNotification",incomingCallsAndMeetingStartSound:"IncomingCallsAndMeetingStartSound",inferred:"Inferred",like:"Like",likeInChat:"LikeInChat_v2",meetingChatNotification:"MeetingChatNotification",meetingChatNotificationForAcceptedMeetings:"MeetingChatNotification_AcceptedMeeting",meetingChatNotificationForTentativeMeetings:"MeetingChatNotification_TentativeMeeting",meetingWentLiveNotification:"MeetingWentLiveNotification",mentionChannel:"Mention_Channel",mentionInChat_Everyone:"MentionInChat_Everyone",mentionInChat_Nearby:"MentionInChat_Nearby",mentionInChat_Person:"MentionInChat_Person_v2",mentionPerson:"Mention_Person",mentionTag:"Mention_Tag",mentionTeam:"Mention_Team",messageSendFailed:"MessageSendFailed",msGraphChannelMeetingCanceled:"channelMeetingCanceled",msGraphChannelMeetingCreated:"channelMeetingCreated",msGraphChannelMeetingForwarded:"channelMeetingForwarded",msGraphChannelMeetingForwardedWithoutOrganizer:"channelMeetingForwardedWithoutOrganizer",msGraphChannelMeetingUpdated:"channelMeetingUpdated",msGraphDelegateMeetingCanceled:"delegateMeetingCanceled",msGraphDelegateMeetingCreated:"delegateMeetingCreated",msGraphDelegateMeetingUpdated:"delegateMeetingUpdated",msGraphMeetingOrganisedByMe:"privateMeetingForwardedNotification",msGraphMeetingSentToMe:"privateMeetingCreated",msGraphPrivateMeetingCanceled:"privateMeetingCanceled",msGraphPrivateMeetingForwarded:"privateMeetingForwarded",msGraphPrivateMeetingForwardedNotificationWithAttendee:"privateMeetingForwardedNotificationWithAttendee",msGraphPrivateMeetingForwardedNotificationWithAttendeeAndTotal:"privateMeetingForwardedNotificationWithAttendeeAndTotal",msGraphPrivateMeetingForwardedNotificationWithTwoAttendee:"privateMeetingForwardedNotificationWithTwoAttendee",msGraphPrivateMeetingUpdated:"privateMeetingUpdated",muteGenericNotifications:"muteGenericNotifications",notificationStyleList:"NotificationStyleList",playNotificationSoundsForUrgentAndPriority:"PlayNotificationSoundsForUrgentAndPriority",playNotificationSoundsWhenBusyOrInMeetings:"PlayNotificationSoundsWhenBusyOrInMeetings",presenceStatus:"PresenceStatus",priority:"Priority",projectBoardAssignments:"ProjectBoardAssignments",reply:"Reply",replyToPolls:"ReplyToPolls",replyToReply:"ReplyToReply",resetTeamsAndChannelsSettings:"Reset_Teams_And_Channels_Settings",respectOsDnDForCustomToasts:"RespectOsDnDForCustomToasts",selectedPreset:"selectedPreset",showNotificationDuringCallsAndMeetings:"ShowNotificationDuringCallsAndMeetings",showPreviewInToasts:"ShowPreviewInToasts",showUnreadChatsRemindersInToasts:"showUnreadChatsRemindersInToasts",staffHub:"StaffHub",teamMembershipChangeAddedToSharedChannel:"TeamMembershipChange_AddedToSharedChannel",teamMembershipChangeAddedToTeam:"TeamMembershipChange_AddedToTeam",teamMembershipChangePendingOnBehalfOfJoinRequest:"TeamMembershipChange_PendingOnBehalfOfJoinRequest",teamMembershipChangePendingOnBehalfOfJoinRequestMultiple:"TeamMembershipChange_PendingOnBehalfOfJoinRequestMultiple",teamMembershipChangePendingSelfJoinRequest:"TeamMembershipChange_PendingSelfJoinRequest",teamMembershipChangePromotedToSharedChannelOwner:"TeamMembershipChange_PromotedToSharedChannelOwner",teamMembershipChangePromotedToTeamAdmin:"TeamMembershipChange_PromotedToTeamAdmin",teamMembershipChannelOwnerUnshareTeamOwnerNotify:"TeamMembershipChange_ChannelOwnerUnshareTeamOwnerNotify",teamMembershipTeamOwnerUnshareChannelOwnerNotify:"TeamMembershipChange_TeamOwnerUnshareChannelOwnerNotify",teamMembershipTeamShareTeamOwnerNotify:"TeamMembershipChange_TeamShareTeamOwnerNotify",teamsTasks:"TeamsTasks",thirdParty_Bot:"ThirdParty_Bot",trending:"Trending",useTeamsChimeForToasts:"useTeamsChimeForToasts",visibleChannelMention_v2:"Visible_ChannelMention_v2",visibleChannelNewMessage_v2:"Visible_ChannelNewMessage_v2",visibleChannelReplyMessage_v2:"Visible_ChannelReplyMessage_v2"};var l,o;!function(e){e[e.AllActivity=1]="AllActivity",e[e.MyAtMentions=2]="MyAtMentions",e[e.Custom=3]="Custom"}(l||(l={})),function(e){e.MainPage="notification_settings_text",e.GraphPage="notification_settings_graph_apps_subheader_text",e.ChatPage="notification_settings_details_chat_subheader_text",e.MeetingsPage="notification_settings_details_only_meetings_subheader_text",e.TeamsChannelCustomisedPage="notification_settings_details_teams_channel_button_custom_label",e.CallGroupPage="group_call_forwarding_notification_setting"}(o||(o={}));const s="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"},846026:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{d1:()=>a,gI:()=>t,f_:()=>r,Kq:()=>l,wf:()=>o,Hh:()=>s,ui:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.followPresence="followPresence",e.statusNote="statusNote",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.externalSuggestedContacts="externalSuggestedContacts",e.forwardMessage="forwardMessage",e.virtualEvent="virtualEvent",e.flyout="flyout",e.fluidAtMention="fluidAtMention",e.signersList="signersList",e.addToCommunities="addToCommunities",e.copyTags="copyTags",e.groupTemplate="groupTemplate",e.adaptiveCard="adaptiveCard",e.selectPeopleFilter="selectPeopleFilter",e.addToMeetingRegularChannel="addToMeetingRegularChannel",e.tflDefault="tflDefault",e.tflZeroStateFallback="tflFilterFallback",e.powerbar="powerbar",e.forwardMessageSingleSelection="forwardMessageSingleSelection",e.callForwardNoUserSelection="callForwardNoUserSelection",e.pickerFilterFallback="pickerFilterFallback",e.callingDefault="callingDefault",e.powerbarSearchV2Filter="powerbarSearchV2Filter"}(a||(a={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.Copilots="Copilots",e.CallQandAA="CallQandAA",e.Channels="Channels",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.ExpandedPersonalContact="ExpandedPersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.SkypeConsumer="SkypeConsumer",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers",e.NonEmailSecurityGroupsWithDLs="NonEmailSecurityGroupsWithDLs",e.UnNamedGroupChats="UnNamedGroupChats",e.Teams="Teams"}(t||(t={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(r||(r={}));const l={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},o={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},s={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},8720:(e,n,i)=>{"use strict";i.d(n,{H:()=>s,G:()=>o});var a=i(846026);const t={[a.d1.callForwardGroupSelection]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Pstn,a.gI.CallQandAA],[a.d1.meetingRoomCall]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.PersonalContact,a.gI.CallQandAA,a.gI.Federated,a.gI.FederatedConsumer,a.gI.ImplicitContacts,a.gI.SkypeConsumer,a.gI.TflConsumer],[a.d1.searchSuggestions]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.GroupChats,a.gI.Xtap,a.gI.Meetings,a.gI.TflSmsName,a.gI.SkypeConsumer],[a.d1.addToMeetingForSharedChannel]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.calendarPeoplePicker]:[a.gI.AADTenant,a.gI.Guest,a.gI.Federated,a.gI.DisabledUser,a.gI.PersonalContact,a.gI.ModernGroup,a.gI.DL,a.gI.SkypeConsumer],[a.d1.searchResults]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addToTeam]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.DisabledUser,a.gI.SkypeConsumer,a.gI.NonEmailSecurityGroupsWithDLs,a.gI.TeamTags],[a.d1.newChat]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.TeamTags,a.gI.TflSmsName,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.transfer]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addToCall]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.PersonalContact,a.gI.CallQandAA,a.gI.Federated,a.gI.FederatedConsumer,a.gI.ImplicitContacts,a.gI.SkypeConsumer,a.gI.TflConsumer,a.gI.Xtap,a.gI.Room],[a.d1.addToChat]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DisabledUser,a.gI.TeamTags,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.searchPeopleFilter]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.Pstn,a.gI.TeamTags,a.gI.SkypeConsumer],[a.d1.callRouting]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.delegationSelection]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.SkypeConsumer],[a.d1.presenceSettings]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.addToMeeting]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.meetingSchedule]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DL,a.gI.ModernGroup,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.addToSpeedDialOrContacts]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addContacts]:[a.gI.AADTenant,a.gI.Guest,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.CallQandAA,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.atMention]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.orgChart]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.shareContact]:[a.gI.AADTenant,a.gI.SkypeConsumer],[a.d1.priorityContactsSelection]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Pstn,a.gI.SkypeConsumer,a.gI.Guest],[a.d1.taggedContactsSelection]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.DL,a.gI.SkypeConsumer],[a.d1.shareToTeams]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.SkypeConsumer],[a.d1.escalateMessage]:[a.gI.AADTenant,a.gI.SkypeConsumer],[a.d1.voicemailTransferTarget]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addToSharedChannel]:[a.gI.AADTenant,a.gI.Xtap,a.gI.SkypeConsumer],[a.d1.externalSuggestedContacts]:[a.gI.ImplicitContactsForSMBSuggestions,a.gI.SkypeConsumer],[a.d1.exceptionHandlingPerson]:[a.gI.AADTenant],[a.d1.exceptionHandlingVoiceapp]:[a.gI.CallQandAA],[a.d1.forwardMessage]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.TeamTags,a.gI.TflSmsName,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.statusNote]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.ModernGroup,a.gI.TflSmsName,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.virtualEvent]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.flyout]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DisabledUser,a.gI.TeamTags,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.fluidAtMention]:[a.gI.AADTenant,a.gI.Room,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.signersList]:[a.gI.AADTenant,a.gI.Federated,a.gI.Guest,a.gI.B2BMembers],[a.d1.addToCommunities]:[a.gI.FederatedConsumer,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.groupTemplate]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DisabledUser,a.gI.TeamTags,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones],[a.d1.adaptiveCard]:[a.gI.AADTenant],[a.d1.selectPeopleFilter]:[a.gI.AADTenant,a.gI.Guest],[a.d1.copyTags]:[a.gI.TeamTags],[a.d1.followPresence]:[a.gI.AADTenant],[a.d1.addToMeetingRegularChannel]:[a.gI.AADTenant,a.gI.Federated,a.gI.Guest,a.gI.B2BMembers,a.gI.Room],[a.d1.tflDefault]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.Guest,a.gI.Federated],[a.d1.powerbar]:[],[a.d1.forwardMessageSingleSelection]:[],[a.d1.callForwardNoUserSelection]:[],[a.d1.pickerFilterFallback]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.callingDefault]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.tflZeroStateFallback]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.powerbarSearchV2Filter]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts]};var r=i(364819);const l=(e,n)=>(0,r.flatten)(e.filter((([e,i])=>e===n)).map((([e,n])=>n))),o={[a.f_.Substrate]:[a.gI.AADTenant,a.gI.Guest,a.gI.GroupChats,a.gI.DL,a.gI.ModernGroup,a.gI.Room,a.gI.ExtendedDirectoryUsers,a.gI.PersonalContact,a.gI.MTOUsers,a.gI.CallQandAA],[a.f_.AAD]:[a.gI.Guest],[a.f_.IndexedDb]:[a.gI.Federated,a.gI.FederatedConsumer,a.gI.SkypeConsumer,a.gI.Bot,a.gI.Pstn],[a.f_.MiddleTier]:[],[a.f_.TopNCache]:[],[a.f_.Memory]:[],[a.f_.TFLZeroState]:[]};class s{constructor(e,n){this.includeFeatures=e,this.name=n,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeExpandedPersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeSkypeConsumer=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeNonEmailSecurityGroupsWithDLs=!1,this.includeUnNamedGroupChats=!1,this.includeChannels=!1,this.includeTeams=!1,this.includeCopilots=!1,this.includeAADTenant=(0,r.includes)(e,a.gI.AADTenant),this.includeGuest=(0,r.includes)(e,a.gI.Guest),this.includeFederated=(0,r.includes)(e,a.gI.Federated),this.includeFederatedConsumer=(0,r.includes)(e,a.gI.FederatedConsumer),this.includeBot=(0,r.includes)(e,a.gI.Bot),this.includeCopilots=(0,r.includes)(e,a.gI.Copilots),this.includeDisabledUser=(0,r.includes)(e,a.gI.DisabledUser),this.includeDL=(0,r.includes)(e,a.gI.DL),this.includeModernGroup=(0,r.includes)(e,a.gI.ModernGroup),this.includePersonalContact=(0,r.includes)(e,a.gI.PersonalContact),this.includeExpandedPersonalContact=(0,r.includes)(e,a.gI.ExpandedPersonalContact),this.includeUserDefinedGroup=(0,r.includes)(e,a.gI.UserDefinedGroup),this.includePstn=(0,r.includes)(e,a.gI.Pstn),this.includeCallQandAA=(0,r.includes)(e,a.gI.CallQandAA),this.includeRoom=(0,r.includes)(e,a.gI.Room),this.includeTeamTags=(0,r.includes)(e,a.gI.TeamTags),this.includeGroupChats=(0,r.includes)(e,a.gI.GroupChats),this.includeMeetingChats=(0,r.includes)(e,a.gI.Meetings),this.includeXtap=(0,r.includes)(e,a.gI.Xtap),this.includeOffNetworkEmails=(0,r.includes)(e,a.gI.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,r.includes)(e,a.gI.TflOffNetworkPhones),this.includeSkypeConsumer=(0,r.includes)(e,a.gI.SkypeConsumer),this.includeTflConsumer=(0,r.includes)(e,a.gI.TflConsumer),this.includeTflSmsName=(0,r.includes)(e,a.gI.TflSmsName),this.includeImplicitContacts=(0,r.includes)(e,a.gI.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,r.includes)(e,a.gI.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,r.includes)(e,a.gI.ExtendedDirectoryUsers),this.includeMTOUsers=(0,r.includes)(e,a.gI.MTOUsers),this.includeTfl2WaySmsUsers=(0,r.includes)(e,a.gI.Tfl2WaySmsUsers),this.includeB2BMembers=(0,r.includes)(e,a.gI.B2BMembers),this.includeNonEmailSecurityGroupsWithDLs=(0,r.includes)(e,a.gI.NonEmailSecurityGroupsWithDLs),this.includeUnNamedGroupChats=(0,r.includes)(e,a.gI.UnNamedGroupChats),this.includeChannels=(0,r.includes)(e,a.gI.Channels),this.includeTeams=(0,r.includes)(e,a.gI.Teams)}}s.fromName=(e,n=[])=>{if(!(e in t))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const i=l(n,!0),a=l(n,!1),o=r.without.apply(null,[(0,r.concat)(t[e],i),...a]);return new s(o,e)},s.createFrom=(e,n,i)=>new s(n||e.includeFeatures,i||e.name),s.includesAll=(e,n)=>(0,r.every)(n,(n=>(0,r.includes)(e.includeFeatures,n))),s.includesAny=(e,n)=>(0,r.some)(n,(n=>(0,r.includes)(e.includeFeatures,n)))},98073:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{SV:()=>a,Yw:()=>t,xi:()=>r,Xz:()=>l,L:()=>o,X3:()=>s,s9:()=>d,GA:()=>c,FL:()=>m,gm:()=>u}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(a||(a={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(t||(t={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(r||(r={}));const l=["Large","XMedium","Medium","Small","XSmall"];var o;!function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Pager="Pager",e.Organization="Organization",e.HomeFax="HomeFax",e.BusinessFax="BusinessFax",e.Other="Other",e.Unknown="Unknown",e.Assistant="Assistant",e.OtherFax="OtherFax",e.Radio="Radio"}(o||(o={}));const s={Private:"Private",Public:"Public"};var d,c,m;!function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed"}(d||(d={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateProfileAvatar="update_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl",e.GetProfilePicturePolicy="getProfilePicturePolicy",e.GetExternalProfilesByAliases="getExternalProfilesByAliases"}(c||(c={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(m||(m={}));const u=["displayName","imageUri","selfAvatarLastupdatedTime","profileType","avatarETag"]},189888:(e,n,i)=>{"use strict";i.d(n,{qQ:()=>a,Pk:()=>t,$o:()=>r,A9:()=>l,OY:()=>o,V5:()=>s,PC:()=>d});const a={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},t={botType:"BOT"},r={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",PublicDistributionList:"PublicDistributionList",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser",room:"Room"},l={inTenant:"INTENANT",federated:"FEDERATED",sharedChannel:"SHAREDCHANNEL",skypeConsumer:"SKYPECONSUMER",tflConsumer:"TFLCONSUMER",tflClient:"TFLCLIENT",notRequestedFromMT:"NOTREQUESTEDFROMMT",anonymous:"ANONYMOUS"},o={appOffline:"appOffline",noProfile:"noprofile",noStatus:"nostatus"},s={MTOUser:64,B2BMember:32},d={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},800079:(e,n,i)=>{"use strict";i.d(n,{OJ:()=>p,Oc:()=>k,iB:()=>h,mc:()=>S,et:()=>T,F:()=>M,X7:()=>y,fV:()=>A,lT:()=>F,jP:()=>C,SG:()=>D,af:()=>U});var a,t=i(98073),r=i(846026),l=i(754255),o=i(678937),s=i(189888),d=i(364819),c=i(8720),m=i(791129),u=i(969013);const p="unknown_email_address@invalid.teams.ms",k="4:",g="8:tfloffnetwork:",N=`${g}email:`,v=`${g}phone:`,I="19:",f="50:sms:",h="50:smsunverified:",S="unknown user",T="8:teamsvisitor:",M="8:guest:",y=4,A="28:orgid:",b=["live","sip_profile","myspace","c2c","sms"];var F;!function(e){e.peoplePickerMTSelection="people_picker_mt_selection",e.peoplePickerGroupConversation="people_picker_group_conversation_selection",e.peoplePickerCachedPeople="people_picker_is_cached_people_selection",e.peoplePickerTeamTags="people_picker_team_tags",e.peoplePickerScheduledTags="people_picker_scheduled_tags",e.peoplePickerSubstrateSelection="people_picker_substrate_selection",e.peoplePickerDistributionList="people_picker_distribution_list",e.peoplePickerImplicitContact="people_picker_implicit_contact",e.peoplePickerPSTNSelection="people_picker_pstn_selection",e.peoplePickerChannelConversation="people_picker_channel_conversation_selection",e.peoplePickerTeamConversation="people_picker_team_conversation_selection"}(F||(F={}));const C="TflContacts";var D;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(D||(D={}));class U{static isUnknownUser(e){return e.email===p||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return p}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r){const{id:s}=e;let{displayName:d}=e,c=null;const{enableExternalTagForPSTNUsers:m,enableLabelingUsersByTrustLevel:u,enableMTOLabel:p}=n.get(l.w.People),k=n.get(l.w.Metadata).environment===o.B.life;if(!d)return{displayName:null,securityLabel:c};if(e.isRenamed&&(d=this.checkAndAddEditedTag(d,i),c=this.getEditedUserTag(i)),k)this.isAnonymousUser(s)&&(d=this.checkAndAddGuestTag(d,i),c=this.getGuestUserTag(i));else{if(this.isMTOUser(e))return this.getMTOUserDisplayNamePostfixHelperAndSecurityLabel(!!p,!!r,"mtoLabel"in e?e.mtoLabel:null,d,i);if(this.isAnonymousUser(s)){const n=this.getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,d,!!u,a,i);d=n.displayName,c=n.securityLabel}else if(this.isFederatedUser(e)||this.isExtendedDirectoryUser(e)||this.isTFLConsumerUser(e)||this.isSfcUser(e))this.isAnonymousTfwUser(a)?(d=U.checkAndAddUnverifiedTag(d,i),c=this.getUnverifiedTag(i)):(d=U.checkAndAddExternalTag(d,i),c=this.getExternalTag(i));else if(u&&("isAnonymousB2bUser"in e&&e.isAnonymousB2bUser||this.isAcsUserMri(s)))d=this.checkAndAddUnverifiedTag(d,i),c=this.getUnverifiedTag(i);else if(this.isGuestUser(e))d=this.checkAndAddGuestTag(d,i),c=this.getGuestUserTag(i);else if(u&&this.isAnonymousTfwUser(a)&&this.isConsumerUserMri(s))d=this.checkAndAddUnverifiedTag(d,i),c=this.getUnverifiedTag(i);else if(m&&this.isPSTNUser({mri:e.id})){const a=U.getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e.id,d,n,!!t,i);d=a.displayName,c=a.securityLabel}}return{displayName:d,securityLabel:c}}static getUserDisplayNameWithPostfix(e,n,i,a,t,r){return this.getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r).displayName}static getUserSecurityLabel(e,n,i,a,t,r){const l=this.getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r).securityLabel;if(!l)return null;const o=l.match(/\(([^)]+)\)/g);return o&&o.length?o[o.length-1].slice(1,-1):null}static checkAndAddEditedTag(e,n){const i=this.getDefaultEditedDisplayName(n),a=this.getEditedUserTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddGuestTag(e,n){const i=this.getDefaultGuestDisplayName(n),a=this.getGuestUserTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddExternalTag(e,n){const i=this.getDefaultExternalDisplayname(n),a=this.getExternalTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddUnverifiedTag(e,n){const i=this.getDefaultUnverifiedDisplayname(n),a=this.getUnverifiedTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){const{enableLabelingUsersByTrustLevel:r,disableUnverifiedLabelForPSTNUsers:o}=i.get(l.w.People),{emergencySmsNumbers:s,hotlineSMSNumbers:d}=i.get(l.w.Messaging);return r?o||a||this.isEmergencyOrHotlinePhoneNumber(e,s||[],d||[])?{displayName:U.checkAndAddExternalTag(n,t),securityLabel:this.getExternalTag(t)}:{displayName:U.checkAndAddUnverifiedTag(n,t),securityLabel:this.getUnverifiedTag(t)}:{displayName:U.checkAndAddExternalTag(n,t),securityLabel:this.getExternalTag(t)}}static getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){let r;return"isCcmUser"in e&&e.isCcmUser?(n=this.checkAndAddExternalTag(n,t),r=this.getExternalTag(t)):i?(n=a!==e.id?this.checkAndAddUnverifiedTag(n,t):n,r=this.getUnverifiedTag(t)):(n=this.checkAndAddGuestTag(n,t),r=this.getGuestUserTag(t)),{displayName:n,securityLabel:r}}static getMTOUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){return e&&n&&i?{displayName:`${a} (${i})`,securityLabel:`(${i})`}:e?{displayName:a,securityLabel:null}:{displayName:U.checkAndAddExternalTag(a,t),securityLabel:this.getExternalTag(t)}}static getDefaultEditedDisplayName(e){return e.stringTranslate("calling","default_edited_displayname",{defaultValue:"Edited"})}static getEditedUserTag(e){return e.stringTranslate("calling","edited_user_postfix",{defaultValue:"(Edited)"})}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static applyFeatureFlagSettings(e,n){let i=e.includeFeatures;const a=Boolean(n.get(l.w.Messaging).enableConsumerConversations);switch(e.name){case r.d1.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:t}=n.get(l.w.Federated);t||(i=(0,d.difference)(i,[r.gI.Federated])),e&&(i=(0,d.difference)(i,[r.gI.Bot])),i=a?(0,d.difference)(i,[r.gI.Federated]):(0,d.difference)(i,[r.gI.TflConsumer]);break}case r.d1.pickerFilterFallback:{const{enableTflTfwFederation:e,enableTfwTflFederation:t}=n.get(l.w.Host);a?e&&(i=(0,d.difference)(i,[r.gI.Federated])):t&&(i=(0,d.difference)(i,[r.gI.TflConsumer]));break}case r.d1.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:t}=n.get(l.w.Federated);t||(i=(0,d.difference)(i,[r.gI.Federated])),e&&(i=(0,d.difference)(i,[r.gI.Bot]));break;case r.d1.addToChat:const{enableFederatedUsersInAddToChat:o}=n.get(l.w.Federated),{enableTfwFederationOnTfl:s,enableTfwTflFederation:c}=n.get(l.w.Host);a?s||(i=(0,d.difference)(i,[r.gI.Federated])):(o||(i=(0,d.difference)(i,[r.gI.Federated])),c||(i=(0,d.difference)(i,[r.gI.TflConsumer])));const{enableDLsInAddToChat:m}=n.get(l.w.DistributionLists);m||(i=(0,d.difference)(i,[r.gI.DL]));break;case r.d1.addToTeam:const{enableFederatedUsersInAddToTeam:u}=n.get(l.w.Federated);u||(i=(0,d.difference)(i,[r.gI.Federated]));break;case r.d1.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:p}=n.get(l.w.Federated);p||(i=(0,d.difference)(i,[r.gI.Federated]))}return c.H.createFrom(e,i)}static filterSearchResults(e,n,i){let a=n;return(e=U.applyFeatureFlagSettings(e,i)).includeFederated||(a=a.filter((e=>!(U.isFederatedUser(e)||U.isSfcUser(e)||U.isTFLConsumerUser(e))))),e.includeGuest||(a=a.filter((e=>!U.isGuestUser(e)))),e.includeBot||(a=a.filter((e=>!U.isBot(e)))),e.includeDL||(a=a.filter((e=>!U.isDistributionList(e)))),e.includePstn||(a=a.filter((e=>!U.isPSTNUser(e)))),e.includeAADTenant||(a=a.filter((e=>!U.isInTenantUser(e)))),e.includeCallQandAA||(a=a.filter((e=>!U.isCallQorAAUser(e)))),e.includeSkypeConsumer||(a=a.filter((e=>!U.isSfcUser(e)))),e.includeTflConsumer||(a=a.filter((e=>!U.isTFLConsumerUser(e)))),e.includeTflSmsName||(a=a.filter((e=>!U.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(a=a.filter((e=>!U.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(a=a.filter((e=>!U.isTFLSmsVerifiedMri(e?.mri||"")))),e.includeB2BMembers||(a=a.filter((e=>!U.isB2BMember(e)))),e.includeRoom||(a=a.filter((e=>!U.isConfRoom(e)))),e.includeCopilots||(a=a.filter((e=>!U.isCopilotBot(e.mri,i)))),a}static isMixedChatUser(e,n){const i=!e&&U.isFederatedUser({type:n})||e&&U.isTFLConsumerUser({type:n})||e&&U.isSfcUser({type:n});return Boolean(i)}static isCopilotBot(e,n){const{copilotAppsIds:i}=n.get(l.w.Messaging)??{};return!(!e||!i?.some((n=>`28:${n}`===e)))}static isSfCUserPrefix(e){return-1!==b.indexOf(e)}static matchEmailAliasInMeProfile(e,n){return!(0,d.isEmpty)(n)&&(0,d.some)(n,(n=>e.toLowerCase()===n.address?.toLowerCase()))}static matchPhoneAliasInMeProfile(e,n){return!(0,d.isEmpty)(n)&&(0,d.some)(n,(n=>e===n.number))}static generatePstnProfile(e,n,i,a,t,r,o){let c;const{enableExternalTagForPSTNUsers:p,enableLabelingUsersByTrustLevel:g,disableUnverifiedLabelForPSTNUsers:N}=r?.get(l.w.People)??{},{emergencySmsNumbers:v,hotlineSMSNumbers:I,enablePaidSmsChat:f}=r?.get(l.w.Messaging)??{},h=e.slice(k.length),S=U.getHotlineNumberMapping(h,r);if(a&&i){const t=(0,u.kZ)(h),r=(0,m.n4)(t,i,a,!0);c={mri:e,displayName:(0,d.isEmpty)(n)?f&&S?.shortCode||r.display:n,givenName:r.display,description:f&&S?r.display:void 0,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:s.$o.pstn,telephoneNumber:r.display}}else c={mri:e,displayName:f&&S?.shortCode||n,description:f&&S?.phoneNumber||void 0,givenName:n,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:s.$o.pstn,telephoneNumber:S?.phoneNumber||h};return p&&t?.stringTranslate instanceof Function&&(!g||N||o||this.isEmergencyOrHotlinePhoneNumber(e,v||[],I||[])?c.decoratedDisplayName=U.checkAndAddExternalTag(c.displayName||n,t):c.decoratedDisplayName=U.checkAndAddUnverifiedTag(c.displayName||n,t)),c}static convertStringToBlobFile(e){const n=e.split(",")[1];if((0,d.isEmpty)(n))return;const i=atob(n),a=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(i.length),r=new Uint8Array(t);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);return new Blob([r],{type:a})}static getPhoneNumbers(e){let n=[];return e?.telephoneNumber&&n.push(e.telephoneNumber),e?.phones&&e.phones.length>0&&(n=n.concat(e.phones.map((e=>e.number)))),n}static getExtendedDirectoryPhoneNumber(e){return U.getPhoneNumbers(e)[0]}static isPartialSCContext(e,n){return!!(e&&!n||!e&&n)}static getFederationType(e,n){let i;const a={type:n};return e?U.isTFLUser(a)?i="tflWithTfl":U.isFederatedUser(a)&&(i="tflWithTfw"):U.isSfcUser(a)?i="tfwWithSfc":U.isTFLConsumerUser(a)?i="tfwWithTfl":U.isFederatedUser(a)&&(i="tfwWithTfw"),i}static getTfwExtendedDirectoryMembership(e,n={}){const{mri:i,userType:a}=e,{excludeOffNetwork:t=!0}=n;return!t&&this.isTFLOffNetworkUser(i)?"offNetwork":this.isPEUPUser(a)?"pending":this.isEUPUser(a)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return D.NotResolved;const{type:n,userType:i}=e;if(!n)return D.NotResolved;switch(n){case"Federated":case"TflConsumer":case"SkypeConsumer":case s.$o.pstn:return D.External;case"person":case"ADUser":return i&&"Guest"===i?D.NotResolved:D.User;case"Group":return D.DistributionList;default:return D.User}}static isValidNameForInitialsAvatarForPstnUser(e,n){return!!(U.isPSTNUser({mri:e})&&U.isValidNameForInitialsAvatar(n))}static isValidNameForInitialsAvatar(e){const n=new RegExp("(^\\p{L})","iu");return!!(!!e&&n.test(e))}static getDescriptionForPstnContact(e,n,i,a,t){let r;const{mri:o,displayName:s}=e,c=o.split(k)[1],{enablePaidSmsChat:m}=t.get(l.w.Messaging)??{};return m&&U.isPSTNUser({mri:o})&&a&&(U.isTextSameAsPhoneNumber(s,c,n)||(0,d.forEach)(a,(e=>{U.isTextSameAsPhoneNumber(c,e.number,n)&&(r=i.stringTranslate("people",U.getPhoneTypePeopleKey(e.type),{phoneNumber:e.number}))}))),r}static isSearchV2EnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&!n.includes(e))}static areUnNamedGroupChatsEnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&n.includes(e))}static areChannelsEnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&n.includes(e))}static areTeamsEnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&n.includes(e))}static getTeamPickerItemIdForTeam(e){return`${e}_team`}static getTeamIdFromTeamPickerItemId(e){return e.replace("_team","")}static isTextSameAsPhoneNumber(e,n,i){if(!e||!n)return!1;if(e.toLocaleLowerCase()===n.toLocaleLowerCase())return!0;const a=(0,u.kZ)(e),t=(0,m.n4)(a,"peopleUtilities_isTextSameAsPhoneNumber_Name",i),r=(0,m.n4)(n,"peopleUtilities_isTextSameAsPhoneNumber_Phone",i);return t?.diallable===r?.diallable}static getPhoneTypePeopleKey(e){switch(e){case t.L.Mobile:return`phone_type_${t.L.Mobile}`;case t.L.Business:return`phone_type_${t.L.Business}`;case t.L.Home:return`phone_type_${t.L.Home}`;case t.L.Pager:return`phone_type_${t.L.Pager}`;case t.L.Organization:return`phone_type_${t.L.Organization}`;case t.L.HomeFax:return`phone_type_${t.L.HomeFax}`;case t.L.BusinessFax:return`phone_type_${t.L.BusinessFax}`;case t.L.Assistant:return`phone_type_${t.L.Assistant}`;case t.L.OtherFax:return`phone_type_${t.L.OtherFax}`;case t.L.Radio:return`phone_type_${t.L.Radio}`;default:return`phone_type_${t.L.Other}`}}static isEmergencyOrHotlinePhoneNumber(e,n,i){const a=e.slice(k.length);return n.includes(a)||i.includes(a)}static getHotlineNumberMapping(e,n){const i=n?.get(l.w.People)?.hotlineNumbersMapping||[{shortCode:"988",phoneNumber:"+18002738255"}];for(const n of i)if(e===n?.shortCode||e===n?.phoneNumber)return n}}a=U,U.isFederatedUser=e=>!!e.isFederated||e.type?.toLowerCase()===s.$o.federated.toLowerCase(),U.isGuestUser=e=>e.type===s.$o.guest||e.userType===s.$o.guest,U.isPersonalContactUser=e=>e.type===s.$o.personalContactUser||e.userType===r.gI.PersonalContact,U.isTFLUser=e=>e.type===s.$o.tflUser,U.isTFLConsumerUser=e=>e.type===s.$o.tflConsumer,U.isTFLSmsUser=e=>e.id&&U.isTFLSmsMri(e.id),U.isTFLSmsFriendlyNameUser=e=>e.id&&U.isTFLSmsMri(e.id)&&e.friendlyName,U.isInTenantUser=e=>!(e.type?.toLowerCase()!==s.PC.type.person.toLowerCase()&&e.type!==s.$o.ADUser||U.isGuestUser(e)||e.isFederated),U.isBot=e=>e.type?.toUpperCase()===s.Pk.botType,U.isDistributionList=e=>e.type===s.$o.DistributionList&&(!e.objectType||e.objectType===s.$o.DistributionList),U.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(k),U.isSfcUser=e=>e.type===s.$o.skypeConsumer,U.isTflOrSkypeConsumerUser=e=>U.isTFLConsumerUser(e)||U.isSfcUser(e),U.isMTOUser=e=>e.profileType===s.V5.MTOUser||e.userType===s.$o.MTOUser||e.peopleSubType===s.$o.MTOUser,U.isB2BMemberMTOUser=e=>U.isMTOUser(e)&&(e.type===s.$o.ADUser||e.type===s.$o.person),U.isFederatedMTOUser=e=>U.isMTOUser(e)&&U.isFederatedUser(e),U.isB2BMember=e=>e.profileType===s.V5.B2BMember||e.userType===s.$o.B2BMember,U.isB2BGuest=e=>e.userType===s.$o.guest,U.isExtendedDirectoryUser=e=>U.isPEUPUser(e.userType)||U.isEUPUser(e.userType)||e.type===s.$o.extendedDirectoryUser,U.isConfRoom=e=>e.userType===s.$o.room,U.isPEUPUser=e=>e===s.$o.PendingOrgContact,U.isEUPUser=e=>e===s.$o.OrgContact,U.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),U.isCallQorAAUser=e=>e.type===s.$o.voiceApp,U.isAnonymousUser=e=>a.isAnonymousTfwUser(e)||a.isAnonymousTflUser(e),U.isAnonymousTfwUser=e=>e?.startsWith(T),U.isAnonymousTflUser=e=>e?.startsWith(M),U.isAnonymousPstn=e=>e?.startsWith("4:anonymous"),U.isAcsUserMri=e=>e?.startsWith("8:acs:"),U.isTFLOffNetworkUser=e=>0===e?.indexOf(g),U.isTFLOffNetworkPhoneUser=e=>0===e?.indexOf(v),U.isTFLOffNetworkEmailUser=e=>0===e?.indexOf(N),U.isTFLSmsUnVerifiedMri=e=>0===e?.indexOf(h),U.isTFLSmsVerifiedMri=e=>0===e?.indexOf(f),U.isTFLSmsMri=e=>0===e?.indexOf(f)||0===e?.indexOf(h),U.isTFLSmsOrOffNetworkPhoneMri=e=>U.isTFLOffNetworkPhoneUser(e)||U.isTFLSmsMri(e),U.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>U.isTFLSmsUnVerifiedMri(e)||U.isTFLOffNetworkPhoneUser(e),U.isEnterpriseUserMri=e=>0===e?.indexOf("8:orgid:"),U.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const n=e.split(":");return!!(2===n.length||3===n.length&&a.isSfCUserPrefix(n[1]))},U.isDisplayNameUnknownUser=e=>e?.toLowerCase()===S||"unknown"===e?.toLowerCase(),U.isConversationItem=e=>0===e.id?.indexOf(I),U.isUnNamedConversationItem=e=>void 0!==e.groupChatName&&(null===e.groupChatName||0===e.groupChatName.length),U.isChannelPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===F.peoplePickerChannelConversation&&0===e.id?.indexOf(I),U.isTeamPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===F.peoplePickerTeamConversation&&0===e.id?.indexOf(I),U.isTag=e=>"Tag"===e.type,U.getPhoneNumberFromMri=e=>e&&U.isTFLSmsUnVerifiedMri(e)?e.slice(h.length):""},809391:(e,n,i)=>{"use strict";function a(e){const n=e.startsWith("?")||e.startsWith("#");e=n?e.substring(1):e;const i={};return e.split("&").forEach((e=>{const[n,a]=e.split("=");i[n]=decodeURIComponent((a||"").replace(/^.+?(=)/,""))})),i}i.d(n,{J:()=>a})},912146:(e,n,i)=>{"use strict";i.d(n,{c:()=>p,nD:()=>N,$j:()=>v,wf:()=>I,d$:()=>f});var a=i(329633),t=i(193406),r=i(779898),l=i(944297);const o=new RegExp("media.*\\.giphy\\.com$","i"),s=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.eaglex\\.ic\\.gov$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.eaglex\\.ic\\.gov$","statics\\.teams\\.microsoft\\.scloud$","media.*\\.giphy\\.com$","local\\.teams\\.(?:office|live)\\.com$"].join("|"),"i"),d=new RegExp([".*\\logout*"].join("|"),"i"),c=/^\/asm\/[a-z]+/i,m="/urlp/v1/url/content",u="/urlp/v1/url/image/Favicon",p=e=>`data:${k(e)};base64,${e}`,k=e=>{const n=(0,a.F)(e);let i;return i=255===n[0]&&216===n[1]?"image/jpg":137===n[0]&&80===n[1]&&78===n[2]&&71===n[3]?"image/png":71===n[0]&&73===n[1]&&70===n[2]?"image/gif":66===n[0]&&77===n[1]?"image/bmp":"image/unknown",i},g=e=>{const n=(0,r.z)().location.origin;if((0,t.nA)(e,n))return!0;const i=(0,t.yz)(e).toLowerCase(),a=(0,t.Yn)(e).toLowerCase();return s.test(i)||"teams.microsoft.com"===i&&c.test(a)},N=e=>g(e)&&(e=>{const n=(0,t.Yn)(e).toLowerCase();return!d.test(n)})(e)||e.startsWith("data:image"),v=e=>{const n=(0,t.yz)(e).toLowerCase();return o.test(n)};function I(e){return e.endsWith("/middletier/getGif/giphy.gif")}function f(e,n){try{const i=new URL(e);return g(e)&&!(0,l.D$)(e)&&!(0,t.nA)(e,n)&&(i.pathname===m||i.pathname===u)}catch(e){return!1}}},643074:(e,n,i)=>{"use strict";i.d(n,{Z2:()=>a,zg:()=>t,Fi:()=>r,Jy:()=>l,Y0:()=>o,D$:()=>s,V6:()=>d,n6:()=>c,kW:()=>m});const a=180,t=2,r=.5,l=10,o=48,s=62,d=20,c=250,m=1e4},973893:(e,n,i)=>{"use strict";i.d(n,{Y5:()=>a,yh:()=>r,AJ:()=>l,cD:()=>o});var a,t=i(643074);!function(e){e.ULTRA_WIDE="ultra-wide",e.SUPER_SMALL="super-small",e.THIN="thin",e.TALL="tall",e.STANDARD="standard",e.ONE_PIXEL_IMAGE="one-pixel-image",e.NONE="none"}(a||(a={}));const r=(e,n,i=t.n6)=>{let a=e,r=n;return n>i&&(a=i*a/r,r=i),{width:a,height:r}},l=(e,n)=>{if(1===n&&1===e)return a.ONE_PIXEL_IMAGE;if(n/e>=t.zg)return a.TALL;const i=n<t.Z2;return e/n>=t.zg?i?a.THIN:a.ULTRA_WIDE:i?a.SUPER_SMALL:a.STANDARD},o=(e,n,i)=>{if(i===a.THIN||i===a.ULTRA_WIDE){const i=e/t.Jy,a=n/t.Jy;let r=i;if(i>t.D$||a>t.Y0){const e=2,n=t.Z2/t.Jy,l=t.D$/i,o=n/a;r=Number((i*Math.min(l,o)).toFixed(e))}return{"--calculatedWideImageWidth":`${r}rem`}}return{}}},944297:(e,n,i)=>{"use strict";i.d(n,{IC:()=>S,FF:()=>T,vB:()=>M,Ap:()=>y,D$:()=>A,N7:()=>b,Xd:()=>F,MC:()=>C,Mw:()=>w,lo:()=>L,fq:()=>O,qD:()=>x,QK:()=>P});var a=i(193406),t=i(643074);const r="asm.skype.com",l="api.ams.gcc.teams.microsoft.com",o="urlp.ams.gcc.teams.microsoft.com",s="api.ams.gov.teams.microsoft.us",d="api.ams.dod.teams.microsoft.us",c="api.asyncgw.teams.microsoft.scloud",m="api.asyncgw.teams.microsoftonline.cn",u="api.asyncgw.teams.eaglex.ic.gov",p="asyncgw.teams.microsoft.com",k="/v1/objects",g="/views/video",N="/ams",v="teams.microsoft.com",I=/^\/asm\/[a-z]+/i,f=/^\/asm\/[a-z]+\/v1\/objects/i,h=/v1\/objects\/([^/]{1,300})/i;var S,T;function M(e){if(e&&A(e)){const n=e.match(h);return n&&n[1]||""}return""}function y(e){const n=(0,a.yz)(e).toLowerCase(),i=(0,a.Yn)(e);return n.endsWith(r)||n===l||n===s||n===d||n===c||n===m||n===u||n===o||n.endsWith(p)||n===v&&I.test(i)}function A(e){if(L(e))return!0;const n=(0,a.Yn)(e);return y(e)&&(n.startsWith(k)||f.test(n))}function b(e){if(!e)return!1;const n=(0,a.Yn)(e);return!(!L(e)||!n.endsWith(g))||y(e)&&n.endsWith(g)}function F(e){return b(e)?T.Video:A(e)?T.Image:T.None}async function C(e){const n=e instanceof Blob?new Uint8Array(await(e.arrayBuffer?.())):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return function(e){if(!e)return!1;let n=-1,i=-1;for(let a=0;a<e.length-4;a++)if(97===e[a]&&99===e[a+1]&&84===e[a+2]&&76===e[a+3]&&(i=a),73===e[a]&&68===e[a+1]&&65===e[a+2]&&84===e[a+3]){n=a;break}return i>=0&&n>i}(n);let i=0;for(let e=0;e<n.length-9&&!(D(n,e)&&(U(n,e+8)||E(n,e+8))&&(i++,i>1));e++);return i>1}function D(e,n){return 33===e[n]&&249===e[n+1]&&4===e[n+2]}function U(e,n){return 44===e[n]}function E(e,n){return 33===e[n]&&255===e[n+1]&&11===e[n+2]}function w(e,n){if(!e||!A(e)||!n||e.startsWith(n))return e;return[n,new URL(e).pathname.substring(1)].join("")}function L(e){return(0,a.Yn)(e).toLowerCase().startsWith(N+k)}function O(e){return e>20971520}function x(e){if(!e||"image/*"===e)return"";const n=e.match(/^image\/([^*]+)$/);return n?n[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(S||(S={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(T||(T={}));const P=async(e,n)=>{const i=document.createElement("canvas"),a=i.getContext("2d");return a?new Promise((r=>{const l=new Image;l.onload=()=>{try{const n=t.kW,o=t.kW;let s=l.width,d=l.height;const c=s/d;if(s<=o&&d<=n)return i.remove(),void r(e);s>d?(s=o,d=s/c):(d=n,s=d*c),i.width=s,i.height=d,a.drawImage(l,0,0,s,d),i.toBlob((n=>{let a;n&&(a=URL.createObjectURL(n)),i.remove(),r(a||e)}),"image/png")}catch(a){n.error(`Error resizing image, error: ${a}`),i.remove(),r(e)}},l.src=e})):(i.remove(),e)}},294613:(e,n,i)=>{"use strict";i.d(n,{Z:()=>a});const a=(e,n)=>{if(e===n)return 0;const i=[e,n].map((e=>e.split("."))),[a,t]=i.map((e=>e.length)),r=Math.min(a,t);for(let e=0;e<r;e++){const[n,a]=i.map((n=>parseInt(n[e],10)||0));if(n!==a)return n>a?1:-1}return a>t?1:a<t?-1:0}},544417:(e,n,i)=>{"use strict";i.d(n,{H:()=>t});var a=i(325180);function t(e,n,i){try{return n.readFragment({id:`Call:${e}`,fragment:a.s,fragmentName:"callingFields"})||void 0}catch(e){i?.log("getCall - call not found in cache")}}},441161:(e,n,i)=>{"use strict";var a,t,r,l,o;i.d(n,{A2:()=>a,UI:()=>t,LF:()=>r,Fo:()=>l,D1:()=>o}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(a||(a={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(t||(t={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(r||(r={})),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(l||(l={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(o||(o={}))},475728:(e,n,i)=>{"use strict";i.d(n,{ST:()=>d,Ju:()=>c,GY:()=>S,Yi:()=>T,oG:()=>D,_2:()=>U,rV:()=>E,lg:()=>O,kI:()=>x});var a=i(640483),t=i(84646),r=i(806658),l=i(454007),o=i(364819);const s="The row was removed for this reason -";var d;!function(e){e.Default="default",e.Voicemail="voicemail",e.CallParkService="callParkService",e.OriginalEmergencyCallParticipant="originalEmergencyCallParticipant"}(d||(d={}));const c=({messages:e,callLogsBlacklistedMRIs:n,currentUserMri:i,logger:a,options:{enableRichCallHistoryExtension:t,enableSLACallHistory:r,enableSLACallHistoryFromPersonalHistory:l,currentTabDelegatorId:s,isLogMergedWithSharedCorrelationId:d},tableType:c,callQueueId:I,keepTranscriptMessages:S})=>{const T=r?e.filter((({callLog:e})=>e&&e.isSharedLineAppearanceCallHistory)):[],y=r?e.filter((({callLog:e})=>e&&e.isDeleted)):[],A=new Set(y.map((({callLog:e})=>e&&e.callId))),{logIds:b,accumulateFilteredCallIds:F}=(()=>{const e=new Map;return{accumulateFilteredCallIds:(n,i,a)=>{if(!n){const n=e.get(a)||[];n.push(i),e.set(a,n)}return n},logIds:n=>{for(const[i,a]of e){const e=(0,o.take)((0,o.chunk)(a,10),10),t=e.length;e.forEach(((e,a)=>{n.log(`reduceCallHistoryMessages(${a+1}/${t}) Ids[${i}]: ${e.join(",")}`)}))}}}})(),C=e.filter((e=>{if(e.callLog){const o={callLog:e.callLog,logger:a,tableType:c},d=e.callLog.callId;return F(!m(o),d,"isScreenSharingSession")&&F(!u(o,n),d,"isTargetBlacklisted")&&F(!p(o,A),d,"isCallHistoryDeleted")&&F(!k(o,i),d,"isGroupCallDeclinedByAllParticipants")&&F(h(o,I),d,"callQueueCallsFilter")&&F(!g(o),d,"isOutgoingCallWithNoTarget")&&F(!N(o),d,"isCallHistoryWithCallParkBot")&&F(!v(o,i,T,r,l,s),d,"slaCallHistoryFiltering")&&F(!f(o,i,t),d,"hideImmediateForwardingCallForForwarder")&&F(!L(U(e.callLog,I).isCallQueue,e.callLog),d,"isIncomingNotAcceptedCallQueueCall")}return!1}));a.log(`[reduceCallHistoryMessages] [tableType=${c}]`),b(a);return M({allValidMessages:C,logger:a,isLogMergedWithSharedCorrelationId:d,tableType:c,callQueueId:I,keepTranscriptMessages:S})},m=e=>{const{callLog:n}=e;return n.sessionType===a.b6.ScreenSharing},u=(e,n)=>{const{callLog:i}=e;return!!i.targetParticipant&&n.indexOf(i.targetParticipant.id)>-1},p=(e,n)=>{const{callLog:i}=e;return i.isDeleted||n.has(i.callId)},k=(e,n)=>{const{callLog:i}=e;if(!i.participantList)return!1;return!i.targetParticipant&&1===i.participantList.length&&i.participantList[0].id===n},g=e=>{const{callLog:n}=e;return n.callDirection===a.QO.Outgoing&&!n.targetParticipant&&!n.participantList?.length},N=e=>{const{callLog:n}=e,i=d.CallParkService.toString();return n.targetParticipant?.type===i},v=(e,n,i,a,t,r)=>{const{callLog:l,logger:o,tableType:d}=e,{isSharedLineAppearanceCallHistory:c,isSharedLineAppearanceActivated:m,targetDelegator:u,originatorDelegator:p}=l;if(!a&&c)return o.log(`[slaCallHistoryFiltering] [tableType=${d}] [callId=${l.callId}] ${s} it is an SLA call history from shared history and enableSLACallHistory is disabled`,l),!0;if(l.recordings?.length||l.transcript)return!1;const k=c||m&&t;if(r){const e=!k||!u&&!p||u&&u.id!==r||p&&p.id!==r;return e&&o.log(`[slaCallHistoryFiltering] [tableType=${d}] [callId=${l.callId}] ${s} it is an SLA call history that is not to be displayed on the current delegator's tab. [currentTabDelegatorId=${r}]`),e}{const e=!(!k||I(l)||!(u&&u.id!==n||p&&p.id!==n)),a=!(c||!i.find((e=>e.callLog?.callId===l.callId))),t=e||a;return t&&o.log(`[slaCallHistoryFiltering] [tableType=${d}] [callId=${l.callId}] ${s} it is an SLA call history that is not to be displayed on the personal tab. [isSlaCallHistoryForDelegatorTab=${e}] [isSlaCallHistoryDuplicateOnPersonalTab=${a}]`),t}},I=e=>{const{isIncoming:n,isSharedLineAppearanceActivated:i,isSharedLineAppearanceCallHistory:a,originatorDelegator:t}=e;return n&&i&&!a&&t},f=(e,n,i)=>{const{callLog:t}=e;return!i&&S(t,n)&&t.forwardingType===a.W1.Immediate},h=({callLog:{isCallQueue:e,isMissed:n,callType:i,applicationContent:a,messageType:r}},l)=>{const o=U({callType:i,applicationContent:a},l||void 0).isForCurrentCallQueue;return Boolean(!l||r!==t.Go.HTML||e&&o&&!n)},S=(e,n)=>{const{forwarderParticipant:i,forwardedTargetParticipant:a}=e;return!!(!i&&a||i&&i.id===n)},T=({callType:e,threadId:n,participantList:i})=>e===a.nz.MultiParty&&(i&&i.length>1||!!n),M=({allValidMessages:e,logger:n,isLogMergedWithSharedCorrelationId:i,tableType:a,callQueueId:t,keepTranscriptMessages:r})=>{const l=y(e,n,a,r);return i&&A(a)?b(l,n,a,t):l},y=(e,n,i,a)=>{const r=new Map,l=new Map,o=new Map;e.forEach((e=>{const{messageType:n,callId:i,userParticipantId:a,isSharedLineAppearanceCallHistory:s}=e.callLog;if(!e.callLog)return;const d=s?i:`${i}-${a}`;(n===t.Go.CallTranscript||n===t.Go.CallLogTranscript)&&o.set(d,e),(n===t.Go.CallRecording||n===t.Go.CallLogRecording)&&l.set(d,[...l.get(d)||[],e]),n===t.Go.HTML&&r.set(d,e)}));const s=[];return r.forEach(((e,a)=>{const t=o.get(a);return t&&o.delete(a),s.push(C(e,n,i,t,l.get(a)))})),a&&o.forEach((e=>s.push(e))),s},A=e=>e===a.vF.CallsApp,b=(e,n,i,a)=>{const t=[],r=new Map;return e.forEach((e=>{if(!e.callLog)return void n.warn(`[mergeMessageWithSharedCorrelationId] Did not receive a call log property or invalid messageId [messageId=${e.id}]`);if(!e.callLog.sharedCorrelationId)return void t.push(e);if(e.callLog.targetParticipant&&e.callLog.targetParticipant.id.startsWith(l.C.Bot))return void(D(e.callLog.targetParticipant.id)?t.push(e):n.log(`[mergeMessageWithSharedCorrelationId] [tableType=${i}] [callId=${e.callLog.callId}] ${s} the target participant is a bot that isn't the VoiceApp bot`));const o=r.get(e.callLog.sharedCorrelationId),d=U(e.callLog,a).isCallQueue;if(!o)return void r.set(e.callLog.sharedCorrelationId,{callLog:e.callLog,id:e.callLog.messageId,isCq:d,duration:E(e.callLog)});n.log(`[mergeMessageWithSharedCorrelationId] [tableType=${i}] [callId=${e.callLog.callId}] ${s} This call history row was merged into another because they share the same correlation id [sharedCorrelationId=${e.callLog.sharedCorrelationId}]`);const c=d===o.callLog.startTime<e.callLog.startTime?e.callLog:o.callLog,m=d?E(c):E(e.callLog)+o.duration,u=`${o.id}_${e.callLog.messageId}`;r.set(e.callLog.sharedCorrelationId,{callLog:c,id:u,isCq:d,duration:m})})),r.forEach((({isCq:e,id:n,callLog:i,duration:a})=>{let r=i;e||(r=i.cloneWithConnectAndEndTime?i.cloneWithConnectAndEndTime({...F(i.startTime,a),messageId:n}):{...i,...F(i.startTime,a),messageId:n}),t.push({callLog:r,id:n})})),t},F=(e,n)=>{const i=new Date(e);return{connectTime:e,endTime:new Date(i.valueOf()+n).toISOString()}},C=(e,n,i,a,t)=>{const r={...e},l=(e=>{const n=[];return e&&e.forEach((e=>{e.callLog?.recordings?.length&&n.push(e.callLog.recordings[0])})),n})(t),o=a?.callLog?.transcript;return(o||l.length)&&r.callLog.cloneWithTranscriptAndRecording&&(r.callLog=r.callLog.cloneWithTranscriptAndRecording({callId:r.callLog.callId,userParticipantId:r.callLog.userParticipantId,transcript:o,recordings:l})),(r.callLog.transcript||r.callLog.recordings.length)&&n.log(`[mergeMessageWithRecordingsAndTranscript] [tableType=${i}] ${r.callLog.transcript?"1 transcript row & ":""} ${r.callLog.recordings?.length?`${r.callLog.recordings?.length} recording row(s)`:""} were merged into this row`,r.callLog),r},D=e=>!!e&&(0,r.oG)(e,t.LE),U=({callType:e,applicationContent:n},i)=>{const t={isCallQueue:!1,isForCurrentCallQueue:!1,callQueueType:null};if(n?.type===a.OT.HuntGroup){switch(e){case a.nz.TwoParty:t.callQueueType=a.Eb.transfer;break;case a.nz.MultiParty:t.callQueueType=a.Eb.conference}t.isCallQueue=void 0!==t.callQueueType,t.isForCurrentCallQueue=w(i,n.configId)}else n?.type===a.OT.CallableChannelOboCall&&(t.isCallQueue=!0,t.isForCurrentCallQueue=w(i,n.configId));return t},E=({endTime:e,connectTime:n,targetParticipant:i})=>{let a=0;if(n&&e&&i?.type!==d.Voicemail.toString()){const i=new Date(e),t=new Date(n);a+=Math.round(i.getTime()-t.getTime())}return a},w=(e,n)=>!!e&&!!n&&e===n,L=(e,n)=>e&&n.callDirection===a.QO.Incoming&&n.callState!==a.A2.Accepted,O=e=>{let n;return n="string"!=typeof e?"":e.includes(";ext=")?e:e.split(";")[0],n},x=(e,n,i,t)=>{const r=a.vF.CallsApp===n&&!t,l=e?.userDelegates.delegates,o=l&&l.length>0,s=Boolean(i&&o&&r),d=e?.userDelegators.delegators,c=d&&d.length>0;return{userIsADelegatorOnPersonalTab:s,userIsADelegateOnPersonalTab:Boolean(i&&c&&r&&!s),userIsOnDelegatorTab:Boolean(i&&t)}}},640483:(e,n,i)=>{"use strict";i.d(n,{b6:()=>a,nz:()=>t,A2:()=>r,QO:()=>l,An:()=>o,W1:()=>s,nk:()=>d,Eb:()=>c,ry:()=>m,vF:()=>u,OT:()=>p});const a={Default:"Default",ScreenSharing:"ScreenSharing",EmergencyGroupCall:"EmergencyGroupCall",Unknown:"Unknown"},t={MultiParty:"MultiParty",TwoParty:"TwoParty",Unknown:"Unknown"},r={Accepted:"Accepted",AcceptedElsewhere:"AcceptedElsewhere",Declined:"Declined",Missed:"Missed",Unknown:"Unknown"},l={Outgoing:"Outgoing",Incoming:"Incoming",Unknown:"Unknown"},o={Transferred:"Transferred",TransferAccepted:"TransferAccepted",TransferFailed:"TransferFailed",TransferSucceeded:"TransferSucceeded",Unknown:"Unknown"},s={Immediate:"Immediate",Simultaneous:"Simultaneous",Unanswered:"Unanswered"},d={Voicemail:"Voicemail",SingleTarget:"SingleTarget",MyDelegates:"MyDelegates",DoNothing:"DoNothing",Group:"Group"};var c;!function(e){e.transfer="transfer",e.conference="conference"}(c||(c={}));const m={Hold:"Hold",Resume:"Resume",Barge:"Barge"},u={CallsApp:"CallsApp",CallableChannel:"CallableChannel",QueuesApp:"QueuesApp"};var p;!function(e){e.HuntGroup="HuntGroup",e.CallableChannelOboCall="CallableChannelOboCall"}(p||(p={}))},52437:(e,n,i)=>{"use strict";i.d(n,{a:()=>t});var a=i(364819);class t{constructor(){this._card={type:"AdaptiveCard",version:"1.5",body:[{type:"Container",items:[]}],actions:[]}}addLabel(e){return this.addElement({type:"TextBlock",text:e,weight:"bolder"}),this}addTextBlock(e){return this.addElement({type:"TextBlock",text:e}),this}addTextInput(e,n,i,a,t,r){return this.addElement({type:"Input.Text",id:e,placeholder:n,value:i,maxLength:a,isMultiline:t,label:r?.label,isRequired:r?.isRequired,errorMessage:r?.errorMessage}),this}addNumberInput(e,n,i,a){return this.addElement({type:"Input.Number",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addDateInput(e,n,i,a){return this.addElement({type:"Input.Date",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addTimeInput(e,n,i,a){return this.addElement({type:"Input.Time",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addToggle(e,n,i,a){return this.addElement({type:"Input.Toggle",id:e,title:n,value:i,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addChoiceSet(e,n,i,a,t,r,l){return this.addElement({type:"Input.ChoiceSet",id:e,title:n,isMultiSelect:i,style:a?"compact":"expanded",choices:t,value:r,label:l?.label,isRequired:l?.isRequired,errorMessage:l?.errorMessage}),this}addImageSet(e,n){return this.addElement({type:"ImageSet",id:e,images:n}),this}addSubmitAction(e,n,i,a){return this._card.actions&&this._card.actions.push({id:e,type:"Action.Submit",title:n,data:i,style:a?.style}),this}addSpeak(e){return this._card.speak=e,this}getCard(){return{content:JSON.stringify(this._card),contentType:"application/vnd.microsoft.card.adaptive"}}getRawJson(){return(0,a.cloneDeep)(this._card)}addElement(e){this._card.body&&this._card.body[0].items.push(e)}}},605288:(e,n,i)=>{"use strict";var a;i.d(n,{s:()=>a}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard"}(a||(a={}))},329633:(e,n,i)=>{"use strict";function a(e){if(!e)return new Uint8Array(0);return t(e.split(",")[1])}function t(e){const n=atob(e),i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return i}i.d(n,{a:()=>a,F:()=>t})},516147:(e,n,i)=>{"use strict";function a(e,n){let i="",a="",t=!1;for(let r=0;r<e.length;r++)if("<"!==e[r])if(t){if(">"===e[r]){t=!1,a="";continue}i+=e[r]}else a+=e[r];else{if("/"===e[r+1]){if(a){const e=n[i];e&&e(a),a=""}do{r++}while(">"!==e[r]);continue}i="",t=!0}}i.d(n,{r:()=>a})},634664:(e,n,i)=>{"use strict";i.d(n,{JT:()=>r,oJ:()=>l,M5:()=>o,Gu:()=>d,hR:()=>c});var a=i(364819),t=i(199448);function r(e,n,i){return e=s(e,n,i=i||l),1===n.length&&"object"==typeof n[0]&&(e=s(e,n[0],i)),e}function l(e){if(null===e)return"null";if(void 0===e)return"undefined";const n=typeof e;if("string"===n)return e;if("number"===n||"boolean"===n)return String(e);if("function"===n)return"";if((0,a.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(n){return c(e)}}function o(e,n){let i=`[errorType=${typeof e}]`;return i+=e?"object"==typeof e?`[errorName=${e.name}][errorMessage=${e.message}][errorStack=${e.stack}]`:`[error=${e.toString()}]`:`[error=Undefined ${n} Error]`,(0,t.Mr)(i)}function s(e,n,i){for(const a in n)n.hasOwnProperty(a)&&(e=e.replace(`{${a}}`,i(n[a])));return d(e)}function d(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function c(e,n){const i=new WeakSet;return JSON.stringify(e,((e,n)=>{if(!i.has(n)){if(n&&"object"==typeof n){if(i.add(n),n instanceof Map||n instanceof Set)return Array.from(n);if(n instanceof Error)return`${n.name}: ${n.message}`;if(n.constructor&&n.constructor!==Object&&n.constructor!==Array||n.prototype)return}return n}}),n)}},668625:(e,n,i)=>{"use strict";i.d(n,{j:()=>a});const a=(e,n={},i)=>{let a;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');a=JSON.parse(e)}catch(e){a=n,i?.(e)}return a}},639884:(e,n,i)=>{"use strict";function a(){return(...e)=>e}i.d(n,{K:()=>a})},493701:(e,n,i)=>{"use strict";i.d(n,{L:()=>a});const a={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,zero:48,a:65,c:67,v:68,command:91,contextMenu:93,number0:48,number9:57,numpad0:96,numpad9:105,numpadAdd:107,numpadSubtract:109,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,hyphen:189,forwardslash:191}},454007:(e,n,i)=>{"use strict";var a;i.d(n,{C:()=>a}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:",e.GcchUser="8:gcch:",e.DodUser="8:dod:",e.AcsUser="8:acs:",e.PstnExtension=";ext="}(a||(a={}))},414664:(e,n,i)=>{"use strict";i.d(n,{Mr:()=>l});var a=i(754255),t=i(84646),r=i(797922);const l=(e,n)=>"conversational"===o(e,n),o=(e,n)=>{const{disableModalityCheckForConvUXSyncJobs:i}=m(n);if(i){if((0,r.Z9)(e))return;if((0,r.IV)(e)){return e.threadProperties[t.iy.ChatModalityType]?"post":void 0}return}const a=c(e,n);return s(a)},s=e=>{switch(e){case d.ChatThreadingEnabled:case d.ConversationalChannelConvUXEnabled:return"conversational";case d.PostReplyChannelConvUXDisabled:case d.PostReplyChannelConvUXEnabled:case d.ConversationalChannelConvUXDisabled:return"post";case d.ChatThreadingDisabled:case d.OldChannelCSASync:default:return}};var d;!function(e){e[e.None=0]="None",e[e.ChatThreadingDisabled=1]="ChatThreadingDisabled",e[e.ChatThreadingEnabled=2]="ChatThreadingEnabled",e[e.OldChannelCSASync=3]="OldChannelCSASync",e[e.ConversationalChannelConvUXDisabled=4]="ConversationalChannelConvUXDisabled",e[e.ConversationalChannelConvUXEnabled=5]="ConversationalChannelConvUXEnabled",e[e.PostReplyChannelConvUXDisabled=6]="PostReplyChannelConvUXDisabled",e[e.PostReplyChannelConvUXEnabled=7]="PostReplyChannelConvUXEnabled"}(d||(d={}));const c=(e,n)=>{const{enableThreadingInChat:i,enableConvUXinChannels:l}=m(n),o=e.threadProperties[t.iy.ChatModalityType];return(0,r.Z9)(e)?i&&function(e,n){const{licenseType:i}=n.get(a.w.UserResources),l=["student","teacher"].indexOf(i?.toLowerCase()||"")>-1,o=e.threadProperties[t.iy.ChatModalityType]===t.L5.Conversational||e.threadProperties[t.iy.ThreadingMode]===t.eg.Enabled,s=(0,r.qL)(e.id);return o&&!l&&!s}(e,n)?d.ChatThreadingEnabled:d.ChatThreadingDisabled:(0,r.IV)(e)?o===t.L5.PostReply?l?d.PostReplyChannelConvUXEnabled:d.PostReplyChannelConvUXDisabled:o===t.L5.Conversational?l?d.ConversationalChannelConvUXEnabled:d.ConversationalChannelConvUXDisabled:d.OldChannelCSASync:d.None};function m(e){const{disableModalityCheckForConvUXSyncJobs:n}=e.get(a.w.CdlWorker),{enableThreadingInChat:i}=e.get(a.w.Messaging),{enableConvUXinChannels:t}=e.get(a.w.Channels);return{disableModalityCheckForConvUXSyncJobs:n,enableThreadingInChat:i,enableConvUXinChannels:t}}},694296:(e,n,i)=>{"use strict";i.d(n,{zL:()=>H,O5:()=>J,b4:()=>X,kq:()=>q,$I:()=>K,o9:()=>$,XU:()=>ee,Xd:()=>ne,K1:()=>ie,a$:()=>ae,JJ:()=>te,WB:()=>re,Oh:()=>le,Ql:()=>oe,qi:()=>se,oB:()=>de,PA:()=>ce,Ft:()=>me,tj:()=>ue,sn:()=>pe,g5:()=>ke,ci:()=>ge,ol:()=>Ne,D0:()=>ve,dS:()=>Ie,Y8:()=>fe,ro:()=>he,tF:()=>Se,s0:()=>Te,cK:()=>Me,xc:()=>ye,es:()=>Ae,ef:()=>be,U_:()=>Fe,D:()=>Ce,q7:()=>De,r6:()=>Ue,zx:()=>Ee,y:()=>we,En:()=>Le,m8:()=>Oe,LW:()=>xe});var a=i(473107),t=i(831090),r=i(530351),l=i(949426),o=i(663609),s=i(125203),d=i(501219),c=i(711900),m=i(352448),u=i(346414),p=i(106578),k=i(527850),g=i(559751),N=i(798202),v=i(917917),I=i(366159),f=i(495081),h=i(197891),S=i(524083),T=i(393721),M=i(165435),y=i(188943),A=i(976588),b=i(376850),F=i(465459),C=i(289390),D=i(542992),U=i(573563),E=i(375886),w=i(84167),L=i(863963),O=i(865264),x=i(299556),P=i(811697),V=i(244606),j=i(26402),B=i(548993),z=i(158291),R=i(446550),Q=i(444759),W=i(695909),Y=i(535249),G=i(566058),_=i(629230),Z=i(134585);const H=e=>e instanceof Date?e:new Date(e),J=(e,n)=>H(e).getTime()<=H(n).getTime(),X=e=>(0,t.A)(Ne(H(e)),1),q=(e,n=a.ZD.Sunday)=>(0,r.A)(H(e),{weekStartsOn:n}),K=(e,n=a.ZD.Sunday)=>Ne((0,l.A)(H(e),{weekStartsOn:n})),$=e=>0-H(e).getTimezoneOffset(),ee=(e,{hours:n,minutes:i,seconds:a,milliseconds:t})=>{let r=new Date(e);return void 0===n||isNaN(n)||(r=(0,o.A)(r,n)),void 0===i||isNaN(i)||(r=(0,s.A)(r,i)),void 0===a||isNaN(a)||(r=(0,d.A)(r,a)),void 0===t||isNaN(t)||(r=(0,c.A)(r,t)),r},ne=(e,{hours:n,months:i,minutes:a,days:r,seconds:l})=>{let o=new Date(e);return void 0===n||isNaN(n)||(o=(0,m.A)(o,n)),void 0===a||isNaN(a)||(o=(0,u.A)(o,a)),void 0===l||isNaN(l)||(o=(0,p.A)(o,l)),void 0===r||isNaN(r)||(o=(0,t.A)(o,r)),void 0===i||isNaN(i)||(o=(0,k.A)(o,i)),o},ie=(e,n)=>ne(e,{days:n}),ae=(e,n)=>(0,g.A)(H(H(e)),n),te=(e,n)=>(0,N.A)(H(e),n),re=e=>e&&e.getTime(),le=e=>(0,v.A)(H(e))*a.XP+(0,I.A)(H(e)),oe=(e,n,i)=>{const a=H(n),t=H(e);switch(i){case"hours":return(0,f.A)(a,t);case"minutes":return(0,h.A)(a,t);case"seconds":return(0,S.A)(a,t);case"days":return(0,T.A)(a,t);case"weeks":return(0,M.A)(a,t);case"months":return(0,y.A)(a,t);case"milliseconds":return(0,A.A)(a,t);case"years":return(0,b.A)(a,t);case"calendarDays":return(0,F.A)(a,t)}},se=()=>{try{const e=Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions();return e&&e.timeZone}catch{return""}},de=(e,n)=>!(!n||n.length<1)&&n.indexOf(H(e).getDay())>-1,ce=e=>{const n=ae(new Date(Date.now()),1);return he(H(e),n)},me=(e,n)=>(0,C.A)(H(e),H(n)),ue=e=>(0,D.A)(H(e)),pe=e=>(0,U.A)(H(e)),ke=e=>(0,E.A)(H(e)),ge=e=>(0,w.A)(H(e)),Ne=e=>(0,L.A)(H(e)),ve=e=>(0,O.A)(H(e)),Ie=(e,n)=>(0,x.A)(H(e),H(n)),fe=(e,n)=>(0,P.A)(H(e),H(n)),he=(e,n)=>(0,V.A)(H(e),H(n)),Se=(e,n)=>(0,j.A)(H(e),H(n)),Te=(e,n)=>(0,B.A)(H(e),H(n)),Me=e=>(0,z.A)(H(e)),ye=e=>(0,R.A)(H(e)),Ae=e=>(0,Q.A)(H(e)),be=e=>(0,W.A)(H(e)),Fe=e=>(0,Y.A)(H(e)),Ce=e=>(0,G.A)(H(e)),De=(e,n="extended",i="complete")=>(0,_.A)(H(e),{format:n,representation:i}),Ue=(e,n)=>(0,Z.A)(H(e),n),Ee=(e,n)=>((e=new Date(e)).setMilliseconds(0),n?e.toISOString():De(e)),we=(e,n=0,i=!1)=>{const a=ne(new Date(e),{minutes:new Date(e).getTimezoneOffset()+n});return n>0&&i?Ne(a):a},Le=e=>{const n=e.indexOf("T");if(n<=0)throw new Error(`Invalid date ${e}`);return`${e.substr(0,n)}T00:00:00.000Z`},Oe=(e,n)=>{const i=oe(e,n,"minutes"),t=Math.floor(i/a.XV),r=i%a.XV;return{durationDays:t,durationHours:Math.floor(r/a.XP),durationMinutes:r%a.XP}},xe=e=>{if(!e)return null;switch(typeof e){case"string":try{return new Date(e).toISOString()}catch(n){if(n instanceof RangeError)return new Date(parseInt(e,10)).toISOString()}case"number":return new Date(e).toISOString();default:return null}}},878336:(e,n,i)=>{"use strict";i.d(n,{F6:()=>l,Q2:()=>s,a9:()=>d,Uf:()=>c,l7:()=>m,dG:()=>u,sZ:()=>p,XU:()=>k,qh:()=>g});var a=i(364819),t=i(572909),r=i(84646);function l(e,n){try{const i=o(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,a.uniqBy)(n,(e=>e.toLowerCase()))){let n="";const a=e.split(".");for(let e=0;e<a.length;e++)n+=(e>0?"[.]":"")+a[e].replace("*","[^/^.]+");const t=new RegExp(`^https://${n}((/|\\?).*)?$`,"i");if(i.match(t))return!0}}catch{return!1}return!1}const o=e=>new URL(e).href,s=e=>e?.replace(/;messageid=.*/,""),d=(e,n,i)=>{let a="";if(!e.id||m(e.id))return a;switch(e.type){case t.ck.extensions:try{a=JSON.parse(e.id).threadId||i}catch(n){a=e.id||i||""}break;case t.ck.chats:case t.ck.chatthread:a=e.id.replace("replyChainId","messageid");break;case t.ck.communities:case t.ck.channels:case t.ck.channelthread:let r;try{r=JSON.parse(e.id).channelId}catch{r=e.id}a=n?`${r};messageid=${n}`:r;break;case t.ck.shareformdialog:break;case t.ck.meetingcollaboration:default:a=e.id}return a},c=e=>e&&e.replace(new RegExp(`^${r.gN.BotPrefix}`),""),m=e=>"newchat"===e||e?.includes("preview"),u=(e,n=r.Go.Call)=>n===r.Go.Call&&/<partlist/.test(e)&&!g(e,n),p=(e,n)=>!!k(e,n)&&g(e),k=(e,n)=>n===r.Go.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>'),g=(e,n=r.Go.Call)=>n===r.Go.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},791129:(e,n,i)=>{"use strict";i.d(n,{n4:()=>d,UZ:()=>N,Wd:()=>I,zj:()=>S});var a=i(364819),t=i(454007),r=i(112850),l=i(754255),o=i(969013),s=i(933678);const d=(e,n,i,a)=>{let t={normalized:e,diallable:e,display:e};const{logger:r,userLocale:l,isDialPlansEnabled:s,allowNonE164Mri:d,phoneNumberUtil:m,phoneNumberFormat:k}=i;if(!m||!k)return r.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!m}, isPhoneNumberFormatDefined=${!!k}`),t;if(!e)return r.warn(`[formatPhoneNumber] No phone number provided from: ${n}`),t;if(r.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${n}`),!a){const n=(0,o.tv)(e),a=c(n,i);if(r.log("[formatPhoneNumber] cleaned_formatting"),s){if(t=f(a,i),r.log(`[formatPhoneNumber] isInternalExtension? ${t.isInternalExtension}`),t.isInternalExtension)return t}else r.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),t.normalized=a;d||(t.normalized=u(t.normalized,k.E164,i,!0),r.log("[formatPhoneNumber] NonE164 mri are not allowed"))}t={...t,...p(t.normalized,i)};try{const e=m.getInstance().parseAndKeepRawInput(t.normalized,l);t.display=m.getInstance().formatInOriginalFormat(e,k.INTERNATIONAL),t.isValid=m.getInstance().isPossibleNumber(e)&&m.getInstance().isValidNumber(e)}catch(e){r.error(`[formatPhoneNumber] ${e}`),t.display=t.normalized,t.isValid=!1}return r.log(`[formatPhoneNumber] isValid? ${t.isValid}`),t},c=(e,n)=>{if(!n.phoneNumberUtil)return n.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!n.phoneNumberUtil}`),e;const i=m(e,n),a=e.substring(i.length);return n.phoneNumberUtil.convertAlphaCharactersInNumber(i)+a},m=(e,n)=>{if(!n.phoneNumberUtil)return n.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!n.phoneNumberUtil}`),e;const i=n.phoneNumberUtil.EXTN_PATTERN_,a=e.search(i);return a>=0?e.substring(0,a):e},u=(e,n,i,a,t)=>{const{userLocale:r,logger:l,phoneNumberUtil:o,phoneNumberFormat:s}=i;if(!o||!s)return l.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}, isPhoneNumberFormatDefined=${!!s}`),e;const d=n||s.INTERNATIONAL,c=I(e,i,"parseAndFormatNumber");if(!v(c,i,t))return c;try{if(a){const e=o.getInstance().parse(c,r);return o.getInstance().format(e,d)}{const e=o.getInstance().parseAndKeepRawInput(c,r);return o.getInstance().formatInOriginalFormat(e,d)}}catch(e){return l.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),c}},p=(e,n)=>{const{enableFormattingFixForExtension:i}=n;return{diallable:m(e,n),extension:i?g(e,n):k(e,n)}},k=(e,n)=>{const i=I(e,n,"getExtension");return g(i,n)},g=(e,n)=>{const{enablePstnWithExtnFix:i,enableFixForDtmfTone:a,logger:t,userLocale:r,phoneNumberUtil:l}=n;if(!l)return t.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!l}`),"";if(!i&&!a&&!v(e,n))return t.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return l.getInstance().parse(e,r).getExtension()||""}catch(e){return t.error("Failed to parse and format a phone number",e),""}},N=(e,n,i,a)=>{const{logger:r}=n;let l=`${t.C.Pstn}${e}`;return i&&(l+=`${t.C.PstnExtension}${i}`),r.log(`[generateMriForPstn] context: ${a} Generated MRI: ${l} for dialOutNumber: ${e} ${i?`and extension: ${i}`:""}`),l},v=(e,n,i)=>{const{userLocale:a,logger:t,phoneNumberUtil:r}=n;if(!r)return t.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!r}`),!1;if(!e)return!1;try{const t=I(e,n,"isStandardFormatNormalized"),l=r.getInstance().parse(t,a),o=r.getInstance().isPossibleNumber(l);return i?o:o&&r.getInstance().isValidNumber(l)}catch(e){return t.error("[isStandardFormatNormalized] error:",e),!1}},I=(e,n,i)=>{const{isDialPlansEnabled:a,logger:t}=n;t.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${i}`);const r=(0,o.tv)(e);return a?f(r,n).normalized:r},f=(e,n)=>{const{normalizationRules:i,logger:a,coreSettings:t,ituCountryPrefix:l}=n,o={normalized:e,diallable:e,display:e};if(!i.length)return o;const s=new r.g(i,l,a,t).normalize(e);return o.normalized=s.phoneNumber,o.diallable=s?.phoneNumber,o.display=s?.phoneNumber,o.isInternalExtension=s?.isInternalExtension,o.isValid=s.isNormalized,o},h=(e,n,i,t,r)=>{let l;if(!(0,a.isEmpty)(e)){const n=t?.getInstance().getRegionCodeForCountryCode(Number(e));if(n)return l=n.toLowerCase(),i.log(`Setting locale based on dial plan to ${l}`),l}const o=r?.()||n||"en-US";return o?(l=o.substring(o.indexOf("-")+1).toLowerCase(),i.log(`Setting locale based on teams locale to ${l}`),l):(i.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},S=async(e,n,a,t)=>{const r=e.get(l.w.Calling);let o;try{o=await(async(e,n)=>{let a;try{const t=()=>i.e(725236).then(i.t.bind(i,744465,23));a=await(0,s.wg)(t,"libphonenumber-bundle",n),e.log("[getLibPhoneNumber] Loaded @microsoft/google-libphonenumber.")}catch(n){return e.errorToTelemetry?.(`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. Name: ${n?.name}, Message: ${n?.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${n?.message}`)}return a})(a,t)}catch(e){return a.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!r.allowNonE164Mri,isDialPlansEnabled:!!r.enableDialPlans,enablePstnWithExtnFix:!!r.enablePstnWithExtnFix,normalizationRules:r.dialPlanPolicy?.normalizationRules||[],ituCountryPrefix:r.dialPlanPolicy?.ituCountryPrefix||"",enableFormattingFixForExtension:!!r.enableFormattingFixForExtension,userLocale:h(r.dialPlanPolicy?.ituCountryPrefix||"",n,a,o.PhoneNumberUtil),enableFixForDtmfTone:!!r.enableFixForDtmfTone,logger:a,phoneNumberUtil:o.PhoneNumberUtil,phoneNumberFormat:o.PhoneNumberFormat,coreSettings:e}}},112850:(e,n,i)=>{"use strict";i.d(n,{g:()=>r});var a=i(754255),t=i(969013);class r{constructor(e,n,i,a){this.iTUCountryPrefix=n,this.logger=i,this.coreSettings=a,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){let n=r.removeFormatCharacters(e);n=r.removeGuid(n);const i=this.coreSettings?.get(a.w.Calling);if(this.logger?.log(`[normalize] Feature flag: stopNormalizationOnPlus=${i?.stopNormalizationOnPlus}`),i?.stopNormalizationOnPlus&&n.startsWith("+"))return this.logger?.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:n,isNormalized:!0};let l=1;for(const i of this.normalizeRules){const{pattern:a,translation:t,isInternalExtension:r}=i;if(a.test(n)){const i=n.replace(a,t);return this.logger?.log(`[normalize] [${e}] was normalized into [${i}] using rule ${l} of ${this.normalizeRules.length}: ruleExpression=[${a}] translation=[${t}] isInternalExtension=[${r}].`),{phoneNumber:i,isInternalExtension:r,isNormalized:!0}}l++}if(this.logger?.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${i?.addCountryCodeDuringNormalization}].`),i?.addCountryCodeDuringNormalization&&!n.startsWith("+")&&(0,t.wk)(n)){const a=this.iTUCountryPrefix||i.dialPlanPolicy?.ituCountryPrefix,t=a?`+${a}`:"",r=`${t}${n}`;return this.logger?.log(`[normalize] [${e}] was normalized into [${r}] by adding country code [${t}].`),{phoneNumber:r,isNormalized:!!t}}return{phoneNumber:n}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const n of e)try{this.normalizeRules.push({pattern:new RegExp(n.pattern),translation:n.translation,isInternalExtension:n.isInternalExtension})}catch(e){this.invalidRules.push(n.pattern)}}}},969013:(e,n,i)=>{"use strict";i.d(n,{Ku:()=>t,h4:()=>r,vk:()=>d,Iy:()=>c,IK:()=>m,KM:()=>u,kZ:()=>p,tv:()=>k,wk:()=>g});var a=i(454007);const t=e=>Boolean(e&&e.startsWith(a.C.Pstn)),r=e=>!(!e||!e.startsWith(a.C.AcsUser)),l=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,o=/^\+?\d*[ ]*(\([ ]*\d+[ ]*\))?[0-9 -]+((?:;ext=([0-9]{1,7})|[ \t,]*(?:e?xt(?:ensi(?:o?|))?n?|??|[,x#~]|int|anexo|)[:\.]?[ \t,-]*([0-9]{1,7})#?|[- ]+([0-9]{1,5})#))?$/i,s=e=>e.indexOf("_"),d=e=>{if(!t(e))return!1;const n=e.slice(a.C.Pstn.length);return-1!==s(n)},c=(e,n)=>l.test(e)&&n,m=e=>{let n=e.slice(a.C.Pstn.length);const i=s(n);return-1!==i&&(n=n.slice(0,i)),n},u=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:"",p=e=>e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,""),k=e=>{const n=(e=>e.replace(/[ \(\)\-_\/]+/g,""))(p(e));return n},g=e=>o.test(e?.trim())},435793:(e,n,i)=>{"use strict";function a(e=1){const n=new Uint32Array(e),a=i.g;if(a.msCrypto)a.msCrypto.getRandomValues(n);else if(a.crypto)a.crypto.getRandomValues(n);else{let i=e;for(;i--;){const e=4294967296;n[i]=Math.floor(Math.random()*e)}}return Array.from(n)}function t(e){return 0===(n=1/e,Math.floor(Math.random()*n));var n}i.d(n,{yT:()=>a,Dz:()=>t})},343468:(e,n,i)=>{"use strict";i.d(n,{bi:()=>a,M5:()=>r,XO:()=>c,fz:()=>m,Vv:()=>u,kr:()=>g,r8:()=>v,qU:()=>I,zs:()=>f,fs:()=>h,TY:()=>S,zU:()=>T,wG:()=>M,fV:()=>y,aJ:()=>A,yD:()=>F,T5:()=>C,pc:()=>E});var a,t,r,l=i(84646),o=i(806658),s=i(364819),d=i(189888);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(a||(a={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(t||(t={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(r||(r={}));const c=e=>!!(e&&e.coExistenceMode&&a[e.coExistenceMode]),m=e=>!(e!==a.TeamsOnly),u=e=>!(-1===[a.Islands,a.IslandsWithTempInterop,a.IslandsWithVoipDeepLinking].indexOf(e)),p=e=>!(-1===[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings].indexOf(e)),k=(e,n,i=!1)=>{const a=[l.Vb,l.uM,l.QX,l.Sq,l.Ne,l.gI,l.cA,l.Bh,l.m2,l.Nk,l.zl],t=e.split(":");return a.some((e=>{const a=t.findIndex((n=>n===e.slice(0,-1)));return a>=0&&(i?t.splice(a+1,1):t.splice(a+1,0,n.slice(0,-1)),!0)})),t.join(":")},g=e=>!!e&&(0,s.startsWith)(e,l.gN.SkypeSpacesUser+l.K),N=e=>!!e&&e.includes(l.K)&&!(0,s.startsWith)(e,l.gN.SkypeSpacesUser+l.K),v=e=>!!e&&(0,s.startsWith)(e,l.Ux+l.K),I=e=>!e||N(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.K):void 0,f=e=>!!e&&!(0,s.startsWith)(l.gN.SkypeSpacesUser+l.hh,e)&&e.includes(l.hh),h=e=>!!e&&!(0,s.startsWith)(l.gN.SkypeSpacesUser+l.O,e)&&e.includes(`:${l.O}`),S=e=>!e||h(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.O):void 0,T=e=>!e||f(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.hh):void 0,M=e=>!e||(e=>!!e&&!e.startsWith(l.gN.SkypeSpacesUser+l.OE)&&e.includes(l.OE))(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.OE):void 0,y=e=>{if(e){if(N(e))return k(e,l.K,!0);if(f(e))return k(e,l.hh,!0)}return e},A=e=>e?h(e)?k(e,l.O,!0):void 0:e,b={isAllowed:!1},F=(e,n,i,a,t,r,l,o)=>{const s=l&&l.coExistenceMode,d=r&&r.coExistenceMode;if(!s||!d)return{isAllowed:!0};if(a){const a=((e,n,i,a,t,r,l)=>{const o=l.newLogger("sfb-interop","services-utilities-sfb-interop");return r.isFederated?!a&&i?(o.log("Chat Disabled: current user is not provisioned on Sfb online"),b):r.coExistenceMode&&t.coExistenceMode?e&&i&&m(t.coExistenceMode)&&m(r.coExistenceMode)?{isAllowed:!1,mri:T(r.mri||"")}:i||n||!u(t.coExistenceMode)&&!u(r.coExistenceMode)?!i&&p(r.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:r.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:r.mri}:(o.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(o.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(r))})(e,n,i,t,r,l,o);if(!a.isAllowed)return a}else{const e=((e,n)=>n.coExistenceMode?e&&m(n.coExistenceMode)?{isAllowed:!1,mri:y(n.mri||"")}:!e&&p(n.coExistenceMode)?{isAllowed:!1,mri:I(n.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(i,l);if(!e.isAllowed)return e}return{isAllowed:!0}},C=e=>{const n=f(e);return D(e)||N(e)||n?(i=e)&&((0,s.startsWith)(i,l.gN.SkypeSpacesUser+l.cA)||(0,s.startsWith)(i,l.gN.SkypeSpacesUser+l.Bh)||(0,s.startsWith)(i,l.gN.SkypeSpacesUser+l.m2)||(0,s.startsWith)(i,l.gN.SkypeSpacesUser+l.Nk)||(0,s.startsWith)(i,l.gN.SkypeSpacesUser+l.zl))?e:n?e.replace(l.hh,""):e.replace(l.K,"").replace(l.v,""):e;var i},D=e=>!!e&&!(0,s.startsWith)(l.gN.SkypeSpacesUser+l.v,e)&&e.includes(l.v),U=(e,n,i,a)=>{const r=e.isFederated,l=(o=e.mri||"",(0,s.endsWith)(o,"@sfbonprem.unq.gbl.spaces"));var o;if(n&&r&&!l&&e.coExistenceMode){const n=t[e.coExistenceMode],r=i===t.TeamsOnly&&n===t.TeamsOnly;return r||a.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${t[i]} recipientCoexistenceMode:${t[n]}`),r}return a.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${n} isFederated:${r} isOnPremFederated:${l} coExistenceMode:${e.coExistenceMode}`),!1},E=(e,n,i,a,l,s)=>{if(!(e&&e.mri&&e.userType!==d.$o.guest&&e.type!==d.$o.skypeConsumer&&e.type!==d.$o.tflUser&&(0,o.Y$)(e.mri)))return i.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),r.Teams;if(e.isFederated)return i.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),U(e,l,s,i)?r.NativeFederated:r.Federated;const c=((e,n,i)=>{const a=e.coExistenceMode,l=t[a];if(i.log(`getCoexistenceChatMode - caller: ${n}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${t[l]}, MT coExistenceMode: ${a}`),t[l]!==a&&i.error(`getUserChatMode - Mapping error - coExistenceMode : ${t[l]}, MT coExistenceMode: ${a}`),l){const e=[t.SfBOnly,t.SfBWithTeamsCollab,t.SfBWithTeamsCollabAndMeetings],n=[t.TeamsOnly,t.Islands,t.IslandsWithVoipDeepLinking];if(e.includes(l))return r.SfB;if(n.includes(l))return r.Teams;i.warn(`getUserChatMode - unknown coExistenceMode ${t[l]}`)}else e.isShortProfile||i.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,n,i);if(c)return c;const m=g(e.mri),u=e.isSkypeTeamsUser,p=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return i.log(`getUserChatMode - caller: ${n}, mri: ${e.mri}, isSfbMri: ${m}, isTeamsChatEnabled: ${p}, hasLoggedInToTeams: ${u}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${a}`),!m&&u&&p||e.isSipDisabled||!a?r.Teams:r.SfB}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/796055-7b0faa9faab76285.js.map